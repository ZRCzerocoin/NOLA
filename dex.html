<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NOLA Exchange</title>

<!-- Ethers.js -->
<script src="https://cdn.jsdelivr.net/npm/ethers/dist/ethers.min.js"></script>

<!-- WalletConnect v2 -->
<script src="https://cdn.jsdelivr.net/npm/@walletconnect/web3modal-provider@2.0.13/dist/index.umd.min.js"></script>

<style>
/* ---------------- RESET ---------------- */
*{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',sans-serif;}
body,html{height:100%;overflow-x:hidden;background:#0a0a0a;color:#fff;perspective:1000px;}
a{color:#00ffe0;text-decoration:none;}
a:hover{text-decoration:underline;}

/* ---------------- BACKGROUND ---------------- */
body{overflow-x:hidden;}
.bg{position:fixed;width:100%;height:100%;background:linear-gradient(135deg,#0a0a0a,#0f0f1f);overflow:hidden;z-index:-1;}
.bg span{position:absolute;display:block;width:2px;height:50px;background:#00ffe0;animation:move 20s linear infinite;opacity:0.5;}
@keyframes move{0%{transform:translateY(-100vh) rotate(0deg);}100%{transform:translateY(100vh) rotate(360deg);}}

/* 3D floating cards */
.card-container{display:flex;flex-wrap:wrap;justify-content:center;gap:20px;perspective:1000px;}
.card{background:rgba(255,255,255,0.05);backdrop-filter:blur(15px);border-radius:20px;padding:25px;min-width:250px;max-width:300px;text-align:center;transition:0.3s transform,0.3s box-shadow;transform-style:preserve-3d;box-shadow:0 0 20px rgba(0,255,224,0.2);}
.card:hover{transform: rotateY(15deg) rotateX(10deg) translateY(-10px);box-shadow:0 0 40px rgba(0,255,224,0.4);}
.card h2{color:#00ffe0;margin-bottom:10px;}
.card p{font-size:1.2rem;}

/* ---------------- HEADER ---------------- */
header{display:flex;align-items:center;padding:20px 40px;background:rgba(0,0,0,0.6);backdrop-filter:blur(10px);position:sticky;top:0;z-index:100;}
header img{width:50px;height:50px;margin-right:15px;}
header h1{font-size:1.8rem;font-weight:700;color:#00ffe0;}

/* ---------------- MAIN ---------------- */
main{padding:60px 20px;display:flex;flex-direction:column;align-items:center;gap:40px;}

/* Token Search Bar */
.search-bar{width:100%;max-width:600px;display:flex;gap:10px;}
.search-bar input{flex:1;padding:15px;border:none;border-radius:10px;font-size:1rem;outline:none;background: rgba(255,255,255,0.05);color:#fff;}
.search-bar button{padding:15px 25px;border:none;border-radius:10px;background:#00ffe0;color:#000;font-weight:600;cursor:pointer;transition:0.3s;}
.search-bar button:hover{background:#00bfa5;}

/* Wallet Buttons */
.wallet-buttons{display:flex;gap:15px;justify-content:center;}
.wallet-buttons button{padding:12px 20px;border:none;border-radius:12px;font-weight:600;cursor:pointer;transition:0.3s;background:#ff5a5f;color:#fff;}
.wallet-buttons button:hover{background:#e0484e;}

/* Swap Section */
.swap-section{display:flex;flex-direction:column;gap:15px;width:100%;max-width:600px;}
.swap-section select,input{padding:12px;border-radius:10px;border:none;background: rgba(255,255,255,0.05);color:#fff;font-size:1rem;width:100%;}
.swap-section button{padding:15px;border:none;border-radius:12px;background:#00ffe0;color:#000;font-weight:600;cursor:pointer;transition:0.3s;}
.swap-section button:hover{background:#00bfa5;}

/* Chart */
.chart-container{width:90%;max-width:900px;height:450px;border-radius:20px;overflow:hidden;box-shadow:0 0 20px rgba(0,255,224,0.2);}

/* Footer */
footer{margin-top:60px;padding:30px 20px;background: rgba(0,0,0,0.6);text-align:center;backdrop-filter: blur(10px);color:#aaa;font-size:0.9rem;}
footer a{color:#00ffe0;margin:0 10px;text-decoration:none;}
footer a:hover{text-decoration:underline;}
</style>
</head>
<body>

<div class="bg">
  <span style="left:5%;animation-duration:25s;"></span>
  <span style="left:15%;animation-duration:20s;"></span>
  <span style="left:25%;animation-duration:18s;"></span>
  <span style="left:35%;animation-duration:22s;"></span>
  <span style="left:45%;animation-duration:19s;"></span>
  <span style="left:55%;animation-duration:21s;"></span>
  <span style="left:65%;animation-duration:23s;"></span>
  <span style="left:75%;animation-duration:17s;"></span>
  <span style="left:85%;animation-duration:24s;"></span>
  <span style="left:95%;animation-duration:20s;"></span>
</div>

<header>
  <img src="nol.png" alt="NOLA Logo">
  <h1>NOLA Exchange</h1>
</header>

<main>
  <div class="wallet-buttons">
    <button id="connectWalletBtn">Connect Wallet</button>
  </div>

  <div class="search-bar">
    <input id="tokenSearch" type="text" placeholder="Search token (Polygon)">
    <button id="searchBtn">Search</button>
  </div>

  <div class="card-container" id="cards">
    <div class="card">
      <h2>Best Rate</h2>
      <p id="bestRate">Select token</p>
    </div>
    <div class="card">
      <h2>DEX Source</h2>
      <p id="dexSource">-</p>
    </div>
    <div class="card">
      <h2>Swap</h2>
      <p>Fast & Low Gas</p>
    </div>
  </div>

  <div class="swap-section">
    <select id="fromToken">
      <option value="">Select From Token</option>
    </select>
    <select id="toToken">
      <option value="">Select To Token</option>
    </select>
    <input type="number" id="amount" placeholder="Amount">
    <button id="swapBtn">Swap</button>
  </div>

  <div class="chart-container">
    <iframe src="https://www.coingecko.com/en/coins/polygon" width="100%" height="100%" frameborder="0" style="border:none;"></iframe>
  </div>
</main>

<footer>
  <p>Â© 2025 NOLA Exchange. All rights reserved.</p>
  <p>
    <a href="#">Twitter</a> | 
    <a href="#">Telegram</a> | 
    <a href="#">GitBook</a>
  </p>
</footer>

<script>
// ---------------------- Wallet Connection ----------------------
let provider, signer, userAddress;

async function connectWallet() {
  // MetaMask (desktop/mobile)
  if (window.ethereum) {
    try {
      provider = new ethers.BrowserProvider(window.ethereum);
      const accounts = await provider.send("eth_requestAccounts", []);
      signer = await provider.getSigner();
      userAddress = accounts[0];
      alert(`MetaMask connected: ${userAddress}`);
      return;
    } catch (err) {
      console.error(err);
    }
  }

  // WalletConnect v2
  const WalletConnectProvider = window.WalletConnectProvider.default;
  const wcProvider = new WalletConnectProvider({
    projectId: "6557a92e3698182727669d41cbeb95a1",
    chains: [137]
  });
  try {
    await wcProvider.enable();
    provider = new ethers.BrowserProvider(wcProvider);
    signer = await provider.getSigner();
    userAddress = await signer.getAddress();
    alert(`WalletConnect connected: ${userAddress}`);
  } catch (err) {
    console.error(err);
    alert("Connection failed!");
  }
}

document.getElementById('connectWalletBtn').addEventListener('click', connectWallet);

// ---------------------- Token List ----------------------
let tokens = [];
async function loadTokens(){
  const res = await fetch('https://tokens.coingecko.com/polygon/all.json');
  const data = await res.json();
  tokens = data.tokens;
  const fromSelect = document.getElementById('fromToken');
  const toSelect = document.getElementById('toToken');
  tokens.forEach(t=>{
    const opt1 = document.createElement('option');
    opt1.value = t.address;
    opt1.textContent = `${t.symbol} - ${t.name}`;
    fromSelect.appendChild(opt1);
    const opt2 = document.createElement('option');
    opt2.value = t.address;
    opt2.textContent = `${t.symbol} - ${t.name}`;
    toSelect.appendChild(opt2);
  });
}
loadTokens();

// ---------------------- Token Search ----------------------
document.getElementById('searchBtn').addEventListener('click',()=>{
  const val = document.getElementById('tokenSearch').value.toUpperCase();
  const found = tokens.find(t=>t.symbol.toUpperCase()===val || t.name.toUpperCase()===val);
  if(found){
    document.getElementById('bestRate').textContent = `1 ${found.symbol} = ?`;
    document.getElementById('dexSource').textContent = "Best route via 1inch API";
  }else{
    alert("Token not found on Polygon list!");
  }
});

// ---------------------- Swap (Demo) ----------------------
document.getElementById('swapBtn').addEventListener('click',async()=>{
  if(!userAddress){alert("Connect wallet first!"); return;}
  const from = document.getElementById('fromToken').value;
  const to = document.getElementById('toToken').value;
  const amount = document.getElementById('amount').value;
  if(!from||!to||!amount){alert("Fill all swap fields"); return;}
  alert(`Swap ${amount} from ${from} to ${to} (demo). Transaction will open in wallet in real app.`);
});
</script>
</body>
</html>
