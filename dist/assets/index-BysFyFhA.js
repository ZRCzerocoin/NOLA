(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function r(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(n){if(n.ep)return;n.ep=!0;const s=r(n);fetch(n.href,s)}})();var Ur=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Os(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Wm(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var r=function i(){return this instanceof i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(i){var n=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(r,i,n.get?n:{enumerable:!0,get:function(){return t[i]}})}),r}var _f={exports:{}};const Jv={},Qv=Object.freeze(Object.defineProperty({__proto__:null,default:Jv},Symbol.toStringTag,{value:"Module"})),Zv=Wm(Qv);_f.exports;(function(t){(function(e,r){function i(A,d){if(!A)throw new Error(d||"Assertion failed")}function n(A,d){A.super_=d;var f=function(){};f.prototype=d.prototype,A.prototype=new f,A.prototype.constructor=A}function s(A,d,f){if(s.isBN(A))return A;this.negative=0,this.words=null,this.length=0,this.red=null,A!==null&&((d==="le"||d==="be")&&(f=d,d=10),this._init(A||0,d||10,f||"be"))}typeof e=="object"?e.exports=s:r.BN=s,s.BN=s,s.wordSize=26;var o;try{typeof window<"u"&&typeof window.Buffer<"u"?o=window.Buffer:o=Zv.Buffer}catch{}s.isBN=function(d){return d instanceof s?!0:d!==null&&typeof d=="object"&&d.constructor.wordSize===s.wordSize&&Array.isArray(d.words)},s.max=function(d,f){return d.cmp(f)>0?d:f},s.min=function(d,f){return d.cmp(f)<0?d:f},s.prototype._init=function(d,f,p){if(typeof d=="number")return this._initNumber(d,f,p);if(typeof d=="object")return this._initArray(d,f,p);f==="hex"&&(f=16),i(f===(f|0)&&f>=2&&f<=36),d=d.toString().replace(/\s+/g,"");var b=0;d[0]==="-"&&(b++,this.negative=1),b<d.length&&(f===16?this._parseHex(d,b,p):(this._parseBase(d,f,b),p==="le"&&this._initArray(this.toArray(),f,p)))},s.prototype._initNumber=function(d,f,p){d<0&&(this.negative=1,d=-d),d<67108864?(this.words=[d&67108863],this.length=1):d<4503599627370496?(this.words=[d&67108863,d/67108864&67108863],this.length=2):(i(d<9007199254740992),this.words=[d&67108863,d/67108864&67108863,1],this.length=3),p==="le"&&this._initArray(this.toArray(),f,p)},s.prototype._initArray=function(d,f,p){if(i(typeof d.length=="number"),d.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(d.length/3),this.words=new Array(this.length);for(var b=0;b<this.length;b++)this.words[b]=0;var x,_,S=0;if(p==="be")for(b=d.length-1,x=0;b>=0;b-=3)_=d[b]|d[b-1]<<8|d[b-2]<<16,this.words[x]|=_<<S&67108863,this.words[x+1]=_>>>26-S&67108863,S+=24,S>=26&&(S-=26,x++);else if(p==="le")for(b=0,x=0;b<d.length;b+=3)_=d[b]|d[b+1]<<8|d[b+2]<<16,this.words[x]|=_<<S&67108863,this.words[x+1]=_>>>26-S&67108863,S+=24,S>=26&&(S-=26,x++);return this._strip()};function a(A,d){var f=A.charCodeAt(d);if(f>=48&&f<=57)return f-48;if(f>=65&&f<=70)return f-55;if(f>=97&&f<=102)return f-87;i(!1,"Invalid character in "+A)}function c(A,d,f){var p=a(A,f);return f-1>=d&&(p|=a(A,f-1)<<4),p}s.prototype._parseHex=function(d,f,p){this.length=Math.ceil((d.length-f)/6),this.words=new Array(this.length);for(var b=0;b<this.length;b++)this.words[b]=0;var x=0,_=0,S;if(p==="be")for(b=d.length-1;b>=f;b-=2)S=c(d,f,b)<<x,this.words[_]|=S&67108863,x>=18?(x-=18,_+=1,this.words[_]|=S>>>26):x+=8;else{var I=d.length-f;for(b=I%2===0?f+1:f;b<d.length;b+=2)S=c(d,f,b)<<x,this.words[_]|=S&67108863,x>=18?(x-=18,_+=1,this.words[_]|=S>>>26):x+=8}this._strip()};function l(A,d,f,p){for(var b=0,x=0,_=Math.min(A.length,f),S=d;S<_;S++){var I=A.charCodeAt(S)-48;b*=p,I>=49?x=I-49+10:I>=17?x=I-17+10:x=I,i(I>=0&&x<p,"Invalid character"),b+=x}return b}s.prototype._parseBase=function(d,f,p){this.words=[0],this.length=1;for(var b=0,x=1;x<=67108863;x*=f)b++;b--,x=x/f|0;for(var _=d.length-p,S=_%b,I=Math.min(_,_-S)+p,m=0,O=p;O<I;O+=b)m=l(d,O,O+b,f),this.imuln(x),this.words[0]+m<67108864?this.words[0]+=m:this._iaddn(m);if(S!==0){var j=1;for(m=l(d,O,d.length,f),O=0;O<S;O++)j*=f;this.imuln(j),this.words[0]+m<67108864?this.words[0]+=m:this._iaddn(m)}this._strip()},s.prototype.copy=function(d){d.words=new Array(this.length);for(var f=0;f<this.length;f++)d.words[f]=this.words[f];d.length=this.length,d.negative=this.negative,d.red=this.red};function u(A,d){A.words=d.words,A.length=d.length,A.negative=d.negative,A.red=d.red}if(s.prototype._move=function(d){u(d,this)},s.prototype.clone=function(){var d=new s(null);return this.copy(d),d},s.prototype._expand=function(d){for(;this.length<d;)this.words[this.length++]=0;return this},s.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},s.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{s.prototype[Symbol.for("nodejs.util.inspect.custom")]=h}catch{s.prototype.inspect=h}else s.prototype.inspect=h;function h(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var g=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],y=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],w=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];s.prototype.toString=function(d,f){d=d||10,f=f|0||1;var p;if(d===16||d==="hex"){p="";for(var b=0,x=0,_=0;_<this.length;_++){var S=this.words[_],I=((S<<b|x)&16777215).toString(16);x=S>>>24-b&16777215,b+=2,b>=26&&(b-=26,_--),x!==0||_!==this.length-1?p=g[6-I.length]+I+p:p=I+p}for(x!==0&&(p=x.toString(16)+p);p.length%f!==0;)p="0"+p;return this.negative!==0&&(p="-"+p),p}if(d===(d|0)&&d>=2&&d<=36){var m=y[d],O=w[d];p="";var j=this.clone();for(j.negative=0;!j.isZero();){var v=j.modrn(O).toString(d);j=j.idivn(O),j.isZero()?p=v+p:p=g[m-v.length]+v+p}for(this.isZero()&&(p="0"+p);p.length%f!==0;)p="0"+p;return this.negative!==0&&(p="-"+p),p}i(!1,"Base should be between 2 and 36")},s.prototype.toNumber=function(){var d=this.words[0];return this.length===2?d+=this.words[1]*67108864:this.length===3&&this.words[2]===1?d+=4503599627370496+this.words[1]*67108864:this.length>2&&i(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-d:d},s.prototype.toJSON=function(){return this.toString(16,2)},o&&(s.prototype.toBuffer=function(d,f){return this.toArrayLike(o,d,f)}),s.prototype.toArray=function(d,f){return this.toArrayLike(Array,d,f)};var E=function(d,f){return d.allocUnsafe?d.allocUnsafe(f):new d(f)};s.prototype.toArrayLike=function(d,f,p){this._strip();var b=this.byteLength(),x=p||Math.max(1,b);i(b<=x,"byte array longer than desired length"),i(x>0,"Requested array length <= 0");var _=E(d,x),S=f==="le"?"LE":"BE";return this["_toArrayLike"+S](_,b),_},s.prototype._toArrayLikeLE=function(d,f){for(var p=0,b=0,x=0,_=0;x<this.length;x++){var S=this.words[x]<<_|b;d[p++]=S&255,p<d.length&&(d[p++]=S>>8&255),p<d.length&&(d[p++]=S>>16&255),_===6?(p<d.length&&(d[p++]=S>>24&255),b=0,_=0):(b=S>>>24,_+=2)}if(p<d.length)for(d[p++]=b;p<d.length;)d[p++]=0},s.prototype._toArrayLikeBE=function(d,f){for(var p=d.length-1,b=0,x=0,_=0;x<this.length;x++){var S=this.words[x]<<_|b;d[p--]=S&255,p>=0&&(d[p--]=S>>8&255),p>=0&&(d[p--]=S>>16&255),_===6?(p>=0&&(d[p--]=S>>24&255),b=0,_=0):(b=S>>>24,_+=2)}if(p>=0)for(d[p--]=b;p>=0;)d[p--]=0},Math.clz32?s.prototype._countBits=function(d){return 32-Math.clz32(d)}:s.prototype._countBits=function(d){var f=d,p=0;return f>=4096&&(p+=13,f>>>=13),f>=64&&(p+=7,f>>>=7),f>=8&&(p+=4,f>>>=4),f>=2&&(p+=2,f>>>=2),p+f},s.prototype._zeroBits=function(d){if(d===0)return 26;var f=d,p=0;return f&8191||(p+=13,f>>>=13),f&127||(p+=7,f>>>=7),f&15||(p+=4,f>>>=4),f&3||(p+=2,f>>>=2),f&1||p++,p},s.prototype.bitLength=function(){var d=this.words[this.length-1],f=this._countBits(d);return(this.length-1)*26+f};function P(A){for(var d=new Array(A.bitLength()),f=0;f<d.length;f++){var p=f/26|0,b=f%26;d[f]=A.words[p]>>>b&1}return d}s.prototype.zeroBits=function(){if(this.isZero())return 0;for(var d=0,f=0;f<this.length;f++){var p=this._zeroBits(this.words[f]);if(d+=p,p!==26)break}return d},s.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},s.prototype.toTwos=function(d){return this.negative!==0?this.abs().inotn(d).iaddn(1):this.clone()},s.prototype.fromTwos=function(d){return this.testn(d-1)?this.notn(d).iaddn(1).ineg():this.clone()},s.prototype.isNeg=function(){return this.negative!==0},s.prototype.neg=function(){return this.clone().ineg()},s.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},s.prototype.iuor=function(d){for(;this.length<d.length;)this.words[this.length++]=0;for(var f=0;f<d.length;f++)this.words[f]=this.words[f]|d.words[f];return this._strip()},s.prototype.ior=function(d){return i((this.negative|d.negative)===0),this.iuor(d)},s.prototype.or=function(d){return this.length>d.length?this.clone().ior(d):d.clone().ior(this)},s.prototype.uor=function(d){return this.length>d.length?this.clone().iuor(d):d.clone().iuor(this)},s.prototype.iuand=function(d){var f;this.length>d.length?f=d:f=this;for(var p=0;p<f.length;p++)this.words[p]=this.words[p]&d.words[p];return this.length=f.length,this._strip()},s.prototype.iand=function(d){return i((this.negative|d.negative)===0),this.iuand(d)},s.prototype.and=function(d){return this.length>d.length?this.clone().iand(d):d.clone().iand(this)},s.prototype.uand=function(d){return this.length>d.length?this.clone().iuand(d):d.clone().iuand(this)},s.prototype.iuxor=function(d){var f,p;this.length>d.length?(f=this,p=d):(f=d,p=this);for(var b=0;b<p.length;b++)this.words[b]=f.words[b]^p.words[b];if(this!==f)for(;b<f.length;b++)this.words[b]=f.words[b];return this.length=f.length,this._strip()},s.prototype.ixor=function(d){return i((this.negative|d.negative)===0),this.iuxor(d)},s.prototype.xor=function(d){return this.length>d.length?this.clone().ixor(d):d.clone().ixor(this)},s.prototype.uxor=function(d){return this.length>d.length?this.clone().iuxor(d):d.clone().iuxor(this)},s.prototype.inotn=function(d){i(typeof d=="number"&&d>=0);var f=Math.ceil(d/26)|0,p=d%26;this._expand(f),p>0&&f--;for(var b=0;b<f;b++)this.words[b]=~this.words[b]&67108863;return p>0&&(this.words[b]=~this.words[b]&67108863>>26-p),this._strip()},s.prototype.notn=function(d){return this.clone().inotn(d)},s.prototype.setn=function(d,f){i(typeof d=="number"&&d>=0);var p=d/26|0,b=d%26;return this._expand(p+1),f?this.words[p]=this.words[p]|1<<b:this.words[p]=this.words[p]&~(1<<b),this._strip()},s.prototype.iadd=function(d){var f;if(this.negative!==0&&d.negative===0)return this.negative=0,f=this.isub(d),this.negative^=1,this._normSign();if(this.negative===0&&d.negative!==0)return d.negative=0,f=this.isub(d),d.negative=1,f._normSign();var p,b;this.length>d.length?(p=this,b=d):(p=d,b=this);for(var x=0,_=0;_<b.length;_++)f=(p.words[_]|0)+(b.words[_]|0)+x,this.words[_]=f&67108863,x=f>>>26;for(;x!==0&&_<p.length;_++)f=(p.words[_]|0)+x,this.words[_]=f&67108863,x=f>>>26;if(this.length=p.length,x!==0)this.words[this.length]=x,this.length++;else if(p!==this)for(;_<p.length;_++)this.words[_]=p.words[_];return this},s.prototype.add=function(d){var f;return d.negative!==0&&this.negative===0?(d.negative=0,f=this.sub(d),d.negative^=1,f):d.negative===0&&this.negative!==0?(this.negative=0,f=d.sub(this),this.negative=1,f):this.length>d.length?this.clone().iadd(d):d.clone().iadd(this)},s.prototype.isub=function(d){if(d.negative!==0){d.negative=0;var f=this.iadd(d);return d.negative=1,f._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(d),this.negative=1,this._normSign();var p=this.cmp(d);if(p===0)return this.negative=0,this.length=1,this.words[0]=0,this;var b,x;p>0?(b=this,x=d):(b=d,x=this);for(var _=0,S=0;S<x.length;S++)f=(b.words[S]|0)-(x.words[S]|0)+_,_=f>>26,this.words[S]=f&67108863;for(;_!==0&&S<b.length;S++)f=(b.words[S]|0)+_,_=f>>26,this.words[S]=f&67108863;if(_===0&&S<b.length&&b!==this)for(;S<b.length;S++)this.words[S]=b.words[S];return this.length=Math.max(this.length,S),b!==this&&(this.negative=1),this._strip()},s.prototype.sub=function(d){return this.clone().isub(d)};function N(A,d,f){f.negative=d.negative^A.negative;var p=A.length+d.length|0;f.length=p,p=p-1|0;var b=A.words[0]|0,x=d.words[0]|0,_=b*x,S=_&67108863,I=_/67108864|0;f.words[0]=S;for(var m=1;m<p;m++){for(var O=I>>>26,j=I&67108863,v=Math.min(m,d.length-1),T=Math.max(0,m-A.length+1);T<=v;T++){var U=m-T|0;b=A.words[U]|0,x=d.words[T]|0,_=b*x+j,O+=_/67108864|0,j=_&67108863}f.words[m]=j|0,I=O|0}return I!==0?f.words[m]=I|0:f.length--,f._strip()}var R=function(d,f,p){var b=d.words,x=f.words,_=p.words,S=0,I,m,O,j=b[0]|0,v=j&8191,T=j>>>13,U=b[1]|0,q=U&8191,z=U>>>13,Y=b[2]|0,J=Y&8191,W=Y>>>13,oe=b[3]|0,X=oe&8191,ie=oe>>>13,Lt=b[4]|0,Oe=Lt&8191,De=Lt>>>13,oi=b[5]|0,Ae=oi&8191,Ee=oi>>>13,ai=b[6]|0,_e=ai&8191,Ie=ai>>>13,ci=b[7]|0,Se=ci&8191,Ne=ci>>>13,Ci=b[8]|0,Ce=Ci&8191,Be=Ci>>>13,zn=b[9]|0,$e=zn&8191,Ue=zn>>>13,Hn=x[0]|0,Le=Hn&8191,Fe=Hn>>>13,Kn=x[1]|0,qe=Kn&8191,je=Kn>>>13,Vn=x[2]|0,ze=Vn&8191,He=Vn>>>13,Gn=x[3]|0,Ke=Gn&8191,Ve=Gn>>>13,Wn=x[4]|0,Ge=Wn&8191,We=Wn>>>13,Yn=x[5]|0,Ye=Yn&8191,Je=Yn>>>13,Jn=x[6]|0,Qe=Jn&8191,Ze=Jn>>>13,Qn=x[7]|0,Xe=Qn&8191,et=Qn>>>13,Zn=x[8]|0,tt=Zn&8191,rt=Zn>>>13,Xn=x[9]|0,it=Xn&8191,nt=Xn>>>13;p.negative=d.negative^f.negative,p.length=19,I=Math.imul(v,Le),m=Math.imul(v,Fe),m=m+Math.imul(T,Le)|0,O=Math.imul(T,Fe);var an=(S+I|0)+((m&8191)<<13)|0;S=(O+(m>>>13)|0)+(an>>>26)|0,an&=67108863,I=Math.imul(q,Le),m=Math.imul(q,Fe),m=m+Math.imul(z,Le)|0,O=Math.imul(z,Fe),I=I+Math.imul(v,qe)|0,m=m+Math.imul(v,je)|0,m=m+Math.imul(T,qe)|0,O=O+Math.imul(T,je)|0;var cn=(S+I|0)+((m&8191)<<13)|0;S=(O+(m>>>13)|0)+(cn>>>26)|0,cn&=67108863,I=Math.imul(J,Le),m=Math.imul(J,Fe),m=m+Math.imul(W,Le)|0,O=Math.imul(W,Fe),I=I+Math.imul(q,qe)|0,m=m+Math.imul(q,je)|0,m=m+Math.imul(z,qe)|0,O=O+Math.imul(z,je)|0,I=I+Math.imul(v,ze)|0,m=m+Math.imul(v,He)|0,m=m+Math.imul(T,ze)|0,O=O+Math.imul(T,He)|0;var ln=(S+I|0)+((m&8191)<<13)|0;S=(O+(m>>>13)|0)+(ln>>>26)|0,ln&=67108863,I=Math.imul(X,Le),m=Math.imul(X,Fe),m=m+Math.imul(ie,Le)|0,O=Math.imul(ie,Fe),I=I+Math.imul(J,qe)|0,m=m+Math.imul(J,je)|0,m=m+Math.imul(W,qe)|0,O=O+Math.imul(W,je)|0,I=I+Math.imul(q,ze)|0,m=m+Math.imul(q,He)|0,m=m+Math.imul(z,ze)|0,O=O+Math.imul(z,He)|0,I=I+Math.imul(v,Ke)|0,m=m+Math.imul(v,Ve)|0,m=m+Math.imul(T,Ke)|0,O=O+Math.imul(T,Ve)|0;var un=(S+I|0)+((m&8191)<<13)|0;S=(O+(m>>>13)|0)+(un>>>26)|0,un&=67108863,I=Math.imul(Oe,Le),m=Math.imul(Oe,Fe),m=m+Math.imul(De,Le)|0,O=Math.imul(De,Fe),I=I+Math.imul(X,qe)|0,m=m+Math.imul(X,je)|0,m=m+Math.imul(ie,qe)|0,O=O+Math.imul(ie,je)|0,I=I+Math.imul(J,ze)|0,m=m+Math.imul(J,He)|0,m=m+Math.imul(W,ze)|0,O=O+Math.imul(W,He)|0,I=I+Math.imul(q,Ke)|0,m=m+Math.imul(q,Ve)|0,m=m+Math.imul(z,Ke)|0,O=O+Math.imul(z,Ve)|0,I=I+Math.imul(v,Ge)|0,m=m+Math.imul(v,We)|0,m=m+Math.imul(T,Ge)|0,O=O+Math.imul(T,We)|0;var hn=(S+I|0)+((m&8191)<<13)|0;S=(O+(m>>>13)|0)+(hn>>>26)|0,hn&=67108863,I=Math.imul(Ae,Le),m=Math.imul(Ae,Fe),m=m+Math.imul(Ee,Le)|0,O=Math.imul(Ee,Fe),I=I+Math.imul(Oe,qe)|0,m=m+Math.imul(Oe,je)|0,m=m+Math.imul(De,qe)|0,O=O+Math.imul(De,je)|0,I=I+Math.imul(X,ze)|0,m=m+Math.imul(X,He)|0,m=m+Math.imul(ie,ze)|0,O=O+Math.imul(ie,He)|0,I=I+Math.imul(J,Ke)|0,m=m+Math.imul(J,Ve)|0,m=m+Math.imul(W,Ke)|0,O=O+Math.imul(W,Ve)|0,I=I+Math.imul(q,Ge)|0,m=m+Math.imul(q,We)|0,m=m+Math.imul(z,Ge)|0,O=O+Math.imul(z,We)|0,I=I+Math.imul(v,Ye)|0,m=m+Math.imul(v,Je)|0,m=m+Math.imul(T,Ye)|0,O=O+Math.imul(T,Je)|0;var Ul=(S+I|0)+((m&8191)<<13)|0;S=(O+(m>>>13)|0)+(Ul>>>26)|0,Ul&=67108863,I=Math.imul(_e,Le),m=Math.imul(_e,Fe),m=m+Math.imul(Ie,Le)|0,O=Math.imul(Ie,Fe),I=I+Math.imul(Ae,qe)|0,m=m+Math.imul(Ae,je)|0,m=m+Math.imul(Ee,qe)|0,O=O+Math.imul(Ee,je)|0,I=I+Math.imul(Oe,ze)|0,m=m+Math.imul(Oe,He)|0,m=m+Math.imul(De,ze)|0,O=O+Math.imul(De,He)|0,I=I+Math.imul(X,Ke)|0,m=m+Math.imul(X,Ve)|0,m=m+Math.imul(ie,Ke)|0,O=O+Math.imul(ie,Ve)|0,I=I+Math.imul(J,Ge)|0,m=m+Math.imul(J,We)|0,m=m+Math.imul(W,Ge)|0,O=O+Math.imul(W,We)|0,I=I+Math.imul(q,Ye)|0,m=m+Math.imul(q,Je)|0,m=m+Math.imul(z,Ye)|0,O=O+Math.imul(z,Je)|0,I=I+Math.imul(v,Qe)|0,m=m+Math.imul(v,Ze)|0,m=m+Math.imul(T,Qe)|0,O=O+Math.imul(T,Ze)|0;var Ll=(S+I|0)+((m&8191)<<13)|0;S=(O+(m>>>13)|0)+(Ll>>>26)|0,Ll&=67108863,I=Math.imul(Se,Le),m=Math.imul(Se,Fe),m=m+Math.imul(Ne,Le)|0,O=Math.imul(Ne,Fe),I=I+Math.imul(_e,qe)|0,m=m+Math.imul(_e,je)|0,m=m+Math.imul(Ie,qe)|0,O=O+Math.imul(Ie,je)|0,I=I+Math.imul(Ae,ze)|0,m=m+Math.imul(Ae,He)|0,m=m+Math.imul(Ee,ze)|0,O=O+Math.imul(Ee,He)|0,I=I+Math.imul(Oe,Ke)|0,m=m+Math.imul(Oe,Ve)|0,m=m+Math.imul(De,Ke)|0,O=O+Math.imul(De,Ve)|0,I=I+Math.imul(X,Ge)|0,m=m+Math.imul(X,We)|0,m=m+Math.imul(ie,Ge)|0,O=O+Math.imul(ie,We)|0,I=I+Math.imul(J,Ye)|0,m=m+Math.imul(J,Je)|0,m=m+Math.imul(W,Ye)|0,O=O+Math.imul(W,Je)|0,I=I+Math.imul(q,Qe)|0,m=m+Math.imul(q,Ze)|0,m=m+Math.imul(z,Qe)|0,O=O+Math.imul(z,Ze)|0,I=I+Math.imul(v,Xe)|0,m=m+Math.imul(v,et)|0,m=m+Math.imul(T,Xe)|0,O=O+Math.imul(T,et)|0;var Fl=(S+I|0)+((m&8191)<<13)|0;S=(O+(m>>>13)|0)+(Fl>>>26)|0,Fl&=67108863,I=Math.imul(Ce,Le),m=Math.imul(Ce,Fe),m=m+Math.imul(Be,Le)|0,O=Math.imul(Be,Fe),I=I+Math.imul(Se,qe)|0,m=m+Math.imul(Se,je)|0,m=m+Math.imul(Ne,qe)|0,O=O+Math.imul(Ne,je)|0,I=I+Math.imul(_e,ze)|0,m=m+Math.imul(_e,He)|0,m=m+Math.imul(Ie,ze)|0,O=O+Math.imul(Ie,He)|0,I=I+Math.imul(Ae,Ke)|0,m=m+Math.imul(Ae,Ve)|0,m=m+Math.imul(Ee,Ke)|0,O=O+Math.imul(Ee,Ve)|0,I=I+Math.imul(Oe,Ge)|0,m=m+Math.imul(Oe,We)|0,m=m+Math.imul(De,Ge)|0,O=O+Math.imul(De,We)|0,I=I+Math.imul(X,Ye)|0,m=m+Math.imul(X,Je)|0,m=m+Math.imul(ie,Ye)|0,O=O+Math.imul(ie,Je)|0,I=I+Math.imul(J,Qe)|0,m=m+Math.imul(J,Ze)|0,m=m+Math.imul(W,Qe)|0,O=O+Math.imul(W,Ze)|0,I=I+Math.imul(q,Xe)|0,m=m+Math.imul(q,et)|0,m=m+Math.imul(z,Xe)|0,O=O+Math.imul(z,et)|0,I=I+Math.imul(v,tt)|0,m=m+Math.imul(v,rt)|0,m=m+Math.imul(T,tt)|0,O=O+Math.imul(T,rt)|0;var ql=(S+I|0)+((m&8191)<<13)|0;S=(O+(m>>>13)|0)+(ql>>>26)|0,ql&=67108863,I=Math.imul($e,Le),m=Math.imul($e,Fe),m=m+Math.imul(Ue,Le)|0,O=Math.imul(Ue,Fe),I=I+Math.imul(Ce,qe)|0,m=m+Math.imul(Ce,je)|0,m=m+Math.imul(Be,qe)|0,O=O+Math.imul(Be,je)|0,I=I+Math.imul(Se,ze)|0,m=m+Math.imul(Se,He)|0,m=m+Math.imul(Ne,ze)|0,O=O+Math.imul(Ne,He)|0,I=I+Math.imul(_e,Ke)|0,m=m+Math.imul(_e,Ve)|0,m=m+Math.imul(Ie,Ke)|0,O=O+Math.imul(Ie,Ve)|0,I=I+Math.imul(Ae,Ge)|0,m=m+Math.imul(Ae,We)|0,m=m+Math.imul(Ee,Ge)|0,O=O+Math.imul(Ee,We)|0,I=I+Math.imul(Oe,Ye)|0,m=m+Math.imul(Oe,Je)|0,m=m+Math.imul(De,Ye)|0,O=O+Math.imul(De,Je)|0,I=I+Math.imul(X,Qe)|0,m=m+Math.imul(X,Ze)|0,m=m+Math.imul(ie,Qe)|0,O=O+Math.imul(ie,Ze)|0,I=I+Math.imul(J,Xe)|0,m=m+Math.imul(J,et)|0,m=m+Math.imul(W,Xe)|0,O=O+Math.imul(W,et)|0,I=I+Math.imul(q,tt)|0,m=m+Math.imul(q,rt)|0,m=m+Math.imul(z,tt)|0,O=O+Math.imul(z,rt)|0,I=I+Math.imul(v,it)|0,m=m+Math.imul(v,nt)|0,m=m+Math.imul(T,it)|0,O=O+Math.imul(T,nt)|0;var jl=(S+I|0)+((m&8191)<<13)|0;S=(O+(m>>>13)|0)+(jl>>>26)|0,jl&=67108863,I=Math.imul($e,qe),m=Math.imul($e,je),m=m+Math.imul(Ue,qe)|0,O=Math.imul(Ue,je),I=I+Math.imul(Ce,ze)|0,m=m+Math.imul(Ce,He)|0,m=m+Math.imul(Be,ze)|0,O=O+Math.imul(Be,He)|0,I=I+Math.imul(Se,Ke)|0,m=m+Math.imul(Se,Ve)|0,m=m+Math.imul(Ne,Ke)|0,O=O+Math.imul(Ne,Ve)|0,I=I+Math.imul(_e,Ge)|0,m=m+Math.imul(_e,We)|0,m=m+Math.imul(Ie,Ge)|0,O=O+Math.imul(Ie,We)|0,I=I+Math.imul(Ae,Ye)|0,m=m+Math.imul(Ae,Je)|0,m=m+Math.imul(Ee,Ye)|0,O=O+Math.imul(Ee,Je)|0,I=I+Math.imul(Oe,Qe)|0,m=m+Math.imul(Oe,Ze)|0,m=m+Math.imul(De,Qe)|0,O=O+Math.imul(De,Ze)|0,I=I+Math.imul(X,Xe)|0,m=m+Math.imul(X,et)|0,m=m+Math.imul(ie,Xe)|0,O=O+Math.imul(ie,et)|0,I=I+Math.imul(J,tt)|0,m=m+Math.imul(J,rt)|0,m=m+Math.imul(W,tt)|0,O=O+Math.imul(W,rt)|0,I=I+Math.imul(q,it)|0,m=m+Math.imul(q,nt)|0,m=m+Math.imul(z,it)|0,O=O+Math.imul(z,nt)|0;var zl=(S+I|0)+((m&8191)<<13)|0;S=(O+(m>>>13)|0)+(zl>>>26)|0,zl&=67108863,I=Math.imul($e,ze),m=Math.imul($e,He),m=m+Math.imul(Ue,ze)|0,O=Math.imul(Ue,He),I=I+Math.imul(Ce,Ke)|0,m=m+Math.imul(Ce,Ve)|0,m=m+Math.imul(Be,Ke)|0,O=O+Math.imul(Be,Ve)|0,I=I+Math.imul(Se,Ge)|0,m=m+Math.imul(Se,We)|0,m=m+Math.imul(Ne,Ge)|0,O=O+Math.imul(Ne,We)|0,I=I+Math.imul(_e,Ye)|0,m=m+Math.imul(_e,Je)|0,m=m+Math.imul(Ie,Ye)|0,O=O+Math.imul(Ie,Je)|0,I=I+Math.imul(Ae,Qe)|0,m=m+Math.imul(Ae,Ze)|0,m=m+Math.imul(Ee,Qe)|0,O=O+Math.imul(Ee,Ze)|0,I=I+Math.imul(Oe,Xe)|0,m=m+Math.imul(Oe,et)|0,m=m+Math.imul(De,Xe)|0,O=O+Math.imul(De,et)|0,I=I+Math.imul(X,tt)|0,m=m+Math.imul(X,rt)|0,m=m+Math.imul(ie,tt)|0,O=O+Math.imul(ie,rt)|0,I=I+Math.imul(J,it)|0,m=m+Math.imul(J,nt)|0,m=m+Math.imul(W,it)|0,O=O+Math.imul(W,nt)|0;var Hl=(S+I|0)+((m&8191)<<13)|0;S=(O+(m>>>13)|0)+(Hl>>>26)|0,Hl&=67108863,I=Math.imul($e,Ke),m=Math.imul($e,Ve),m=m+Math.imul(Ue,Ke)|0,O=Math.imul(Ue,Ve),I=I+Math.imul(Ce,Ge)|0,m=m+Math.imul(Ce,We)|0,m=m+Math.imul(Be,Ge)|0,O=O+Math.imul(Be,We)|0,I=I+Math.imul(Se,Ye)|0,m=m+Math.imul(Se,Je)|0,m=m+Math.imul(Ne,Ye)|0,O=O+Math.imul(Ne,Je)|0,I=I+Math.imul(_e,Qe)|0,m=m+Math.imul(_e,Ze)|0,m=m+Math.imul(Ie,Qe)|0,O=O+Math.imul(Ie,Ze)|0,I=I+Math.imul(Ae,Xe)|0,m=m+Math.imul(Ae,et)|0,m=m+Math.imul(Ee,Xe)|0,O=O+Math.imul(Ee,et)|0,I=I+Math.imul(Oe,tt)|0,m=m+Math.imul(Oe,rt)|0,m=m+Math.imul(De,tt)|0,O=O+Math.imul(De,rt)|0,I=I+Math.imul(X,it)|0,m=m+Math.imul(X,nt)|0,m=m+Math.imul(ie,it)|0,O=O+Math.imul(ie,nt)|0;var Kl=(S+I|0)+((m&8191)<<13)|0;S=(O+(m>>>13)|0)+(Kl>>>26)|0,Kl&=67108863,I=Math.imul($e,Ge),m=Math.imul($e,We),m=m+Math.imul(Ue,Ge)|0,O=Math.imul(Ue,We),I=I+Math.imul(Ce,Ye)|0,m=m+Math.imul(Ce,Je)|0,m=m+Math.imul(Be,Ye)|0,O=O+Math.imul(Be,Je)|0,I=I+Math.imul(Se,Qe)|0,m=m+Math.imul(Se,Ze)|0,m=m+Math.imul(Ne,Qe)|0,O=O+Math.imul(Ne,Ze)|0,I=I+Math.imul(_e,Xe)|0,m=m+Math.imul(_e,et)|0,m=m+Math.imul(Ie,Xe)|0,O=O+Math.imul(Ie,et)|0,I=I+Math.imul(Ae,tt)|0,m=m+Math.imul(Ae,rt)|0,m=m+Math.imul(Ee,tt)|0,O=O+Math.imul(Ee,rt)|0,I=I+Math.imul(Oe,it)|0,m=m+Math.imul(Oe,nt)|0,m=m+Math.imul(De,it)|0,O=O+Math.imul(De,nt)|0;var Vl=(S+I|0)+((m&8191)<<13)|0;S=(O+(m>>>13)|0)+(Vl>>>26)|0,Vl&=67108863,I=Math.imul($e,Ye),m=Math.imul($e,Je),m=m+Math.imul(Ue,Ye)|0,O=Math.imul(Ue,Je),I=I+Math.imul(Ce,Qe)|0,m=m+Math.imul(Ce,Ze)|0,m=m+Math.imul(Be,Qe)|0,O=O+Math.imul(Be,Ze)|0,I=I+Math.imul(Se,Xe)|0,m=m+Math.imul(Se,et)|0,m=m+Math.imul(Ne,Xe)|0,O=O+Math.imul(Ne,et)|0,I=I+Math.imul(_e,tt)|0,m=m+Math.imul(_e,rt)|0,m=m+Math.imul(Ie,tt)|0,O=O+Math.imul(Ie,rt)|0,I=I+Math.imul(Ae,it)|0,m=m+Math.imul(Ae,nt)|0,m=m+Math.imul(Ee,it)|0,O=O+Math.imul(Ee,nt)|0;var Gl=(S+I|0)+((m&8191)<<13)|0;S=(O+(m>>>13)|0)+(Gl>>>26)|0,Gl&=67108863,I=Math.imul($e,Qe),m=Math.imul($e,Ze),m=m+Math.imul(Ue,Qe)|0,O=Math.imul(Ue,Ze),I=I+Math.imul(Ce,Xe)|0,m=m+Math.imul(Ce,et)|0,m=m+Math.imul(Be,Xe)|0,O=O+Math.imul(Be,et)|0,I=I+Math.imul(Se,tt)|0,m=m+Math.imul(Se,rt)|0,m=m+Math.imul(Ne,tt)|0,O=O+Math.imul(Ne,rt)|0,I=I+Math.imul(_e,it)|0,m=m+Math.imul(_e,nt)|0,m=m+Math.imul(Ie,it)|0,O=O+Math.imul(Ie,nt)|0;var Wl=(S+I|0)+((m&8191)<<13)|0;S=(O+(m>>>13)|0)+(Wl>>>26)|0,Wl&=67108863,I=Math.imul($e,Xe),m=Math.imul($e,et),m=m+Math.imul(Ue,Xe)|0,O=Math.imul(Ue,et),I=I+Math.imul(Ce,tt)|0,m=m+Math.imul(Ce,rt)|0,m=m+Math.imul(Be,tt)|0,O=O+Math.imul(Be,rt)|0,I=I+Math.imul(Se,it)|0,m=m+Math.imul(Se,nt)|0,m=m+Math.imul(Ne,it)|0,O=O+Math.imul(Ne,nt)|0;var Yl=(S+I|0)+((m&8191)<<13)|0;S=(O+(m>>>13)|0)+(Yl>>>26)|0,Yl&=67108863,I=Math.imul($e,tt),m=Math.imul($e,rt),m=m+Math.imul(Ue,tt)|0,O=Math.imul(Ue,rt),I=I+Math.imul(Ce,it)|0,m=m+Math.imul(Ce,nt)|0,m=m+Math.imul(Be,it)|0,O=O+Math.imul(Be,nt)|0;var Jl=(S+I|0)+((m&8191)<<13)|0;S=(O+(m>>>13)|0)+(Jl>>>26)|0,Jl&=67108863,I=Math.imul($e,it),m=Math.imul($e,nt),m=m+Math.imul(Ue,it)|0,O=Math.imul(Ue,nt);var Ql=(S+I|0)+((m&8191)<<13)|0;return S=(O+(m>>>13)|0)+(Ql>>>26)|0,Ql&=67108863,_[0]=an,_[1]=cn,_[2]=ln,_[3]=un,_[4]=hn,_[5]=Ul,_[6]=Ll,_[7]=Fl,_[8]=ql,_[9]=jl,_[10]=zl,_[11]=Hl,_[12]=Kl,_[13]=Vl,_[14]=Gl,_[15]=Wl,_[16]=Yl,_[17]=Jl,_[18]=Ql,S!==0&&(_[19]=S,p.length++),p};Math.imul||(R=N);function D(A,d,f){f.negative=d.negative^A.negative,f.length=A.length+d.length;for(var p=0,b=0,x=0;x<f.length-1;x++){var _=b;b=0;for(var S=p&67108863,I=Math.min(x,d.length-1),m=Math.max(0,x-A.length+1);m<=I;m++){var O=x-m,j=A.words[O]|0,v=d.words[m]|0,T=j*v,U=T&67108863;_=_+(T/67108864|0)|0,U=U+S|0,S=U&67108863,_=_+(U>>>26)|0,b+=_>>>26,_&=67108863}f.words[x]=S,p=_,_=b}return p!==0?f.words[x]=p:f.length--,f._strip()}function C(A,d,f){return D(A,d,f)}s.prototype.mulTo=function(d,f){var p,b=this.length+d.length;return this.length===10&&d.length===10?p=R(this,d,f):b<63?p=N(this,d,f):b<1024?p=D(this,d,f):p=C(this,d,f),p},s.prototype.mul=function(d){var f=new s(null);return f.words=new Array(this.length+d.length),this.mulTo(d,f)},s.prototype.mulf=function(d){var f=new s(null);return f.words=new Array(this.length+d.length),C(this,d,f)},s.prototype.imul=function(d){return this.clone().mulTo(d,this)},s.prototype.imuln=function(d){var f=d<0;f&&(d=-d),i(typeof d=="number"),i(d<67108864);for(var p=0,b=0;b<this.length;b++){var x=(this.words[b]|0)*d,_=(x&67108863)+(p&67108863);p>>=26,p+=x/67108864|0,p+=_>>>26,this.words[b]=_&67108863}return p!==0&&(this.words[b]=p,this.length++),this.length=d===0?1:this.length,f?this.ineg():this},s.prototype.muln=function(d){return this.clone().imuln(d)},s.prototype.sqr=function(){return this.mul(this)},s.prototype.isqr=function(){return this.imul(this.clone())},s.prototype.pow=function(d){var f=P(d);if(f.length===0)return new s(1);for(var p=this,b=0;b<f.length&&f[b]===0;b++,p=p.sqr());if(++b<f.length)for(var x=p.sqr();b<f.length;b++,x=x.sqr())f[b]!==0&&(p=p.mul(x));return p},s.prototype.iushln=function(d){i(typeof d=="number"&&d>=0);var f=d%26,p=(d-f)/26,b=67108863>>>26-f<<26-f,x;if(f!==0){var _=0;for(x=0;x<this.length;x++){var S=this.words[x]&b,I=(this.words[x]|0)-S<<f;this.words[x]=I|_,_=S>>>26-f}_&&(this.words[x]=_,this.length++)}if(p!==0){for(x=this.length-1;x>=0;x--)this.words[x+p]=this.words[x];for(x=0;x<p;x++)this.words[x]=0;this.length+=p}return this._strip()},s.prototype.ishln=function(d){return i(this.negative===0),this.iushln(d)},s.prototype.iushrn=function(d,f,p){i(typeof d=="number"&&d>=0);var b;f?b=(f-f%26)/26:b=0;var x=d%26,_=Math.min((d-x)/26,this.length),S=67108863^67108863>>>x<<x,I=p;if(b-=_,b=Math.max(0,b),I){for(var m=0;m<_;m++)I.words[m]=this.words[m];I.length=_}if(_!==0)if(this.length>_)for(this.length-=_,m=0;m<this.length;m++)this.words[m]=this.words[m+_];else this.words[0]=0,this.length=1;var O=0;for(m=this.length-1;m>=0&&(O!==0||m>=b);m--){var j=this.words[m]|0;this.words[m]=O<<26-x|j>>>x,O=j&S}return I&&O!==0&&(I.words[I.length++]=O),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},s.prototype.ishrn=function(d,f,p){return i(this.negative===0),this.iushrn(d,f,p)},s.prototype.shln=function(d){return this.clone().ishln(d)},s.prototype.ushln=function(d){return this.clone().iushln(d)},s.prototype.shrn=function(d){return this.clone().ishrn(d)},s.prototype.ushrn=function(d){return this.clone().iushrn(d)},s.prototype.testn=function(d){i(typeof d=="number"&&d>=0);var f=d%26,p=(d-f)/26,b=1<<f;if(this.length<=p)return!1;var x=this.words[p];return!!(x&b)},s.prototype.imaskn=function(d){i(typeof d=="number"&&d>=0);var f=d%26,p=(d-f)/26;if(i(this.negative===0,"imaskn works only with positive numbers"),this.length<=p)return this;if(f!==0&&p++,this.length=Math.min(p,this.length),f!==0){var b=67108863^67108863>>>f<<f;this.words[this.length-1]&=b}return this._strip()},s.prototype.maskn=function(d){return this.clone().imaskn(d)},s.prototype.iaddn=function(d){return i(typeof d=="number"),i(d<67108864),d<0?this.isubn(-d):this.negative!==0?this.length===1&&(this.words[0]|0)<=d?(this.words[0]=d-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(d),this.negative=1,this):this._iaddn(d)},s.prototype._iaddn=function(d){this.words[0]+=d;for(var f=0;f<this.length&&this.words[f]>=67108864;f++)this.words[f]-=67108864,f===this.length-1?this.words[f+1]=1:this.words[f+1]++;return this.length=Math.max(this.length,f+1),this},s.prototype.isubn=function(d){if(i(typeof d=="number"),i(d<67108864),d<0)return this.iaddn(-d);if(this.negative!==0)return this.negative=0,this.iaddn(d),this.negative=1,this;if(this.words[0]-=d,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var f=0;f<this.length&&this.words[f]<0;f++)this.words[f]+=67108864,this.words[f+1]-=1;return this._strip()},s.prototype.addn=function(d){return this.clone().iaddn(d)},s.prototype.subn=function(d){return this.clone().isubn(d)},s.prototype.iabs=function(){return this.negative=0,this},s.prototype.abs=function(){return this.clone().iabs()},s.prototype._ishlnsubmul=function(d,f,p){var b=d.length+p,x;this._expand(b);var _,S=0;for(x=0;x<d.length;x++){_=(this.words[x+p]|0)+S;var I=(d.words[x]|0)*f;_-=I&67108863,S=(_>>26)-(I/67108864|0),this.words[x+p]=_&67108863}for(;x<this.length-p;x++)_=(this.words[x+p]|0)+S,S=_>>26,this.words[x+p]=_&67108863;if(S===0)return this._strip();for(i(S===-1),S=0,x=0;x<this.length;x++)_=-(this.words[x]|0)+S,S=_>>26,this.words[x]=_&67108863;return this.negative=1,this._strip()},s.prototype._wordDiv=function(d,f){var p=this.length-d.length,b=this.clone(),x=d,_=x.words[x.length-1]|0,S=this._countBits(_);p=26-S,p!==0&&(x=x.ushln(p),b.iushln(p),_=x.words[x.length-1]|0);var I=b.length-x.length,m;if(f!=="mod"){m=new s(null),m.length=I+1,m.words=new Array(m.length);for(var O=0;O<m.length;O++)m.words[O]=0}var j=b.clone()._ishlnsubmul(x,1,I);j.negative===0&&(b=j,m&&(m.words[I]=1));for(var v=I-1;v>=0;v--){var T=(b.words[x.length+v]|0)*67108864+(b.words[x.length+v-1]|0);for(T=Math.min(T/_|0,67108863),b._ishlnsubmul(x,T,v);b.negative!==0;)T--,b.negative=0,b._ishlnsubmul(x,1,v),b.isZero()||(b.negative^=1);m&&(m.words[v]=T)}return m&&m._strip(),b._strip(),f!=="div"&&p!==0&&b.iushrn(p),{div:m||null,mod:b}},s.prototype.divmod=function(d,f,p){if(i(!d.isZero()),this.isZero())return{div:new s(0),mod:new s(0)};var b,x,_;return this.negative!==0&&d.negative===0?(_=this.neg().divmod(d,f),f!=="mod"&&(b=_.div.neg()),f!=="div"&&(x=_.mod.neg(),p&&x.negative!==0&&x.iadd(d)),{div:b,mod:x}):this.negative===0&&d.negative!==0?(_=this.divmod(d.neg(),f),f!=="mod"&&(b=_.div.neg()),{div:b,mod:_.mod}):this.negative&d.negative?(_=this.neg().divmod(d.neg(),f),f!=="div"&&(x=_.mod.neg(),p&&x.negative!==0&&x.isub(d)),{div:_.div,mod:x}):d.length>this.length||this.cmp(d)<0?{div:new s(0),mod:this}:d.length===1?f==="div"?{div:this.divn(d.words[0]),mod:null}:f==="mod"?{div:null,mod:new s(this.modrn(d.words[0]))}:{div:this.divn(d.words[0]),mod:new s(this.modrn(d.words[0]))}:this._wordDiv(d,f)},s.prototype.div=function(d){return this.divmod(d,"div",!1).div},s.prototype.mod=function(d){return this.divmod(d,"mod",!1).mod},s.prototype.umod=function(d){return this.divmod(d,"mod",!0).mod},s.prototype.divRound=function(d){var f=this.divmod(d);if(f.mod.isZero())return f.div;var p=f.div.negative!==0?f.mod.isub(d):f.mod,b=d.ushrn(1),x=d.andln(1),_=p.cmp(b);return _<0||x===1&&_===0?f.div:f.div.negative!==0?f.div.isubn(1):f.div.iaddn(1)},s.prototype.modrn=function(d){var f=d<0;f&&(d=-d),i(d<=67108863);for(var p=(1<<26)%d,b=0,x=this.length-1;x>=0;x--)b=(p*b+(this.words[x]|0))%d;return f?-b:b},s.prototype.modn=function(d){return this.modrn(d)},s.prototype.idivn=function(d){var f=d<0;f&&(d=-d),i(d<=67108863);for(var p=0,b=this.length-1;b>=0;b--){var x=(this.words[b]|0)+p*67108864;this.words[b]=x/d|0,p=x%d}return this._strip(),f?this.ineg():this},s.prototype.divn=function(d){return this.clone().idivn(d)},s.prototype.egcd=function(d){i(d.negative===0),i(!d.isZero());var f=this,p=d.clone();f.negative!==0?f=f.umod(d):f=f.clone();for(var b=new s(1),x=new s(0),_=new s(0),S=new s(1),I=0;f.isEven()&&p.isEven();)f.iushrn(1),p.iushrn(1),++I;for(var m=p.clone(),O=f.clone();!f.isZero();){for(var j=0,v=1;!(f.words[0]&v)&&j<26;++j,v<<=1);if(j>0)for(f.iushrn(j);j-- >0;)(b.isOdd()||x.isOdd())&&(b.iadd(m),x.isub(O)),b.iushrn(1),x.iushrn(1);for(var T=0,U=1;!(p.words[0]&U)&&T<26;++T,U<<=1);if(T>0)for(p.iushrn(T);T-- >0;)(_.isOdd()||S.isOdd())&&(_.iadd(m),S.isub(O)),_.iushrn(1),S.iushrn(1);f.cmp(p)>=0?(f.isub(p),b.isub(_),x.isub(S)):(p.isub(f),_.isub(b),S.isub(x))}return{a:_,b:S,gcd:p.iushln(I)}},s.prototype._invmp=function(d){i(d.negative===0),i(!d.isZero());var f=this,p=d.clone();f.negative!==0?f=f.umod(d):f=f.clone();for(var b=new s(1),x=new s(0),_=p.clone();f.cmpn(1)>0&&p.cmpn(1)>0;){for(var S=0,I=1;!(f.words[0]&I)&&S<26;++S,I<<=1);if(S>0)for(f.iushrn(S);S-- >0;)b.isOdd()&&b.iadd(_),b.iushrn(1);for(var m=0,O=1;!(p.words[0]&O)&&m<26;++m,O<<=1);if(m>0)for(p.iushrn(m);m-- >0;)x.isOdd()&&x.iadd(_),x.iushrn(1);f.cmp(p)>=0?(f.isub(p),b.isub(x)):(p.isub(f),x.isub(b))}var j;return f.cmpn(1)===0?j=b:j=x,j.cmpn(0)<0&&j.iadd(d),j},s.prototype.gcd=function(d){if(this.isZero())return d.abs();if(d.isZero())return this.abs();var f=this.clone(),p=d.clone();f.negative=0,p.negative=0;for(var b=0;f.isEven()&&p.isEven();b++)f.iushrn(1),p.iushrn(1);do{for(;f.isEven();)f.iushrn(1);for(;p.isEven();)p.iushrn(1);var x=f.cmp(p);if(x<0){var _=f;f=p,p=_}else if(x===0||p.cmpn(1)===0)break;f.isub(p)}while(!0);return p.iushln(b)},s.prototype.invm=function(d){return this.egcd(d).a.umod(d)},s.prototype.isEven=function(){return(this.words[0]&1)===0},s.prototype.isOdd=function(){return(this.words[0]&1)===1},s.prototype.andln=function(d){return this.words[0]&d},s.prototype.bincn=function(d){i(typeof d=="number");var f=d%26,p=(d-f)/26,b=1<<f;if(this.length<=p)return this._expand(p+1),this.words[p]|=b,this;for(var x=b,_=p;x!==0&&_<this.length;_++){var S=this.words[_]|0;S+=x,x=S>>>26,S&=67108863,this.words[_]=S}return x!==0&&(this.words[_]=x,this.length++),this},s.prototype.isZero=function(){return this.length===1&&this.words[0]===0},s.prototype.cmpn=function(d){var f=d<0;if(this.negative!==0&&!f)return-1;if(this.negative===0&&f)return 1;this._strip();var p;if(this.length>1)p=1;else{f&&(d=-d),i(d<=67108863,"Number is too big");var b=this.words[0]|0;p=b===d?0:b<d?-1:1}return this.negative!==0?-p|0:p},s.prototype.cmp=function(d){if(this.negative!==0&&d.negative===0)return-1;if(this.negative===0&&d.negative!==0)return 1;var f=this.ucmp(d);return this.negative!==0?-f|0:f},s.prototype.ucmp=function(d){if(this.length>d.length)return 1;if(this.length<d.length)return-1;for(var f=0,p=this.length-1;p>=0;p--){var b=this.words[p]|0,x=d.words[p]|0;if(b!==x){b<x?f=-1:b>x&&(f=1);break}}return f},s.prototype.gtn=function(d){return this.cmpn(d)===1},s.prototype.gt=function(d){return this.cmp(d)===1},s.prototype.gten=function(d){return this.cmpn(d)>=0},s.prototype.gte=function(d){return this.cmp(d)>=0},s.prototype.ltn=function(d){return this.cmpn(d)===-1},s.prototype.lt=function(d){return this.cmp(d)===-1},s.prototype.lten=function(d){return this.cmpn(d)<=0},s.prototype.lte=function(d){return this.cmp(d)<=0},s.prototype.eqn=function(d){return this.cmpn(d)===0},s.prototype.eq=function(d){return this.cmp(d)===0},s.red=function(d){return new H(d)},s.prototype.toRed=function(d){return i(!this.red,"Already a number in reduction context"),i(this.negative===0,"red works only with positives"),d.convertTo(this)._forceRed(d)},s.prototype.fromRed=function(){return i(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},s.prototype._forceRed=function(d){return this.red=d,this},s.prototype.forceRed=function(d){return i(!this.red,"Already a number in reduction context"),this._forceRed(d)},s.prototype.redAdd=function(d){return i(this.red,"redAdd works only with red numbers"),this.red.add(this,d)},s.prototype.redIAdd=function(d){return i(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,d)},s.prototype.redSub=function(d){return i(this.red,"redSub works only with red numbers"),this.red.sub(this,d)},s.prototype.redISub=function(d){return i(this.red,"redISub works only with red numbers"),this.red.isub(this,d)},s.prototype.redShl=function(d){return i(this.red,"redShl works only with red numbers"),this.red.shl(this,d)},s.prototype.redMul=function(d){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,d),this.red.mul(this,d)},s.prototype.redIMul=function(d){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,d),this.red.imul(this,d)},s.prototype.redSqr=function(){return i(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},s.prototype.redISqr=function(){return i(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},s.prototype.redSqrt=function(){return i(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},s.prototype.redInvm=function(){return i(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},s.prototype.redNeg=function(){return i(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},s.prototype.redPow=function(d){return i(this.red&&!d.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,d)};var B={k256:null,p224:null,p192:null,p25519:null};function M(A,d){this.name=A,this.p=new s(d,16),this.n=this.p.bitLength(),this.k=new s(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}M.prototype._tmp=function(){var d=new s(null);return d.words=new Array(Math.ceil(this.n/13)),d},M.prototype.ireduce=function(d){var f=d,p;do this.split(f,this.tmp),f=this.imulK(f),f=f.iadd(this.tmp),p=f.bitLength();while(p>this.n);var b=p<this.n?-1:f.ucmp(this.p);return b===0?(f.words[0]=0,f.length=1):b>0?f.isub(this.p):f.strip!==void 0?f.strip():f._strip(),f},M.prototype.split=function(d,f){d.iushrn(this.n,0,f)},M.prototype.imulK=function(d){return d.imul(this.k)};function L(){M.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}n(L,M),L.prototype.split=function(d,f){for(var p=4194303,b=Math.min(d.length,9),x=0;x<b;x++)f.words[x]=d.words[x];if(f.length=b,d.length<=9){d.words[0]=0,d.length=1;return}var _=d.words[9];for(f.words[f.length++]=_&p,x=10;x<d.length;x++){var S=d.words[x]|0;d.words[x-10]=(S&p)<<4|_>>>22,_=S}_>>>=22,d.words[x-10]=_,_===0&&d.length>10?d.length-=10:d.length-=9},L.prototype.imulK=function(d){d.words[d.length]=0,d.words[d.length+1]=0,d.length+=2;for(var f=0,p=0;p<d.length;p++){var b=d.words[p]|0;f+=b*977,d.words[p]=f&67108863,f=b*64+(f/67108864|0)}return d.words[d.length-1]===0&&(d.length--,d.words[d.length-1]===0&&d.length--),d};function F(){M.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}n(F,M);function k(){M.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}n(k,M);function V(){M.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}n(V,M),V.prototype.imulK=function(d){for(var f=0,p=0;p<d.length;p++){var b=(d.words[p]|0)*19+f,x=b&67108863;b>>>=26,d.words[p]=x,f=b}return f!==0&&(d.words[d.length++]=f),d},s._prime=function(d){if(B[d])return B[d];var f;if(d==="k256")f=new L;else if(d==="p224")f=new F;else if(d==="p192")f=new k;else if(d==="p25519")f=new V;else throw new Error("Unknown prime "+d);return B[d]=f,f};function H(A){if(typeof A=="string"){var d=s._prime(A);this.m=d.p,this.prime=d}else i(A.gtn(1),"modulus must be greater than 1"),this.m=A,this.prime=null}H.prototype._verify1=function(d){i(d.negative===0,"red works only with positives"),i(d.red,"red works only with red numbers")},H.prototype._verify2=function(d,f){i((d.negative|f.negative)===0,"red works only with positives"),i(d.red&&d.red===f.red,"red works only with red numbers")},H.prototype.imod=function(d){return this.prime?this.prime.ireduce(d)._forceRed(this):(u(d,d.umod(this.m)._forceRed(this)),d)},H.prototype.neg=function(d){return d.isZero()?d.clone():this.m.sub(d)._forceRed(this)},H.prototype.add=function(d,f){this._verify2(d,f);var p=d.add(f);return p.cmp(this.m)>=0&&p.isub(this.m),p._forceRed(this)},H.prototype.iadd=function(d,f){this._verify2(d,f);var p=d.iadd(f);return p.cmp(this.m)>=0&&p.isub(this.m),p},H.prototype.sub=function(d,f){this._verify2(d,f);var p=d.sub(f);return p.cmpn(0)<0&&p.iadd(this.m),p._forceRed(this)},H.prototype.isub=function(d,f){this._verify2(d,f);var p=d.isub(f);return p.cmpn(0)<0&&p.iadd(this.m),p},H.prototype.shl=function(d,f){return this._verify1(d),this.imod(d.ushln(f))},H.prototype.imul=function(d,f){return this._verify2(d,f),this.imod(d.imul(f))},H.prototype.mul=function(d,f){return this._verify2(d,f),this.imod(d.mul(f))},H.prototype.isqr=function(d){return this.imul(d,d.clone())},H.prototype.sqr=function(d){return this.mul(d,d)},H.prototype.sqrt=function(d){if(d.isZero())return d.clone();var f=this.m.andln(3);if(i(f%2===1),f===3){var p=this.m.add(new s(1)).iushrn(2);return this.pow(d,p)}for(var b=this.m.subn(1),x=0;!b.isZero()&&b.andln(1)===0;)x++,b.iushrn(1);i(!b.isZero());var _=new s(1).toRed(this),S=_.redNeg(),I=this.m.subn(1).iushrn(1),m=this.m.bitLength();for(m=new s(2*m*m).toRed(this);this.pow(m,I).cmp(S)!==0;)m.redIAdd(S);for(var O=this.pow(m,b),j=this.pow(d,b.addn(1).iushrn(1)),v=this.pow(d,b),T=x;v.cmp(_)!==0;){for(var U=v,q=0;U.cmp(_)!==0;q++)U=U.redSqr();i(q<T);var z=this.pow(O,new s(1).iushln(T-q-1));j=j.redMul(z),O=z.redSqr(),v=v.redMul(O),T=q}return j},H.prototype.invm=function(d){var f=d._invmp(this.m);return f.negative!==0?(f.negative=0,this.imod(f).redNeg()):this.imod(f)},H.prototype.pow=function(d,f){if(f.isZero())return new s(1).toRed(this);if(f.cmpn(1)===0)return d.clone();var p=4,b=new Array(1<<p);b[0]=new s(1).toRed(this),b[1]=d;for(var x=2;x<b.length;x++)b[x]=this.mul(b[x-1],d);var _=b[0],S=0,I=0,m=f.bitLength()%26;for(m===0&&(m=26),x=f.length-1;x>=0;x--){for(var O=f.words[x],j=m-1;j>=0;j--){var v=O>>j&1;if(_!==b[0]&&(_=this.sqr(_)),v===0&&S===0){I=0;continue}S<<=1,S|=v,I++,!(I!==p&&(x!==0||j!==0))&&(_=this.mul(_,b[S]),I=0,S=0)}m=26}return _},H.prototype.convertTo=function(d){var f=d.umod(this.m);return f===d?f.clone():f},H.prototype.convertFrom=function(d){var f=d.clone();return f.red=null,f},s.mont=function(d){return new $(d)};function $(A){H.call(this,A),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new s(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}n($,H),$.prototype.convertTo=function(d){return this.imod(d.ushln(this.shift))},$.prototype.convertFrom=function(d){var f=this.imod(d.mul(this.rinv));return f.red=null,f},$.prototype.imul=function(d,f){if(d.isZero()||f.isZero())return d.words[0]=0,d.length=1,d;var p=d.imul(f),b=p.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),x=p.isub(b).iushrn(this.shift),_=x;return x.cmp(this.m)>=0?_=x.isub(this.m):x.cmpn(0)<0&&(_=x.iadd(this.m)),_._forceRed(this)},$.prototype.mul=function(d,f){if(d.isZero()||f.isZero())return new s(0)._forceRed(this);var p=d.mul(f),b=p.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),x=p.isub(b).iushrn(this.shift),_=x;return x.cmp(this.m)>=0?_=x.isub(this.m):x.cmpn(0)<0&&(_=x.iadd(this.m)),_._forceRed(this)},$.prototype.invm=function(d){var f=this.imod(d._invmp(this.m).mul(this.r2));return f._forceRed(this)}})(t,Ur)})(_f);var Xv=_f.exports;const se=Os(Xv),e2="logger/5.7.0";let Bd=!1,Rd=!1;const pc={debug:1,default:2,info:2,warning:3,error:4,off:5};let Td=pc.default,Zl=null;function t2(){try{const t=[];if(["NFD","NFC","NFKD","NFKC"].forEach(e=>{try{if("test".normalize(e)!=="test")throw new Error("bad normalize")}catch{t.push(e)}}),t.length)throw new Error("missing "+t.join(", "));if("é".normalize("NFD")!=="é")throw new Error("broken implementation")}catch(t){return t.message}return null}const Md=t2();var ph;(function(t){t.DEBUG="DEBUG",t.INFO="INFO",t.WARNING="WARNING",t.ERROR="ERROR",t.OFF="OFF"})(ph||(ph={}));var ei;(function(t){t.UNKNOWN_ERROR="UNKNOWN_ERROR",t.NOT_IMPLEMENTED="NOT_IMPLEMENTED",t.UNSUPPORTED_OPERATION="UNSUPPORTED_OPERATION",t.NETWORK_ERROR="NETWORK_ERROR",t.SERVER_ERROR="SERVER_ERROR",t.TIMEOUT="TIMEOUT",t.BUFFER_OVERRUN="BUFFER_OVERRUN",t.NUMERIC_FAULT="NUMERIC_FAULT",t.MISSING_NEW="MISSING_NEW",t.INVALID_ARGUMENT="INVALID_ARGUMENT",t.MISSING_ARGUMENT="MISSING_ARGUMENT",t.UNEXPECTED_ARGUMENT="UNEXPECTED_ARGUMENT",t.CALL_EXCEPTION="CALL_EXCEPTION",t.INSUFFICIENT_FUNDS="INSUFFICIENT_FUNDS",t.NONCE_EXPIRED="NONCE_EXPIRED",t.REPLACEMENT_UNDERPRICED="REPLACEMENT_UNDERPRICED",t.UNPREDICTABLE_GAS_LIMIT="UNPREDICTABLE_GAS_LIMIT",t.TRANSACTION_REPLACED="TRANSACTION_REPLACED",t.ACTION_REJECTED="ACTION_REJECTED"})(ei||(ei={}));const kd="0123456789abcdef";class K{constructor(e){Object.defineProperty(this,"version",{enumerable:!0,value:e,writable:!1})}_log(e,r){const i=e.toLowerCase();pc[i]==null&&this.throwArgumentError("invalid log level name","logLevel",e),!(Td>pc[i])&&console.log.apply(console,r)}debug(...e){this._log(K.levels.DEBUG,e)}info(...e){this._log(K.levels.INFO,e)}warn(...e){this._log(K.levels.WARNING,e)}makeError(e,r,i){if(Rd)return this.makeError("censored error",r,{});r||(r=K.errors.UNKNOWN_ERROR),i||(i={});const n=[];Object.keys(i).forEach(c=>{const l=i[c];try{if(l instanceof Uint8Array){let u="";for(let h=0;h<l.length;h++)u+=kd[l[h]>>4],u+=kd[l[h]&15];n.push(c+"=Uint8Array(0x"+u+")")}else n.push(c+"="+JSON.stringify(l))}catch{n.push(c+"="+JSON.stringify(i[c].toString()))}}),n.push(`code=${r}`),n.push(`version=${this.version}`);const s=e;let o="";switch(r){case ei.NUMERIC_FAULT:{o="NUMERIC_FAULT";const c=e;switch(c){case"overflow":case"underflow":case"division-by-zero":o+="-"+c;break;case"negative-power":case"negative-width":o+="-unsupported";break;case"unbound-bitwise-result":o+="-unbound-result";break}break}case ei.CALL_EXCEPTION:case ei.INSUFFICIENT_FUNDS:case ei.MISSING_NEW:case ei.NONCE_EXPIRED:case ei.REPLACEMENT_UNDERPRICED:case ei.TRANSACTION_REPLACED:case ei.UNPREDICTABLE_GAS_LIMIT:o=r;break}o&&(e+=" [ See: https://links.ethers.org/v5-errors-"+o+" ]"),n.length&&(e+=" ("+n.join(", ")+")");const a=new Error(e);return a.reason=s,a.code=r,Object.keys(i).forEach(function(c){a[c]=i[c]}),a}throwError(e,r,i){throw this.makeError(e,r,i)}throwArgumentError(e,r,i){return this.throwError(e,K.errors.INVALID_ARGUMENT,{argument:r,value:i})}assert(e,r,i,n){e||this.throwError(r,i,n)}assertArgument(e,r,i,n){e||this.throwArgumentError(r,i,n)}checkNormalize(e){Md&&this.throwError("platform missing String.prototype.normalize",K.errors.UNSUPPORTED_OPERATION,{operation:"String.prototype.normalize",form:Md})}checkSafeUint53(e,r){typeof e=="number"&&(r==null&&(r="value not safe"),(e<0||e>=9007199254740991)&&this.throwError(r,K.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"out-of-safe-range",value:e}),e%1&&this.throwError(r,K.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"non-integer",value:e}))}checkArgumentCount(e,r,i){i?i=": "+i:i="",e<r&&this.throwError("missing argument"+i,K.errors.MISSING_ARGUMENT,{count:e,expectedCount:r}),e>r&&this.throwError("too many arguments"+i,K.errors.UNEXPECTED_ARGUMENT,{count:e,expectedCount:r})}checkNew(e,r){(e===Object||e==null)&&this.throwError("missing new",K.errors.MISSING_NEW,{name:r.name})}checkAbstract(e,r){e===r?this.throwError("cannot instantiate abstract class "+JSON.stringify(r.name)+" directly; use a sub-class",K.errors.UNSUPPORTED_OPERATION,{name:e.name,operation:"new"}):(e===Object||e==null)&&this.throwError("missing new",K.errors.MISSING_NEW,{name:r.name})}static globalLogger(){return Zl||(Zl=new K(e2)),Zl}static setCensorship(e,r){if(!e&&r&&this.globalLogger().throwError("cannot permanently disable censorship",K.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"}),Bd){if(!e)return;this.globalLogger().throwError("error censorship permanent",K.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"})}Rd=!!e,Bd=!!r}static setLogLevel(e){const r=pc[e.toLowerCase()];if(r==null){K.globalLogger().warn("invalid log level - "+e);return}Td=r}static from(e){return new K(e)}}K.errors=ei;K.levels=ph;const r2="bytes/5.7.0",lt=new K(r2);function Ym(t){return!!t.toHexString}function Xs(t){return t.slice||(t.slice=function(){const e=Array.prototype.slice.call(arguments);return Xs(new Uint8Array(Array.prototype.slice.apply(t,e)))}),t}function If(t){return Te(t)&&!(t.length%2)||vo(t)}function $d(t){return typeof t=="number"&&t==t&&t%1===0}function vo(t){if(t==null)return!1;if(t.constructor===Uint8Array)return!0;if(typeof t=="string"||!$d(t.length)||t.length<0)return!1;for(let e=0;e<t.length;e++){const r=t[e];if(!$d(r)||r<0||r>=256)return!1}return!0}function le(t,e){if(e||(e={}),typeof t=="number"){lt.checkSafeUint53(t,"invalid arrayify value");const r=[];for(;t;)r.unshift(t&255),t=parseInt(String(t/256));return r.length===0&&r.push(0),Xs(new Uint8Array(r))}if(e.allowMissingPrefix&&typeof t=="string"&&t.substring(0,2)!=="0x"&&(t="0x"+t),Ym(t)&&(t=t.toHexString()),Te(t)){let r=t.substring(2);r.length%2&&(e.hexPad==="left"?r="0"+r:e.hexPad==="right"?r+="0":lt.throwArgumentError("hex data is odd-length","value",t));const i=[];for(let n=0;n<r.length;n+=2)i.push(parseInt(r.substring(n,n+2),16));return Xs(new Uint8Array(i))}return vo(t)?Xs(new Uint8Array(t)):lt.throwArgumentError("invalid arrayify value","value",t)}function hs(t){const e=t.map(n=>le(n)),r=e.reduce((n,s)=>n+s.length,0),i=new Uint8Array(r);return e.reduce((n,s)=>(i.set(s,n),n+s.length),0),Xs(i)}function lo(t){let e=le(t);if(e.length===0)return e;let r=0;for(;r<e.length&&e[r]===0;)r++;return r&&(e=e.slice(r)),e}function i2(t,e){t=le(t),t.length>e&&lt.throwArgumentError("value out of range","value",arguments[0]);const r=new Uint8Array(e);return r.set(t,e-t.length),Xs(r)}function Te(t,e){return!(typeof t!="string"||!t.match(/^0x[0-9A-Fa-f]*$/)||e&&t.length!==2+2*e)}const Xl="0123456789abcdef";function ce(t,e){if(e||(e={}),typeof t=="number"){lt.checkSafeUint53(t,"invalid hexlify value");let r="";for(;t;)r=Xl[t&15]+r,t=Math.floor(t/16);return r.length?(r.length%2&&(r="0"+r),"0x"+r):"0x00"}if(typeof t=="bigint")return t=t.toString(16),t.length%2?"0x0"+t:"0x"+t;if(e.allowMissingPrefix&&typeof t=="string"&&t.substring(0,2)!=="0x"&&(t="0x"+t),Ym(t))return t.toHexString();if(Te(t))return t.length%2&&(e.hexPad==="left"?t="0x0"+t.substring(2):e.hexPad==="right"?t+="0":lt.throwArgumentError("hex data is odd-length","value",t)),t.toLowerCase();if(vo(t)){let r="0x";for(let i=0;i<t.length;i++){let n=t[i];r+=Xl[(n&240)>>4]+Xl[n&15]}return r}return lt.throwArgumentError("invalid hexlify value","value",t)}function bs(t){if(typeof t!="string")t=ce(t);else if(!Te(t)||t.length%2)return null;return(t.length-2)/2}function Yt(t,e,r){return typeof t!="string"?t=ce(t):(!Te(t)||t.length%2)&&lt.throwArgumentError("invalid hexData","value",t),e=2+2*e,r!=null?"0x"+t.substring(e,2+2*r):"0x"+t.substring(e)}function _r(t){let e="0x";return t.forEach(r=>{e+=ce(r).substring(2)}),e}function Sf(t){const e=n2(ce(t,{hexPad:"left"}));return e==="0x"?"0x0":e}function n2(t){typeof t!="string"&&(t=ce(t)),Te(t)||lt.throwArgumentError("invalid hex string","value",t),t=t.substring(2);let e=0;for(;e<t.length&&t[e]==="0";)e++;return"0x"+t.substring(e)}function ut(t,e){for(typeof t!="string"?t=ce(t):Te(t)||lt.throwArgumentError("invalid hex string","value",t),t.length>2*e+2&&lt.throwArgumentError("value out of range","value",arguments[1]);t.length<2*e+2;)t="0x0"+t.substring(2);return t}function sl(t){const e={r:"0x",s:"0x",_vs:"0x",recoveryParam:0,v:0,yParityAndS:"0x",compact:"0x"};if(If(t)){let r=le(t);r.length===64?(e.v=27+(r[32]>>7),r[32]&=127,e.r=ce(r.slice(0,32)),e.s=ce(r.slice(32,64))):r.length===65?(e.r=ce(r.slice(0,32)),e.s=ce(r.slice(32,64)),e.v=r[64]):lt.throwArgumentError("invalid signature string","signature",t),e.v<27&&(e.v===0||e.v===1?e.v+=27:lt.throwArgumentError("signature invalid v byte","signature",t)),e.recoveryParam=1-e.v%2,e.recoveryParam&&(r[32]|=128),e._vs=ce(r.slice(32,64))}else{if(e.r=t.r,e.s=t.s,e.v=t.v,e.recoveryParam=t.recoveryParam,e._vs=t._vs,e._vs!=null){const n=i2(le(e._vs),32);e._vs=ce(n);const s=n[0]>=128?1:0;e.recoveryParam==null?e.recoveryParam=s:e.recoveryParam!==s&&lt.throwArgumentError("signature recoveryParam mismatch _vs","signature",t),n[0]&=127;const o=ce(n);e.s==null?e.s=o:e.s!==o&&lt.throwArgumentError("signature v mismatch _vs","signature",t)}if(e.recoveryParam==null)e.v==null?lt.throwArgumentError("signature missing v and recoveryParam","signature",t):e.v===0||e.v===1?e.recoveryParam=e.v:e.recoveryParam=1-e.v%2;else if(e.v==null)e.v=27+e.recoveryParam;else{const n=e.v===0||e.v===1?e.v:1-e.v%2;e.recoveryParam!==n&&lt.throwArgumentError("signature recoveryParam mismatch v","signature",t)}e.r==null||!Te(e.r)?lt.throwArgumentError("signature missing or invalid r","signature",t):e.r=ut(e.r,32),e.s==null||!Te(e.s)?lt.throwArgumentError("signature missing or invalid s","signature",t):e.s=ut(e.s,32);const r=le(e.s);r[0]>=128&&lt.throwArgumentError("signature s out of range","signature",t),e.recoveryParam&&(r[0]|=128);const i=ce(r);e._vs&&(Te(e._vs)||lt.throwArgumentError("signature invalid _vs","signature",t),e._vs=ut(e._vs,32)),e._vs==null?e._vs=i:e._vs!==i&&lt.throwArgumentError("signature _vs mismatch v and s","signature",t)}return e.yParityAndS=e._vs,e.compact=e.r+e.yParityAndS.substring(2),e}const Jm="bignumber/5.7.0";var Dc=se.BN;const ji=new K(Jm),eu={},Ud=9007199254740991;function s2(t){return t!=null&&(te.isBigNumber(t)||typeof t=="number"&&t%1===0||typeof t=="string"&&!!t.match(/^-?[0-9]+$/)||Te(t)||typeof t=="bigint"||vo(t))}let Ld=!1;class te{constructor(e,r){e!==eu&&ji.throwError("cannot call constructor directly; use BigNumber.from",K.errors.UNSUPPORTED_OPERATION,{operation:"new (BigNumber)"}),this._hex=r,this._isBigNumber=!0,Object.freeze(this)}fromTwos(e){return er(fe(this).fromTwos(e))}toTwos(e){return er(fe(this).toTwos(e))}abs(){return this._hex[0]==="-"?te.from(this._hex.substring(1)):this}add(e){return er(fe(this).add(fe(e)))}sub(e){return er(fe(this).sub(fe(e)))}div(e){return te.from(e).isZero()&&Nr("division-by-zero","div"),er(fe(this).div(fe(e)))}mul(e){return er(fe(this).mul(fe(e)))}mod(e){const r=fe(e);return r.isNeg()&&Nr("division-by-zero","mod"),er(fe(this).umod(r))}pow(e){const r=fe(e);return r.isNeg()&&Nr("negative-power","pow"),er(fe(this).pow(r))}and(e){const r=fe(e);return(this.isNegative()||r.isNeg())&&Nr("unbound-bitwise-result","and"),er(fe(this).and(r))}or(e){const r=fe(e);return(this.isNegative()||r.isNeg())&&Nr("unbound-bitwise-result","or"),er(fe(this).or(r))}xor(e){const r=fe(e);return(this.isNegative()||r.isNeg())&&Nr("unbound-bitwise-result","xor"),er(fe(this).xor(r))}mask(e){return(this.isNegative()||e<0)&&Nr("negative-width","mask"),er(fe(this).maskn(e))}shl(e){return(this.isNegative()||e<0)&&Nr("negative-width","shl"),er(fe(this).shln(e))}shr(e){return(this.isNegative()||e<0)&&Nr("negative-width","shr"),er(fe(this).shrn(e))}eq(e){return fe(this).eq(fe(e))}lt(e){return fe(this).lt(fe(e))}lte(e){return fe(this).lte(fe(e))}gt(e){return fe(this).gt(fe(e))}gte(e){return fe(this).gte(fe(e))}isNegative(){return this._hex[0]==="-"}isZero(){return fe(this).isZero()}toNumber(){try{return fe(this).toNumber()}catch{Nr("overflow","toNumber",this.toString())}return null}toBigInt(){try{return BigInt(this.toString())}catch{}return ji.throwError("this platform does not support BigInt",K.errors.UNSUPPORTED_OPERATION,{value:this.toString()})}toString(){return arguments.length>0&&(arguments[0]===10?Ld||(Ld=!0,ji.warn("BigNumber.toString does not accept any parameters; base-10 is assumed")):arguments[0]===16?ji.throwError("BigNumber.toString does not accept any parameters; use bigNumber.toHexString()",K.errors.UNEXPECTED_ARGUMENT,{}):ji.throwError("BigNumber.toString does not accept parameters",K.errors.UNEXPECTED_ARGUMENT,{})),fe(this).toString(10)}toHexString(){return this._hex}toJSON(e){return{type:"BigNumber",hex:this.toHexString()}}static from(e){if(e instanceof te)return e;if(typeof e=="string")return e.match(/^-?0x[0-9a-f]+$/i)?new te(eu,fa(e)):e.match(/^-?[0-9]+$/)?new te(eu,fa(new Dc(e))):ji.throwArgumentError("invalid BigNumber string","value",e);if(typeof e=="number")return e%1&&Nr("underflow","BigNumber.from",e),(e>=Ud||e<=-Ud)&&Nr("overflow","BigNumber.from",e),te.from(String(e));const r=e;if(typeof r=="bigint")return te.from(r.toString());if(vo(r))return te.from(ce(r));if(r)if(r.toHexString){const i=r.toHexString();if(typeof i=="string")return te.from(i)}else{let i=r._hex;if(i==null&&r.type==="BigNumber"&&(i=r.hex),typeof i=="string"&&(Te(i)||i[0]==="-"&&Te(i.substring(1))))return te.from(i)}return ji.throwArgumentError("invalid BigNumber value","value",e)}static isBigNumber(e){return!!(e&&e._isBigNumber)}}function fa(t){if(typeof t!="string")return fa(t.toString(16));if(t[0]==="-")return t=t.substring(1),t[0]==="-"&&ji.throwArgumentError("invalid hex","value",t),t=fa(t),t==="0x00"?t:"-"+t;if(t.substring(0,2)!=="0x"&&(t="0x"+t),t==="0x")return"0x00";for(t.length%2&&(t="0x0"+t.substring(2));t.length>4&&t.substring(0,4)==="0x00";)t="0x"+t.substring(4);return t}function er(t){return te.from(fa(t))}function fe(t){const e=te.from(t).toHexString();return e[0]==="-"?new Dc("-"+e.substring(3),16):new Dc(e.substring(2),16)}function Nr(t,e,r){const i={fault:t,operation:e};return r!=null&&(i.value=r),ji.throwError(t,K.errors.NUMERIC_FAULT,i)}function o2(t){return new Dc(t,36).toString(16)}const Jt=new K(Jm),ia={},Qm=te.from(0),Zm=te.from(-1);function Xm(t,e,r,i){const n={fault:e,operation:r};return i!==void 0&&(n.value=i),Jt.throwError(t,K.errors.NUMERIC_FAULT,n)}let na="0";for(;na.length<256;)na+=na;function Pf(t){if(typeof t!="number")try{t=te.from(t).toNumber()}catch{}return typeof t=="number"&&t>=0&&t<=256&&!(t%1)?"1"+na.substring(0,t):Jt.throwArgumentError("invalid decimal size","decimals",t)}function gc(t,e){e==null&&(e=0);const r=Pf(e);t=te.from(t);const i=t.lt(Qm);i&&(t=t.mul(Zm));let n=t.mod(r).toString();for(;n.length<r.length-1;)n="0"+n;n=n.match(/^([0-9]*[1-9]|0)(0*)/)[1];const s=t.div(r).toString();return r.length===1?t=s:t=s+"."+n,i&&(t="-"+t),t}function Bi(t,e){e==null&&(e=0);const r=Pf(e);(typeof t!="string"||!t.match(/^-?[0-9.]+$/))&&Jt.throwArgumentError("invalid decimal value","value",t);const i=t.substring(0,1)==="-";i&&(t=t.substring(1)),t==="."&&Jt.throwArgumentError("missing value","value",t);const n=t.split(".");n.length>2&&Jt.throwArgumentError("too many decimal points","value",t);let s=n[0],o=n[1];for(s||(s="0"),o||(o="0");o[o.length-1]==="0";)o=o.substring(0,o.length-1);for(o.length>r.length-1&&Xm("fractional component exceeds decimals","underflow","parseFixed"),o===""&&(o="0");o.length<r.length-1;)o+="0";const a=te.from(s),c=te.from(o);let l=a.mul(r).add(c);return i&&(l=l.mul(Zm)),l}class eo{constructor(e,r,i,n){e!==ia&&Jt.throwError("cannot use FixedFormat constructor; use FixedFormat.from",K.errors.UNSUPPORTED_OPERATION,{operation:"new FixedFormat"}),this.signed=r,this.width=i,this.decimals=n,this.name=(r?"":"u")+"fixed"+String(i)+"x"+String(n),this._multiplier=Pf(n),Object.freeze(this)}static from(e){if(e instanceof eo)return e;typeof e=="number"&&(e=`fixed128x${e}`);let r=!0,i=128,n=18;if(typeof e=="string"){if(e!=="fixed")if(e==="ufixed")r=!1;else{const s=e.match(/^(u?)fixed([0-9]+)x([0-9]+)$/);s||Jt.throwArgumentError("invalid fixed format","format",e),r=s[1]!=="u",i=parseInt(s[2]),n=parseInt(s[3])}}else if(e){const s=(o,a,c)=>e[o]==null?c:(typeof e[o]!==a&&Jt.throwArgumentError("invalid fixed format ("+o+" not "+a+")","format."+o,e[o]),e[o]);r=s("signed","boolean",r),i=s("width","number",i),n=s("decimals","number",n)}return i%8&&Jt.throwArgumentError("invalid fixed format width (not byte aligned)","format.width",i),n>80&&Jt.throwArgumentError("invalid fixed format (decimals too large)","format.decimals",n),new eo(ia,r,i,n)}}class Ct{constructor(e,r,i,n){e!==ia&&Jt.throwError("cannot use FixedNumber constructor; use FixedNumber.from",K.errors.UNSUPPORTED_OPERATION,{operation:"new FixedFormat"}),this.format=n,this._hex=r,this._value=i,this._isFixedNumber=!0,Object.freeze(this)}_checkFormat(e){this.format.name!==e.format.name&&Jt.throwArgumentError("incompatible format; use fixedNumber.toFormat","other",e)}addUnsafe(e){this._checkFormat(e);const r=Bi(this._value,this.format.decimals),i=Bi(e._value,e.format.decimals);return Ct.fromValue(r.add(i),this.format.decimals,this.format)}subUnsafe(e){this._checkFormat(e);const r=Bi(this._value,this.format.decimals),i=Bi(e._value,e.format.decimals);return Ct.fromValue(r.sub(i),this.format.decimals,this.format)}mulUnsafe(e){this._checkFormat(e);const r=Bi(this._value,this.format.decimals),i=Bi(e._value,e.format.decimals);return Ct.fromValue(r.mul(i).div(this.format._multiplier),this.format.decimals,this.format)}divUnsafe(e){this._checkFormat(e);const r=Bi(this._value,this.format.decimals),i=Bi(e._value,e.format.decimals);return Ct.fromValue(r.mul(this.format._multiplier).div(i),this.format.decimals,this.format)}floor(){const e=this.toString().split(".");e.length===1&&e.push("0");let r=Ct.from(e[0],this.format);const i=!e[1].match(/^(0*)$/);return this.isNegative()&&i&&(r=r.subUnsafe(Fd.toFormat(r.format))),r}ceiling(){const e=this.toString().split(".");e.length===1&&e.push("0");let r=Ct.from(e[0],this.format);const i=!e[1].match(/^(0*)$/);return!this.isNegative()&&i&&(r=r.addUnsafe(Fd.toFormat(r.format))),r}round(e){e==null&&(e=0);const r=this.toString().split(".");if(r.length===1&&r.push("0"),(e<0||e>80||e%1)&&Jt.throwArgumentError("invalid decimal count","decimals",e),r[1].length<=e)return this;const i=Ct.from("1"+na.substring(0,e),this.format),n=a2.toFormat(this.format);return this.mulUnsafe(i).addUnsafe(n).floor().divUnsafe(i)}isZero(){return this._value==="0.0"||this._value==="0"}isNegative(){return this._value[0]==="-"}toString(){return this._value}toHexString(e){if(e==null)return this._hex;e%8&&Jt.throwArgumentError("invalid byte width","width",e);const r=te.from(this._hex).fromTwos(this.format.width).toTwos(e).toHexString();return ut(r,e/8)}toUnsafeFloat(){return parseFloat(this.toString())}toFormat(e){return Ct.fromString(this._value,e)}static fromValue(e,r,i){return i==null&&r!=null&&!s2(r)&&(i=r,r=null),r==null&&(r=0),i==null&&(i="fixed"),Ct.fromString(gc(e,r),eo.from(i))}static fromString(e,r){r==null&&(r="fixed");const i=eo.from(r),n=Bi(e,i.decimals);!i.signed&&n.lt(Qm)&&Xm("unsigned value cannot be negative","overflow","value",e);let s=null;i.signed?s=n.toTwos(i.width).toHexString():(s=n.toHexString(),s=ut(s,i.width/8));const o=gc(n,i.decimals);return new Ct(ia,s,o,i)}static fromBytes(e,r){r==null&&(r="fixed");const i=eo.from(r);if(le(e).length>i.width/8)throw new Error("overflow");let n=te.from(e);i.signed&&(n=n.fromTwos(i.width));const s=n.toTwos((i.signed?0:1)+i.width).toHexString(),o=gc(n,i.decimals);return new Ct(ia,s,o,i)}static from(e,r){if(typeof e=="string")return Ct.fromString(e,r);if(vo(e))return Ct.fromBytes(e,r);try{return Ct.fromValue(e,0,r)}catch(i){if(i.code!==K.errors.INVALID_ARGUMENT)throw i}return Jt.throwArgumentError("invalid FixedNumber value","value",e)}static isFixedNumber(e){return!!(e&&e._isFixedNumber)}}const Fd=Ct.from(1),a2=Ct.from("0.5"),c2="properties/5.7.0";var l2=function(t,e,r,i){function n(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(u){try{l(i.next(u))}catch(h){o(h)}}function c(u){try{l(i.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):n(u.value).then(a,c)}l((i=i.apply(t,e||[])).next())})};const Nc=new K(c2);function me(t,e,r){Object.defineProperty(t,e,{enumerable:!0,value:r,writable:!1})}function Qo(t,e){for(let r=0;r<32;r++){if(t[e])return t[e];if(!t.prototype||typeof t.prototype!="object")break;t=Object.getPrototypeOf(t.prototype).constructor}return null}function Bt(t){return l2(this,void 0,void 0,function*(){const e=Object.keys(t).map(i=>{const n=t[i];return Promise.resolve(n).then(s=>({key:i,value:s}))});return(yield Promise.all(e)).reduce((i,n)=>(i[n.key]=n.value,i),{})})}function u2(t,e){(!t||typeof t!="object")&&Nc.throwArgumentError("invalid object","object",t),Object.keys(t).forEach(r=>{e[r]||Nc.throwArgumentError("invalid object key - "+r,"transaction:"+r,t)})}function cr(t){const e={};for(const r in t)e[r]=t[r];return e}const h2={bigint:!0,boolean:!0,function:!0,number:!0,string:!0};function ey(t){if(t==null||h2[typeof t])return!0;if(Array.isArray(t)||typeof t=="object"){if(!Object.isFrozen(t))return!1;const e=Object.keys(t);for(let r=0;r<e.length;r++){let i=null;try{i=t[e[r]]}catch{continue}if(!ey(i))return!1}return!0}return Nc.throwArgumentError(`Cannot deepCopy ${typeof t}`,"object",t)}function f2(t){if(ey(t))return t;if(Array.isArray(t))return Object.freeze(t.map(e=>vs(e)));if(typeof t=="object"){const e={};for(const r in t){const i=t[r];i!==void 0&&me(e,r,vs(i))}return e}return Nc.throwArgumentError(`Cannot deepCopy ${typeof t}`,"object",t)}function vs(t){return f2(t)}class d2{constructor(e){for(const r in e)this[r]=vs(e[r])}}var ty={exports:{}};/**
 * [js-sha3]{@link https://github.com/emn178/js-sha3}
 *
 * @version 0.8.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2015-2018
 * @license MIT
 */(function(t){(function(){var e="input is invalid type",r="finalize already called",i=typeof window=="object",n=i?window:{};n.JS_SHA3_NO_WINDOW&&(i=!1);var s=!i&&typeof self=="object",o=!n.JS_SHA3_NO_NODE_JS&&typeof process=="object"&&process.versions&&process.versions.node;o?n=Ur:s&&(n=self);var a=!n.JS_SHA3_NO_COMMON_JS&&!0&&t.exports,c=!n.JS_SHA3_NO_ARRAY_BUFFER&&typeof ArrayBuffer<"u",l="0123456789abcdef".split(""),u=[31,7936,2031616,520093696],h=[4,1024,262144,67108864],g=[1,256,65536,16777216],y=[6,1536,393216,100663296],w=[0,8,16,24],E=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648],P=[224,256,384,512],N=[128,256],R=["hex","buffer","arrayBuffer","array","digest"],D={128:168,256:136};(n.JS_SHA3_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(v){return Object.prototype.toString.call(v)==="[object Array]"}),c&&(n.JS_SHA3_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(v){return typeof v=="object"&&v.buffer&&v.buffer.constructor===ArrayBuffer});for(var C=function(v,T,U){return function(q){return new m(v,T,v).update(q)[U]()}},B=function(v,T,U){return function(q,z){return new m(v,T,z).update(q)[U]()}},M=function(v,T,U){return function(q,z,Y,J){return d["cshake"+v].update(q,z,Y,J)[U]()}},L=function(v,T,U){return function(q,z,Y,J){return d["kmac"+v].update(q,z,Y,J)[U]()}},F=function(v,T,U,q){for(var z=0;z<R.length;++z){var Y=R[z];v[Y]=T(U,q,Y)}return v},k=function(v,T){var U=C(v,T,"hex");return U.create=function(){return new m(v,T,v)},U.update=function(q){return U.create().update(q)},F(U,C,v,T)},V=function(v,T){var U=B(v,T,"hex");return U.create=function(q){return new m(v,T,q)},U.update=function(q,z){return U.create(z).update(q)},F(U,B,v,T)},H=function(v,T){var U=D[v],q=M(v,T,"hex");return q.create=function(z,Y,J){return!Y&&!J?d["shake"+v].create(z):new m(v,T,z).bytepad([Y,J],U)},q.update=function(z,Y,J,W){return q.create(Y,J,W).update(z)},F(q,M,v,T)},$=function(v,T){var U=D[v],q=L(v,T,"hex");return q.create=function(z,Y,J){return new O(v,T,Y).bytepad(["KMAC",J],U).bytepad([z],U)},q.update=function(z,Y,J,W){return q.create(z,J,W).update(Y)},F(q,L,v,T)},A=[{name:"keccak",padding:g,bits:P,createMethod:k},{name:"sha3",padding:y,bits:P,createMethod:k},{name:"shake",padding:u,bits:N,createMethod:V},{name:"cshake",padding:h,bits:N,createMethod:H},{name:"kmac",padding:h,bits:N,createMethod:$}],d={},f=[],p=0;p<A.length;++p)for(var b=A[p],x=b.bits,_=0;_<x.length;++_){var S=b.name+"_"+x[_];if(f.push(S),d[S]=b.createMethod(x[_],b.padding),b.name!=="sha3"){var I=b.name+x[_];f.push(I),d[I]=d[S]}}function m(v,T,U){this.blocks=[],this.s=[],this.padding=T,this.outputBits=U,this.reset=!0,this.finalized=!1,this.block=0,this.start=0,this.blockCount=1600-(v<<1)>>5,this.byteCount=this.blockCount<<2,this.outputBlocks=U>>5,this.extraBytes=(U&31)>>3;for(var q=0;q<50;++q)this.s[q]=0}m.prototype.update=function(v){if(this.finalized)throw new Error(r);var T,U=typeof v;if(U!=="string"){if(U==="object"){if(v===null)throw new Error(e);if(c&&v.constructor===ArrayBuffer)v=new Uint8Array(v);else if(!Array.isArray(v)&&(!c||!ArrayBuffer.isView(v)))throw new Error(e)}else throw new Error(e);T=!0}for(var q=this.blocks,z=this.byteCount,Y=v.length,J=this.blockCount,W=0,oe=this.s,X,ie;W<Y;){if(this.reset)for(this.reset=!1,q[0]=this.block,X=1;X<J+1;++X)q[X]=0;if(T)for(X=this.start;W<Y&&X<z;++W)q[X>>2]|=v[W]<<w[X++&3];else for(X=this.start;W<Y&&X<z;++W)ie=v.charCodeAt(W),ie<128?q[X>>2]|=ie<<w[X++&3]:ie<2048?(q[X>>2]|=(192|ie>>6)<<w[X++&3],q[X>>2]|=(128|ie&63)<<w[X++&3]):ie<55296||ie>=57344?(q[X>>2]|=(224|ie>>12)<<w[X++&3],q[X>>2]|=(128|ie>>6&63)<<w[X++&3],q[X>>2]|=(128|ie&63)<<w[X++&3]):(ie=65536+((ie&1023)<<10|v.charCodeAt(++W)&1023),q[X>>2]|=(240|ie>>18)<<w[X++&3],q[X>>2]|=(128|ie>>12&63)<<w[X++&3],q[X>>2]|=(128|ie>>6&63)<<w[X++&3],q[X>>2]|=(128|ie&63)<<w[X++&3]);if(this.lastByteIndex=X,X>=z){for(this.start=X-z,this.block=q[J],X=0;X<J;++X)oe[X]^=q[X];j(oe),this.reset=!0}else this.start=X}return this},m.prototype.encode=function(v,T){var U=v&255,q=1,z=[U];for(v=v>>8,U=v&255;U>0;)z.unshift(U),v=v>>8,U=v&255,++q;return T?z.push(q):z.unshift(q),this.update(z),z.length},m.prototype.encodeString=function(v){var T,U=typeof v;if(U!=="string"){if(U==="object"){if(v===null)throw new Error(e);if(c&&v.constructor===ArrayBuffer)v=new Uint8Array(v);else if(!Array.isArray(v)&&(!c||!ArrayBuffer.isView(v)))throw new Error(e)}else throw new Error(e);T=!0}var q=0,z=v.length;if(T)q=z;else for(var Y=0;Y<v.length;++Y){var J=v.charCodeAt(Y);J<128?q+=1:J<2048?q+=2:J<55296||J>=57344?q+=3:(J=65536+((J&1023)<<10|v.charCodeAt(++Y)&1023),q+=4)}return q+=this.encode(q*8),this.update(v),q},m.prototype.bytepad=function(v,T){for(var U=this.encode(T),q=0;q<v.length;++q)U+=this.encodeString(v[q]);var z=T-U%T,Y=[];return Y.length=z,this.update(Y),this},m.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var v=this.blocks,T=this.lastByteIndex,U=this.blockCount,q=this.s;if(v[T>>2]|=this.padding[T&3],this.lastByteIndex===this.byteCount)for(v[0]=v[U],T=1;T<U+1;++T)v[T]=0;for(v[U-1]|=2147483648,T=0;T<U;++T)q[T]^=v[T];j(q)}},m.prototype.toString=m.prototype.hex=function(){this.finalize();for(var v=this.blockCount,T=this.s,U=this.outputBlocks,q=this.extraBytes,z=0,Y=0,J="",W;Y<U;){for(z=0;z<v&&Y<U;++z,++Y)W=T[z],J+=l[W>>4&15]+l[W&15]+l[W>>12&15]+l[W>>8&15]+l[W>>20&15]+l[W>>16&15]+l[W>>28&15]+l[W>>24&15];Y%v===0&&(j(T),z=0)}return q&&(W=T[z],J+=l[W>>4&15]+l[W&15],q>1&&(J+=l[W>>12&15]+l[W>>8&15]),q>2&&(J+=l[W>>20&15]+l[W>>16&15])),J},m.prototype.arrayBuffer=function(){this.finalize();var v=this.blockCount,T=this.s,U=this.outputBlocks,q=this.extraBytes,z=0,Y=0,J=this.outputBits>>3,W;q?W=new ArrayBuffer(U+1<<2):W=new ArrayBuffer(J);for(var oe=new Uint32Array(W);Y<U;){for(z=0;z<v&&Y<U;++z,++Y)oe[Y]=T[z];Y%v===0&&j(T)}return q&&(oe[z]=T[z],W=W.slice(0,J)),W},m.prototype.buffer=m.prototype.arrayBuffer,m.prototype.digest=m.prototype.array=function(){this.finalize();for(var v=this.blockCount,T=this.s,U=this.outputBlocks,q=this.extraBytes,z=0,Y=0,J=[],W,oe;Y<U;){for(z=0;z<v&&Y<U;++z,++Y)W=Y<<2,oe=T[z],J[W]=oe&255,J[W+1]=oe>>8&255,J[W+2]=oe>>16&255,J[W+3]=oe>>24&255;Y%v===0&&j(T)}return q&&(W=Y<<2,oe=T[z],J[W]=oe&255,q>1&&(J[W+1]=oe>>8&255),q>2&&(J[W+2]=oe>>16&255)),J};function O(v,T,U){m.call(this,v,T,U)}O.prototype=new m,O.prototype.finalize=function(){return this.encode(this.outputBits,!0),m.prototype.finalize.call(this)};var j=function(v){var T,U,q,z,Y,J,W,oe,X,ie,Lt,Oe,De,oi,Ae,Ee,ai,_e,Ie,ci,Se,Ne,Ci,Ce,Be,zn,$e,Ue,Hn,Le,Fe,Kn,qe,je,Vn,ze,He,Gn,Ke,Ve,Wn,Ge,We,Yn,Ye,Je,Jn,Qe,Ze,Qn,Xe,et,Zn,tt,rt,Xn,it,nt,an,cn,ln,un,hn;for(q=0;q<48;q+=2)z=v[0]^v[10]^v[20]^v[30]^v[40],Y=v[1]^v[11]^v[21]^v[31]^v[41],J=v[2]^v[12]^v[22]^v[32]^v[42],W=v[3]^v[13]^v[23]^v[33]^v[43],oe=v[4]^v[14]^v[24]^v[34]^v[44],X=v[5]^v[15]^v[25]^v[35]^v[45],ie=v[6]^v[16]^v[26]^v[36]^v[46],Lt=v[7]^v[17]^v[27]^v[37]^v[47],Oe=v[8]^v[18]^v[28]^v[38]^v[48],De=v[9]^v[19]^v[29]^v[39]^v[49],T=Oe^(J<<1|W>>>31),U=De^(W<<1|J>>>31),v[0]^=T,v[1]^=U,v[10]^=T,v[11]^=U,v[20]^=T,v[21]^=U,v[30]^=T,v[31]^=U,v[40]^=T,v[41]^=U,T=z^(oe<<1|X>>>31),U=Y^(X<<1|oe>>>31),v[2]^=T,v[3]^=U,v[12]^=T,v[13]^=U,v[22]^=T,v[23]^=U,v[32]^=T,v[33]^=U,v[42]^=T,v[43]^=U,T=J^(ie<<1|Lt>>>31),U=W^(Lt<<1|ie>>>31),v[4]^=T,v[5]^=U,v[14]^=T,v[15]^=U,v[24]^=T,v[25]^=U,v[34]^=T,v[35]^=U,v[44]^=T,v[45]^=U,T=oe^(Oe<<1|De>>>31),U=X^(De<<1|Oe>>>31),v[6]^=T,v[7]^=U,v[16]^=T,v[17]^=U,v[26]^=T,v[27]^=U,v[36]^=T,v[37]^=U,v[46]^=T,v[47]^=U,T=ie^(z<<1|Y>>>31),U=Lt^(Y<<1|z>>>31),v[8]^=T,v[9]^=U,v[18]^=T,v[19]^=U,v[28]^=T,v[29]^=U,v[38]^=T,v[39]^=U,v[48]^=T,v[49]^=U,oi=v[0],Ae=v[1],Je=v[11]<<4|v[10]>>>28,Jn=v[10]<<4|v[11]>>>28,Ue=v[20]<<3|v[21]>>>29,Hn=v[21]<<3|v[20]>>>29,cn=v[31]<<9|v[30]>>>23,ln=v[30]<<9|v[31]>>>23,Ge=v[40]<<18|v[41]>>>14,We=v[41]<<18|v[40]>>>14,je=v[2]<<1|v[3]>>>31,Vn=v[3]<<1|v[2]>>>31,Ee=v[13]<<12|v[12]>>>20,ai=v[12]<<12|v[13]>>>20,Qe=v[22]<<10|v[23]>>>22,Ze=v[23]<<10|v[22]>>>22,Le=v[33]<<13|v[32]>>>19,Fe=v[32]<<13|v[33]>>>19,un=v[42]<<2|v[43]>>>30,hn=v[43]<<2|v[42]>>>30,tt=v[5]<<30|v[4]>>>2,rt=v[4]<<30|v[5]>>>2,ze=v[14]<<6|v[15]>>>26,He=v[15]<<6|v[14]>>>26,_e=v[25]<<11|v[24]>>>21,Ie=v[24]<<11|v[25]>>>21,Qn=v[34]<<15|v[35]>>>17,Xe=v[35]<<15|v[34]>>>17,Kn=v[45]<<29|v[44]>>>3,qe=v[44]<<29|v[45]>>>3,Ce=v[6]<<28|v[7]>>>4,Be=v[7]<<28|v[6]>>>4,Xn=v[17]<<23|v[16]>>>9,it=v[16]<<23|v[17]>>>9,Gn=v[26]<<25|v[27]>>>7,Ke=v[27]<<25|v[26]>>>7,ci=v[36]<<21|v[37]>>>11,Se=v[37]<<21|v[36]>>>11,et=v[47]<<24|v[46]>>>8,Zn=v[46]<<24|v[47]>>>8,Yn=v[8]<<27|v[9]>>>5,Ye=v[9]<<27|v[8]>>>5,zn=v[18]<<20|v[19]>>>12,$e=v[19]<<20|v[18]>>>12,nt=v[29]<<7|v[28]>>>25,an=v[28]<<7|v[29]>>>25,Ve=v[38]<<8|v[39]>>>24,Wn=v[39]<<8|v[38]>>>24,Ne=v[48]<<14|v[49]>>>18,Ci=v[49]<<14|v[48]>>>18,v[0]=oi^~Ee&_e,v[1]=Ae^~ai&Ie,v[10]=Ce^~zn&Ue,v[11]=Be^~$e&Hn,v[20]=je^~ze&Gn,v[21]=Vn^~He&Ke,v[30]=Yn^~Je&Qe,v[31]=Ye^~Jn&Ze,v[40]=tt^~Xn&nt,v[41]=rt^~it&an,v[2]=Ee^~_e&ci,v[3]=ai^~Ie&Se,v[12]=zn^~Ue&Le,v[13]=$e^~Hn&Fe,v[22]=ze^~Gn&Ve,v[23]=He^~Ke&Wn,v[32]=Je^~Qe&Qn,v[33]=Jn^~Ze&Xe,v[42]=Xn^~nt&cn,v[43]=it^~an&ln,v[4]=_e^~ci&Ne,v[5]=Ie^~Se&Ci,v[14]=Ue^~Le&Kn,v[15]=Hn^~Fe&qe,v[24]=Gn^~Ve&Ge,v[25]=Ke^~Wn&We,v[34]=Qe^~Qn&et,v[35]=Ze^~Xe&Zn,v[44]=nt^~cn&un,v[45]=an^~ln&hn,v[6]=ci^~Ne&oi,v[7]=Se^~Ci&Ae,v[16]=Le^~Kn&Ce,v[17]=Fe^~qe&Be,v[26]=Ve^~Ge&je,v[27]=Wn^~We&Vn,v[36]=Qn^~et&Yn,v[37]=Xe^~Zn&Ye,v[46]=cn^~un&tt,v[47]=ln^~hn&rt,v[8]=Ne^~oi&Ee,v[9]=Ci^~Ae&ai,v[18]=Kn^~Ce&zn,v[19]=qe^~Be&$e,v[28]=Ge^~je&ze,v[29]=We^~Vn&He,v[38]=et^~Yn&Je,v[39]=Zn^~Ye&Jn,v[48]=un^~tt&Xn,v[49]=hn^~rt&it,v[0]^=E[q],v[1]^=E[q+1]};if(a)t.exports=d;else for(p=0;p<f.length;++p)n[f[p]]=d[f[p]]})()})(ty);var p2=ty.exports;const g2=Os(p2);function Tt(t){return"0x"+g2.keccak_256(le(t))}const m2="rlp/5.7.0",wi=new K(m2);function qd(t){const e=[];for(;t;)e.unshift(t&255),t>>=8;return e}function jd(t,e,r){let i=0;for(let n=0;n<r;n++)i=i*256+t[e+n];return i}function ry(t){if(Array.isArray(t)){let i=[];if(t.forEach(function(s){i=i.concat(ry(s))}),i.length<=55)return i.unshift(192+i.length),i;const n=qd(i.length);return n.unshift(247+n.length),n.concat(i)}If(t)||wi.throwArgumentError("RLP object must be BytesLike","object",t);const e=Array.prototype.slice.call(le(t));if(e.length===1&&e[0]<=127)return e;if(e.length<=55)return e.unshift(128+e.length),e;const r=qd(e.length);return r.unshift(183+r.length),r.concat(e)}function ol(t){return ce(ry(t))}function zd(t,e,r,i){const n=[];for(;r<e+1+i;){const s=iy(t,r);n.push(s.result),r+=s.consumed,r>e+1+i&&wi.throwError("child data too short",K.errors.BUFFER_OVERRUN,{})}return{consumed:1+i,result:n}}function iy(t,e){if(t.length===0&&wi.throwError("data too short",K.errors.BUFFER_OVERRUN,{}),t[e]>=248){const r=t[e]-247;e+1+r>t.length&&wi.throwError("data short segment too short",K.errors.BUFFER_OVERRUN,{});const i=jd(t,e+1,r);return e+1+r+i>t.length&&wi.throwError("data long segment too short",K.errors.BUFFER_OVERRUN,{}),zd(t,e,e+1+r,r+i)}else if(t[e]>=192){const r=t[e]-192;return e+1+r>t.length&&wi.throwError("data array too short",K.errors.BUFFER_OVERRUN,{}),zd(t,e,e+1,r)}else if(t[e]>=184){const r=t[e]-183;e+1+r>t.length&&wi.throwError("data array too short",K.errors.BUFFER_OVERRUN,{});const i=jd(t,e+1,r);e+1+r+i>t.length&&wi.throwError("data array too short",K.errors.BUFFER_OVERRUN,{});const n=ce(t.slice(e+1+r,e+1+r+i));return{consumed:1+r+i,result:n}}else if(t[e]>=128){const r=t[e]-128;e+1+r>t.length&&wi.throwError("data too short",K.errors.BUFFER_OVERRUN,{});const i=ce(t.slice(e+1,e+1+r));return{consumed:1+r,result:i}}return{consumed:1,result:ce(t[e])}}function Of(t){const e=le(t),r=iy(e,0);return r.consumed!==e.length&&wi.throwArgumentError("invalid rlp data","data",t),r.result}const y2="address/5.7.0",Gs=new K(y2);function Hd(t){Te(t,20)||Gs.throwArgumentError("invalid address","address",t),t=t.toLowerCase();const e=t.substring(2).split(""),r=new Uint8Array(40);for(let n=0;n<40;n++)r[n]=e[n].charCodeAt(0);const i=le(Tt(r));for(let n=0;n<40;n+=2)i[n>>1]>>4>=8&&(e[n]=e[n].toUpperCase()),(i[n>>1]&15)>=8&&(e[n+1]=e[n+1].toUpperCase());return"0x"+e.join("")}const w2=9007199254740991;function b2(t){return Math.log10?Math.log10(t):Math.log(t)/Math.LN10}const Df={};for(let t=0;t<10;t++)Df[String(t)]=String(t);for(let t=0;t<26;t++)Df[String.fromCharCode(65+t)]=String(10+t);const Kd=Math.floor(b2(w2));function v2(t){t=t.toUpperCase(),t=t.substring(4)+t.substring(0,2)+"00";let e=t.split("").map(i=>Df[i]).join("");for(;e.length>=Kd;){let i=e.substring(0,Kd);e=parseInt(i,10)%97+e.substring(i.length)}let r=String(98-parseInt(e,10)%97);for(;r.length<2;)r="0"+r;return r}function fr(t){let e=null;if(typeof t!="string"&&Gs.throwArgumentError("invalid address","address",t),t.match(/^(0x)?[0-9a-fA-F]{40}$/))t.substring(0,2)!=="0x"&&(t="0x"+t),e=Hd(t),t.match(/([A-F].*[a-f])|([a-f].*[A-F])/)&&e!==t&&Gs.throwArgumentError("bad address checksum","address",t);else if(t.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){for(t.substring(2,4)!==v2(t)&&Gs.throwArgumentError("bad icap checksum","address",t),e=o2(t.substring(4));e.length<40;)e="0"+e;e=Hd("0x"+e)}else Gs.throwArgumentError("invalid address","address",t);return e}function E2(t){let e=null;try{e=fr(t.from)}catch{Gs.throwArgumentError("missing from address","transaction",t)}const r=lo(le(te.from(t.nonce).toHexString()));return fr(Yt(Tt(ol([e,r])),12))}const x2="0x0000000000000000000000000000000000000000",A2=te.from(0),_2="0x0000000000000000000000000000000000000000000000000000000000000000",I2="strings/5.7.0",ny=new K(I2);var da;(function(t){t.current="",t.NFC="NFC",t.NFD="NFD",t.NFKC="NFKC",t.NFKD="NFKD"})(da||(da={}));var xr;(function(t){t.UNEXPECTED_CONTINUE="unexpected continuation byte",t.BAD_PREFIX="bad codepoint prefix",t.OVERRUN="string overrun",t.MISSING_CONTINUE="missing continuation byte",t.OUT_OF_RANGE="out of UTF-8 range",t.UTF16_SURROGATE="UTF-16 surrogate",t.OVERLONG="overlong representation"})(xr||(xr={}));function S2(t,e,r,i,n){return ny.throwArgumentError(`invalid codepoint at offset ${e}; ${t}`,"bytes",r)}function sy(t,e,r,i,n){if(t===xr.BAD_PREFIX||t===xr.UNEXPECTED_CONTINUE){let s=0;for(let o=e+1;o<r.length&&r[o]>>6===2;o++)s++;return s}return t===xr.OVERRUN?r.length-e-1:0}function P2(t,e,r,i,n){return t===xr.OVERLONG?(i.push(n),0):(i.push(65533),sy(t,e,r))}const O2=Object.freeze({error:S2,ignore:sy,replace:P2});function oy(t,e){e==null&&(e=O2.error),t=le(t);const r=[];let i=0;for(;i<t.length;){const n=t[i++];if(!(n>>7)){r.push(n);continue}let s=null,o=null;if((n&224)===192)s=1,o=127;else if((n&240)===224)s=2,o=2047;else if((n&248)===240)s=3,o=65535;else{(n&192)===128?i+=e(xr.UNEXPECTED_CONTINUE,i-1,t,r):i+=e(xr.BAD_PREFIX,i-1,t,r);continue}if(i-1+s>=t.length){i+=e(xr.OVERRUN,i-1,t,r);continue}let a=n&(1<<8-s-1)-1;for(let c=0;c<s;c++){let l=t[i];if((l&192)!=128){i+=e(xr.MISSING_CONTINUE,i,t,r),a=null;break}a=a<<6|l&63,i++}if(a!==null){if(a>1114111){i+=e(xr.OUT_OF_RANGE,i-1-s,t,r,a);continue}if(a>=55296&&a<=57343){i+=e(xr.UTF16_SURROGATE,i-1-s,t,r,a);continue}if(a<=o){i+=e(xr.OVERLONG,i-1-s,t,r,a);continue}r.push(a)}}return r}function Xi(t,e=da.current){e!=da.current&&(ny.checkNormalize(),t=t.normalize(e));let r=[];for(let i=0;i<t.length;i++){const n=t.charCodeAt(i);if(n<128)r.push(n);else if(n<2048)r.push(n>>6|192),r.push(n&63|128);else if((n&64512)==55296){i++;const s=t.charCodeAt(i);if(i>=t.length||(s&64512)!==56320)throw new Error("invalid utf-8 string");const o=65536+((n&1023)<<10)+(s&1023);r.push(o>>18|240),r.push(o>>12&63|128),r.push(o>>6&63|128),r.push(o&63|128)}else r.push(n>>12|224),r.push(n>>6&63|128),r.push(n&63|128)}return le(r)}function D2(t){return t.map(e=>e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode((e>>10&1023)+55296,(e&1023)+56320))).join("")}function al(t,e){return D2(oy(t,e))}function N2(t,e=da.current){return oy(Xi(t,e))}function ay(t){return Tt(Xi(t))}const cy="hash/5.7.0";function ly(t){t=atob(t);const e=[];for(let r=0;r<t.length;r++)e.push(t.charCodeAt(r));return le(e)}function uy(t){t=le(t);let e="";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return btoa(e)}function hy(t,e){e==null&&(e=1);const r=[],i=r.forEach,n=function(s,o){i.call(s,function(a){o>0&&Array.isArray(a)?n(a,o-1):r.push(a)})};return n(t,e),r}function C2(t){const e={};for(let r=0;r<t.length;r++){const i=t[r];e[i[0]]=i[1]}return e}function B2(t){let e=0;function r(){return t[e++]<<8|t[e++]}let i=r(),n=1,s=[0,1];for(let B=1;B<i;B++)s.push(n+=r());let o=r(),a=e;e+=o;let c=0,l=0;function u(){return c==0&&(l=l<<8|t[e++],c=8),l>>--c&1}const h=31,g=Math.pow(2,h),y=g>>>1,w=y>>1,E=g-1;let P=0;for(let B=0;B<h;B++)P=P<<1|u();let N=[],R=0,D=g;for(;;){let B=Math.floor(((P-R+1)*n-1)/D),M=0,L=i;for(;L-M>1;){let V=M+L>>>1;B<s[V]?L=V:M=V}if(M==0)break;N.push(M);let F=R+Math.floor(D*s[M]/n),k=R+Math.floor(D*s[M+1]/n)-1;for(;!((F^k)&y);)P=P<<1&E|u(),F=F<<1&E,k=k<<1&E|1;for(;F&~k&w;)P=P&y|P<<1&E>>>1|u(),F=F<<1^y,k=(k^y)<<1|y|1;R=F,D=1+k-F}let C=i-4;return N.map(B=>{switch(B-C){case 3:return C+65792+(t[a++]<<16|t[a++]<<8|t[a++]);case 2:return C+256+(t[a++]<<8|t[a++]);case 1:return C+t[a++];default:return B-1}})}function R2(t){let e=0;return()=>t[e++]}function T2(t){return R2(B2(t))}function M2(t){return t&1?~t>>1:t>>1}function k2(t,e){let r=Array(t);for(let i=0;i<t;i++)r[i]=1+e();return r}function Vd(t,e){let r=Array(t);for(let i=0,n=-1;i<t;i++)r[i]=n+=1+e();return r}function $2(t,e){let r=Array(t);for(let i=0,n=0;i<t;i++)r[i]=n+=M2(e());return r}function Cc(t,e){let r=Vd(t(),t),i=t(),n=Vd(i,t),s=k2(i,t);for(let o=0;o<i;o++)for(let a=0;a<s[o];a++)r.push(n[o]+a);return e?r.map(o=>e[o]):r}function U2(t){let e=[];for(;;){let r=t();if(r==0)break;e.push(F2(r,t))}for(;;){let r=t()-1;if(r<0)break;e.push(q2(r,t))}return C2(hy(e))}function L2(t){let e=[];for(;;){let r=t();if(r==0)break;e.push(r)}return e}function fy(t,e,r){let i=Array(t).fill(void 0).map(()=>[]);for(let n=0;n<e;n++)$2(t,r).forEach((s,o)=>i[o].push(s));return i}function F2(t,e){let r=1+e(),i=e(),n=L2(e),s=fy(n.length,1+t,e);return hy(s.map((o,a)=>{const c=o[0],l=o.slice(1);return Array(n[a]).fill(void 0).map((u,h)=>{let g=h*i;return[c+h*r,l.map(y=>y+g)]})}))}function q2(t,e){let r=1+e();return fy(r,1+t,e).map(n=>[n[0],n.slice(1)])}function j2(t){let e=Cc(t).sort((i,n)=>i-n);return r();function r(){let i=[];for(;;){let l=Cc(t,e);if(l.length==0)break;i.push({set:new Set(l),node:r()})}i.sort((l,u)=>u.set.size-l.set.size);let n=t(),s=n%3;n=n/3|0;let o=!!(n&1);n>>=1;let a=n==1,c=n==2;return{branches:i,valid:s,fe0f:o,save:a,check:c}}}function z2(){return T2(ly("AEQF2AO2DEsA2wIrAGsBRABxAN8AZwCcAEwAqgA0AGwAUgByADcATAAVAFYAIQAyACEAKAAYAFgAGwAjABQAMAAmADIAFAAfABQAKwATACoADgAbAA8AHQAYABoAGQAxADgALAAoADwAEwA9ABMAGgARAA4ADwAWABMAFgAIAA8AHgQXBYMA5BHJAS8JtAYoAe4AExozi0UAH21tAaMnBT8CrnIyhrMDhRgDygIBUAEHcoFHUPe8AXBjAewCjgDQR8IICIcEcQLwATXCDgzvHwBmBoHNAqsBdBcUAykgDhAMShskMgo8AY8jqAQfAUAfHw8BDw87MioGlCIPBwZCa4ELatMAAMspJVgsDl8AIhckSg8XAHdvTwBcIQEiDT4OPhUqbyECAEoAS34Aej8Ybx83JgT/Xw8gHxZ/7w8RICxPHA9vBw+Pfw8PHwAPFv+fAsAvCc8vEr8ivwD/EQ8Bol8OEBa/A78hrwAPCU8vESNvvwWfHwNfAVoDHr+ZAAED34YaAdJPAK7PLwSEgDLHAGo1Pz8Pvx9fUwMrpb8O/58VTzAPIBoXIyQJNF8hpwIVAT8YGAUADDNBaX3RAMomJCg9EhUeA29MABsZBTMNJipjOhc19gcIDR8bBwQHEggCWi6DIgLuAQYA+BAFCha3A5XiAEsqM7UFFgFLhAMjFTMYE1Klnw74nRVBG/ASCm0BYRN/BrsU3VoWy+S0vV8LQx+vN8gF2AC2AK5EAWwApgYDKmAAroQ0NDQ0AT+OCg7wAAIHRAbpNgVcBV0APTA5BfbPFgMLzcYL/QqqA82eBALKCjQCjqYCht0/k2+OAsXQAoP3ASTKDgDw6ACKAUYCMpIKJpRaAE4A5womABzZvs0REEKiACIQAd5QdAECAj4Ywg/wGqY2AVgAYADYvAoCGAEubA0gvAY2ALAAbpbvqpyEAGAEpgQAJgAG7gAgAEACmghUFwCqAMpAINQIwC4DthRAAPcycKgApoIdABwBfCisABoATwBqASIAvhnSBP8aH/ECeAKXAq40NjgDBTwFYQU6AXs3oABgAD4XNgmcCY1eCl5tIFZeUqGgyoNHABgAEQAaABNwWQAmABMATPMa3T34ADldyprmM1M2XociUQgLzvwAXT3xABgAEQAaABNwIGFAnADD8AAgAD4BBJWzaCcIAIEBFMAWwKoAAdq9BWAF5wLQpALEtQAKUSGkahR4GnJM+gsAwCgeFAiUAECQ0BQuL8AAIAAAADKeIheclvFqQAAETr4iAMxIARMgAMIoHhQIAn0E0pDQFC4HhznoAAAAIAI2C0/4lvFqQAAETgBJJwYCAy4ABgYAFAA8MBKYEH4eRhTkAjYeFcgACAYAeABsOqyQ5gRwDayqugEgaIIAtgoACgDmEABmBAWGme5OBJJA2m4cDeoAmITWAXwrMgOgAGwBCh6CBXYF1Tzg1wKAAFdiuABRAFwAXQBsAG8AdgBrAHYAbwCEAHEwfxQBVE5TEQADVFhTBwBDANILAqcCzgLTApQCrQL6vAAMAL8APLhNBKkE6glGKTAU4Dr4N2EYEwBCkABKk8rHAbYBmwIoAiU4Ajf/Aq4CowCAANIChzgaNBsCsTgeODcFXrgClQKdAqQBiQGYAqsCsjTsNHsfNPA0ixsAWTWiOAMFPDQSNCk2BDZHNow2TTZUNhk28Jk9VzI3QkEoAoICoQKwAqcAQAAxBV4FXbS9BW47YkIXP1ciUqs05DS/FwABUwJW11e6nHuYZmSh/RAYA8oMKvZ8KASoUAJYWAJ6ILAsAZSoqjpgA0ocBIhmDgDWAAawRDQoAAcuAj5iAHABZiR2AIgiHgCaAU68ACxuHAG0ygM8MiZIAlgBdF4GagJqAPZOHAMuBgoATkYAsABiAHgAMLoGDPj0HpKEBAAOJgAuALggTAHWAeAMEDbd20Uege0ADwAWADkAQgA9OHd+2MUQZBBhBgNNDkxxPxUQArEPqwvqERoM1irQ090ANK4H8ANYB/ADWANYB/AH8ANYB/ADWANYA1gDWBwP8B/YxRBkD00EcgWTBZAE2wiIJk4RhgctCNdUEnQjHEwDSgEBIypJITuYMxAlR0wRTQgIATZHbKx9PQNMMbBU+pCnA9AyVDlxBgMedhKlAC8PeCE1uk6DekxxpQpQT7NX9wBFBgASqwAS5gBJDSgAUCwGPQBI4zTYABNGAE2bAE3KAExdGABKaAbgAFBXAFCOAFBJABI2SWdObALDOq0//QomCZhvwHdTBkIQHCemEPgMNAG2ATwN7kvZBPIGPATKH34ZGg/OlZ0Ipi3eDO4m5C6igFsj9iqEBe5L9TzeC05RaQ9aC2YJ5DpkgU8DIgEOIowK3g06CG4Q9ArKbA3mEUYHOgPWSZsApgcCCxIdNhW2JhFirQsKOXgG/Br3C5AmsBMqev0F1BoiBk4BKhsAANAu6IWxWjJcHU9gBgQLJiPIFKlQIQ0mQLh4SRocBxYlqgKSQ3FKiFE3HpQh9zw+DWcuFFF9B/Y8BhlQC4I8n0asRQ8R0z6OPUkiSkwtBDaALDAnjAnQD4YMunxzAVoJIgmyDHITMhEYN8YIOgcaLpclJxYIIkaWYJsE+KAD9BPSAwwFQAlCBxQDthwuEy8VKgUOgSXYAvQ21i60ApBWgQEYBcwPJh/gEFFH4Q7qCJwCZgOEJewALhUiABginAhEZABgj9lTBi7MCMhqbSN1A2gU6GIRdAeSDlgHqBw0FcAc4nDJXgyGCSiksAlcAXYJmgFgBOQICjVcjKEgQmdUi1kYnCBiQUBd/QIyDGYVoES+h3kCjA9sEhwBNgF0BzoNAgJ4Ee4RbBCWCOyGBTW2M/k6JgRQIYQgEgooA1BszwsoJvoM+WoBpBJjAw00PnfvZ6xgtyUX/gcaMsZBYSHyC5NPzgydGsIYQ1QvGeUHwAP0GvQn60FYBgADpAQUOk4z7wS+C2oIjAlAAEoOpBgH2BhrCnKM0QEyjAG4mgNYkoQCcJAGOAcMAGgMiAV65gAeAqgIpAAGANADWAA6Aq4HngAaAIZCAT4DKDABIuYCkAOUCDLMAZYwAfQqBBzEDBYA+DhuSwLDsgKAa2ajBd5ZAo8CSjYBTiYEBk9IUgOwcuIA3ABMBhTgSAEWrEvMG+REAeBwLADIAPwABjYHBkIBzgH0bgC4AWALMgmjtLYBTuoqAIQAFmwB2AKKAN4ANgCA8gFUAE4FWvoF1AJQSgESMhksWGIBvAMgATQBDgB6BsyOpsoIIARuB9QCEBwV4gLvLwe2AgMi4BPOQsYCvd9WADIXUu5eZwqoCqdeaAC0YTQHMnM9UQAPH6k+yAdy/BZIiQImSwBQ5gBQQzSaNTFWSTYBpwGqKQK38AFtqwBI/wK37gK3rQK3sAK6280C0gK33AK3zxAAUEIAUD9SklKDArekArw5AEQAzAHCO147WTteO1k7XjtZO147WTteO1kDmChYI03AVU0oJqkKbV9GYewMpw3VRMk6ShPcYFJgMxPJLbgUwhXPJVcZPhq9JwYl5VUKDwUt1GYxCC00dhe9AEApaYNCY4ceMQpMHOhTklT5LRwAskujM7ANrRsWREEFSHXuYisWDwojAmSCAmJDXE6wXDchAqH4AmiZAmYKAp+FOBwMAmY8AmYnBG8EgAN/FAN+kzkHOXgYOYM6JCQCbB4CMjc4CwJtyAJtr/CLADRoRiwBaADfAOIASwYHmQyOAP8MwwAOtgJ3MAJ2o0ACeUxEAni7Hl3cRa9G9AJ8QAJ6yQJ9CgJ88UgBSH5kJQAsFklZSlwWGErNAtECAtDNSygDiFADh+dExpEzAvKiXQQDA69Lz0wuJgTQTU1NsAKLQAKK2cIcCB5EaAa4Ao44Ao5dQZiCAo7aAo5deVG1UzYLUtVUhgKT/AKTDQDqAB1VH1WwVdEHLBwplocy4nhnRTw6ApegAu+zWCKpAFomApaQApZ9nQCqWa1aCoJOADwClrYClk9cRVzSApnMApllXMtdCBoCnJw5wzqeApwXAp+cAp65iwAeEDIrEAKd8gKekwC2PmE1YfACntQCoG8BqgKeoCACnk+mY8lkKCYsAiewAiZ/AqD8AqBN2AKmMAKlzwKoAAB+AqfzaH1osgAESmodatICrOQCrK8CrWgCrQMCVx4CVd0CseLYAx9PbJgCsr4OArLpGGzhbWRtSWADJc4Ctl08QG6RAylGArhfArlIFgK5K3hwN3DiAr0aAy2zAzISAr6JcgMDM3ICvhtzI3NQAsPMAsMFc4N0TDZGdOEDPKgDPJsDPcACxX0CxkgCxhGKAshqUgLIRQLJUALJLwJkngLd03h6YniveSZL0QMYpGcDAmH1GfSVJXsMXpNevBICz2wCz20wTFTT9BSgAMeuAs90ASrrA04TfkwGAtwoAtuLAtJQA1JdA1NgAQIDVY2AikABzBfuYUZ2AILPg44C2sgC2d+EEYRKpz0DhqYAMANkD4ZyWvoAVgLfZgLeuXR4AuIw7RUB8zEoAfScAfLTiALr9ALpcXoAAur6AurlAPpIAboC7ooC652Wq5cEAu5AA4XhmHpw4XGiAvMEAGoDjheZlAL3FAORbwOSiAL3mQL52gL4Z5odmqy8OJsfA52EAv77ARwAOp8dn7QDBY4DpmsDptoA0sYDBmuhiaIGCgMMSgFgASACtgNGAJwEgLpoBgC8BGzAEowcggCEDC6kdjoAJAM0C5IKRoABZCgiAIzw3AYBLACkfng9ogigkgNmWAN6AEQCvrkEVqTGAwCsBRbAA+4iQkMCHR072jI2PTbUNsk2RjY5NvA23TZKNiU3EDcZN5I+RTxDRTBCJkK5VBYKFhZfwQCWygU3AJBRHpu+OytgNxa61A40GMsYjsn7BVwFXQVcBV0FaAVdBVwFXQVcBV0FXAVdBVwFXUsaCNyKAK4AAQUHBwKU7oICoW1e7jAEzgPxA+YDwgCkBFDAwADABKzAAOxFLhitA1UFTDeyPkM+bj51QkRCuwTQWWQ8X+0AWBYzsACNA8xwzAGm7EZ/QisoCTAbLDs6fnLfb8H2GccsbgFw13M1HAVkBW/Jxsm9CNRO8E8FDD0FBQw9FkcClOYCoMFegpDfADgcMiA2AJQACB8AsigKAIzIEAJKeBIApY5yPZQIAKQiHb4fvj5BKSRPQrZCOz0oXyxgOywfKAnGbgMClQaCAkILXgdeCD9IIGUgQj5fPoY+dT52Ao5CM0dAX9BTVG9SDzFwWTQAbxBzJF/lOEIQQglCCkKJIAls5AcClQICoKPMODEFxhi6KSAbiyfIRrMjtCgdWCAkPlFBIitCsEJRzAbMAV/OEyQzDg0OAQQEJ36i328/Mk9AybDJsQlq3tDRApUKAkFzXf1d/j9uALYP6hCoFgCTGD8kPsFKQiobrm0+zj0KSD8kPnVCRBwMDyJRTHFgMTJa5rwXQiQ2YfI/JD7BMEJEHGINTw4TOFlIRzwJO0icMQpyPyQ+wzJCRBv6DVgnKB01NgUKj2bwYzMqCoBkznBgEF+zYDIocwRIX+NgHj4HICNfh2C4CwdwFWpTG/lgUhYGAwRfv2Ts8mAaXzVgml/XYIJfuWC4HI1gUF9pYJZgMR6ilQHMAOwLAlDRefC0in4AXAEJA6PjCwc0IamOANMMCAECRQDFNRTZBgd+CwQlRA+r6+gLBDEFBnwUBXgKATIArwAGRAAHA3cDdAN2A3kDdwN9A3oDdQN7A30DfAN4A3oDfQAYEAAlAtYASwMAUAFsAHcKAHcAmgB3AHUAdQB2AHVu8UgAygDAAHcAdQB1AHYAdQALCgB3AAsAmgB3AAsCOwB3AAtu8UgAygDAAHgKAJoAdwB3AHUAdQB2AHUAeAB1AHUAdgB1bvFIAMoAwAALCgCaAHcACwB3AAsCOwB3AAtu8UgAygDAAH4ACwGgALcBpwC6AahdAu0COwLtbvFIAMoAwAALCgCaAu0ACwLtAAsCOwLtAAtu8UgAygDAA24ACwNvAAu0VsQAAzsAABCkjUIpAAsAUIusOggWcgMeBxVsGwL67U/2HlzmWOEeOgALASvuAAseAfpKUpnpGgYJDCIZM6YyARUE9ThqAD5iXQgnAJYJPnOzw0ZAEZxEKsIAkA4DhAHnTAIDxxUDK0lxCQlPYgIvIQVYJQBVqE1GakUAKGYiDToSBA1EtAYAXQJYAIF8GgMHRyAAIAjOe9YncekRAA0KACUrjwE7Ayc6AAYWAqaiKG4McEcqANoN3+Mg9TwCBhIkuCny+JwUQ29L008JluRxu3K+oAdqiHOqFH0AG5SUIfUJ5SxCGfxdipRzqTmT4V5Zb+r1Uo4Vm+NqSSEl2mNvR2JhIa8SpYO6ntdwFXHCWTCK8f2+Hxo7uiG3drDycAuKIMP5bhi06ACnqArH1rz4Rqg//lm6SgJGEVbF9xJHISaR6HxqxSnkw6shDnelHKNEfGUXSJRJ1GcsmtJw25xrZMDK9gXSm1/YMkdX4/6NKYOdtk/NQ3/NnDASjTc3fPjIjW/5sVfVObX2oTDWkr1dF9f3kxBsD3/3aQO8hPfRz+e0uEiJqt1161griu7gz8hDDwtpy+F+BWtefnKHZPAxcZoWbnznhJpy0e842j36bcNzGnIEusgGX0a8ZxsnjcSsPDZ09yZ36fCQbriHeQ72JRMILNl6ePPf2HWoVwgWAm1fb3V2sAY0+B6rAXqSwPBgseVmoqsBTSrm91+XasMYYySI8eeRxH3ZvHkMz3BQ5aJ3iUVbYPNM3/7emRtjlsMgv/9VyTsyt/mK+8fgWeT6SoFaclXqn42dAIsvAarF5vNNWHzKSkKQ/8Hfk5ZWK7r9yliOsooyBjRhfkHP4Q2DkWXQi6FG/9r/IwbmkV5T7JSopHKn1pJwm9tb5Ot0oyN1Z2mPpKXHTxx2nlK08fKk1hEYA8WgVVWL5lgx0iTv+KdojJeU23ZDjmiubXOxVXJKKi2Wjuh2HLZOFLiSC7Tls5SMh4f+Pj6xUSrNjFqLGehRNB8lC0QSLNmkJJx/wSG3MnjE9T1CkPwJI0wH2lfzwETIiVqUxg0dfu5q39Gt+hwdcxkhhNvQ4TyrBceof3Mhs/IxFci1HmHr4FMZgXEEczPiGCx0HRwzAqDq2j9AVm1kwN0mRVLWLylgtoPNapF5cY4Y1wJh/e0BBwZj44YgZrDNqvD/9Hv7GFYdUQeDJuQ3EWI4HaKqavU1XjC/n41kT4L79kqGq0kLhdTZvgP3TA3fS0ozVz+5piZsoOtIvBUFoMKbNcmBL6YxxaUAusHB38XrS8dQMnQwJfUUkpRoGr5AUeWicvBTzyK9g77+yCkf5PAysL7r/JjcZgrbvRpMW9iyaxZvKO6ceZN2EwIxKwVFPuvFuiEPGCoagbMo+SpydLrXqBzNCDGFCrO/rkcwa2xhokQZ5CdZ0AsU3JfSqJ6n5I14YA+P/uAgfhPU84Tlw7cEFfp7AEE8ey4sP12PTt4Cods1GRgDOB5xvyiR5m+Bx8O5nBCNctU8BevfV5A08x6RHd5jcwPTMDSZJOedIZ1cGQ704lxbAzqZOP05ZxaOghzSdvFBHYqomATARyAADK4elP8Ly3IrUZKfWh23Xy20uBUmLS4Pfagu9+oyVa2iPgqRP3F2CTUsvJ7+RYnN8fFZbU/HVvxvcFFDKkiTqV5UBZ3Gz54JAKByi9hkKMZJvuGgcSYXFmw08UyoQyVdfTD1/dMkCHXcTGAKeROgArsvmRrQTLUOXioOHGK2QkjHuoYFgXciZoTJd6Fs5q1QX1G+p/e26hYsEf7QZD1nnIyl/SFkNtYYmmBhpBrxl9WbY0YpHWRuw2Ll/tj9mD8P4snVzJl4F9J+1arVeTb9E5r2ILH04qStjxQNwn3m4YNqxmaNbLAqW2TN6LidwuJRqS+NXbtqxoeDXpxeGWmxzSkWxjkyCkX4NQRme6q5SAcC+M7+9ETfA/EwrzQajKakCwYyeunP6ZFlxU2oMEn1Pz31zeStW74G406ZJFCl1wAXIoUKkWotYEpOuXB1uVNxJ63dpJEqfxBeptwIHNrPz8BllZoIcBoXwgfJ+8VAUnVPvRvexnw0Ma/WiGYuJO5y8QTvEYBigFmhUxY5RqzE8OcywN/8m4UYrlaniJO75XQ6KSo9+tWHlu+hMi0UVdiKQp7NelnoZUzNaIyBPVeOwK6GNp+FfHuPOoyhaWuNvTYFkvxscMQWDh+zeFCFkgwbXftiV23ywJ4+uwRqmg9k3KzwIQpzppt8DBBOMbrqwQM5Gb05sEwdKzMiAqOloaA/lr0KA+1pr0/+HiWoiIjHA/wir2nIuS3PeU/ji3O6ZwoxcR1SZ9FhtLC5S0FIzFhbBWcGVP/KpxOPSiUoAdWUpqKH++6Scz507iCcxYI6rdMBICPJZea7OcmeFw5mObJSiqpjg2UoWNIs+cFhyDSt6geV5qgi3FunmwwDoGSMgerFOZGX1m0dMCYo5XOruxO063dwENK9DbnVM9wYFREzh4vyU1WYYJ/LRRp6oxgjqP/X5a8/4Af6p6NWkQferzBmXme0zY/4nwMJm/wd1tIqSwGz+E3xPEAOoZlJit3XddD7/BT1pllzOx+8bmQtANQ/S6fZexc6qi3W+Q2xcmXTUhuS5mpHQRvcxZUN0S5+PL9lXWUAaRZhEH8hTdAcuNMMCuVNKTEGtSUKNi3O6KhSaTzck8csZ2vWRZ+d7mW8c4IKwXIYd25S/zIftPkwPzufjEvOHWVD1m+FjpDVUTV0DGDuHj6QnaEwLu/dEgdLQOg9E1Sro9XHJ8ykLAwtPu+pxqKDuFexqON1sKQm7rwbE1E68UCfA/erovrTCG+DBSNg0l4goDQvZN6uNlbyLpcZAwj2UclycvLpIZMgv4yRlpb3YuMftozorbcGVHt/VeDV3+Fdf1TP0iuaCsPi2G4XeGhsyF1ubVDxkoJhmniQ0/jSg/eYML9KLfnCFgISWkp91eauR3IQvED0nAPXK+6hPCYs+n3+hCZbiskmVMG2da+0EsZPonUeIY8EbfusQXjsK/eFDaosbPjEfQS0RKG7yj5GG69M7MeO1HmiUYocgygJHL6M1qzUDDwUSmr99V7Sdr2F3JjQAJY+F0yH33Iv3+C9M38eML7gTgmNu/r2bUMiPvpYbZ6v1/IaESirBHNa7mPKn4dEmYg7v/+HQgPN1G79jBQ1+soydfDC2r+h2Bl/KIc5KjMK7OH6nb1jLsNf0EHVe2KBiE51ox636uyG6Lho0t3J34L5QY/ilE3mikaF4HKXG1mG1rCevT1Vv6GavltxoQe/bMrpZvRggnBxSEPEeEzkEdOxTnPXHVjUYdw8JYvjB/o7Eegc3Ma+NUxLLnsK0kJlinPmUHzHGtrk5+CAbVzFOBqpyy3QVUnzTDfC/0XD94/okH+OB+i7g9lolhWIjSnfIb+Eq43ZXOWmwvjyV/qqD+t0e+7mTEM74qP/Ozt8nmC7mRpyu63OB4KnUzFc074SqoyPUAgM+/TJGFo6T44EHnQU4X4z6qannVqgw/U7zCpwcmXV1AubIrvOmkKHazJAR55ePjp5tLBsN8vAqs3NAHdcEHOR2xQ0lsNAFzSUuxFQCFYvXLZJdOj9p4fNq6p0HBGUik2YzaI4xySy91KzhQ0+q1hjxvImRwPRf76tChlRkhRCi74NXZ9qUNeIwP+s5p+3m5nwPdNOHgSLD79n7O9m1n1uDHiMntq4nkYwV5OZ1ENbXxFd4PgrlvavZsyUO4MqYlqqn1O8W/I1dEZq5dXhrbETLaZIbC2Kj/Aa/QM+fqUOHdf0tXAQ1huZ3cmWECWSXy/43j35+Mvq9xws7JKseriZ1pEWKc8qlzNrGPUGcVgOa9cPJYIJsGnJTAUsEcDOEVULO5x0rXBijc1lgXEzQQKhROf8zIV82w8eswc78YX11KYLWQRcgHNJElBxfXr72lS2RBSl07qTKorO2uUDZr3sFhYsvnhLZn0A94KRzJ/7DEGIAhW5ZWFpL8gEwu1aLA9MuWZzNwl8Oze9Y+bX+v9gywRVnoB5I/8kXTXU3141yRLYrIOOz6SOnyHNy4SieqzkBXharjfjqq1q6tklaEbA8Qfm2DaIPs7OTq/nvJBjKfO2H9bH2cCMh1+5gspfycu8f/cuuRmtDjyqZ7uCIMyjdV3a+p3fqmXsRx4C8lujezIFHnQiVTXLXuI1XrwN3+siYYj2HHTvESUx8DlOTXpak9qFRK+L3mgJ1WsD7F4cu1aJoFoYQnu+wGDMOjJM3kiBQWHCcvhJ/HRdxodOQp45YZaOTA22Nb4XKCVxqkbwMYFhzYQYIAnCW8FW14uf98jhUG2zrKhQQ0q0CEq0t5nXyvUyvR8DvD69LU+g3i+HFWQMQ8PqZuHD+sNKAV0+M6EJC0szq7rEr7B5bQ8BcNHzvDMc9eqB5ZCQdTf80Obn4uzjwpYU7SISdtV0QGa9D3Wrh2BDQtpBKxaNFV+/Cy2P/Sv+8s7Ud0Fd74X4+o/TNztWgETUapy+majNQ68Lq3ee0ZO48VEbTZYiH1Co4OlfWef82RWeyUXo7woM03PyapGfikTnQinoNq5z5veLpeMV3HCAMTaZmA1oGLAn7XS3XYsz+XK7VMQsc4XKrmDXOLU/pSXVNUq8dIqTba///3x6LiLS6xs1xuCAYSfcQ3+rQgmu7uvf3THKt5Ooo97TqcbRqxx7EASizaQCBQllG/rYxVapMLgtLbZS64w1MDBMXX+PQpBKNwqUKOf2DDRDUXQf9EhOS0Qj4nTmlA8dzSLz/G1d+Ud8MTy/6ghhdiLpeerGY/UlDOfiuqFsMUU5/UYlP+BAmgRLuNpvrUaLlVkrqDievNVEAwF+4CoM1MZTmjxjJMsKJq+u8Zd7tNCUFy6LiyYXRJQ4VyvEQFFaCGKsxIwQkk7EzZ6LTJq2hUuPhvAW+gQnSG6J+MszC+7QCRHcnqDdyNRJ6T9xyS87A6MDutbzKGvGktpbXqtzWtXb9HsfK2cBMomjN9a4y+TaJLnXxAeX/HWzmf4cR4vALt/P4w4qgKY04ml4ZdLOinFYS6cup3G/1ie4+t1eOnpBNlqGqs75ilzkT4+DsZQxNvaSKJ//6zIbbk/M7LOhFmRc/1R+kBtz7JFGdZm/COotIdvQoXpTqP/1uqEUmCb/QWoGLMwO5ANcHzxdY48IGP5+J+zKOTBFZ4Pid+GTM+Wq12MV/H86xEJptBa6T+p3kgpwLedManBHC2GgNrFpoN2xnrMz9WFWX/8/ygSBkavq2Uv7FdCsLEYLu9LLIvAU0bNRDtzYl+/vXmjpIvuJFYjmI0im6QEYqnIeMsNjXG4vIutIGHijeAG/9EDBozKV5cldkHbLxHh25vT+ZEzbhXlqvpzKJwcEgfNwLAKFeo0/pvEE10XDB+EXRTXtSzJozQKFFAJhMxYkVaCW+E9AL7tMeU8acxidHqzb6lX4691UsDpy/LLRmT+epgW56+5Cw8tB4kMUv6s9lh3eRKbyGs+H/4mQMaYzPTf2OOdokEn+zzgvoD3FqNKk8QqGAXVsqcGdXrT62fSPkR2vROFi68A6se86UxRUk4cajfPyCC4G5wDhD+zNq4jodQ4u4n/m37Lr36n4LIAAsVr02dFi9AiwA81MYs2rm4eDlDNmdMRvEKRHfBwW5DdMNp0jPFZMeARqF/wL4XBfd+EMLBfMzpH5GH6NaW+1vrvMdg+VxDzatk3MXgO3ro3P/DpcC6+Mo4MySJhKJhSR01SGGGp5hPWmrrUgrv3lDnP+HhcI3nt3YqBoVAVTBAQT5iuhTg8nvPtd8ZeYj6w1x6RqGUBrSku7+N1+BaasZvjTk64RoIDlL8brpEcJx3OmY7jLoZsswdtmhfC/G21llXhITOwmvRDDeTTPbyASOa16cF5/A1fZAidJpqju3wYAy9avPR1ya6eNp9K8XYrrtuxlqi+bDKwlfrYdR0RRiKRVTLOH85+ZY7XSmzRpfZBJjaTa81VDcJHpZnZnSQLASGYW9l51ZV/h7eVzTi3Hv6hUsgc/51AqJRTkpbFVLXXszoBL8nBX0u/0jBLT8nH+fJePbrwURT58OY+UieRjd1vs04w0VG5VN2U6MoGZkQzKN/ptz0Q366dxoTGmj7i1NQGHi9GgnquXFYdrCfZBmeb7s0T6yrdlZH5cZuwHFyIJ/kAtGsTg0xH5taAAq44BAk1CPk9KVVbqQzrCUiFdF/6gtlPQ8bHHc1G1W92MXGZ5HEHftyLYs8mbD/9xYRUWkHmlM0zC2ilJlnNgV4bfALpQghxOUoZL7VTqtCHIaQSXm+YUMnpkXybnV+A6xlm2CVy8fn0Xlm2XRa0+zzOa21JWWmixfiPMSCZ7qA4rS93VN3pkpF1s5TonQjisHf7iU9ZGvUPOAKZcR1pbeVf/Ul7OhepGCaId9wOtqo7pJ7yLcBZ0pFkOF28y4zEI/kcUNmutBHaQpBdNM8vjCS6HZRokkeo88TBAjGyG7SR+6vUgTcyK9Imalj0kuxz0wmK+byQU11AiJFk/ya5dNduRClcnU64yGu/ieWSeOos1t3ep+RPIWQ2pyTYVbZltTbsb7NiwSi3AV+8KLWk7LxCnfZUetEM8ThnsSoGH38/nyAwFguJp8FjvlHtcWZuU4hPva0rHfr0UhOOJ/F6vS62FW7KzkmRll2HEc7oUq4fyi5T70Vl7YVIfsPHUCdHesf9Lk7WNVWO75JDkYbMI8TOW8JKVtLY9d6UJRITO8oKo0xS+o99Yy04iniGHAaGj88kEWgwv0OrHdY/nr76DOGNS59hXCGXzTKUvDl9iKpLSWYN1lxIeyywdNpTkhay74w2jFT6NS8qkjo5CxA1yfSYwp6AJIZNKIeEK5PJAW7ORgWgwp0VgzYpqovMrWxbu+DGZ6Lhie1RAqpzm8VUzKJOH3mCzWuTOLsN3VT/dv2eeYe9UjbR8YTBsLz7q60VN1sU51k+um1f8JxD5pPhbhSC8rRaB454tmh6YUWrJI3+GWY0qeWioj/tbkYITOkJaeuGt4JrJvHA+l0Gu7kY7XOaa05alMnRWVCXqFgLIwSY4uF59Ue5SU4QKuc/HamDxbr0x6csCetXGoP7Qn1Bk/J9DsynO/UD6iZ1Hyrz+jit0hDCwi/E9OjgKTbB3ZQKQ/0ZOvevfNHG0NK4Aj3Cp7NpRk07RT1i/S0EL93Ag8GRgKI9CfpajKyK6+Jj/PI1KO5/85VAwz2AwzP8FTBb075IxCXv6T9RVvWT2tUaqxDS92zrGUbWzUYk9mSs82pECH+fkqsDt93VW++4YsR/dHCYcQSYTO/KaBMDj9LSD/J/+z20Kq8XvZUAIHtm9hRPP3ItbuAu2Hm5lkPs92pd7kCxgRs0xOVBnZ13ccdA0aunrwv9SdqElJRC3g+oCu+nXyCgmXUs9yMjTMAIHfxZV+aPKcZeUBWt057Xo85Ks1Ir5gzEHCWqZEhrLZMuF11ziGtFQUds/EESajhagzcKsxamcSZxGth4UII+adPhQkUnx2WyN+4YWR+r3f8MnkyGFuR4zjzxJS8WsQYR5PTyRaD9ixa6Mh741nBHbzfjXHskGDq179xaRNrCIB1z1xRfWfjqw2pHc1zk9xlPpL8sQWAIuETZZhbnmL54rceXVNRvUiKrrqIkeogsl0XXb17ylNb0f4GA9Wd44vffEG8FSZGHEL2fbaTGRcSiCeA8PmA/f6Hz8HCS76fXUHwgwkzSwlI71ekZ7Fapmlk/KC+Hs8hUcw3N2LN5LhkVYyizYFl/uPeVP5lsoJHhhfWvvSWruCUW1ZcJOeuTbrDgywJ/qG07gZJplnTvLcYdNaH0KMYOYMGX+rB4NGPFmQsNaIwlWrfCezxre8zXBrsMT+edVLbLqN1BqB76JH4BvZTqUIMfGwPGEn+EnmTV86fPBaYbFL3DFEhjB45CewkXEAtJxk4/Ms2pPXnaRqdky0HOYdcUcE2zcXq4vaIvW2/v0nHFJH2XXe22ueDmq/18XGtELSq85j9X8q0tcNSSKJIX8FTuJF/Pf8j5PhqG2u+osvsLxYrvvfeVJL+4tkcXcr9JV7v0ERmj/X6fM3NC4j6dS1+9Umr2oPavqiAydTZPLMNRGY23LO9zAVDly7jD+70G5TPPLdhRIl4WxcYjLnM+SNcJ26FOrkrISUtPObIz5Zb3AG612krnpy15RMW+1cQjlnWFI6538qky9axd2oJmHIHP08KyP0ubGO+TQNOYuv2uh17yCIvR8VcStw7o1g0NM60sk+8Tq7YfIBJrtp53GkvzXH7OA0p8/n/u1satf/VJhtR1l8Wa6Gmaug7haSpaCaYQax6ta0mkutlb+eAOSG1aobM81D9A4iS1RRlzBBoVX6tU1S6WE2N9ORY6DfeLRC4l9Rvr5h95XDWB2mR1d4WFudpsgVYwiTwT31ljskD8ZyDOlm5DkGh9N/UB/0AI5Xvb8ZBmai2hQ4BWMqFwYnzxwB26YHSOv9WgY3JXnvoN+2R4rqGVh/LLDMtpFP+SpMGJNWvbIl5SOodbCczW2RKleksPoUeGEzrjtKHVdtZA+kfqO+rVx/iclCqwoopepvJpSTDjT+b9GWylGRF8EDbGlw6eUzmJM95Ovoz+kwLX3c2fTjFeYEsE7vUZm3mqdGJuKh2w9/QGSaqRHs99aScGOdDqkFcACoqdbBoQqqjamhH6Q9ng39JCg3lrGJwd50Qk9ovnqBTr8MME7Ps2wiVfygUmPoUBJJfJWX5Nda0nuncbFkA=="))}const cl=z2(),H2=new Set(Cc(cl)),K2=new Set(Cc(cl)),V2=U2(cl),G2=j2(cl),Gd=45,Wd=95;function dy(t){return N2(t)}function W2(t){return t.filter(e=>e!=65039)}function py(t){for(let e of t.split(".")){let r=dy(e);try{for(let i=r.lastIndexOf(Wd)-1;i>=0;i--)if(r[i]!==Wd)throw new Error("underscore only allowed at start");if(r.length>=4&&r.every(i=>i<128)&&r[2]===Gd&&r[3]===Gd)throw new Error("invalid label extension")}catch(i){throw new Error(`Invalid label "${e}": ${i.message}`)}}return t}function Y2(t){return py(J2(t,W2))}function J2(t,e){let r=dy(t).reverse(),i=[];for(;r.length;){let n=Z2(r);if(n){i.push(...e(n));continue}let s=r.pop();if(H2.has(s)){i.push(s);continue}if(K2.has(s))continue;let o=V2[s];if(o){i.push(...o);continue}throw new Error(`Disallowed codepoint: 0x${s.toString(16).toUpperCase()}`)}return py(Q2(String.fromCodePoint(...i)))}function Q2(t){return t.normalize("NFC")}function Z2(t,e){var r;let i=G2,n,s,o=[],a=t.length;for(;a;){let c=t[--a];if(i=(r=i.branches.find(l=>l.set.has(c)))===null||r===void 0?void 0:r.node,!i)break;if(i.save)s=c;else if(i.check&&c===s)break;o.push(c),i.fe0f&&(o.push(65039),a>0&&t[a-1]==65039&&a--),i.valid&&(n=o.slice(),i.valid==2&&n.splice(1,1),t.length=a)}return n}const X2=new K(cy),gy=new Uint8Array(32);gy.fill(0);function Yd(t){if(t.length===0)throw new Error("invalid ENS name; empty component");return t}function my(t){const e=Xi(Y2(t)),r=[];if(t.length===0)return r;let i=0;for(let n=0;n<e.length;n++)e[n]===46&&(r.push(Yd(e.slice(i,n))),i=n+1);if(i>=e.length)throw new Error("invalid ENS name; empty component");return r.push(Yd(e.slice(i))),r}function mc(t){typeof t!="string"&&X2.throwArgumentError("invalid ENS name; not a string","name",t);let e=gy;const r=my(t);for(;r.length;)e=Tt(hs([e,Tt(r.pop())]));return ce(e)}function eE(t){return ce(hs(my(t).map(e=>{if(e.length>63)throw new Error("invalid DNS encoded entry; length exceeds 63 bytes");const r=new Uint8Array(e.length+1);return r.set(e,1),r[0]=r.length-1,r})))+"00"}var tE=function(t,e,r,i){function n(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(u){try{l(i.next(u))}catch(h){o(h)}}function c(u){try{l(i.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):n(u.value).then(a,c)}l((i=i.apply(t,e||[])).next())})};const ct=new K(cy),yy=new Uint8Array(32);yy.fill(0);const rE=te.from(-1),wy=te.from(0),by=te.from(1),iE=te.from("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function nE(t){const e=le(t),r=e.length%32;return r?_r([e,yy.slice(r)]):ce(e)}const sE=ut(by.toHexString(),32),oE=ut(wy.toHexString(),32),Jd={name:"string",version:"string",chainId:"uint256",verifyingContract:"address",salt:"bytes32"},tu=["name","version","chainId","verifyingContract","salt"];function Qd(t){return function(e){return typeof e!="string"&&ct.throwArgumentError(`invalid domain value for ${JSON.stringify(t)}`,`domain.${t}`,e),e}}const aE={name:Qd("name"),version:Qd("version"),chainId:function(t){try{return te.from(t).toString()}catch{}return ct.throwArgumentError('invalid domain value for "chainId"',"domain.chainId",t)},verifyingContract:function(t){try{return fr(t).toLowerCase()}catch{}return ct.throwArgumentError('invalid domain value "verifyingContract"',"domain.verifyingContract",t)},salt:function(t){try{const e=le(t);if(e.length!==32)throw new Error("bad length");return ce(e)}catch{}return ct.throwArgumentError('invalid domain value "salt"',"domain.salt",t)}};function ru(t){{const e=t.match(/^(u?)int(\d*)$/);if(e){const r=e[1]==="",i=parseInt(e[2]||"256");(i%8!==0||i>256||e[2]&&e[2]!==String(i))&&ct.throwArgumentError("invalid numeric width","type",t);const n=iE.mask(r?i-1:i),s=r?n.add(by).mul(rE):wy;return function(o){const a=te.from(o);return(a.lt(s)||a.gt(n))&&ct.throwArgumentError(`value out-of-bounds for ${t}`,"value",o),ut(a.toTwos(256).toHexString(),32)}}}{const e=t.match(/^bytes(\d+)$/);if(e){const r=parseInt(e[1]);return(r===0||r>32||e[1]!==String(r))&&ct.throwArgumentError("invalid bytes width","type",t),function(i){return le(i).length!==r&&ct.throwArgumentError(`invalid length for ${t}`,"value",i),nE(i)}}}switch(t){case"address":return function(e){return ut(fr(e),32)};case"bool":return function(e){return e?sE:oE};case"bytes":return function(e){return Tt(e)};case"string":return function(e){return ay(e)}}return null}function Zd(t,e){return`${t}(${e.map(({name:r,type:i})=>i+" "+r).join(",")})`}class br{constructor(e){me(this,"types",Object.freeze(vs(e))),me(this,"_encoderCache",{}),me(this,"_types",{});const r={},i={},n={};Object.keys(e).forEach(a=>{r[a]={},i[a]=[],n[a]={}});for(const a in e){const c={};e[a].forEach(l=>{c[l.name]&&ct.throwArgumentError(`duplicate variable name ${JSON.stringify(l.name)} in ${JSON.stringify(a)}`,"types",e),c[l.name]=!0;const u=l.type.match(/^([^\x5b]*)(\x5b|$)/)[1];u===a&&ct.throwArgumentError(`circular type reference to ${JSON.stringify(u)}`,"types",e),!ru(u)&&(i[u]||ct.throwArgumentError(`unknown type ${JSON.stringify(u)}`,"types",e),i[u].push(a),r[a][u]=!0)})}const s=Object.keys(i).filter(a=>i[a].length===0);s.length===0?ct.throwArgumentError("missing primary type","types",e):s.length>1&&ct.throwArgumentError(`ambiguous primary types or unused types: ${s.map(a=>JSON.stringify(a)).join(", ")}`,"types",e),me(this,"primaryType",s[0]);function o(a,c){c[a]&&ct.throwArgumentError(`circular type reference to ${JSON.stringify(a)}`,"types",e),c[a]=!0,Object.keys(r[a]).forEach(l=>{i[l]&&(o(l,c),Object.keys(c).forEach(u=>{n[u][l]=!0}))}),delete c[a]}o(this.primaryType,{});for(const a in n){const c=Object.keys(n[a]);c.sort(),this._types[a]=Zd(a,e[a])+c.map(l=>Zd(l,e[l])).join("")}}getEncoder(e){let r=this._encoderCache[e];return r||(r=this._encoderCache[e]=this._getEncoder(e)),r}_getEncoder(e){{const n=ru(e);if(n)return n}const r=e.match(/^(.*)(\x5b(\d*)\x5d)$/);if(r){const n=r[1],s=this.getEncoder(n),o=parseInt(r[3]);return a=>{o>=0&&a.length!==o&&ct.throwArgumentError("array length mismatch; expected length ${ arrayLength }","value",a);let c=a.map(s);return this._types[n]&&(c=c.map(Tt)),Tt(_r(c))}}const i=this.types[e];if(i){const n=ay(this._types[e]);return s=>{const o=i.map(({name:a,type:c})=>{const l=this.getEncoder(c)(s[a]);return this._types[c]?Tt(l):l});return o.unshift(n),_r(o)}}return ct.throwArgumentError(`unknown type: ${e}`,"type",e)}encodeType(e){const r=this._types[e];return r||ct.throwArgumentError(`unknown type: ${JSON.stringify(e)}`,"name",e),r}encodeData(e,r){return this.getEncoder(e)(r)}hashStruct(e,r){return Tt(this.encodeData(e,r))}encode(e){return this.encodeData(this.primaryType,e)}hash(e){return this.hashStruct(this.primaryType,e)}_visit(e,r,i){if(ru(e))return i(e,r);const n=e.match(/^(.*)(\x5b(\d*)\x5d)$/);if(n){const o=n[1],a=parseInt(n[3]);return a>=0&&r.length!==a&&ct.throwArgumentError("array length mismatch; expected length ${ arrayLength }","value",r),r.map(c=>this._visit(o,c,i))}const s=this.types[e];return s?s.reduce((o,{name:a,type:c})=>(o[a]=this._visit(c,r[a],i),o),{}):ct.throwArgumentError(`unknown type: ${e}`,"type",e)}visit(e,r){return this._visit(this.primaryType,e,r)}static from(e){return new br(e)}static getPrimaryType(e){return br.from(e).primaryType}static hashStruct(e,r,i){return br.from(r).hashStruct(e,i)}static hashDomain(e){const r=[];for(const i in e){const n=Jd[i];n||ct.throwArgumentError(`invalid typed-data domain key: ${JSON.stringify(i)}`,"domain",e),r.push({name:i,type:n})}return r.sort((i,n)=>tu.indexOf(i.name)-tu.indexOf(n.name)),br.hashStruct("EIP712Domain",{EIP712Domain:r},e)}static encode(e,r,i){return _r(["0x1901",br.hashDomain(e),br.from(r).hash(i)])}static hash(e,r,i){return Tt(br.encode(e,r,i))}static resolveNames(e,r,i,n){return tE(this,void 0,void 0,function*(){e=cr(e);const s={};e.verifyingContract&&!Te(e.verifyingContract,20)&&(s[e.verifyingContract]="0x");const o=br.from(r);o.visit(i,(a,c)=>(a==="address"&&!Te(c,20)&&(s[c]="0x"),c));for(const a in s)s[a]=yield n(a);return e.verifyingContract&&s[e.verifyingContract]&&(e.verifyingContract=s[e.verifyingContract]),i=o.visit(i,(a,c)=>a==="address"&&s[c]?s[c]:c),{domain:e,value:i}})}static getPayload(e,r,i){br.hashDomain(e);const n={},s=[];tu.forEach(c=>{const l=e[c];l!=null&&(n[c]=aE[c](l),s.push({name:c,type:Jd[c]}))});const o=br.from(r),a=cr(r);return a.EIP712Domain?ct.throwArgumentError("types must not contain EIP712Domain type","types.EIP712Domain",r):a.EIP712Domain=s,o.encode(i),{types:a,domain:n,primaryType:o.primaryType,message:o.visit(i,(c,l)=>{if(c.match(/^bytes(\d*)/))return ce(le(l));if(c.match(/^u?int/))return te.from(l).toString();switch(c){case"address":return l.toLowerCase();case"bool":return!!l;case"string":return typeof l!="string"&&ct.throwArgumentError("invalid string","value",l),l}return ct.throwArgumentError("unsupported type","type",c)})}}}const cE="abstract-provider/5.7.0";var lE=function(t,e,r,i){function n(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(u){try{l(i.next(u))}catch(h){o(h)}}function c(u){try{l(i.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):n(u.value).then(a,c)}l((i=i.apply(t,e||[])).next())})};const uE=new K(cE);class hE extends d2{static isForkEvent(e){return!!(e&&e._isForkEvent)}}class Nf{constructor(){uE.checkAbstract(new.target,Nf),me(this,"_isProvider",!0)}getFeeData(){return lE(this,void 0,void 0,function*(){const{block:e,gasPrice:r}=yield Bt({block:this.getBlock("latest"),gasPrice:this.getGasPrice().catch(o=>null)});let i=null,n=null,s=null;return e&&e.baseFeePerGas&&(i=e.baseFeePerGas,s=te.from("1500000000"),n=e.baseFeePerGas.mul(2).add(s)),{lastBaseFeePerGas:i,maxFeePerGas:n,maxPriorityFeePerGas:s,gasPrice:r}})}addListener(e,r){return this.on(e,r)}removeListener(e,r){return this.off(e,r)}static isProvider(e){return!!(e&&e._isProvider)}}const fE="abstract-signer/5.7.0";var Kr=function(t,e,r,i){function n(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(u){try{l(i.next(u))}catch(h){o(h)}}function c(u){try{l(i.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):n(u.value).then(a,c)}l((i=i.apply(t,e||[])).next())})};const Vr=new K(fE),dE=["accessList","ccipReadEnabled","chainId","customData","data","from","gasLimit","gasPrice","maxFeePerGas","maxPriorityFeePerGas","nonce","to","type","value"],pE=[K.errors.INSUFFICIENT_FUNDS,K.errors.NONCE_EXPIRED,K.errors.REPLACEMENT_UNDERPRICED];class Cf{constructor(){Vr.checkAbstract(new.target,Cf),me(this,"_isSigner",!0)}getBalance(e){return Kr(this,void 0,void 0,function*(){return this._checkProvider("getBalance"),yield this.provider.getBalance(this.getAddress(),e)})}getTransactionCount(e){return Kr(this,void 0,void 0,function*(){return this._checkProvider("getTransactionCount"),yield this.provider.getTransactionCount(this.getAddress(),e)})}estimateGas(e){return Kr(this,void 0,void 0,function*(){this._checkProvider("estimateGas");const r=yield Bt(this.checkTransaction(e));return yield this.provider.estimateGas(r)})}call(e,r){return Kr(this,void 0,void 0,function*(){this._checkProvider("call");const i=yield Bt(this.checkTransaction(e));return yield this.provider.call(i,r)})}sendTransaction(e){return Kr(this,void 0,void 0,function*(){this._checkProvider("sendTransaction");const r=yield this.populateTransaction(e),i=yield this.signTransaction(r);return yield this.provider.sendTransaction(i)})}getChainId(){return Kr(this,void 0,void 0,function*(){return this._checkProvider("getChainId"),(yield this.provider.getNetwork()).chainId})}getGasPrice(){return Kr(this,void 0,void 0,function*(){return this._checkProvider("getGasPrice"),yield this.provider.getGasPrice()})}getFeeData(){return Kr(this,void 0,void 0,function*(){return this._checkProvider("getFeeData"),yield this.provider.getFeeData()})}resolveName(e){return Kr(this,void 0,void 0,function*(){return this._checkProvider("resolveName"),yield this.provider.resolveName(e)})}checkTransaction(e){for(const i in e)dE.indexOf(i)===-1&&Vr.throwArgumentError("invalid transaction key: "+i,"transaction",e);const r=cr(e);return r.from==null?r.from=this.getAddress():r.from=Promise.all([Promise.resolve(r.from),this.getAddress()]).then(i=>(i[0].toLowerCase()!==i[1].toLowerCase()&&Vr.throwArgumentError("from address mismatch","transaction",e),i[0])),r}populateTransaction(e){return Kr(this,void 0,void 0,function*(){const r=yield Bt(this.checkTransaction(e));r.to!=null&&(r.to=Promise.resolve(r.to).then(n=>Kr(this,void 0,void 0,function*(){if(n==null)return null;const s=yield this.resolveName(n);return s==null&&Vr.throwArgumentError("provided ENS name resolves to null","tx.to",n),s})),r.to.catch(n=>{}));const i=r.maxFeePerGas!=null||r.maxPriorityFeePerGas!=null;if(r.gasPrice!=null&&(r.type===2||i)?Vr.throwArgumentError("eip-1559 transaction do not support gasPrice","transaction",e):(r.type===0||r.type===1)&&i&&Vr.throwArgumentError("pre-eip-1559 transaction do not support maxFeePerGas/maxPriorityFeePerGas","transaction",e),(r.type===2||r.type==null)&&r.maxFeePerGas!=null&&r.maxPriorityFeePerGas!=null)r.type=2;else if(r.type===0||r.type===1)r.gasPrice==null&&(r.gasPrice=this.getGasPrice());else{const n=yield this.getFeeData();if(r.type==null)if(n.maxFeePerGas!=null&&n.maxPriorityFeePerGas!=null)if(r.type=2,r.gasPrice!=null){const s=r.gasPrice;delete r.gasPrice,r.maxFeePerGas=s,r.maxPriorityFeePerGas=s}else r.maxFeePerGas==null&&(r.maxFeePerGas=n.maxFeePerGas),r.maxPriorityFeePerGas==null&&(r.maxPriorityFeePerGas=n.maxPriorityFeePerGas);else n.gasPrice!=null?(i&&Vr.throwError("network does not support EIP-1559",K.errors.UNSUPPORTED_OPERATION,{operation:"populateTransaction"}),r.gasPrice==null&&(r.gasPrice=n.gasPrice),r.type=0):Vr.throwError("failed to get consistent fee data",K.errors.UNSUPPORTED_OPERATION,{operation:"signer.getFeeData"});else r.type===2&&(r.maxFeePerGas==null&&(r.maxFeePerGas=n.maxFeePerGas),r.maxPriorityFeePerGas==null&&(r.maxPriorityFeePerGas=n.maxPriorityFeePerGas))}return r.nonce==null&&(r.nonce=this.getTransactionCount("pending")),r.gasLimit==null&&(r.gasLimit=this.estimateGas(r).catch(n=>{if(pE.indexOf(n.code)>=0)throw n;return Vr.throwError("cannot estimate gas; transaction may fail or may require manual gas limit",K.errors.UNPREDICTABLE_GAS_LIMIT,{error:n,tx:r})})),r.chainId==null?r.chainId=this.getChainId():r.chainId=Promise.all([Promise.resolve(r.chainId),this.getChainId()]).then(n=>(n[1]!==0&&n[0]!==n[1]&&Vr.throwArgumentError("chainId address mismatch","transaction",e),n[0])),yield Bt(r)})}_checkProvider(e){this.provider||Vr.throwError("missing provider",K.errors.UNSUPPORTED_OPERATION,{operation:e||"_checkProvider"})}static isSigner(e){return!!(e&&e._isSigner)}}var vy={},de={},Ia=Ey;function Ey(t,e){if(!t)throw new Error(e||"Assertion failed")}Ey.equal=function(e,r,i){if(e!=r)throw new Error(i||"Assertion failed: "+e+" != "+r)};var gh={exports:{}};typeof Object.create=="function"?gh.exports=function(e,r){r&&(e.super_=r,e.prototype=Object.create(r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:gh.exports=function(e,r){if(r){e.super_=r;var i=function(){};i.prototype=r.prototype,e.prototype=new i,e.prototype.constructor=e}};var gE=gh.exports,mE=Ia,yE=gE;de.inherits=yE;function wE(t,e){return(t.charCodeAt(e)&64512)!==55296||e<0||e+1>=t.length?!1:(t.charCodeAt(e+1)&64512)===56320}function bE(t,e){if(Array.isArray(t))return t.slice();if(!t)return[];var r=[];if(typeof t=="string")if(e){if(e==="hex")for(t=t.replace(/[^a-z0-9]+/ig,""),t.length%2!==0&&(t="0"+t),n=0;n<t.length;n+=2)r.push(parseInt(t[n]+t[n+1],16))}else for(var i=0,n=0;n<t.length;n++){var s=t.charCodeAt(n);s<128?r[i++]=s:s<2048?(r[i++]=s>>6|192,r[i++]=s&63|128):wE(t,n)?(s=65536+((s&1023)<<10)+(t.charCodeAt(++n)&1023),r[i++]=s>>18|240,r[i++]=s>>12&63|128,r[i++]=s>>6&63|128,r[i++]=s&63|128):(r[i++]=s>>12|224,r[i++]=s>>6&63|128,r[i++]=s&63|128)}else for(n=0;n<t.length;n++)r[n]=t[n]|0;return r}de.toArray=bE;function vE(t){for(var e="",r=0;r<t.length;r++)e+=Ay(t[r].toString(16));return e}de.toHex=vE;function xy(t){var e=t>>>24|t>>>8&65280|t<<8&16711680|(t&255)<<24;return e>>>0}de.htonl=xy;function EE(t,e){for(var r="",i=0;i<t.length;i++){var n=t[i];e==="little"&&(n=xy(n)),r+=_y(n.toString(16))}return r}de.toHex32=EE;function Ay(t){return t.length===1?"0"+t:t}de.zero2=Ay;function _y(t){return t.length===7?"0"+t:t.length===6?"00"+t:t.length===5?"000"+t:t.length===4?"0000"+t:t.length===3?"00000"+t:t.length===2?"000000"+t:t.length===1?"0000000"+t:t}de.zero8=_y;function xE(t,e,r,i){var n=r-e;mE(n%4===0);for(var s=new Array(n/4),o=0,a=e;o<s.length;o++,a+=4){var c;i==="big"?c=t[a]<<24|t[a+1]<<16|t[a+2]<<8|t[a+3]:c=t[a+3]<<24|t[a+2]<<16|t[a+1]<<8|t[a],s[o]=c>>>0}return s}de.join32=xE;function AE(t,e){for(var r=new Array(t.length*4),i=0,n=0;i<t.length;i++,n+=4){var s=t[i];e==="big"?(r[n]=s>>>24,r[n+1]=s>>>16&255,r[n+2]=s>>>8&255,r[n+3]=s&255):(r[n+3]=s>>>24,r[n+2]=s>>>16&255,r[n+1]=s>>>8&255,r[n]=s&255)}return r}de.split32=AE;function _E(t,e){return t>>>e|t<<32-e}de.rotr32=_E;function IE(t,e){return t<<e|t>>>32-e}de.rotl32=IE;function SE(t,e){return t+e>>>0}de.sum32=SE;function PE(t,e,r){return t+e+r>>>0}de.sum32_3=PE;function OE(t,e,r,i){return t+e+r+i>>>0}de.sum32_4=OE;function DE(t,e,r,i,n){return t+e+r+i+n>>>0}de.sum32_5=DE;function NE(t,e,r,i){var n=t[e],s=t[e+1],o=i+s>>>0,a=(o<i?1:0)+r+n;t[e]=a>>>0,t[e+1]=o}de.sum64=NE;function CE(t,e,r,i){var n=e+i>>>0,s=(n<e?1:0)+t+r;return s>>>0}de.sum64_hi=CE;function BE(t,e,r,i){var n=e+i;return n>>>0}de.sum64_lo=BE;function RE(t,e,r,i,n,s,o,a){var c=0,l=e;l=l+i>>>0,c+=l<e?1:0,l=l+s>>>0,c+=l<s?1:0,l=l+a>>>0,c+=l<a?1:0;var u=t+r+n+o+c;return u>>>0}de.sum64_4_hi=RE;function TE(t,e,r,i,n,s,o,a){var c=e+i+s+a;return c>>>0}de.sum64_4_lo=TE;function ME(t,e,r,i,n,s,o,a,c,l){var u=0,h=e;h=h+i>>>0,u+=h<e?1:0,h=h+s>>>0,u+=h<s?1:0,h=h+a>>>0,u+=h<a?1:0,h=h+l>>>0,u+=h<l?1:0;var g=t+r+n+o+c+u;return g>>>0}de.sum64_5_hi=ME;function kE(t,e,r,i,n,s,o,a,c,l){var u=e+i+s+a+l;return u>>>0}de.sum64_5_lo=kE;function $E(t,e,r){var i=e<<32-r|t>>>r;return i>>>0}de.rotr64_hi=$E;function UE(t,e,r){var i=t<<32-r|e>>>r;return i>>>0}de.rotr64_lo=UE;function LE(t,e,r){return t>>>r}de.shr64_hi=LE;function FE(t,e,r){var i=t<<32-r|e>>>r;return i>>>0}de.shr64_lo=FE;var Eo={},Xd=de,qE=Ia;function ll(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}Eo.BlockHash=ll;ll.prototype.update=function(e,r){if(e=Xd.toArray(e,r),this.pending?this.pending=this.pending.concat(e):this.pending=e,this.pendingTotal+=e.length,this.pending.length>=this._delta8){e=this.pending;var i=e.length%this._delta8;this.pending=e.slice(e.length-i,e.length),this.pending.length===0&&(this.pending=null),e=Xd.join32(e,0,e.length-i,this.endian);for(var n=0;n<e.length;n+=this._delta32)this._update(e,n,n+this._delta32)}return this};ll.prototype.digest=function(e){return this.update(this._pad()),qE(this.pending===null),this._digest(e)};ll.prototype._pad=function(){var e=this.pendingTotal,r=this._delta8,i=r-(e+this.padLength)%r,n=new Array(i+this.padLength);n[0]=128;for(var s=1;s<i;s++)n[s]=0;if(e<<=3,this.endian==="big"){for(var o=8;o<this.padLength;o++)n[s++]=0;n[s++]=0,n[s++]=0,n[s++]=0,n[s++]=0,n[s++]=e>>>24&255,n[s++]=e>>>16&255,n[s++]=e>>>8&255,n[s++]=e&255}else for(n[s++]=e&255,n[s++]=e>>>8&255,n[s++]=e>>>16&255,n[s++]=e>>>24&255,n[s++]=0,n[s++]=0,n[s++]=0,n[s++]=0,o=8;o<this.padLength;o++)n[s++]=0;return n};var xo={},Ni={},jE=de,Ei=jE.rotr32;function zE(t,e,r,i){if(t===0)return Iy(e,r,i);if(t===1||t===3)return Py(e,r,i);if(t===2)return Sy(e,r,i)}Ni.ft_1=zE;function Iy(t,e,r){return t&e^~t&r}Ni.ch32=Iy;function Sy(t,e,r){return t&e^t&r^e&r}Ni.maj32=Sy;function Py(t,e,r){return t^e^r}Ni.p32=Py;function HE(t){return Ei(t,2)^Ei(t,13)^Ei(t,22)}Ni.s0_256=HE;function KE(t){return Ei(t,6)^Ei(t,11)^Ei(t,25)}Ni.s1_256=KE;function VE(t){return Ei(t,7)^Ei(t,18)^t>>>3}Ni.g0_256=VE;function GE(t){return Ei(t,17)^Ei(t,19)^t>>>10}Ni.g1_256=GE;var uo=de,WE=Eo,YE=Ni,iu=uo.rotl32,Do=uo.sum32,JE=uo.sum32_5,QE=YE.ft_1,Oy=WE.BlockHash,ZE=[1518500249,1859775393,2400959708,3395469782];function Si(){if(!(this instanceof Si))return new Si;Oy.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}uo.inherits(Si,Oy);var XE=Si;Si.blockSize=512;Si.outSize=160;Si.hmacStrength=80;Si.padLength=64;Si.prototype._update=function(e,r){for(var i=this.W,n=0;n<16;n++)i[n]=e[r+n];for(;n<i.length;n++)i[n]=iu(i[n-3]^i[n-8]^i[n-14]^i[n-16],1);var s=this.h[0],o=this.h[1],a=this.h[2],c=this.h[3],l=this.h[4];for(n=0;n<i.length;n++){var u=~~(n/20),h=JE(iu(s,5),QE(u,o,a,c),l,i[n],ZE[u]);l=c,c=a,a=iu(o,30),o=s,s=h}this.h[0]=Do(this.h[0],s),this.h[1]=Do(this.h[1],o),this.h[2]=Do(this.h[2],a),this.h[3]=Do(this.h[3],c),this.h[4]=Do(this.h[4],l)};Si.prototype._digest=function(e){return e==="hex"?uo.toHex32(this.h,"big"):uo.split32(this.h,"big")};var ho=de,ex=Eo,Ao=Ni,tx=Ia,Gr=ho.sum32,rx=ho.sum32_4,ix=ho.sum32_5,nx=Ao.ch32,sx=Ao.maj32,ox=Ao.s0_256,ax=Ao.s1_256,cx=Ao.g0_256,lx=Ao.g1_256,Dy=ex.BlockHash,ux=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function Pi(){if(!(this instanceof Pi))return new Pi;Dy.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=ux,this.W=new Array(64)}ho.inherits(Pi,Dy);var Ny=Pi;Pi.blockSize=512;Pi.outSize=256;Pi.hmacStrength=192;Pi.padLength=64;Pi.prototype._update=function(e,r){for(var i=this.W,n=0;n<16;n++)i[n]=e[r+n];for(;n<i.length;n++)i[n]=rx(lx(i[n-2]),i[n-7],cx(i[n-15]),i[n-16]);var s=this.h[0],o=this.h[1],a=this.h[2],c=this.h[3],l=this.h[4],u=this.h[5],h=this.h[6],g=this.h[7];for(tx(this.k.length===i.length),n=0;n<i.length;n++){var y=ix(g,ax(l),nx(l,u,h),this.k[n],i[n]),w=Gr(ox(s),sx(s,o,a));g=h,h=u,u=l,l=Gr(c,y),c=a,a=o,o=s,s=Gr(y,w)}this.h[0]=Gr(this.h[0],s),this.h[1]=Gr(this.h[1],o),this.h[2]=Gr(this.h[2],a),this.h[3]=Gr(this.h[3],c),this.h[4]=Gr(this.h[4],l),this.h[5]=Gr(this.h[5],u),this.h[6]=Gr(this.h[6],h),this.h[7]=Gr(this.h[7],g)};Pi.prototype._digest=function(e){return e==="hex"?ho.toHex32(this.h,"big"):ho.split32(this.h,"big")};var mh=de,Cy=Ny;function en(){if(!(this instanceof en))return new en;Cy.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}mh.inherits(en,Cy);var hx=en;en.blockSize=512;en.outSize=224;en.hmacStrength=192;en.padLength=64;en.prototype._digest=function(e){return e==="hex"?mh.toHex32(this.h.slice(0,7),"big"):mh.split32(this.h.slice(0,7),"big")};var dr=de,fx=Eo,dx=Ia,xi=dr.rotr64_hi,Ai=dr.rotr64_lo,By=dr.shr64_hi,Ry=dr.shr64_lo,fn=dr.sum64,nu=dr.sum64_hi,su=dr.sum64_lo,px=dr.sum64_4_hi,gx=dr.sum64_4_lo,mx=dr.sum64_5_hi,yx=dr.sum64_5_lo,Ty=fx.BlockHash,wx=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function ni(){if(!(this instanceof ni))return new ni;Ty.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=wx,this.W=new Array(160)}dr.inherits(ni,Ty);var My=ni;ni.blockSize=1024;ni.outSize=512;ni.hmacStrength=192;ni.padLength=128;ni.prototype._prepareBlock=function(e,r){for(var i=this.W,n=0;n<32;n++)i[n]=e[r+n];for(;n<i.length;n+=2){var s=Dx(i[n-4],i[n-3]),o=Nx(i[n-4],i[n-3]),a=i[n-14],c=i[n-13],l=Px(i[n-30],i[n-29]),u=Ox(i[n-30],i[n-29]),h=i[n-32],g=i[n-31];i[n]=px(s,o,a,c,l,u,h,g),i[n+1]=gx(s,o,a,c,l,u,h,g)}};ni.prototype._update=function(e,r){this._prepareBlock(e,r);var i=this.W,n=this.h[0],s=this.h[1],o=this.h[2],a=this.h[3],c=this.h[4],l=this.h[5],u=this.h[6],h=this.h[7],g=this.h[8],y=this.h[9],w=this.h[10],E=this.h[11],P=this.h[12],N=this.h[13],R=this.h[14],D=this.h[15];dx(this.k.length===i.length);for(var C=0;C<i.length;C+=2){var B=R,M=D,L=Ix(g,y),F=Sx(g,y),k=bx(g,y,w,E,P),V=vx(g,y,w,E,P,N),H=this.k[C],$=this.k[C+1],A=i[C],d=i[C+1],f=mx(B,M,L,F,k,V,H,$,A,d),p=yx(B,M,L,F,k,V,H,$,A,d);B=Ax(n,s),M=_x(n,s),L=Ex(n,s,o,a,c),F=xx(n,s,o,a,c,l);var b=nu(B,M,L,F),x=su(B,M,L,F);R=P,D=N,P=w,N=E,w=g,E=y,g=nu(u,h,f,p),y=su(h,h,f,p),u=c,h=l,c=o,l=a,o=n,a=s,n=nu(f,p,b,x),s=su(f,p,b,x)}fn(this.h,0,n,s),fn(this.h,2,o,a),fn(this.h,4,c,l),fn(this.h,6,u,h),fn(this.h,8,g,y),fn(this.h,10,w,E),fn(this.h,12,P,N),fn(this.h,14,R,D)};ni.prototype._digest=function(e){return e==="hex"?dr.toHex32(this.h,"big"):dr.split32(this.h,"big")};function bx(t,e,r,i,n){var s=t&r^~t&n;return s<0&&(s+=4294967296),s}function vx(t,e,r,i,n,s){var o=e&i^~e&s;return o<0&&(o+=4294967296),o}function Ex(t,e,r,i,n){var s=t&r^t&n^r&n;return s<0&&(s+=4294967296),s}function xx(t,e,r,i,n,s){var o=e&i^e&s^i&s;return o<0&&(o+=4294967296),o}function Ax(t,e){var r=xi(t,e,28),i=xi(e,t,2),n=xi(e,t,7),s=r^i^n;return s<0&&(s+=4294967296),s}function _x(t,e){var r=Ai(t,e,28),i=Ai(e,t,2),n=Ai(e,t,7),s=r^i^n;return s<0&&(s+=4294967296),s}function Ix(t,e){var r=xi(t,e,14),i=xi(t,e,18),n=xi(e,t,9),s=r^i^n;return s<0&&(s+=4294967296),s}function Sx(t,e){var r=Ai(t,e,14),i=Ai(t,e,18),n=Ai(e,t,9),s=r^i^n;return s<0&&(s+=4294967296),s}function Px(t,e){var r=xi(t,e,1),i=xi(t,e,8),n=By(t,e,7),s=r^i^n;return s<0&&(s+=4294967296),s}function Ox(t,e){var r=Ai(t,e,1),i=Ai(t,e,8),n=Ry(t,e,7),s=r^i^n;return s<0&&(s+=4294967296),s}function Dx(t,e){var r=xi(t,e,19),i=xi(e,t,29),n=By(t,e,6),s=r^i^n;return s<0&&(s+=4294967296),s}function Nx(t,e){var r=Ai(t,e,19),i=Ai(e,t,29),n=Ry(t,e,6),s=r^i^n;return s<0&&(s+=4294967296),s}var yh=de,ky=My;function tn(){if(!(this instanceof tn))return new tn;ky.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}yh.inherits(tn,ky);var Cx=tn;tn.blockSize=1024;tn.outSize=384;tn.hmacStrength=192;tn.padLength=128;tn.prototype._digest=function(e){return e==="hex"?yh.toHex32(this.h.slice(0,12),"big"):yh.split32(this.h.slice(0,12),"big")};xo.sha1=XE;xo.sha224=hx;xo.sha256=Ny;xo.sha384=Cx;xo.sha512=My;var $y={},Es=de,Bx=Eo,Fa=Es.rotl32,ep=Es.sum32,No=Es.sum32_3,tp=Es.sum32_4,Uy=Bx.BlockHash;function Oi(){if(!(this instanceof Oi))return new Oi;Uy.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}Es.inherits(Oi,Uy);$y.ripemd160=Oi;Oi.blockSize=512;Oi.outSize=160;Oi.hmacStrength=192;Oi.padLength=64;Oi.prototype._update=function(e,r){for(var i=this.h[0],n=this.h[1],s=this.h[2],o=this.h[3],a=this.h[4],c=i,l=n,u=s,h=o,g=a,y=0;y<80;y++){var w=ep(Fa(tp(i,rp(y,n,s,o),e[Mx[y]+r],Rx(y)),$x[y]),a);i=a,a=o,o=Fa(s,10),s=n,n=w,w=ep(Fa(tp(c,rp(79-y,l,u,h),e[kx[y]+r],Tx(y)),Ux[y]),g),c=g,g=h,h=Fa(u,10),u=l,l=w}w=No(this.h[1],s,h),this.h[1]=No(this.h[2],o,g),this.h[2]=No(this.h[3],a,c),this.h[3]=No(this.h[4],i,l),this.h[4]=No(this.h[0],n,u),this.h[0]=w};Oi.prototype._digest=function(e){return e==="hex"?Es.toHex32(this.h,"little"):Es.split32(this.h,"little")};function rp(t,e,r,i){return t<=15?e^r^i:t<=31?e&r|~e&i:t<=47?(e|~r)^i:t<=63?e&i|r&~i:e^(r|~i)}function Rx(t){return t<=15?0:t<=31?1518500249:t<=47?1859775393:t<=63?2400959708:2840853838}function Tx(t){return t<=15?1352829926:t<=31?1548603684:t<=47?1836072691:t<=63?2053994217:0}var Mx=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],kx=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],$x=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],Ux=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],Lx=de,Fx=Ia;function fo(t,e,r){if(!(this instanceof fo))return new fo(t,e,r);this.Hash=t,this.blockSize=t.blockSize/8,this.outSize=t.outSize/8,this.inner=null,this.outer=null,this._init(Lx.toArray(e,r))}var qx=fo;fo.prototype._init=function(e){e.length>this.blockSize&&(e=new this.Hash().update(e).digest()),Fx(e.length<=this.blockSize);for(var r=e.length;r<this.blockSize;r++)e.push(0);for(r=0;r<e.length;r++)e[r]^=54;for(this.inner=new this.Hash().update(e),r=0;r<e.length;r++)e[r]^=106;this.outer=new this.Hash().update(e)};fo.prototype.update=function(e,r){return this.inner.update(e,r),this};fo.prototype.digest=function(e){return this.outer.update(this.inner.digest()),this.outer.digest(e)};(function(t){var e=t;e.utils=de,e.common=Eo,e.sha=xo,e.ripemd=$y,e.hmac=qx,e.sha1=e.sha.sha1,e.sha256=e.sha.sha256,e.sha224=e.sha.sha224,e.sha384=e.sha.sha384,e.sha512=e.sha.sha512,e.ripemd160=e.ripemd.ripemd160})(vy);const gi=Os(vy);function _o(t,e,r){return r={path:e,exports:{},require:function(i,n){return jx(i,n??r.path)}},t(r,r.exports),r.exports}function jx(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var Bf=Ly;function Ly(t,e){if(!t)throw new Error(e||"Assertion failed")}Ly.equal=function(e,r,i){if(e!=r)throw new Error(i||"Assertion failed: "+e+" != "+r)};var ri=_o(function(t,e){var r=e;function i(o,a){if(Array.isArray(o))return o.slice();if(!o)return[];var c=[];if(typeof o!="string"){for(var l=0;l<o.length;l++)c[l]=o[l]|0;return c}if(a==="hex"){o=o.replace(/[^a-z0-9]+/ig,""),o.length%2!==0&&(o="0"+o);for(var l=0;l<o.length;l+=2)c.push(parseInt(o[l]+o[l+1],16))}else for(var l=0;l<o.length;l++){var u=o.charCodeAt(l),h=u>>8,g=u&255;h?c.push(h,g):c.push(g)}return c}r.toArray=i;function n(o){return o.length===1?"0"+o:o}r.zero2=n;function s(o){for(var a="",c=0;c<o.length;c++)a+=n(o[c].toString(16));return a}r.toHex=s,r.encode=function(a,c){return c==="hex"?s(a):a}}),Pr=_o(function(t,e){var r=e;r.assert=Bf,r.toArray=ri.toArray,r.zero2=ri.zero2,r.toHex=ri.toHex,r.encode=ri.encode;function i(c,l,u){var h=new Array(Math.max(c.bitLength(),u)+1);h.fill(0);for(var g=1<<l+1,y=c.clone(),w=0;w<h.length;w++){var E,P=y.andln(g-1);y.isOdd()?(P>(g>>1)-1?E=(g>>1)-P:E=P,y.isubn(E)):E=0,h[w]=E,y.iushrn(1)}return h}r.getNAF=i;function n(c,l){var u=[[],[]];c=c.clone(),l=l.clone();for(var h=0,g=0,y;c.cmpn(-h)>0||l.cmpn(-g)>0;){var w=c.andln(3)+h&3,E=l.andln(3)+g&3;w===3&&(w=-1),E===3&&(E=-1);var P;w&1?(y=c.andln(7)+h&7,(y===3||y===5)&&E===2?P=-w:P=w):P=0,u[0].push(P);var N;E&1?(y=l.andln(7)+g&7,(y===3||y===5)&&w===2?N=-E:N=E):N=0,u[1].push(N),2*h===P+1&&(h=1-h),2*g===N+1&&(g=1-g),c.iushrn(1),l.iushrn(1)}return u}r.getJSF=n;function s(c,l,u){var h="_"+l;c.prototype[l]=function(){return this[h]!==void 0?this[h]:this[h]=u.call(this)}}r.cachedProperty=s;function o(c){return typeof c=="string"?r.toArray(c,"hex"):c}r.parseBytes=o;function a(c){return new se(c,"hex","le")}r.intFromLE=a}),Bc=Pr.getNAF,zx=Pr.getJSF,Rc=Pr.assert;function Fn(t,e){this.type=t,this.p=new se(e.p,16),this.red=e.prime?se.red(e.prime):se.mont(this.p),this.zero=new se(0).toRed(this.red),this.one=new se(1).toRed(this.red),this.two=new se(2).toRed(this.red),this.n=e.n&&new se(e.n,16),this.g=e.g&&this.pointFromJSON(e.g,e.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var r=this.n&&this.p.div(this.n);!r||r.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}var Ds=Fn;Fn.prototype.point=function(){throw new Error("Not implemented")};Fn.prototype.validate=function(){throw new Error("Not implemented")};Fn.prototype._fixedNafMul=function(e,r){Rc(e.precomputed);var i=e._getDoubles(),n=Bc(r,1,this._bitLength),s=(1<<i.step+1)-(i.step%2===0?2:1);s/=3;var o=[],a,c;for(a=0;a<n.length;a+=i.step){c=0;for(var l=a+i.step-1;l>=a;l--)c=(c<<1)+n[l];o.push(c)}for(var u=this.jpoint(null,null,null),h=this.jpoint(null,null,null),g=s;g>0;g--){for(a=0;a<o.length;a++)c=o[a],c===g?h=h.mixedAdd(i.points[a]):c===-g&&(h=h.mixedAdd(i.points[a].neg()));u=u.add(h)}return u.toP()};Fn.prototype._wnafMul=function(e,r){var i=4,n=e._getNAFPoints(i);i=n.wnd;for(var s=n.points,o=Bc(r,i,this._bitLength),a=this.jpoint(null,null,null),c=o.length-1;c>=0;c--){for(var l=0;c>=0&&o[c]===0;c--)l++;if(c>=0&&l++,a=a.dblp(l),c<0)break;var u=o[c];Rc(u!==0),e.type==="affine"?u>0?a=a.mixedAdd(s[u-1>>1]):a=a.mixedAdd(s[-u-1>>1].neg()):u>0?a=a.add(s[u-1>>1]):a=a.add(s[-u-1>>1].neg())}return e.type==="affine"?a.toP():a};Fn.prototype._wnafMulAdd=function(e,r,i,n,s){var o=this._wnafT1,a=this._wnafT2,c=this._wnafT3,l=0,u,h,g;for(u=0;u<n;u++){g=r[u];var y=g._getNAFPoints(e);o[u]=y.wnd,a[u]=y.points}for(u=n-1;u>=1;u-=2){var w=u-1,E=u;if(o[w]!==1||o[E]!==1){c[w]=Bc(i[w],o[w],this._bitLength),c[E]=Bc(i[E],o[E],this._bitLength),l=Math.max(c[w].length,l),l=Math.max(c[E].length,l);continue}var P=[r[w],null,null,r[E]];r[w].y.cmp(r[E].y)===0?(P[1]=r[w].add(r[E]),P[2]=r[w].toJ().mixedAdd(r[E].neg())):r[w].y.cmp(r[E].y.redNeg())===0?(P[1]=r[w].toJ().mixedAdd(r[E]),P[2]=r[w].add(r[E].neg())):(P[1]=r[w].toJ().mixedAdd(r[E]),P[2]=r[w].toJ().mixedAdd(r[E].neg()));var N=[-3,-1,-5,-7,0,7,5,1,3],R=zx(i[w],i[E]);for(l=Math.max(R[0].length,l),c[w]=new Array(l),c[E]=new Array(l),h=0;h<l;h++){var D=R[0][h]|0,C=R[1][h]|0;c[w][h]=N[(D+1)*3+(C+1)],c[E][h]=0,a[w]=P}}var B=this.jpoint(null,null,null),M=this._wnafT4;for(u=l;u>=0;u--){for(var L=0;u>=0;){var F=!0;for(h=0;h<n;h++)M[h]=c[h][u]|0,M[h]!==0&&(F=!1);if(!F)break;L++,u--}if(u>=0&&L++,B=B.dblp(L),u<0)break;for(h=0;h<n;h++){var k=M[h];k!==0&&(k>0?g=a[h][k-1>>1]:k<0&&(g=a[h][-k-1>>1].neg()),g.type==="affine"?B=B.mixedAdd(g):B=B.add(g))}}for(u=0;u<n;u++)a[u]=null;return s?B:B.toP()};function zr(t,e){this.curve=t,this.type=e,this.precomputed=null}Fn.BasePoint=zr;zr.prototype.eq=function(){throw new Error("Not implemented")};zr.prototype.validate=function(){return this.curve.validate(this)};Fn.prototype.decodePoint=function(e,r){e=Pr.toArray(e,r);var i=this.p.byteLength();if((e[0]===4||e[0]===6||e[0]===7)&&e.length-1===2*i){e[0]===6?Rc(e[e.length-1]%2===0):e[0]===7&&Rc(e[e.length-1]%2===1);var n=this.point(e.slice(1,1+i),e.slice(1+i,1+2*i));return n}else if((e[0]===2||e[0]===3)&&e.length-1===i)return this.pointFromX(e.slice(1,1+i),e[0]===3);throw new Error("Unknown point format")};zr.prototype.encodeCompressed=function(e){return this.encode(e,!0)};zr.prototype._encode=function(e){var r=this.curve.p.byteLength(),i=this.getX().toArray("be",r);return e?[this.getY().isEven()?2:3].concat(i):[4].concat(i,this.getY().toArray("be",r))};zr.prototype.encode=function(e,r){return Pr.encode(this._encode(r),e)};zr.prototype.precompute=function(e){if(this.precomputed)return this;var r={doubles:null,naf:null,beta:null};return r.naf=this._getNAFPoints(8),r.doubles=this._getDoubles(4,e),r.beta=this._getBeta(),this.precomputed=r,this};zr.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var r=this.precomputed.doubles;return r?r.points.length>=Math.ceil((e.bitLength()+1)/r.step):!1};zr.prototype._getDoubles=function(e,r){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var i=[this],n=this,s=0;s<r;s+=e){for(var o=0;o<e;o++)n=n.dbl();i.push(n)}return{step:e,points:i}};zr.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var r=[this],i=(1<<e)-1,n=i===1?null:this.dbl(),s=1;s<i;s++)r[s]=r[s-1].add(n);return{wnd:e,points:r}};zr.prototype._getBeta=function(){return null};zr.prototype.dblp=function(e){for(var r=this,i=0;i<e;i++)r=r.dbl();return r};var Rf=_o(function(t){typeof Object.create=="function"?t.exports=function(r,i){i&&(r.super_=i,r.prototype=Object.create(i.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(r,i){if(i){r.super_=i;var n=function(){};n.prototype=i.prototype,r.prototype=new n,r.prototype.constructor=r}}}),Hx=Pr.assert;function Hr(t){Ds.call(this,"short",t),this.a=new se(t.a,16).toRed(this.red),this.b=new se(t.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(t),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}Rf(Hr,Ds);var Kx=Hr;Hr.prototype._getEndomorphism=function(e){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var r,i;if(e.beta)r=new se(e.beta,16).toRed(this.red);else{var n=this._getEndoRoots(this.p);r=n[0].cmp(n[1])<0?n[0]:n[1],r=r.toRed(this.red)}if(e.lambda)i=new se(e.lambda,16);else{var s=this._getEndoRoots(this.n);this.g.mul(s[0]).x.cmp(this.g.x.redMul(r))===0?i=s[0]:(i=s[1],Hx(this.g.mul(i).x.cmp(this.g.x.redMul(r))===0))}var o;return e.basis?o=e.basis.map(function(a){return{a:new se(a.a,16),b:new se(a.b,16)}}):o=this._getEndoBasis(i),{beta:r,lambda:i,basis:o}}};Hr.prototype._getEndoRoots=function(e){var r=e===this.p?this.red:se.mont(e),i=new se(2).toRed(r).redInvm(),n=i.redNeg(),s=new se(3).toRed(r).redNeg().redSqrt().redMul(i),o=n.redAdd(s).fromRed(),a=n.redSub(s).fromRed();return[o,a]};Hr.prototype._getEndoBasis=function(e){for(var r=this.n.ushrn(Math.floor(this.n.bitLength()/2)),i=e,n=this.n.clone(),s=new se(1),o=new se(0),a=new se(0),c=new se(1),l,u,h,g,y,w,E,P=0,N,R;i.cmpn(0)!==0;){var D=n.div(i);N=n.sub(D.mul(i)),R=a.sub(D.mul(s));var C=c.sub(D.mul(o));if(!h&&N.cmp(r)<0)l=E.neg(),u=s,h=N.neg(),g=R;else if(h&&++P===2)break;E=N,n=i,i=N,a=s,s=R,c=o,o=C}y=N.neg(),w=R;var B=h.sqr().add(g.sqr()),M=y.sqr().add(w.sqr());return M.cmp(B)>=0&&(y=l,w=u),h.negative&&(h=h.neg(),g=g.neg()),y.negative&&(y=y.neg(),w=w.neg()),[{a:h,b:g},{a:y,b:w}]};Hr.prototype._endoSplit=function(e){var r=this.endo.basis,i=r[0],n=r[1],s=n.b.mul(e).divRound(this.n),o=i.b.neg().mul(e).divRound(this.n),a=s.mul(i.a),c=o.mul(n.a),l=s.mul(i.b),u=o.mul(n.b),h=e.sub(a).sub(c),g=l.add(u).neg();return{k1:h,k2:g}};Hr.prototype.pointFromX=function(e,r){e=new se(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),n=i.redSqrt();if(n.redSqr().redSub(i).cmp(this.zero)!==0)throw new Error("invalid point");var s=n.fromRed().isOdd();return(r&&!s||!r&&s)&&(n=n.redNeg()),this.point(e,n)};Hr.prototype.validate=function(e){if(e.inf)return!0;var r=e.x,i=e.y,n=this.a.redMul(r),s=r.redSqr().redMul(r).redIAdd(n).redIAdd(this.b);return i.redSqr().redISub(s).cmpn(0)===0};Hr.prototype._endoWnafMulAdd=function(e,r,i){for(var n=this._endoWnafT1,s=this._endoWnafT2,o=0;o<e.length;o++){var a=this._endoSplit(r[o]),c=e[o],l=c._getBeta();a.k1.negative&&(a.k1.ineg(),c=c.neg(!0)),a.k2.negative&&(a.k2.ineg(),l=l.neg(!0)),n[o*2]=c,n[o*2+1]=l,s[o*2]=a.k1,s[o*2+1]=a.k2}for(var u=this._wnafMulAdd(1,n,s,o*2,i),h=0;h<o*2;h++)n[h]=null,s[h]=null;return u};function It(t,e,r,i){Ds.BasePoint.call(this,t,"affine"),e===null&&r===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new se(e,16),this.y=new se(r,16),i&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}Rf(It,Ds.BasePoint);Hr.prototype.point=function(e,r,i){return new It(this,e,r,i)};Hr.prototype.pointFromJSON=function(e,r){return It.fromJSON(this,e,r)};It.prototype._getBeta=function(){if(this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var r=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var i=this.curve,n=function(s){return i.point(s.x.redMul(i.endo.beta),s.y)};e.beta=r,r.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(n)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(n)}}}return r}};It.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]};It.fromJSON=function(e,r,i){typeof r=="string"&&(r=JSON.parse(r));var n=e.point(r[0],r[1],i);if(!r[2])return n;function s(a){return e.point(a[0],a[1],i)}var o=r[2];return n.precomputed={beta:null,doubles:o.doubles&&{step:o.doubles.step,points:[n].concat(o.doubles.points.map(s))},naf:o.naf&&{wnd:o.naf.wnd,points:[n].concat(o.naf.points.map(s))}},n};It.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"};It.prototype.isInfinity=function(){return this.inf};It.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e))return this.curve.point(null,null);if(this.x.cmp(e.x)===0)return this.curve.point(null,null);var r=this.y.redSub(e.y);r.cmpn(0)!==0&&(r=r.redMul(this.x.redSub(e.x).redInvm()));var i=r.redSqr().redISub(this.x).redISub(e.x),n=r.redMul(this.x.redSub(i)).redISub(this.y);return this.curve.point(i,n)};It.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(e.cmpn(0)===0)return this.curve.point(null,null);var r=this.curve.a,i=this.x.redSqr(),n=e.redInvm(),s=i.redAdd(i).redIAdd(i).redIAdd(r).redMul(n),o=s.redSqr().redISub(this.x.redAdd(this.x)),a=s.redMul(this.x.redSub(o)).redISub(this.y);return this.curve.point(o,a)};It.prototype.getX=function(){return this.x.fromRed()};It.prototype.getY=function(){return this.y.fromRed()};It.prototype.mul=function(e){return e=new se(e,16),this.isInfinity()?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)};It.prototype.mulAdd=function(e,r,i){var n=[this,r],s=[e,i];return this.curve.endo?this.curve._endoWnafMulAdd(n,s):this.curve._wnafMulAdd(1,n,s,2)};It.prototype.jmulAdd=function(e,r,i){var n=[this,r],s=[e,i];return this.curve.endo?this.curve._endoWnafMulAdd(n,s,!0):this.curve._wnafMulAdd(1,n,s,2,!0)};It.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||this.x.cmp(e.x)===0&&this.y.cmp(e.y)===0)};It.prototype.neg=function(e){if(this.inf)return this;var r=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var i=this.precomputed,n=function(s){return s.neg()};r.precomputed={naf:i.naf&&{wnd:i.naf.wnd,points:i.naf.points.map(n)},doubles:i.doubles&&{step:i.doubles.step,points:i.doubles.points.map(n)}}}return r};It.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var e=this.curve.jpoint(this.x,this.y,this.curve.one);return e};function Mt(t,e,r,i){Ds.BasePoint.call(this,t,"jacobian"),e===null&&r===null&&i===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new se(0)):(this.x=new se(e,16),this.y=new se(r,16),this.z=new se(i,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}Rf(Mt,Ds.BasePoint);Hr.prototype.jpoint=function(e,r,i){return new Mt(this,e,r,i)};Mt.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),r=e.redSqr(),i=this.x.redMul(r),n=this.y.redMul(r).redMul(e);return this.curve.point(i,n)};Mt.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)};Mt.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var r=e.z.redSqr(),i=this.z.redSqr(),n=this.x.redMul(r),s=e.x.redMul(i),o=this.y.redMul(r.redMul(e.z)),a=e.y.redMul(i.redMul(this.z)),c=n.redSub(s),l=o.redSub(a);if(c.cmpn(0)===0)return l.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var u=c.redSqr(),h=u.redMul(c),g=n.redMul(u),y=l.redSqr().redIAdd(h).redISub(g).redISub(g),w=l.redMul(g.redISub(y)).redISub(o.redMul(h)),E=this.z.redMul(e.z).redMul(c);return this.curve.jpoint(y,w,E)};Mt.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var r=this.z.redSqr(),i=this.x,n=e.x.redMul(r),s=this.y,o=e.y.redMul(r).redMul(this.z),a=i.redSub(n),c=s.redSub(o);if(a.cmpn(0)===0)return c.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var l=a.redSqr(),u=l.redMul(a),h=i.redMul(l),g=c.redSqr().redIAdd(u).redISub(h).redISub(h),y=c.redMul(h.redISub(g)).redISub(s.redMul(u)),w=this.z.redMul(a);return this.curve.jpoint(g,y,w)};Mt.prototype.dblp=function(e){if(e===0)return this;if(this.isInfinity())return this;if(!e)return this.dbl();var r;if(this.curve.zeroA||this.curve.threeA){var i=this;for(r=0;r<e;r++)i=i.dbl();return i}var n=this.curve.a,s=this.curve.tinv,o=this.x,a=this.y,c=this.z,l=c.redSqr().redSqr(),u=a.redAdd(a);for(r=0;r<e;r++){var h=o.redSqr(),g=u.redSqr(),y=g.redSqr(),w=h.redAdd(h).redIAdd(h).redIAdd(n.redMul(l)),E=o.redMul(g),P=w.redSqr().redISub(E.redAdd(E)),N=E.redISub(P),R=w.redMul(N);R=R.redIAdd(R).redISub(y);var D=u.redMul(c);r+1<e&&(l=l.redMul(y)),o=P,c=D,u=R}return this.curve.jpoint(o,u.redMul(s),c)};Mt.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()};Mt.prototype._zeroDbl=function(){var e,r,i;if(this.zOne){var n=this.x.redSqr(),s=this.y.redSqr(),o=s.redSqr(),a=this.x.redAdd(s).redSqr().redISub(n).redISub(o);a=a.redIAdd(a);var c=n.redAdd(n).redIAdd(n),l=c.redSqr().redISub(a).redISub(a),u=o.redIAdd(o);u=u.redIAdd(u),u=u.redIAdd(u),e=l,r=c.redMul(a.redISub(l)).redISub(u),i=this.y.redAdd(this.y)}else{var h=this.x.redSqr(),g=this.y.redSqr(),y=g.redSqr(),w=this.x.redAdd(g).redSqr().redISub(h).redISub(y);w=w.redIAdd(w);var E=h.redAdd(h).redIAdd(h),P=E.redSqr(),N=y.redIAdd(y);N=N.redIAdd(N),N=N.redIAdd(N),e=P.redISub(w).redISub(w),r=E.redMul(w.redISub(e)).redISub(N),i=this.y.redMul(this.z),i=i.redIAdd(i)}return this.curve.jpoint(e,r,i)};Mt.prototype._threeDbl=function(){var e,r,i;if(this.zOne){var n=this.x.redSqr(),s=this.y.redSqr(),o=s.redSqr(),a=this.x.redAdd(s).redSqr().redISub(n).redISub(o);a=a.redIAdd(a);var c=n.redAdd(n).redIAdd(n).redIAdd(this.curve.a),l=c.redSqr().redISub(a).redISub(a);e=l;var u=o.redIAdd(o);u=u.redIAdd(u),u=u.redIAdd(u),r=c.redMul(a.redISub(l)).redISub(u),i=this.y.redAdd(this.y)}else{var h=this.z.redSqr(),g=this.y.redSqr(),y=this.x.redMul(g),w=this.x.redSub(h).redMul(this.x.redAdd(h));w=w.redAdd(w).redIAdd(w);var E=y.redIAdd(y);E=E.redIAdd(E);var P=E.redAdd(E);e=w.redSqr().redISub(P),i=this.y.redAdd(this.z).redSqr().redISub(g).redISub(h);var N=g.redSqr();N=N.redIAdd(N),N=N.redIAdd(N),N=N.redIAdd(N),r=w.redMul(E.redISub(e)).redISub(N)}return this.curve.jpoint(e,r,i)};Mt.prototype._dbl=function(){var e=this.curve.a,r=this.x,i=this.y,n=this.z,s=n.redSqr().redSqr(),o=r.redSqr(),a=i.redSqr(),c=o.redAdd(o).redIAdd(o).redIAdd(e.redMul(s)),l=r.redAdd(r);l=l.redIAdd(l);var u=l.redMul(a),h=c.redSqr().redISub(u.redAdd(u)),g=u.redISub(h),y=a.redSqr();y=y.redIAdd(y),y=y.redIAdd(y),y=y.redIAdd(y);var w=c.redMul(g).redISub(y),E=i.redAdd(i).redMul(n);return this.curve.jpoint(h,w,E)};Mt.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),r=this.y.redSqr(),i=this.z.redSqr(),n=r.redSqr(),s=e.redAdd(e).redIAdd(e),o=s.redSqr(),a=this.x.redAdd(r).redSqr().redISub(e).redISub(n);a=a.redIAdd(a),a=a.redAdd(a).redIAdd(a),a=a.redISub(o);var c=a.redSqr(),l=n.redIAdd(n);l=l.redIAdd(l),l=l.redIAdd(l),l=l.redIAdd(l);var u=s.redIAdd(a).redSqr().redISub(o).redISub(c).redISub(l),h=r.redMul(u);h=h.redIAdd(h),h=h.redIAdd(h);var g=this.x.redMul(c).redISub(h);g=g.redIAdd(g),g=g.redIAdd(g);var y=this.y.redMul(u.redMul(l.redISub(u)).redISub(a.redMul(c)));y=y.redIAdd(y),y=y.redIAdd(y),y=y.redIAdd(y);var w=this.z.redAdd(a).redSqr().redISub(i).redISub(c);return this.curve.jpoint(g,y,w)};Mt.prototype.mul=function(e,r){return e=new se(e,r),this.curve._wnafMul(this,e)};Mt.prototype.eq=function(e){if(e.type==="affine")return this.eq(e.toJ());if(this===e)return!0;var r=this.z.redSqr(),i=e.z.redSqr();if(this.x.redMul(i).redISub(e.x.redMul(r)).cmpn(0)!==0)return!1;var n=r.redMul(this.z),s=i.redMul(e.z);return this.y.redMul(s).redISub(e.y.redMul(n)).cmpn(0)===0};Mt.prototype.eqXToP=function(e){var r=this.z.redSqr(),i=e.toRed(this.curve.red).redMul(r);if(this.x.cmp(i)===0)return!0;for(var n=e.clone(),s=this.curve.redN.redMul(r);;){if(n.iadd(this.curve.n),n.cmp(this.curve.p)>=0)return!1;if(i.redIAdd(s),this.x.cmp(i)===0)return!0}};Mt.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"};Mt.prototype.isInfinity=function(){return this.z.cmpn(0)===0};var yc=_o(function(t,e){var r=e;r.base=Ds,r.short=Kx,r.mont=null,r.edwards=null}),wc=_o(function(t,e){var r=e,i=Pr.assert;function n(a){a.type==="short"?this.curve=new yc.short(a):a.type==="edwards"?this.curve=new yc.edwards(a):this.curve=new yc.mont(a),this.g=this.curve.g,this.n=this.curve.n,this.hash=a.hash,i(this.g.validate(),"Invalid curve"),i(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}r.PresetCurve=n;function s(a,c){Object.defineProperty(r,a,{configurable:!0,enumerable:!0,get:function(){var l=new n(c);return Object.defineProperty(r,a,{configurable:!0,enumerable:!0,value:l}),l}})}s("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:gi.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),s("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:gi.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),s("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:gi.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),s("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:gi.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),s("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:gi.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),s("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:gi.sha256,gRed:!1,g:["9"]}),s("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:gi.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var o;try{o=null.crash()}catch{o=void 0}s("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:gi.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",o]})});function $n(t){if(!(this instanceof $n))return new $n(t);this.hash=t.hash,this.predResist=!!t.predResist,this.outLen=this.hash.outSize,this.minEntropy=t.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var e=ri.toArray(t.entropy,t.entropyEnc||"hex"),r=ri.toArray(t.nonce,t.nonceEnc||"hex"),i=ri.toArray(t.pers,t.persEnc||"hex");Bf(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(e,r,i)}var Fy=$n;$n.prototype._init=function(e,r,i){var n=e.concat(r).concat(i);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var s=0;s<this.V.length;s++)this.K[s]=0,this.V[s]=1;this._update(n),this._reseed=1,this.reseedInterval=281474976710656};$n.prototype._hmac=function(){return new gi.hmac(this.hash,this.K)};$n.prototype._update=function(e){var r=this._hmac().update(this.V).update([0]);e&&(r=r.update(e)),this.K=r.digest(),this.V=this._hmac().update(this.V).digest(),e&&(this.K=this._hmac().update(this.V).update([1]).update(e).digest(),this.V=this._hmac().update(this.V).digest())};$n.prototype.reseed=function(e,r,i,n){typeof r!="string"&&(n=i,i=r,r=null),e=ri.toArray(e,r),i=ri.toArray(i,n),Bf(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(e.concat(i||[])),this._reseed=1};$n.prototype.generate=function(e,r,i,n){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof r!="string"&&(n=i,i=r,r=null),i&&(i=ri.toArray(i,n||"hex"),this._update(i));for(var s=[];s.length<e;)this.V=this._hmac().update(this.V).digest(),s=s.concat(this.V);var o=s.slice(0,e);return this._update(i),this._reseed++,ri.encode(o,r)};var wh=Pr.assert;function Wt(t,e){this.ec=t,this.priv=null,this.pub=null,e.priv&&this._importPrivate(e.priv,e.privEnc),e.pub&&this._importPublic(e.pub,e.pubEnc)}var Tf=Wt;Wt.fromPublic=function(e,r,i){return r instanceof Wt?r:new Wt(e,{pub:r,pubEnc:i})};Wt.fromPrivate=function(e,r,i){return r instanceof Wt?r:new Wt(e,{priv:r,privEnc:i})};Wt.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}};Wt.prototype.getPublic=function(e,r){return typeof e=="string"&&(r=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),r?this.pub.encode(r,e):this.pub};Wt.prototype.getPrivate=function(e){return e==="hex"?this.priv.toString(16,2):this.priv};Wt.prototype._importPrivate=function(e,r){this.priv=new se(e,r||16),this.priv=this.priv.umod(this.ec.curve.n)};Wt.prototype._importPublic=function(e,r){if(e.x||e.y){this.ec.curve.type==="mont"?wh(e.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&wh(e.x&&e.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(e.x,e.y);return}this.pub=this.ec.curve.decodePoint(e,r)};Wt.prototype.derive=function(e){return e.validate()||wh(e.validate(),"public point not validated"),e.mul(this.priv).getX()};Wt.prototype.sign=function(e,r,i){return this.ec.sign(e,this,r,i)};Wt.prototype.verify=function(e,r){return this.ec.verify(e,r,this)};Wt.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"};var Vx=Pr.assert;function ul(t,e){if(t instanceof ul)return t;this._importDER(t,e)||(Vx(t.r&&t.s,"Signature without r or s"),this.r=new se(t.r,16),this.s=new se(t.s,16),t.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=t.recoveryParam)}var hl=ul;function Gx(){this.place=0}function ou(t,e){var r=t[e.place++];if(!(r&128))return r;var i=r&15;if(i===0||i>4)return!1;for(var n=0,s=0,o=e.place;s<i;s++,o++)n<<=8,n|=t[o],n>>>=0;return n<=127?!1:(e.place=o,n)}function ip(t){for(var e=0,r=t.length-1;!t[e]&&!(t[e+1]&128)&&e<r;)e++;return e===0?t:t.slice(e)}ul.prototype._importDER=function(e,r){e=Pr.toArray(e,r);var i=new Gx;if(e[i.place++]!==48)return!1;var n=ou(e,i);if(n===!1||n+i.place!==e.length||e[i.place++]!==2)return!1;var s=ou(e,i);if(s===!1)return!1;var o=e.slice(i.place,s+i.place);if(i.place+=s,e[i.place++]!==2)return!1;var a=ou(e,i);if(a===!1||e.length!==a+i.place)return!1;var c=e.slice(i.place,a+i.place);if(o[0]===0)if(o[1]&128)o=o.slice(1);else return!1;if(c[0]===0)if(c[1]&128)c=c.slice(1);else return!1;return this.r=new se(o),this.s=new se(c),this.recoveryParam=null,!0};function au(t,e){if(e<128){t.push(e);return}var r=1+(Math.log(e)/Math.LN2>>>3);for(t.push(r|128);--r;)t.push(e>>>(r<<3)&255);t.push(e)}ul.prototype.toDER=function(e){var r=this.r.toArray(),i=this.s.toArray();for(r[0]&128&&(r=[0].concat(r)),i[0]&128&&(i=[0].concat(i)),r=ip(r),i=ip(i);!i[0]&&!(i[1]&128);)i=i.slice(1);var n=[2];au(n,r.length),n=n.concat(r),n.push(2),au(n,i.length);var s=n.concat(i),o=[48];return au(o,s.length),o=o.concat(s),Pr.encode(o,e)};var Wx=function(){throw new Error("unsupported")},qy=Pr.assert;function qr(t){if(!(this instanceof qr))return new qr(t);typeof t=="string"&&(qy(Object.prototype.hasOwnProperty.call(wc,t),"Unknown curve "+t),t=wc[t]),t instanceof wc.PresetCurve&&(t={curve:t}),this.curve=t.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=t.curve.g,this.g.precompute(t.curve.n.bitLength()+1),this.hash=t.hash||t.curve.hash}var Yx=qr;qr.prototype.keyPair=function(e){return new Tf(this,e)};qr.prototype.keyFromPrivate=function(e,r){return Tf.fromPrivate(this,e,r)};qr.prototype.keyFromPublic=function(e,r){return Tf.fromPublic(this,e,r)};qr.prototype.genKeyPair=function(e){e||(e={});for(var r=new Fy({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||Wx(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),i=this.n.byteLength(),n=this.n.sub(new se(2));;){var s=new se(r.generate(i));if(!(s.cmp(n)>0))return s.iaddn(1),this.keyFromPrivate(s)}};qr.prototype._truncateToN=function(e,r){var i=e.byteLength()*8-this.n.bitLength();return i>0&&(e=e.ushrn(i)),!r&&e.cmp(this.n)>=0?e.sub(this.n):e};qr.prototype.sign=function(e,r,i,n){typeof i=="object"&&(n=i,i=null),n||(n={}),r=this.keyFromPrivate(r,i),e=this._truncateToN(new se(e,16));for(var s=this.n.byteLength(),o=r.getPrivate().toArray("be",s),a=e.toArray("be",s),c=new Fy({hash:this.hash,entropy:o,nonce:a,pers:n.pers,persEnc:n.persEnc||"utf8"}),l=this.n.sub(new se(1)),u=0;;u++){var h=n.k?n.k(u):new se(c.generate(this.n.byteLength()));if(h=this._truncateToN(h,!0),!(h.cmpn(1)<=0||h.cmp(l)>=0)){var g=this.g.mul(h);if(!g.isInfinity()){var y=g.getX(),w=y.umod(this.n);if(w.cmpn(0)!==0){var E=h.invm(this.n).mul(w.mul(r.getPrivate()).iadd(e));if(E=E.umod(this.n),E.cmpn(0)!==0){var P=(g.getY().isOdd()?1:0)|(y.cmp(w)!==0?2:0);return n.canonical&&E.cmp(this.nh)>0&&(E=this.n.sub(E),P^=1),new hl({r:w,s:E,recoveryParam:P})}}}}}};qr.prototype.verify=function(e,r,i,n){e=this._truncateToN(new se(e,16)),i=this.keyFromPublic(i,n),r=new hl(r,"hex");var s=r.r,o=r.s;if(s.cmpn(1)<0||s.cmp(this.n)>=0||o.cmpn(1)<0||o.cmp(this.n)>=0)return!1;var a=o.invm(this.n),c=a.mul(e).umod(this.n),l=a.mul(s).umod(this.n),u;return this.curve._maxwellTrick?(u=this.g.jmulAdd(c,i.getPublic(),l),u.isInfinity()?!1:u.eqXToP(s)):(u=this.g.mulAdd(c,i.getPublic(),l),u.isInfinity()?!1:u.getX().umod(this.n).cmp(s)===0)};qr.prototype.recoverPubKey=function(t,e,r,i){qy((3&r)===r,"The recovery param is more than two bits"),e=new hl(e,i);var n=this.n,s=new se(t),o=e.r,a=e.s,c=r&1,l=r>>1;if(o.cmp(this.curve.p.umod(this.curve.n))>=0&&l)throw new Error("Unable to find sencond key candinate");l?o=this.curve.pointFromX(o.add(this.curve.n),c):o=this.curve.pointFromX(o,c);var u=e.r.invm(n),h=n.sub(s).mul(u).umod(n),g=a.mul(u).umod(n);return this.g.mulAdd(h,o,g)};qr.prototype.getKeyRecoveryParam=function(t,e,r,i){if(e=new hl(e,i),e.recoveryParam!==null)return e.recoveryParam;for(var n=0;n<4;n++){var s;try{s=this.recoverPubKey(t,e,n)}catch{continue}if(s.eq(r))return n}throw new Error("Unable to find valid recovery factor")};var Jx=_o(function(t,e){var r=e;r.version="6.5.4",r.utils=Pr,r.rand=function(){throw new Error("unsupported")},r.curve=yc,r.curves=wc,r.ec=Yx,r.eddsa=null}),Qx=Jx.ec;const Zx="signing-key/5.7.0",bh=new K(Zx);let cu=null;function Pn(){return cu||(cu=new Qx("secp256k1")),cu}class Xx{constructor(e){me(this,"curve","secp256k1"),me(this,"privateKey",ce(e)),bs(this.privateKey)!==32&&bh.throwArgumentError("invalid private key","privateKey","[[ REDACTED ]]");const r=Pn().keyFromPrivate(le(this.privateKey));me(this,"publicKey","0x"+r.getPublic(!1,"hex")),me(this,"compressedPublicKey","0x"+r.getPublic(!0,"hex")),me(this,"_isSigningKey",!0)}_addPoint(e){const r=Pn().keyFromPublic(le(this.publicKey)),i=Pn().keyFromPublic(le(e));return"0x"+r.pub.add(i.pub).encodeCompressed("hex")}signDigest(e){const r=Pn().keyFromPrivate(le(this.privateKey)),i=le(e);i.length!==32&&bh.throwArgumentError("bad digest length","digest",e);const n=r.sign(i,{canonical:!0});return sl({recoveryParam:n.recoveryParam,r:ut("0x"+n.r.toString(16),32),s:ut("0x"+n.s.toString(16),32)})}computeSharedSecret(e){const r=Pn().keyFromPrivate(le(this.privateKey)),i=Pn().keyFromPublic(le(jy(e)));return ut("0x"+r.derive(i.getPublic()).toString(16),32)}static isSigningKey(e){return!!(e&&e._isSigningKey)}}function eA(t,e){const r=sl(e),i={r:le(r.r),s:le(r.s)};return"0x"+Pn().recoverPubKey(le(t),i,r.recoveryParam).encode("hex",!1)}function jy(t,e){const r=le(t);return r.length===32?new Xx(r).publicKey:r.length===33?"0x"+Pn().keyFromPublic(r).getPublic(!1,"hex"):r.length===65?ce(r):bh.throwArgumentError("invalid public or private key","key","[REDACTED]")}const tA="transactions/5.7.0",on=new K(tA);var np;(function(t){t[t.legacy=0]="legacy",t[t.eip2930=1]="eip2930",t[t.eip1559=2]="eip1559"})(np||(np={}));function Mf(t){return t==="0x"?null:fr(t)}function Gt(t){return t==="0x"?A2:te.from(t)}function rA(t){const e=jy(t);return fr(Yt(Tt(Yt(e,1)),12))}function zy(t,e){return rA(eA(le(t),e))}function Ar(t,e){const r=lo(te.from(t).toHexString());return r.length>32&&on.throwArgumentError("invalid length for "+e,"transaction:"+e,t),r}function lu(t,e){return{address:fr(t),storageKeys:(e||[]).map((r,i)=>(bs(r)!==32&&on.throwArgumentError("invalid access list storageKey",`accessList[${t}:${i}]`,r),r.toLowerCase()))}}function Sa(t){if(Array.isArray(t))return t.map((r,i)=>Array.isArray(r)?(r.length>2&&on.throwArgumentError("access list expected to be [ address, storageKeys[] ]",`value[${i}]`,r),lu(r[0],r[1])):lu(r.address,r.storageKeys));const e=Object.keys(t).map(r=>{const i=t[r].reduce((n,s)=>(n[s]=!0,n),{});return lu(r,Object.keys(i).sort())});return e.sort((r,i)=>r.address.localeCompare(i.address)),e}function Hy(t){return Sa(t).map(e=>[e.address,e.storageKeys])}function iA(t,e){if(t.gasPrice!=null){const i=te.from(t.gasPrice),n=te.from(t.maxFeePerGas||0);i.eq(n)||on.throwArgumentError("mismatch EIP-1559 gasPrice != maxFeePerGas","tx",{gasPrice:i,maxFeePerGas:n})}const r=[Ar(t.chainId||0,"chainId"),Ar(t.nonce||0,"nonce"),Ar(t.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),Ar(t.maxFeePerGas||0,"maxFeePerGas"),Ar(t.gasLimit||0,"gasLimit"),t.to!=null?fr(t.to):"0x",Ar(t.value||0,"value"),t.data||"0x",Hy(t.accessList||[])];if(e){const i=sl(e);r.push(Ar(i.recoveryParam,"recoveryParam")),r.push(lo(i.r)),r.push(lo(i.s))}return _r(["0x02",ol(r)])}function nA(t,e){const r=[Ar(t.chainId||0,"chainId"),Ar(t.nonce||0,"nonce"),Ar(t.gasPrice||0,"gasPrice"),Ar(t.gasLimit||0,"gasLimit"),t.to!=null?fr(t.to):"0x",Ar(t.value||0,"value"),t.data||"0x",Hy(t.accessList||[])];if(e){const i=sl(e);r.push(Ar(i.recoveryParam,"recoveryParam")),r.push(lo(i.r)),r.push(lo(i.s))}return _r(["0x01",ol(r)])}function Ky(t,e,r){try{const i=Gt(e[0]).toNumber();if(i!==0&&i!==1)throw new Error("bad recid");t.v=i}catch{on.throwArgumentError("invalid v for transaction type: 1","v",e[0])}t.r=ut(e[1],32),t.s=ut(e[2],32);try{const i=Tt(r(t));t.from=zy(i,{r:t.r,s:t.s,recoveryParam:t.v})}catch{}}function sA(t){const e=Of(t.slice(1));e.length!==9&&e.length!==12&&on.throwArgumentError("invalid component count for transaction type: 2","payload",ce(t));const r=Gt(e[2]),i=Gt(e[3]),n={type:2,chainId:Gt(e[0]).toNumber(),nonce:Gt(e[1]).toNumber(),maxPriorityFeePerGas:r,maxFeePerGas:i,gasPrice:null,gasLimit:Gt(e[4]),to:Mf(e[5]),value:Gt(e[6]),data:e[7],accessList:Sa(e[8])};return e.length===9||(n.hash=Tt(t),Ky(n,e.slice(9),iA)),n}function oA(t){const e=Of(t.slice(1));e.length!==8&&e.length!==11&&on.throwArgumentError("invalid component count for transaction type: 1","payload",ce(t));const r={type:1,chainId:Gt(e[0]).toNumber(),nonce:Gt(e[1]).toNumber(),gasPrice:Gt(e[2]),gasLimit:Gt(e[3]),to:Mf(e[4]),value:Gt(e[5]),data:e[6],accessList:Sa(e[7])};return e.length===8||(r.hash=Tt(t),Ky(r,e.slice(8),nA)),r}function aA(t){const e=Of(t);e.length!==9&&e.length!==6&&on.throwArgumentError("invalid raw transaction","rawTransaction",t);const r={nonce:Gt(e[0]).toNumber(),gasPrice:Gt(e[1]),gasLimit:Gt(e[2]),to:Mf(e[3]),value:Gt(e[4]),data:e[5],chainId:0};if(e.length===6)return r;try{r.v=te.from(e[6]).toNumber()}catch{return r}if(r.r=ut(e[7],32),r.s=ut(e[8],32),te.from(r.r).isZero()&&te.from(r.s).isZero())r.chainId=r.v,r.v=0;else{r.chainId=Math.floor((r.v-35)/2),r.chainId<0&&(r.chainId=0);let i=r.v-27;const n=e.slice(0,6);r.chainId!==0&&(n.push(ce(r.chainId)),n.push("0x"),n.push("0x"),i-=r.chainId*2+8);const s=Tt(ol(n));try{r.from=zy(s,{r:ce(r.r),s:ce(r.s),recoveryParam:i})}catch{}r.hash=Tt(t)}return r.type=null,r}function cA(t){const e=le(t);if(e[0]>127)return aA(e);switch(e[0]){case 1:return oA(e);case 2:return sA(e)}return on.throwError(`unsupported transaction type: ${e[0]}`,K.errors.UNSUPPORTED_OPERATION,{operation:"parseTransaction",transactionType:e[0]})}class Vy{constructor(e){me(this,"alphabet",e),me(this,"base",e.length),me(this,"_alphabetMap",{}),me(this,"_leader",e.charAt(0));for(let r=0;r<e.length;r++)this._alphabetMap[e.charAt(r)]=r}encode(e){let r=le(e);if(r.length===0)return"";let i=[0];for(let s=0;s<r.length;++s){let o=r[s];for(let a=0;a<i.length;++a)o+=i[a]<<8,i[a]=o%this.base,o=o/this.base|0;for(;o>0;)i.push(o%this.base),o=o/this.base|0}let n="";for(let s=0;r[s]===0&&s<r.length-1;++s)n+=this._leader;for(let s=i.length-1;s>=0;--s)n+=this.alphabet[i[s]];return n}decode(e){if(typeof e!="string")throw new TypeError("Expected String");let r=[];if(e.length===0)return new Uint8Array(r);r.push(0);for(let i=0;i<e.length;i++){let n=this._alphabetMap[e[i]];if(n===void 0)throw new Error("Non-base"+this.base+" character");let s=n;for(let o=0;o<r.length;++o)s+=r[o]*this.base,r[o]=s&255,s>>=8;for(;s>0;)r.push(s&255),s>>=8}for(let i=0;e[i]===this._leader&&i<e.length-1;++i)r.push(0);return le(new Uint8Array(r.reverse()))}}new Vy("abcdefghijklmnopqrstuvwxyz234567");const vh=new Vy("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz");function sp(t){return"0x"+gi.sha256().update(le(t)).digest("hex")}const lA="networks/5.7.1",op=new K(lA);function uA(t){return t&&typeof t.renetwork=="function"}function Ki(t){const e=function(r,i){i==null&&(i={});const n=[];if(r.InfuraProvider&&i.infura!=="-")try{n.push(new r.InfuraProvider(t,i.infura))}catch{}if(r.EtherscanProvider&&i.etherscan!=="-")try{n.push(new r.EtherscanProvider(t,i.etherscan))}catch{}if(r.AlchemyProvider&&i.alchemy!=="-")try{n.push(new r.AlchemyProvider(t,i.alchemy))}catch{}if(r.PocketProvider&&i.pocket!=="-"){const s=["goerli","ropsten","rinkeby","sepolia"];try{const o=new r.PocketProvider(t,i.pocket);o.network&&s.indexOf(o.network.name)===-1&&n.push(o)}catch{}}if(r.CloudflareProvider&&i.cloudflare!=="-")try{n.push(new r.CloudflareProvider(t))}catch{}if(r.AnkrProvider&&i.ankr!=="-")try{const s=["ropsten"],o=new r.AnkrProvider(t,i.ankr);o.network&&s.indexOf(o.network.name)===-1&&n.push(o)}catch{}if(n.length===0)return null;if(r.FallbackProvider){let s=1;return i.quorum!=null?s=i.quorum:t==="homestead"&&(s=2),new r.FallbackProvider(n,s)}return n[0]};return e.renetwork=function(r){return Ki(r)},e}function Tc(t,e){const r=function(i,n){return i.JsonRpcProvider?new i.JsonRpcProvider(t,e):null};return r.renetwork=function(i){return Tc(t,i)},r}const ap={chainId:1,ensAddress:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",name:"homestead",_defaultProvider:Ki("homestead")},cp={chainId:3,ensAddress:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",name:"ropsten",_defaultProvider:Ki("ropsten")},lp={chainId:63,name:"classicMordor",_defaultProvider:Tc("https://www.ethercluster.com/mordor","classicMordor")},qa={unspecified:{chainId:0,name:"unspecified"},homestead:ap,mainnet:ap,morden:{chainId:2,name:"morden"},ropsten:cp,testnet:cp,rinkeby:{chainId:4,ensAddress:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",name:"rinkeby",_defaultProvider:Ki("rinkeby")},kovan:{chainId:42,name:"kovan",_defaultProvider:Ki("kovan")},goerli:{chainId:5,ensAddress:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",name:"goerli",_defaultProvider:Ki("goerli")},kintsugi:{chainId:1337702,name:"kintsugi"},sepolia:{chainId:11155111,name:"sepolia",_defaultProvider:Ki("sepolia")},classic:{chainId:61,name:"classic",_defaultProvider:Tc("https://www.ethercluster.com/etc","classic")},classicMorden:{chainId:62,name:"classicMorden"},classicMordor:lp,classicTestnet:lp,classicKotti:{chainId:6,name:"classicKotti",_defaultProvider:Tc("https://www.ethercluster.com/kotti","classicKotti")},xdai:{chainId:100,name:"xdai"},matic:{chainId:137,name:"matic",_defaultProvider:Ki("matic")},maticmum:{chainId:80001,name:"maticmum"},optimism:{chainId:10,name:"optimism",_defaultProvider:Ki("optimism")},"optimism-kovan":{chainId:69,name:"optimism-kovan"},"optimism-goerli":{chainId:420,name:"optimism-goerli"},arbitrum:{chainId:42161,name:"arbitrum"},"arbitrum-rinkeby":{chainId:421611,name:"arbitrum-rinkeby"},"arbitrum-goerli":{chainId:421613,name:"arbitrum-goerli"},bnb:{chainId:56,name:"bnb"},bnbt:{chainId:97,name:"bnbt"}};function hA(t){if(t==null)return null;if(typeof t=="number"){for(const i in qa){const n=qa[i];if(n.chainId===t)return{name:n.name,chainId:n.chainId,ensAddress:n.ensAddress||null,_defaultProvider:n._defaultProvider||null}}return{chainId:t,name:"unknown"}}if(typeof t=="string"){const i=qa[t];return i==null?null:{name:i.name,chainId:i.chainId,ensAddress:i.ensAddress,_defaultProvider:i._defaultProvider||null}}const e=qa[t.name];if(!e)return typeof t.chainId!="number"&&op.throwArgumentError("invalid network chainId","network",t),t;t.chainId!==0&&t.chainId!==e.chainId&&op.throwArgumentError("network chainId mismatch","network",t);let r=t._defaultProvider||null;return r==null&&e._defaultProvider&&(uA(e._defaultProvider)?r=e._defaultProvider.renetwork(t):r=e._defaultProvider),{name:t.name,chainId:e.chainId,ensAddress:t.ensAddress||e.ensAddress||null,_defaultProvider:r}}const fA="web/5.7.1";var dA=function(t,e,r,i){function n(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(u){try{l(i.next(u))}catch(h){o(h)}}function c(u){try{l(i.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):n(u.value).then(a,c)}l((i=i.apply(t,e||[])).next())})};function pA(t,e){return dA(this,void 0,void 0,function*(){e==null&&(e={});const r={method:e.method||"GET",headers:e.headers||{},body:e.body||void 0};if(e.skipFetchSetup!==!0&&(r.mode="cors",r.cache="no-cache",r.credentials="same-origin",r.redirect="follow",r.referrer="client"),e.fetchOptions!=null){const o=e.fetchOptions;o.mode&&(r.mode=o.mode),o.cache&&(r.cache=o.cache),o.credentials&&(r.credentials=o.credentials),o.redirect&&(r.redirect=o.redirect),o.referrer&&(r.referrer=o.referrer)}const i=yield fetch(t,r),n=yield i.arrayBuffer(),s={};return i.headers.forEach?i.headers.forEach((o,a)=>{s[a.toLowerCase()]=o}):i.headers.keys().forEach(o=>{s[o.toLowerCase()]=i.headers.get(o)}),{headers:s,statusCode:i.status,statusMessage:i.statusText,body:le(new Uint8Array(n))}})}var gA=function(t,e,r,i){function n(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(u){try{l(i.next(u))}catch(h){o(h)}}function c(u){try{l(i.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):n(u.value).then(a,c)}l((i=i.apply(t,e||[])).next())})};const Qr=new K(fA);function up(t){return new Promise(e=>{setTimeout(e,t)})}function dn(t,e){if(t==null)return null;if(typeof t=="string")return t;if(If(t)){if(e&&(e.split("/")[0]==="text"||e.split(";")[0].trim()==="application/json"))try{return al(t)}catch{}return ce(t)}return t}function mA(t){return Xi(t.replace(/%([0-9a-f][0-9a-f])/gi,(e,r)=>String.fromCharCode(parseInt(r,16))))}function yA(t,e,r){const i=typeof t=="object"&&t.throttleLimit!=null?t.throttleLimit:12;Qr.assertArgument(i>0&&i%1===0,"invalid connection throttle limit","connection.throttleLimit",i);const n=typeof t=="object"?t.throttleCallback:null,s=typeof t=="object"&&typeof t.throttleSlotInterval=="number"?t.throttleSlotInterval:100;Qr.assertArgument(s>0&&s%1===0,"invalid connection throttle slot interval","connection.throttleSlotInterval",s);const o=typeof t=="object"?!!t.errorPassThrough:!1,a={};let c=null;const l={method:"GET"};let u=!1,h=2*60*1e3;if(typeof t=="string")c=t;else if(typeof t=="object"){if((t==null||t.url==null)&&Qr.throwArgumentError("missing URL","connection.url",t),c=t.url,typeof t.timeout=="number"&&t.timeout>0&&(h=t.timeout),t.headers)for(const N in t.headers)a[N.toLowerCase()]={key:N,value:String(t.headers[N])},["if-none-match","if-modified-since"].indexOf(N.toLowerCase())>=0&&(u=!0);if(l.allowGzip=!!t.allowGzip,t.user!=null&&t.password!=null){c.substring(0,6)!=="https:"&&t.allowInsecureAuthentication!==!0&&Qr.throwError("basic authentication requires a secure https url",K.errors.INVALID_ARGUMENT,{argument:"url",url:c,user:t.user,password:"[REDACTED]"});const N=t.user+":"+t.password;a.authorization={key:"Authorization",value:"Basic "+uy(Xi(N))}}t.skipFetchSetup!=null&&(l.skipFetchSetup=!!t.skipFetchSetup),t.fetchOptions!=null&&(l.fetchOptions=cr(t.fetchOptions))}const g=new RegExp("^data:([^;:]*)?(;base64)?,(.*)$","i"),y=c?c.match(g):null;if(y)try{const N={statusCode:200,statusMessage:"OK",headers:{"content-type":y[1]||"text/plain"},body:y[2]?ly(y[3]):mA(y[3])};let R=N.body;return r&&(R=r(N.body,N)),Promise.resolve(R)}catch(N){Qr.throwError("processing response error",K.errors.SERVER_ERROR,{body:dn(y[1],y[2]),error:N,requestBody:null,requestMethod:"GET",url:c})}e&&(l.method="POST",l.body=e,a["content-type"]==null&&(a["content-type"]={key:"Content-Type",value:"application/octet-stream"}),a["content-length"]==null&&(a["content-length"]={key:"Content-Length",value:String(e.length)}));const w={};Object.keys(a).forEach(N=>{const R=a[N];w[R.key]=R.value}),l.headers=w;const E=function(){let N=null;return{promise:new Promise(function(C,B){h&&(N=setTimeout(()=>{N!=null&&(N=null,B(Qr.makeError("timeout",K.errors.TIMEOUT,{requestBody:dn(l.body,w["content-type"]),requestMethod:l.method,timeout:h,url:c})))},h))}),cancel:function(){N!=null&&(clearTimeout(N),N=null)}}}(),P=function(){return gA(this,void 0,void 0,function*(){for(let N=0;N<i;N++){let R=null;try{if(R=yield pA(c,l),N<i){if(R.statusCode===301||R.statusCode===302){const C=R.headers.location||"";if(l.method==="GET"&&C.match(/^https:/)){c=R.headers.location;continue}}else if(R.statusCode===429){let C=!0;if(n&&(C=yield n(N,c)),C){let B=0;const M=R.headers["retry-after"];typeof M=="string"&&M.match(/^[1-9][0-9]*$/)?B=parseInt(M)*1e3:B=s*parseInt(String(Math.random()*Math.pow(2,N))),yield up(B);continue}}}}catch(C){R=C.response,R==null&&(E.cancel(),Qr.throwError("missing response",K.errors.SERVER_ERROR,{requestBody:dn(l.body,w["content-type"]),requestMethod:l.method,serverError:C,url:c}))}let D=R.body;if(u&&R.statusCode===304?D=null:!o&&(R.statusCode<200||R.statusCode>=300)&&(E.cancel(),Qr.throwError("bad response",K.errors.SERVER_ERROR,{status:R.statusCode,headers:R.headers,body:dn(D,R.headers?R.headers["content-type"]:null),requestBody:dn(l.body,w["content-type"]),requestMethod:l.method,url:c})),r)try{const C=yield r(D,R);return E.cancel(),C}catch(C){if(C.throttleRetry&&N<i){let B=!0;if(n&&(B=yield n(N,c)),B){const M=s*parseInt(String(Math.random()*Math.pow(2,N)));yield up(M);continue}}E.cancel(),Qr.throwError("processing response error",K.errors.SERVER_ERROR,{body:dn(D,R.headers?R.headers["content-type"]:null),error:C,requestBody:dn(l.body,w["content-type"]),requestMethod:l.method,url:c})}return E.cancel(),D}return Qr.throwError("failed response",K.errors.SERVER_ERROR,{requestBody:dn(l.body,w["content-type"]),requestMethod:l.method,url:c})})}();return Promise.race([E.promise,P])}function kf(t,e,r){let i=(s,o)=>{let a=null;if(s!=null)try{a=JSON.parse(al(s))}catch(c){Qr.throwError("invalid JSON",K.errors.SERVER_ERROR,{body:s,error:c})}return r&&(a=r(a,o)),a},n=null;if(e!=null){n=Xi(e);const s=typeof t=="string"?{url:t}:cr(t);s.headers?Object.keys(s.headers).filter(a=>a.toLowerCase()==="content-type").length!==0||(s.headers=cr(s.headers),s.headers["content-type"]="application/json"):s.headers={"content-type":"application/json"},t=s}return yA(t,n,i)}function Zo(t,e){return e||(e={}),e=cr(e),e.floor==null&&(e.floor=0),e.ceiling==null&&(e.ceiling=1e4),e.interval==null&&(e.interval=250),new Promise(function(r,i){let n=null,s=!1;const o=()=>s?!1:(s=!0,n&&clearTimeout(n),!0);e.timeout&&(n=setTimeout(()=>{o()&&i(new Error("timeout"))},e.timeout));const a=e.retryLimit;let c=0;function l(){return t().then(function(u){if(u!==void 0)o()&&r(u);else if(e.oncePoll)e.oncePoll.once("poll",l);else if(e.onceBlock)e.onceBlock.once("block",l);else if(!s){if(c++,c>a){o()&&i(new Error("retry limit reached"));return}let h=e.interval*parseInt(String(Math.random()*Math.pow(2,c)));h<e.floor&&(h=e.floor),h>e.ceiling&&(h=e.ceiling),setTimeout(l,h)}return null},function(u){o()&&i(u)})}l()})}var Mc="qpzry9x8gf2tvdw0s3jn54khce6mua7l",Eh={};for(var ja=0;ja<Mc.length;ja++){var uu=Mc.charAt(ja);if(Eh[uu]!==void 0)throw new TypeError(uu+" is ambiguous");Eh[uu]=ja}function to(t){var e=t>>25;return(t&33554431)<<5^-(e>>0&1)&996825010^-(e>>1&1)&642813549^-(e>>2&1)&513874426^-(e>>3&1)&1027748829^-(e>>4&1)&705979059}function Gy(t){for(var e=1,r=0;r<t.length;++r){var i=t.charCodeAt(r);if(i<33||i>126)return"Invalid prefix ("+t+")";e=to(e)^i>>5}for(e=to(e),r=0;r<t.length;++r){var n=t.charCodeAt(r);e=to(e)^n&31}return e}function wA(t,e,r){if(r=r||90,t.length+7+e.length>r)throw new TypeError("Exceeds length limit");t=t.toLowerCase();var i=Gy(t);if(typeof i=="string")throw new Error(i);for(var n=t+"1",s=0;s<e.length;++s){var o=e[s];if(o>>5)throw new Error("Non 5-bit word");i=to(i)^o,n+=Mc.charAt(o)}for(s=0;s<6;++s)i=to(i);for(i^=1,s=0;s<6;++s){var a=i>>(5-s)*5&31;n+=Mc.charAt(a)}return n}function Wy(t,e){if(e=e||90,t.length<8)return t+" too short";if(t.length>e)return"Exceeds length limit";var r=t.toLowerCase(),i=t.toUpperCase();if(t!==r&&t!==i)return"Mixed-case string "+t;t=r;var n=t.lastIndexOf("1");if(n===-1)return"No separator character for "+t;if(n===0)return"Missing prefix for "+t;var s=t.slice(0,n),o=t.slice(n+1);if(o.length<6)return"Data too short";var a=Gy(s);if(typeof a=="string")return a;for(var c=[],l=0;l<o.length;++l){var u=o.charAt(l),h=Eh[u];if(h===void 0)return"Unknown character "+u;a=to(a)^h,!(l+6>=o.length)&&c.push(h)}return a!==1?"Invalid checksum for "+t:{prefix:s,words:c}}function bA(){var t=Wy.apply(null,arguments);if(typeof t=="object")return t}function vA(t){var e=Wy.apply(null,arguments);if(typeof e=="object")return e;throw new Error(e)}function fl(t,e,r,i){for(var n=0,s=0,o=(1<<r)-1,a=[],c=0;c<t.length;++c)for(n=n<<e|t[c],s+=e;s>=r;)s-=r,a.push(n>>s&o);if(i)s>0&&a.push(n<<r-s&o);else{if(s>=e)return"Excess padding";if(n<<r-s&o)return"Non-zero padding"}return a}function EA(t){var e=fl(t,8,5,!0);if(Array.isArray(e))return e}function xA(t){var e=fl(t,8,5,!0);if(Array.isArray(e))return e;throw new Error(e)}function AA(t){var e=fl(t,5,8,!1);if(Array.isArray(e))return e}function _A(t){var e=fl(t,5,8,!1);if(Array.isArray(e))return e;throw new Error(e)}var IA={decodeUnsafe:bA,decode:vA,encode:wA,toWordsUnsafe:EA,toWords:xA,fromWordsUnsafe:AA,fromWords:_A};const hp=Os(IA),dl="providers/5.7.2",Co=new K(dl);class re{constructor(){this.formats=this.getDefaultFormats()}getDefaultFormats(){const e={},r=this.address.bind(this),i=this.bigNumber.bind(this),n=this.blockTag.bind(this),s=this.data.bind(this),o=this.hash.bind(this),a=this.hex.bind(this),c=this.number.bind(this),l=this.type.bind(this),u=h=>this.data(h,!0);return e.transaction={hash:o,type:l,accessList:re.allowNull(this.accessList.bind(this),null),blockHash:re.allowNull(o,null),blockNumber:re.allowNull(c,null),transactionIndex:re.allowNull(c,null),confirmations:re.allowNull(c,null),from:r,gasPrice:re.allowNull(i),maxPriorityFeePerGas:re.allowNull(i),maxFeePerGas:re.allowNull(i),gasLimit:i,to:re.allowNull(r,null),value:i,nonce:c,data:s,r:re.allowNull(this.uint256),s:re.allowNull(this.uint256),v:re.allowNull(c),creates:re.allowNull(r,null),raw:re.allowNull(s)},e.transactionRequest={from:re.allowNull(r),nonce:re.allowNull(c),gasLimit:re.allowNull(i),gasPrice:re.allowNull(i),maxPriorityFeePerGas:re.allowNull(i),maxFeePerGas:re.allowNull(i),to:re.allowNull(r),value:re.allowNull(i),data:re.allowNull(u),type:re.allowNull(c),accessList:re.allowNull(this.accessList.bind(this),null)},e.receiptLog={transactionIndex:c,blockNumber:c,transactionHash:o,address:r,topics:re.arrayOf(o),data:s,logIndex:c,blockHash:o},e.receipt={to:re.allowNull(this.address,null),from:re.allowNull(this.address,null),contractAddress:re.allowNull(r,null),transactionIndex:c,root:re.allowNull(a),gasUsed:i,logsBloom:re.allowNull(s),blockHash:o,transactionHash:o,logs:re.arrayOf(this.receiptLog.bind(this)),blockNumber:c,confirmations:re.allowNull(c,null),cumulativeGasUsed:i,effectiveGasPrice:re.allowNull(i),status:re.allowNull(c),type:l},e.block={hash:re.allowNull(o),parentHash:o,number:c,timestamp:c,nonce:re.allowNull(a),difficulty:this.difficulty.bind(this),gasLimit:i,gasUsed:i,miner:re.allowNull(r),extraData:s,transactions:re.allowNull(re.arrayOf(o)),baseFeePerGas:re.allowNull(i)},e.blockWithTransactions=cr(e.block),e.blockWithTransactions.transactions=re.allowNull(re.arrayOf(this.transactionResponse.bind(this))),e.filter={fromBlock:re.allowNull(n,void 0),toBlock:re.allowNull(n,void 0),blockHash:re.allowNull(o,void 0),address:re.allowNull(r,void 0),topics:re.allowNull(this.topics.bind(this),void 0)},e.filterLog={blockNumber:re.allowNull(c),blockHash:re.allowNull(o),transactionIndex:c,removed:re.allowNull(this.boolean.bind(this)),address:r,data:re.allowFalsish(s,"0x"),topics:re.arrayOf(o),transactionHash:o,logIndex:c},e}accessList(e){return Sa(e||[])}number(e){return e==="0x"?0:te.from(e).toNumber()}type(e){return e==="0x"||e==null?0:te.from(e).toNumber()}bigNumber(e){return te.from(e)}boolean(e){if(typeof e=="boolean")return e;if(typeof e=="string"){if(e=e.toLowerCase(),e==="true")return!0;if(e==="false")return!1}throw new Error("invalid boolean - "+e)}hex(e,r){return typeof e=="string"&&(!r&&e.substring(0,2)!=="0x"&&(e="0x"+e),Te(e))?e.toLowerCase():Co.throwArgumentError("invalid hash","value",e)}data(e,r){const i=this.hex(e,r);if(i.length%2!==0)throw new Error("invalid data; odd-length - "+e);return i}address(e){return fr(e)}callAddress(e){if(!Te(e,32))return null;const r=fr(Yt(e,12));return r===x2?null:r}contractAddress(e){return E2(e)}blockTag(e){if(e==null)return"latest";if(e==="earliest")return"0x0";switch(e){case"earliest":return"0x0";case"latest":case"pending":case"safe":case"finalized":return e}if(typeof e=="number"||Te(e))return Sf(e);throw new Error("invalid blockTag")}hash(e,r){const i=this.hex(e,r);return bs(i)!==32?Co.throwArgumentError("invalid hash","value",e):i}difficulty(e){if(e==null)return null;const r=te.from(e);try{return r.toNumber()}catch{}return null}uint256(e){if(!Te(e))throw new Error("invalid uint256");return ut(e,32)}_block(e,r){e.author!=null&&e.miner==null&&(e.miner=e.author);const i=e._difficulty!=null?e._difficulty:e.difficulty,n=re.check(r,e);return n._difficulty=i==null?null:te.from(i),n}block(e){return this._block(e,this.formats.block)}blockWithTransactions(e){return this._block(e,this.formats.blockWithTransactions)}transactionRequest(e){return re.check(this.formats.transactionRequest,e)}transactionResponse(e){e.gas!=null&&e.gasLimit==null&&(e.gasLimit=e.gas),e.to&&te.from(e.to).isZero()&&(e.to="0x0000000000000000000000000000000000000000"),e.input!=null&&e.data==null&&(e.data=e.input),e.to==null&&e.creates==null&&(e.creates=this.contractAddress(e)),(e.type===1||e.type===2)&&e.accessList==null&&(e.accessList=[]);const r=re.check(this.formats.transaction,e);if(e.chainId!=null){let i=e.chainId;Te(i)&&(i=te.from(i).toNumber()),r.chainId=i}else{let i=e.networkId;i==null&&r.v==null&&(i=e.chainId),Te(i)&&(i=te.from(i).toNumber()),typeof i!="number"&&r.v!=null&&(i=(r.v-35)/2,i<0&&(i=0),i=parseInt(i)),typeof i!="number"&&(i=0),r.chainId=i}return r.blockHash&&r.blockHash.replace(/0/g,"")==="x"&&(r.blockHash=null),r}transaction(e){return cA(e)}receiptLog(e){return re.check(this.formats.receiptLog,e)}receipt(e){const r=re.check(this.formats.receipt,e);if(r.root!=null)if(r.root.length<=4){const i=te.from(r.root).toNumber();i===0||i===1?(r.status!=null&&r.status!==i&&Co.throwArgumentError("alt-root-status/status mismatch","value",{root:r.root,status:r.status}),r.status=i,delete r.root):Co.throwArgumentError("invalid alt-root-status","value.root",r.root)}else r.root.length!==66&&Co.throwArgumentError("invalid root hash","value.root",r.root);return r.status!=null&&(r.byzantium=!0),r}topics(e){return Array.isArray(e)?e.map(r=>this.topics(r)):e!=null?this.hash(e,!0):null}filter(e){return re.check(this.formats.filter,e)}filterLog(e){return re.check(this.formats.filterLog,e)}static check(e,r){const i={};for(const n in e)try{const s=e[n](r[n]);s!==void 0&&(i[n]=s)}catch(s){throw s.checkKey=n,s.checkValue=r[n],s}return i}static allowNull(e,r){return function(i){return i==null?r:e(i)}}static allowFalsish(e,r){return function(i){return i?e(i):r}}static arrayOf(e){return function(r){if(!Array.isArray(r))throw new Error("not an array");const i=[];return r.forEach(function(n){i.push(e(n))}),i}}}var ne=function(t,e,r,i){function n(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(u){try{l(i.next(u))}catch(h){o(h)}}function c(u){try{l(i.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):n(u.value).then(a,c)}l((i=i.apply(t,e||[])).next())})};const he=new K(dl),SA=10;function fp(t){return t==null?"null":(bs(t)!==32&&he.throwArgumentError("invalid topic","topic",t),t.toLowerCase())}function dp(t){for(t=t.slice();t.length>0&&t[t.length-1]==null;)t.pop();return t.map(e=>{if(Array.isArray(e)){const r={};e.forEach(n=>{r[fp(n)]=!0});const i=Object.keys(r);return i.sort(),i.join("|")}else return fp(e)}).join("&")}function PA(t){return t===""?[]:t.split(/&/g).map(e=>{if(e==="")return[];const r=e.split("|").map(i=>i==="null"?null:i);return r.length===1?r[0]:r})}function ks(t){if(typeof t=="string"){if(t=t.toLowerCase(),bs(t)===32)return"tx:"+t;if(t.indexOf(":")===-1)return t}else{if(Array.isArray(t))return"filter:*:"+dp(t);if(hE.isForkEvent(t))throw he.warn("not implemented"),new Error("not implemented");if(t&&typeof t=="object")return"filter:"+(t.address||"*")+":"+dp(t.topics||[])}throw new Error("invalid event - "+t)}function Bo(){return new Date().getTime()}function pp(t){return new Promise(e=>{setTimeout(e,t)})}const OA=["block","network","pending","poll"];let DA=class{constructor(e,r,i){me(this,"tag",e),me(this,"listener",r),me(this,"once",i),this._lastBlockNumber=-2,this._inflight=!1}get event(){switch(this.type){case"tx":return this.hash;case"filter":return this.filter}return this.tag}get type(){return this.tag.split(":")[0]}get hash(){const e=this.tag.split(":");return e[0]!=="tx"?null:e[1]}get filter(){const e=this.tag.split(":");if(e[0]!=="filter")return null;const r=e[1],i=PA(e[2]),n={};return i.length>0&&(n.topics=i),r&&r!=="*"&&(n.address=r),n}pollable(){return this.tag.indexOf(":")>=0||OA.indexOf(this.tag)>=0}};const NA={0:{symbol:"btc",p2pkh:0,p2sh:5,prefix:"bc"},2:{symbol:"ltc",p2pkh:48,p2sh:50,prefix:"ltc"},3:{symbol:"doge",p2pkh:30,p2sh:22},60:{symbol:"eth",ilk:"eth"},61:{symbol:"etc",ilk:"eth"},700:{symbol:"xdai",ilk:"eth"}};function hu(t){return ut(te.from(t).toHexString(),32)}function gp(t){return vh.encode(hs([t,Yt(sp(sp(t)),0,4)]))}const Yy=new RegExp("^(ipfs)://(.*)$","i"),mp=[new RegExp("^(https)://(.*)$","i"),new RegExp("^(data):(.*)$","i"),Yy,new RegExp("^eip155:[0-9]+/(erc[0-9]+):(.*)$","i")];function bc(t,e){try{return al(pa(t,e))}catch{}return null}function pa(t,e){if(t==="0x")return null;const r=te.from(Yt(t,e,e+32)).toNumber(),i=te.from(Yt(t,r,r+32)).toNumber();return Yt(t,r+32,r+32+i)}function fu(t){return t.match(/^ipfs:\/\/ipfs\//i)?t=t.substring(12):t.match(/^ipfs:\/\//i)?t=t.substring(7):he.throwArgumentError("unsupported IPFS format","link",t),`https://gateway.ipfs.io/ipfs/${t}`}function yp(t){const e=le(t);if(e.length>32)throw new Error("internal; should not happen");const r=new Uint8Array(32);return r.set(e,32-e.length),r}function CA(t){if(t.length%32===0)return t;const e=new Uint8Array(Math.ceil(t.length/32)*32);return e.set(t),e}function Jy(t){const e=[];let r=0;for(let i=0;i<t.length;i++)e.push(null),r+=32;for(let i=0;i<t.length;i++){const n=le(t[i]);e[i]=yp(r),e.push(yp(n.length)),e.push(CA(n)),r+=32+Math.ceil(n.length/32)*32}return _r(e)}class wp{constructor(e,r,i,n){me(this,"provider",e),me(this,"name",i),me(this,"address",e.formatter.address(r)),me(this,"_resolvedAddress",n)}supportsWildcard(){return this._supportsEip2544||(this._supportsEip2544=this.provider.call({to:this.address,data:"0x01ffc9a79061b92300000000000000000000000000000000000000000000000000000000"}).then(e=>te.from(e).eq(1)).catch(e=>{if(e.code===K.errors.CALL_EXCEPTION)return!1;throw this._supportsEip2544=null,e})),this._supportsEip2544}_fetch(e,r){return ne(this,void 0,void 0,function*(){const i={to:this.address,ccipReadEnabled:!0,data:_r([e,mc(this.name),r||"0x"])};let n=!1;(yield this.supportsWildcard())&&(n=!0,i.data=_r(["0x9061b923",Jy([eE(this.name),i.data])]));try{let s=yield this.provider.call(i);return le(s).length%32===4&&he.throwError("resolver threw error",K.errors.CALL_EXCEPTION,{transaction:i,data:s}),n&&(s=pa(s,0)),s}catch(s){if(s.code===K.errors.CALL_EXCEPTION)return null;throw s}})}_fetchBytes(e,r){return ne(this,void 0,void 0,function*(){const i=yield this._fetch(e,r);return i!=null?pa(i,0):null})}_getAddress(e,r){const i=NA[String(e)];if(i==null&&he.throwError(`unsupported coin type: ${e}`,K.errors.UNSUPPORTED_OPERATION,{operation:`getAddress(${e})`}),i.ilk==="eth")return this.provider.formatter.address(r);const n=le(r);if(i.p2pkh!=null){const s=r.match(/^0x76a9([0-9a-f][0-9a-f])([0-9a-f]*)88ac$/);if(s){const o=parseInt(s[1],16);if(s[2].length===o*2&&o>=1&&o<=75)return gp(hs([[i.p2pkh],"0x"+s[2]]))}}if(i.p2sh!=null){const s=r.match(/^0xa9([0-9a-f][0-9a-f])([0-9a-f]*)87$/);if(s){const o=parseInt(s[1],16);if(s[2].length===o*2&&o>=1&&o<=75)return gp(hs([[i.p2sh],"0x"+s[2]]))}}if(i.prefix!=null){const s=n[1];let o=n[0];if(o===0?s!==20&&s!==32&&(o=-1):o=-1,o>=0&&n.length===2+s&&s>=1&&s<=75){const a=hp.toWords(n.slice(2));return a.unshift(o),hp.encode(i.prefix,a)}}return null}getAddress(e){return ne(this,void 0,void 0,function*(){if(e==null&&(e=60),e===60)try{const n=yield this._fetch("0x3b3b57de");return n==="0x"||n===_2?null:this.provider.formatter.callAddress(n)}catch(n){if(n.code===K.errors.CALL_EXCEPTION)return null;throw n}const r=yield this._fetchBytes("0xf1cb7e06",hu(e));if(r==null||r==="0x")return null;const i=this._getAddress(e,r);return i==null&&he.throwError("invalid or unsupported coin data",K.errors.UNSUPPORTED_OPERATION,{operation:`getAddress(${e})`,coinType:e,data:r}),i})}getAvatar(){return ne(this,void 0,void 0,function*(){const e=[{type:"name",content:this.name}];try{const r=yield this.getText("avatar");if(r==null)return null;for(let i=0;i<mp.length;i++){const n=r.match(mp[i]);if(n==null)continue;const s=n[1].toLowerCase();switch(s){case"https":return e.push({type:"url",content:r}),{linkage:e,url:r};case"data":return e.push({type:"data",content:r}),{linkage:e,url:r};case"ipfs":return e.push({type:"ipfs",content:r}),{linkage:e,url:fu(r)};case"erc721":case"erc1155":{const o=s==="erc721"?"0xc87b56dd":"0x0e89341c";e.push({type:s,content:r});const a=this._resolvedAddress||(yield this.getAddress()),c=(n[2]||"").split("/");if(c.length!==2)return null;const l=yield this.provider.formatter.address(c[0]),u=ut(te.from(c[1]).toHexString(),32);if(s==="erc721"){const E=this.provider.formatter.callAddress(yield this.provider.call({to:l,data:_r(["0x6352211e",u])}));if(a!==E)return null;e.push({type:"owner",content:E})}else if(s==="erc1155"){const E=te.from(yield this.provider.call({to:l,data:_r(["0x00fdd58e",ut(a,32),u])}));if(E.isZero())return null;e.push({type:"balance",content:E.toString()})}const h={to:this.provider.formatter.address(c[0]),data:_r([o,u])};let g=bc(yield this.provider.call(h),0);if(g==null)return null;e.push({type:"metadata-url-base",content:g}),s==="erc1155"&&(g=g.replace("{id}",u.substring(2)),e.push({type:"metadata-url-expanded",content:g})),g.match(/^ipfs:/i)&&(g=fu(g)),e.push({type:"metadata-url",content:g});const y=yield kf(g);if(!y)return null;e.push({type:"metadata",content:JSON.stringify(y)});let w=y.image;if(typeof w!="string")return null;if(!w.match(/^(https:\/\/|data:)/i)){if(w.match(Yy)==null)return null;e.push({type:"url-ipfs",content:w}),w=fu(w)}return e.push({type:"url",content:w}),{linkage:e,url:w}}}}}catch{}return null})}getContentHash(){return ne(this,void 0,void 0,function*(){const e=yield this._fetchBytes("0xbc1c58d1");if(e==null||e==="0x")return null;const r=e.match(/^0xe3010170(([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f]*))$/);if(r){const o=parseInt(r[3],16);if(r[4].length===o*2)return"ipfs://"+vh.encode("0x"+r[1])}const i=e.match(/^0xe5010172(([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f]*))$/);if(i){const o=parseInt(i[3],16);if(i[4].length===o*2)return"ipns://"+vh.encode("0x"+i[1])}const n=e.match(/^0xe40101fa011b20([0-9a-f]*)$/);if(n&&n[1].length===32*2)return"bzz://"+n[1];const s=e.match(/^0x90b2c605([0-9a-f]*)$/);if(s&&s[1].length===34*2){const o={"=":"","+":"-","/":"_"};return"sia://"+uy("0x"+s[1]).replace(/[=+\/]/g,c=>o[c])}return he.throwError("invalid or unsupported content hash data",K.errors.UNSUPPORTED_OPERATION,{operation:"getContentHash()",data:e})})}getText(e){return ne(this,void 0,void 0,function*(){let r=Xi(e);r=hs([hu(64),hu(r.length),r]),r.length%32!==0&&(r=hs([r,ut("0x",32-e.length%32)]));const i=yield this._fetchBytes("0x59d1d43c",ce(r));return i==null||i==="0x"?null:al(i)})}}let du=null,BA=1;class RA extends Nf{constructor(e){if(super(),this._events=[],this._emitted={block:-2},this.disableCcipRead=!1,this.formatter=new.target.getFormatter(),me(this,"anyNetwork",e==="any"),this.anyNetwork&&(e=this.detectNetwork()),e instanceof Promise)this._networkPromise=e,e.catch(r=>{}),this._ready().catch(r=>{});else{const r=Qo(new.target,"getNetwork")(e);r?(me(this,"_network",r),this.emit("network",r,null)):he.throwArgumentError("invalid network","network",e)}this._maxInternalBlockNumber=-1024,this._lastBlockNumber=-2,this._maxFilterBlockRange=10,this._pollingInterval=4e3,this._fastQueryDate=0}_ready(){return ne(this,void 0,void 0,function*(){if(this._network==null){let e=null;if(this._networkPromise)try{e=yield this._networkPromise}catch{}e==null&&(e=yield this.detectNetwork()),e||he.throwError("no network detected",K.errors.UNKNOWN_ERROR,{}),this._network==null&&(this.anyNetwork?this._network=e:me(this,"_network",e),this.emit("network",e,null))}return this._network})}get ready(){return Zo(()=>this._ready().then(e=>e,e=>{if(!(e.code===K.errors.NETWORK_ERROR&&e.event==="noNetwork"))throw e}))}static getFormatter(){return du==null&&(du=new re),du}static getNetwork(e){return hA(e??"homestead")}ccipReadFetch(e,r,i){return ne(this,void 0,void 0,function*(){if(this.disableCcipRead||i.length===0)return null;const n=e.to.toLowerCase(),s=r.toLowerCase(),o=[];for(let a=0;a<i.length;a++){const c=i[a],l=c.replace("{sender}",n).replace("{data}",s),u=c.indexOf("{data}")>=0?null:JSON.stringify({data:s,sender:n}),h=yield kf({url:l,errorPassThrough:!0},u,(y,w)=>(y.status=w.statusCode,y));if(h.data)return h.data;const g=h.message||"unknown error";if(h.status>=400&&h.status<500)return he.throwError(`response not found during CCIP fetch: ${g}`,K.errors.SERVER_ERROR,{url:c,errorMessage:g});o.push(g)}return he.throwError(`error encountered during CCIP fetch: ${o.map(a=>JSON.stringify(a)).join(", ")}`,K.errors.SERVER_ERROR,{urls:i,errorMessages:o})})}_getInternalBlockNumber(e){return ne(this,void 0,void 0,function*(){if(yield this._ready(),e>0)for(;this._internalBlockNumber;){const n=this._internalBlockNumber;try{const s=yield n;if(Bo()-s.respTime<=e)return s.blockNumber;break}catch{if(this._internalBlockNumber===n)break}}const r=Bo(),i=Bt({blockNumber:this.perform("getBlockNumber",{}),networkError:this.getNetwork().then(n=>null,n=>n)}).then(({blockNumber:n,networkError:s})=>{if(s)throw this._internalBlockNumber===i&&(this._internalBlockNumber=null),s;const o=Bo();return n=te.from(n).toNumber(),n<this._maxInternalBlockNumber&&(n=this._maxInternalBlockNumber),this._maxInternalBlockNumber=n,this._setFastBlockNumber(n),{blockNumber:n,reqTime:r,respTime:o}});return this._internalBlockNumber=i,i.catch(n=>{this._internalBlockNumber===i&&(this._internalBlockNumber=null)}),(yield i).blockNumber})}poll(){return ne(this,void 0,void 0,function*(){const e=BA++,r=[];let i=null;try{i=yield this._getInternalBlockNumber(100+this.pollingInterval/2)}catch(n){this.emit("error",n);return}if(this._setFastBlockNumber(i),this.emit("poll",e,i),i===this._lastBlockNumber){this.emit("didPoll",e);return}if(this._emitted.block===-2&&(this._emitted.block=i-1),Math.abs(this._emitted.block-i)>1e3)he.warn(`network block skew detected; skipping block events (emitted=${this._emitted.block} blockNumber${i})`),this.emit("error",he.makeError("network block skew detected",K.errors.NETWORK_ERROR,{blockNumber:i,event:"blockSkew",previousBlockNumber:this._emitted.block})),this.emit("block",i);else for(let n=this._emitted.block+1;n<=i;n++)this.emit("block",n);this._emitted.block!==i&&(this._emitted.block=i,Object.keys(this._emitted).forEach(n=>{if(n==="block")return;const s=this._emitted[n];s!=="pending"&&i-s>12&&delete this._emitted[n]})),this._lastBlockNumber===-2&&(this._lastBlockNumber=i-1),this._events.forEach(n=>{switch(n.type){case"tx":{const s=n.hash;let o=this.getTransactionReceipt(s).then(a=>(!a||a.blockNumber==null||(this._emitted["t:"+s]=a.blockNumber,this.emit(s,a)),null)).catch(a=>{this.emit("error",a)});r.push(o);break}case"filter":{if(!n._inflight){n._inflight=!0,n._lastBlockNumber===-2&&(n._lastBlockNumber=i-1);const s=n.filter;s.fromBlock=n._lastBlockNumber+1,s.toBlock=i;const o=s.toBlock-this._maxFilterBlockRange;o>s.fromBlock&&(s.fromBlock=o),s.fromBlock<0&&(s.fromBlock=0);const a=this.getLogs(s).then(c=>{n._inflight=!1,c.length!==0&&c.forEach(l=>{l.blockNumber>n._lastBlockNumber&&(n._lastBlockNumber=l.blockNumber),this._emitted["b:"+l.blockHash]=l.blockNumber,this._emitted["t:"+l.transactionHash]=l.blockNumber,this.emit(s,l)})}).catch(c=>{this.emit("error",c),n._inflight=!1});r.push(a)}break}}}),this._lastBlockNumber=i,Promise.all(r).then(()=>{this.emit("didPoll",e)}).catch(n=>{this.emit("error",n)})})}resetEventsBlock(e){this._lastBlockNumber=e-1,this.polling&&this.poll()}get network(){return this._network}detectNetwork(){return ne(this,void 0,void 0,function*(){return he.throwError("provider does not support network detection",K.errors.UNSUPPORTED_OPERATION,{operation:"provider.detectNetwork"})})}getNetwork(){return ne(this,void 0,void 0,function*(){const e=yield this._ready(),r=yield this.detectNetwork();if(e.chainId!==r.chainId){if(this.anyNetwork)return this._network=r,this._lastBlockNumber=-2,this._fastBlockNumber=null,this._fastBlockNumberPromise=null,this._fastQueryDate=0,this._emitted.block=-2,this._maxInternalBlockNumber=-1024,this._internalBlockNumber=null,this.emit("network",r,e),yield pp(0),this._network;const i=he.makeError("underlying network changed",K.errors.NETWORK_ERROR,{event:"changed",network:e,detectedNetwork:r});throw this.emit("error",i),i}return e})}get blockNumber(){return this._getInternalBlockNumber(100+this.pollingInterval/2).then(e=>{this._setFastBlockNumber(e)},e=>{}),this._fastBlockNumber!=null?this._fastBlockNumber:-1}get polling(){return this._poller!=null}set polling(e){e&&!this._poller?(this._poller=setInterval(()=>{this.poll()},this.pollingInterval),this._bootstrapPoll||(this._bootstrapPoll=setTimeout(()=>{this.poll(),this._bootstrapPoll=setTimeout(()=>{this._poller||this.poll(),this._bootstrapPoll=null},this.pollingInterval)},0))):!e&&this._poller&&(clearInterval(this._poller),this._poller=null)}get pollingInterval(){return this._pollingInterval}set pollingInterval(e){if(typeof e!="number"||e<=0||parseInt(String(e))!=e)throw new Error("invalid polling interval");this._pollingInterval=e,this._poller&&(clearInterval(this._poller),this._poller=setInterval(()=>{this.poll()},this._pollingInterval))}_getFastBlockNumber(){const e=Bo();return e-this._fastQueryDate>2*this._pollingInterval&&(this._fastQueryDate=e,this._fastBlockNumberPromise=this.getBlockNumber().then(r=>((this._fastBlockNumber==null||r>this._fastBlockNumber)&&(this._fastBlockNumber=r),this._fastBlockNumber))),this._fastBlockNumberPromise}_setFastBlockNumber(e){this._fastBlockNumber!=null&&e<this._fastBlockNumber||(this._fastQueryDate=Bo(),(this._fastBlockNumber==null||e>this._fastBlockNumber)&&(this._fastBlockNumber=e,this._fastBlockNumberPromise=Promise.resolve(e)))}waitForTransaction(e,r,i){return ne(this,void 0,void 0,function*(){return this._waitForTransaction(e,r??1,i||0,null)})}_waitForTransaction(e,r,i,n){return ne(this,void 0,void 0,function*(){const s=yield this.getTransactionReceipt(e);return(s?s.confirmations:0)>=r?s:new Promise((o,a)=>{const c=[];let l=!1;const u=function(){return l?!0:(l=!0,c.forEach(g=>{g()}),!1)},h=g=>{g.confirmations<r||u()||o(g)};if(this.on(e,h),c.push(()=>{this.removeListener(e,h)}),n){let g=n.startBlock,y=null;const w=E=>ne(this,void 0,void 0,function*(){l||(yield pp(1e3),this.getTransactionCount(n.from).then(P=>ne(this,void 0,void 0,function*(){if(!l){if(P<=n.nonce)g=E;else{{const N=yield this.getTransaction(e);if(N&&N.blockNumber!=null)return}for(y==null&&(y=g-3,y<n.startBlock&&(y=n.startBlock));y<=E;){if(l)return;const N=yield this.getBlockWithTransactions(y);for(let R=0;R<N.transactions.length;R++){const D=N.transactions[R];if(D.hash===e)return;if(D.from===n.from&&D.nonce===n.nonce){if(l)return;const C=yield this.waitForTransaction(D.hash,r);if(u())return;let B="replaced";D.data===n.data&&D.to===n.to&&D.value.eq(n.value)?B="repriced":D.data==="0x"&&D.from===D.to&&D.value.isZero()&&(B="cancelled"),a(he.makeError("transaction was replaced",K.errors.TRANSACTION_REPLACED,{cancelled:B==="replaced"||B==="cancelled",reason:B,replacement:this._wrapTransaction(D),hash:e,receipt:C}));return}}y++}}l||this.once("block",w)}}),P=>{l||this.once("block",w)}))});if(l)return;this.once("block",w),c.push(()=>{this.removeListener("block",w)})}if(typeof i=="number"&&i>0){const g=setTimeout(()=>{u()||a(he.makeError("timeout exceeded",K.errors.TIMEOUT,{timeout:i}))},i);g.unref&&g.unref(),c.push(()=>{clearTimeout(g)})}})})}getBlockNumber(){return ne(this,void 0,void 0,function*(){return this._getInternalBlockNumber(0)})}getGasPrice(){return ne(this,void 0,void 0,function*(){yield this.getNetwork();const e=yield this.perform("getGasPrice",{});try{return te.from(e)}catch(r){return he.throwError("bad result from backend",K.errors.SERVER_ERROR,{method:"getGasPrice",result:e,error:r})}})}getBalance(e,r){return ne(this,void 0,void 0,function*(){yield this.getNetwork();const i=yield Bt({address:this._getAddress(e),blockTag:this._getBlockTag(r)}),n=yield this.perform("getBalance",i);try{return te.from(n)}catch(s){return he.throwError("bad result from backend",K.errors.SERVER_ERROR,{method:"getBalance",params:i,result:n,error:s})}})}getTransactionCount(e,r){return ne(this,void 0,void 0,function*(){yield this.getNetwork();const i=yield Bt({address:this._getAddress(e),blockTag:this._getBlockTag(r)}),n=yield this.perform("getTransactionCount",i);try{return te.from(n).toNumber()}catch(s){return he.throwError("bad result from backend",K.errors.SERVER_ERROR,{method:"getTransactionCount",params:i,result:n,error:s})}})}getCode(e,r){return ne(this,void 0,void 0,function*(){yield this.getNetwork();const i=yield Bt({address:this._getAddress(e),blockTag:this._getBlockTag(r)}),n=yield this.perform("getCode",i);try{return ce(n)}catch(s){return he.throwError("bad result from backend",K.errors.SERVER_ERROR,{method:"getCode",params:i,result:n,error:s})}})}getStorageAt(e,r,i){return ne(this,void 0,void 0,function*(){yield this.getNetwork();const n=yield Bt({address:this._getAddress(e),blockTag:this._getBlockTag(i),position:Promise.resolve(r).then(o=>Sf(o))}),s=yield this.perform("getStorageAt",n);try{return ce(s)}catch(o){return he.throwError("bad result from backend",K.errors.SERVER_ERROR,{method:"getStorageAt",params:n,result:s,error:o})}})}_wrapTransaction(e,r,i){if(r!=null&&bs(r)!==32)throw new Error("invalid response - sendTransaction");const n=e;return r!=null&&e.hash!==r&&he.throwError("Transaction hash mismatch from Provider.sendTransaction.",K.errors.UNKNOWN_ERROR,{expectedHash:e.hash,returnedHash:r}),n.wait=(s,o)=>ne(this,void 0,void 0,function*(){s==null&&(s=1),o==null&&(o=0);let a;s!==0&&i!=null&&(a={data:e.data,from:e.from,nonce:e.nonce,to:e.to,value:e.value,startBlock:i});const c=yield this._waitForTransaction(e.hash,s,o,a);return c==null&&s===0?null:(this._emitted["t:"+e.hash]=c.blockNumber,c.status===0&&he.throwError("transaction failed",K.errors.CALL_EXCEPTION,{transactionHash:e.hash,transaction:e,receipt:c}),c)}),n}sendTransaction(e){return ne(this,void 0,void 0,function*(){yield this.getNetwork();const r=yield Promise.resolve(e).then(s=>ce(s)),i=this.formatter.transaction(e);i.confirmations==null&&(i.confirmations=0);const n=yield this._getInternalBlockNumber(100+2*this.pollingInterval);try{const s=yield this.perform("sendTransaction",{signedTransaction:r});return this._wrapTransaction(i,s,n)}catch(s){throw s.transaction=i,s.transactionHash=i.hash,s}})}_getTransactionRequest(e){return ne(this,void 0,void 0,function*(){const r=yield e,i={};return["from","to"].forEach(n=>{r[n]!=null&&(i[n]=Promise.resolve(r[n]).then(s=>s?this._getAddress(s):null))}),["gasLimit","gasPrice","maxFeePerGas","maxPriorityFeePerGas","value"].forEach(n=>{r[n]!=null&&(i[n]=Promise.resolve(r[n]).then(s=>s?te.from(s):null))}),["type"].forEach(n=>{r[n]!=null&&(i[n]=Promise.resolve(r[n]).then(s=>s??null))}),r.accessList&&(i.accessList=this.formatter.accessList(r.accessList)),["data"].forEach(n=>{r[n]!=null&&(i[n]=Promise.resolve(r[n]).then(s=>s?ce(s):null))}),this.formatter.transactionRequest(yield Bt(i))})}_getFilter(e){return ne(this,void 0,void 0,function*(){e=yield e;const r={};return e.address!=null&&(r.address=this._getAddress(e.address)),["blockHash","topics"].forEach(i=>{e[i]!=null&&(r[i]=e[i])}),["fromBlock","toBlock"].forEach(i=>{e[i]!=null&&(r[i]=this._getBlockTag(e[i]))}),this.formatter.filter(yield Bt(r))})}_call(e,r,i){return ne(this,void 0,void 0,function*(){i>=SA&&he.throwError("CCIP read exceeded maximum redirections",K.errors.SERVER_ERROR,{redirects:i,transaction:e});const n=e.to,s=yield this.perform("call",{transaction:e,blockTag:r});if(i>=0&&r==="latest"&&n!=null&&s.substring(0,10)==="0x556f1830"&&bs(s)%32===4)try{const o=Yt(s,4),a=Yt(o,0,32);te.from(a).eq(n)||he.throwError("CCIP Read sender did not match",K.errors.CALL_EXCEPTION,{name:"OffchainLookup",signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",transaction:e,data:s});const c=[],l=te.from(Yt(o,32,64)).toNumber(),u=te.from(Yt(o,l,l+32)).toNumber(),h=Yt(o,l+32);for(let N=0;N<u;N++){const R=bc(h,N*32);R==null&&he.throwError("CCIP Read contained corrupt URL string",K.errors.CALL_EXCEPTION,{name:"OffchainLookup",signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",transaction:e,data:s}),c.push(R)}const g=pa(o,64);te.from(Yt(o,100,128)).isZero()||he.throwError("CCIP Read callback selector included junk",K.errors.CALL_EXCEPTION,{name:"OffchainLookup",signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",transaction:e,data:s});const y=Yt(o,96,100),w=pa(o,128),E=yield this.ccipReadFetch(e,g,c);E==null&&he.throwError("CCIP Read disabled or provided no URLs",K.errors.CALL_EXCEPTION,{name:"OffchainLookup",signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",transaction:e,data:s});const P={to:n,data:_r([y,Jy([E,w])])};return this._call(P,r,i+1)}catch(o){if(o.code===K.errors.SERVER_ERROR)throw o}try{return ce(s)}catch(o){return he.throwError("bad result from backend",K.errors.SERVER_ERROR,{method:"call",params:{transaction:e,blockTag:r},result:s,error:o})}})}call(e,r){return ne(this,void 0,void 0,function*(){yield this.getNetwork();const i=yield Bt({transaction:this._getTransactionRequest(e),blockTag:this._getBlockTag(r),ccipReadEnabled:Promise.resolve(e.ccipReadEnabled)});return this._call(i.transaction,i.blockTag,i.ccipReadEnabled?0:-1)})}estimateGas(e){return ne(this,void 0,void 0,function*(){yield this.getNetwork();const r=yield Bt({transaction:this._getTransactionRequest(e)}),i=yield this.perform("estimateGas",r);try{return te.from(i)}catch(n){return he.throwError("bad result from backend",K.errors.SERVER_ERROR,{method:"estimateGas",params:r,result:i,error:n})}})}_getAddress(e){return ne(this,void 0,void 0,function*(){e=yield e,typeof e!="string"&&he.throwArgumentError("invalid address or ENS name","name",e);const r=yield this.resolveName(e);return r==null&&he.throwError("ENS name not configured",K.errors.UNSUPPORTED_OPERATION,{operation:`resolveName(${JSON.stringify(e)})`}),r})}_getBlock(e,r){return ne(this,void 0,void 0,function*(){yield this.getNetwork(),e=yield e;let i=-128;const n={includeTransactions:!!r};if(Te(e,32))n.blockHash=e;else try{n.blockTag=yield this._getBlockTag(e),Te(n.blockTag)&&(i=parseInt(n.blockTag.substring(2),16))}catch{he.throwArgumentError("invalid block hash or block tag","blockHashOrBlockTag",e)}return Zo(()=>ne(this,void 0,void 0,function*(){const s=yield this.perform("getBlock",n);if(s==null)return n.blockHash!=null&&this._emitted["b:"+n.blockHash]==null||n.blockTag!=null&&i>this._emitted.block?null:void 0;if(r){let o=null;for(let c=0;c<s.transactions.length;c++){const l=s.transactions[c];if(l.blockNumber==null)l.confirmations=0;else if(l.confirmations==null){o==null&&(o=yield this._getInternalBlockNumber(100+2*this.pollingInterval));let u=o-l.blockNumber+1;u<=0&&(u=1),l.confirmations=u}}const a=this.formatter.blockWithTransactions(s);return a.transactions=a.transactions.map(c=>this._wrapTransaction(c)),a}return this.formatter.block(s)}),{oncePoll:this})})}getBlock(e){return this._getBlock(e,!1)}getBlockWithTransactions(e){return this._getBlock(e,!0)}getTransaction(e){return ne(this,void 0,void 0,function*(){yield this.getNetwork(),e=yield e;const r={transactionHash:this.formatter.hash(e,!0)};return Zo(()=>ne(this,void 0,void 0,function*(){const i=yield this.perform("getTransaction",r);if(i==null)return this._emitted["t:"+e]==null?null:void 0;const n=this.formatter.transactionResponse(i);if(n.blockNumber==null)n.confirmations=0;else if(n.confirmations==null){let o=(yield this._getInternalBlockNumber(100+2*this.pollingInterval))-n.blockNumber+1;o<=0&&(o=1),n.confirmations=o}return this._wrapTransaction(n)}),{oncePoll:this})})}getTransactionReceipt(e){return ne(this,void 0,void 0,function*(){yield this.getNetwork(),e=yield e;const r={transactionHash:this.formatter.hash(e,!0)};return Zo(()=>ne(this,void 0,void 0,function*(){const i=yield this.perform("getTransactionReceipt",r);if(i==null)return this._emitted["t:"+e]==null?null:void 0;if(i.blockHash==null)return;const n=this.formatter.receipt(i);if(n.blockNumber==null)n.confirmations=0;else if(n.confirmations==null){let o=(yield this._getInternalBlockNumber(100+2*this.pollingInterval))-n.blockNumber+1;o<=0&&(o=1),n.confirmations=o}return n}),{oncePoll:this})})}getLogs(e){return ne(this,void 0,void 0,function*(){yield this.getNetwork();const r=yield Bt({filter:this._getFilter(e)}),i=yield this.perform("getLogs",r);return i.forEach(n=>{n.removed==null&&(n.removed=!1)}),re.arrayOf(this.formatter.filterLog.bind(this.formatter))(i)})}getEtherPrice(){return ne(this,void 0,void 0,function*(){return yield this.getNetwork(),this.perform("getEtherPrice",{})})}_getBlockTag(e){return ne(this,void 0,void 0,function*(){if(e=yield e,typeof e=="number"&&e<0){e%1&&he.throwArgumentError("invalid BlockTag","blockTag",e);let r=yield this._getInternalBlockNumber(100+2*this.pollingInterval);return r+=e,r<0&&(r=0),this.formatter.blockTag(r)}return this.formatter.blockTag(e)})}getResolver(e){return ne(this,void 0,void 0,function*(){let r=e;for(;;){if(r===""||r==="."||e!=="eth"&&r==="eth")return null;const i=yield this._getResolver(r,"getResolver");if(i!=null){const n=new wp(this,i,e);return r!==e&&!(yield n.supportsWildcard())?null:n}r=r.split(".").slice(1).join(".")}})}_getResolver(e,r){return ne(this,void 0,void 0,function*(){r==null&&(r="ENS");const i=yield this.getNetwork();i.ensAddress||he.throwError("network does not support ENS",K.errors.UNSUPPORTED_OPERATION,{operation:r,network:i.name});try{const n=yield this.call({to:i.ensAddress,data:"0x0178b8bf"+mc(e).substring(2)});return this.formatter.callAddress(n)}catch{}return null})}resolveName(e){return ne(this,void 0,void 0,function*(){e=yield e;try{return Promise.resolve(this.formatter.address(e))}catch(i){if(Te(e))throw i}typeof e!="string"&&he.throwArgumentError("invalid ENS name","name",e);const r=yield this.getResolver(e);return r?yield r.getAddress():null})}lookupAddress(e){return ne(this,void 0,void 0,function*(){e=yield e,e=this.formatter.address(e);const r=e.substring(2).toLowerCase()+".addr.reverse",i=yield this._getResolver(r,"lookupAddress");if(i==null)return null;const n=bc(yield this.call({to:i,data:"0x691f3431"+mc(r).substring(2)}),0);return(yield this.resolveName(n))!=e?null:n})}getAvatar(e){return ne(this,void 0,void 0,function*(){let r=null;if(Te(e)){const s=this.formatter.address(e).substring(2).toLowerCase()+".addr.reverse",o=yield this._getResolver(s,"getAvatar");if(!o)return null;r=new wp(this,o,s);try{const a=yield r.getAvatar();if(a)return a.url}catch(a){if(a.code!==K.errors.CALL_EXCEPTION)throw a}try{const a=bc(yield this.call({to:o,data:"0x691f3431"+mc(s).substring(2)}),0);r=yield this.getResolver(a)}catch(a){if(a.code!==K.errors.CALL_EXCEPTION)throw a;return null}}else if(r=yield this.getResolver(e),!r)return null;const i=yield r.getAvatar();return i==null?null:i.url})}perform(e,r){return he.throwError(e+" not implemented",K.errors.NOT_IMPLEMENTED,{operation:e})}_startEvent(e){this.polling=this._events.filter(r=>r.pollable()).length>0}_stopEvent(e){this.polling=this._events.filter(r=>r.pollable()).length>0}_addEventListener(e,r,i){const n=new DA(ks(e),r,i);return this._events.push(n),this._startEvent(n),this}on(e,r){return this._addEventListener(e,r,!1)}once(e,r){return this._addEventListener(e,r,!0)}emit(e,...r){let i=!1,n=[],s=ks(e);return this._events=this._events.filter(o=>o.tag!==s?!0:(setTimeout(()=>{o.listener.apply(this,r)},0),i=!0,o.once?(n.push(o),!1):!0)),n.forEach(o=>{this._stopEvent(o)}),i}listenerCount(e){if(!e)return this._events.length;let r=ks(e);return this._events.filter(i=>i.tag===r).length}listeners(e){if(e==null)return this._events.map(i=>i.listener);let r=ks(e);return this._events.filter(i=>i.tag===r).map(i=>i.listener)}off(e,r){if(r==null)return this.removeAllListeners(e);const i=[];let n=!1,s=ks(e);return this._events=this._events.filter(o=>o.tag!==s||o.listener!=r||n?!0:(n=!0,i.push(o),!1)),i.forEach(o=>{this._stopEvent(o)}),this}removeAllListeners(e){let r=[];if(e==null)r=this._events,this._events=[];else{const i=ks(e);this._events=this._events.filter(n=>n.tag!==i?!0:(r.push(n),!1))}return r.forEach(i=>{this._stopEvent(i)}),this}}var zi=function(t,e,r,i){function n(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(u){try{l(i.next(u))}catch(h){o(h)}}function c(u){try{l(i.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):n(u.value).then(a,c)}l((i=i.apply(t,e||[])).next())})};const pt=new K(dl),TA=["call","estimateGas"];function sa(t,e){if(t==null)return null;if(typeof t.message=="string"&&t.message.match("reverted")){const r=Te(t.data)?t.data:null;if(!e||r)return{message:t.message,data:r}}if(typeof t=="object"){for(const r in t){const i=sa(t[r],e);if(i)return i}return null}if(typeof t=="string")try{return sa(JSON.parse(t),e)}catch{}return null}function Qy(t,e,r){const i=r.transaction||r.signedTransaction;if(t==="call"){const s=sa(e,!0);if(s)return s.data;pt.throwError("missing revert data in call exception; Transaction reverted without a reason string",K.errors.CALL_EXCEPTION,{data:"0x",transaction:i,error:e})}if(t==="estimateGas"){let s=sa(e.body,!1);s==null&&(s=sa(e,!1)),s&&pt.throwError("cannot estimate gas; transaction may fail or may require manual gas limit",K.errors.UNPREDICTABLE_GAS_LIMIT,{reason:s.message,method:t,transaction:i,error:e})}let n=e.message;throw e.code===K.errors.SERVER_ERROR&&e.error&&typeof e.error.message=="string"?n=e.error.message:typeof e.body=="string"?n=e.body:typeof e.responseText=="string"&&(n=e.responseText),n=(n||"").toLowerCase(),n.match(/insufficient funds|base fee exceeds gas limit|InsufficientFunds/i)&&pt.throwError("insufficient funds for intrinsic transaction cost",K.errors.INSUFFICIENT_FUNDS,{error:e,method:t,transaction:i}),n.match(/nonce (is )?too low/i)&&pt.throwError("nonce has already been used",K.errors.NONCE_EXPIRED,{error:e,method:t,transaction:i}),n.match(/replacement transaction underpriced|transaction gas price.*too low/i)&&pt.throwError("replacement fee too low",K.errors.REPLACEMENT_UNDERPRICED,{error:e,method:t,transaction:i}),n.match(/only replay-protected/i)&&pt.throwError("legacy pre-eip-155 transactions not supported",K.errors.UNSUPPORTED_OPERATION,{error:e,method:t,transaction:i}),TA.indexOf(t)>=0&&n.match(/gas required exceeds allowance|always failing transaction|execution reverted|revert/)&&pt.throwError("cannot estimate gas; transaction may fail or may require manual gas limit",K.errors.UNPREDICTABLE_GAS_LIMIT,{error:e,method:t,transaction:i}),e}function bp(t){return new Promise(function(e){setTimeout(e,t)})}function MA(t){if(t.error){const e=new Error(t.error.message);throw e.code=t.error.code,e.data=t.error.data,e}return t.result}function Ro(t){return t&&t.toLowerCase()}const xh={};class Zy extends Cf{constructor(e,r,i){if(super(),e!==xh)throw new Error("do not call the JsonRpcSigner constructor directly; use provider.getSigner");me(this,"provider",r),i==null&&(i=0),typeof i=="string"?(me(this,"_address",this.provider.formatter.address(i)),me(this,"_index",null)):typeof i=="number"?(me(this,"_index",i),me(this,"_address",null)):pt.throwArgumentError("invalid address or index","addressOrIndex",i)}connect(e){return pt.throwError("cannot alter JSON-RPC Signer connection",K.errors.UNSUPPORTED_OPERATION,{operation:"connect"})}connectUnchecked(){return new kA(xh,this.provider,this._address||this._index)}getAddress(){return this._address?Promise.resolve(this._address):this.provider.send("eth_accounts",[]).then(e=>(e.length<=this._index&&pt.throwError("unknown account #"+this._index,K.errors.UNSUPPORTED_OPERATION,{operation:"getAddress"}),this.provider.formatter.address(e[this._index])))}sendUncheckedTransaction(e){e=cr(e);const r=this.getAddress().then(i=>(i&&(i=i.toLowerCase()),i));if(e.gasLimit==null){const i=cr(e);i.from=r,e.gasLimit=this.provider.estimateGas(i)}return e.to!=null&&(e.to=Promise.resolve(e.to).then(i=>zi(this,void 0,void 0,function*(){if(i==null)return null;const n=yield this.provider.resolveName(i);return n==null&&pt.throwArgumentError("provided ENS name resolves to null","tx.to",i),n}))),Bt({tx:Bt(e),sender:r}).then(({tx:i,sender:n})=>{i.from!=null?i.from.toLowerCase()!==n&&pt.throwArgumentError("from address mismatch","transaction",e):i.from=n;const s=this.provider.constructor.hexlifyTransaction(i,{from:!0});return this.provider.send("eth_sendTransaction",[s]).then(o=>o,o=>(typeof o.message=="string"&&o.message.match(/user denied/i)&&pt.throwError("user rejected transaction",K.errors.ACTION_REJECTED,{action:"sendTransaction",transaction:i}),Qy("sendTransaction",o,s)))})}signTransaction(e){return pt.throwError("signing transactions is unsupported",K.errors.UNSUPPORTED_OPERATION,{operation:"signTransaction"})}sendTransaction(e){return zi(this,void 0,void 0,function*(){const r=yield this.provider._getInternalBlockNumber(100+2*this.provider.pollingInterval),i=yield this.sendUncheckedTransaction(e);try{return yield Zo(()=>zi(this,void 0,void 0,function*(){const n=yield this.provider.getTransaction(i);if(n!==null)return this.provider._wrapTransaction(n,i,r)}),{oncePoll:this.provider})}catch(n){throw n.transactionHash=i,n}})}signMessage(e){return zi(this,void 0,void 0,function*(){const r=typeof e=="string"?Xi(e):e,i=yield this.getAddress();try{return yield this.provider.send("personal_sign",[ce(r),i.toLowerCase()])}catch(n){throw typeof n.message=="string"&&n.message.match(/user denied/i)&&pt.throwError("user rejected signing",K.errors.ACTION_REJECTED,{action:"signMessage",from:i,messageData:e}),n}})}_legacySignMessage(e){return zi(this,void 0,void 0,function*(){const r=typeof e=="string"?Xi(e):e,i=yield this.getAddress();try{return yield this.provider.send("eth_sign",[i.toLowerCase(),ce(r)])}catch(n){throw typeof n.message=="string"&&n.message.match(/user denied/i)&&pt.throwError("user rejected signing",K.errors.ACTION_REJECTED,{action:"_legacySignMessage",from:i,messageData:e}),n}})}_signTypedData(e,r,i){return zi(this,void 0,void 0,function*(){const n=yield br.resolveNames(e,r,i,o=>this.provider.resolveName(o)),s=yield this.getAddress();try{return yield this.provider.send("eth_signTypedData_v4",[s.toLowerCase(),JSON.stringify(br.getPayload(n.domain,r,n.value))])}catch(o){throw typeof o.message=="string"&&o.message.match(/user denied/i)&&pt.throwError("user rejected signing",K.errors.ACTION_REJECTED,{action:"_signTypedData",from:s,messageData:{domain:n.domain,types:r,value:n.value}}),o}})}unlock(e){return zi(this,void 0,void 0,function*(){const r=this.provider,i=yield this.getAddress();return r.send("personal_unlockAccount",[i.toLowerCase(),e,null])})}}class kA extends Zy{sendTransaction(e){return this.sendUncheckedTransaction(e).then(r=>({hash:r,nonce:null,gasLimit:null,gasPrice:null,data:null,value:null,chainId:null,confirmations:0,from:null,wait:i=>this.provider.waitForTransaction(r,i)}))}}const $A={chainId:!0,data:!0,gasLimit:!0,gasPrice:!0,nonce:!0,to:!0,value:!0,type:!0,accessList:!0,maxFeePerGas:!0,maxPriorityFeePerGas:!0};class UA extends RA{constructor(e,r){let i=r;i==null&&(i=new Promise((n,s)=>{setTimeout(()=>{this.detectNetwork().then(o=>{n(o)},o=>{s(o)})},0)})),super(i),e||(e=Qo(this.constructor,"defaultUrl")()),typeof e=="string"?me(this,"connection",Object.freeze({url:e})):me(this,"connection",Object.freeze(cr(e))),this._nextId=42}get _cache(){return this._eventLoopCache==null&&(this._eventLoopCache={}),this._eventLoopCache}static defaultUrl(){return"http://localhost:8545"}detectNetwork(){return this._cache.detectNetwork||(this._cache.detectNetwork=this._uncachedDetectNetwork(),setTimeout(()=>{this._cache.detectNetwork=null},0)),this._cache.detectNetwork}_uncachedDetectNetwork(){return zi(this,void 0,void 0,function*(){yield bp(0);let e=null;try{e=yield this.send("eth_chainId",[])}catch{try{e=yield this.send("net_version",[])}catch{}}if(e!=null){const r=Qo(this.constructor,"getNetwork");try{return r(te.from(e).toNumber())}catch(i){return pt.throwError("could not detect network",K.errors.NETWORK_ERROR,{chainId:e,event:"invalidNetwork",serverError:i})}}return pt.throwError("could not detect network",K.errors.NETWORK_ERROR,{event:"noNetwork"})})}getSigner(e){return new Zy(xh,this,e)}getUncheckedSigner(e){return this.getSigner(e).connectUnchecked()}listAccounts(){return this.send("eth_accounts",[]).then(e=>e.map(r=>this.formatter.address(r)))}send(e,r){const i={method:e,params:r,id:this._nextId++,jsonrpc:"2.0"};this.emit("debug",{action:"request",request:vs(i),provider:this});const n=["eth_chainId","eth_blockNumber"].indexOf(e)>=0;if(n&&this._cache[e])return this._cache[e];const s=kf(this.connection,JSON.stringify(i),MA).then(o=>(this.emit("debug",{action:"response",request:i,response:o,provider:this}),o),o=>{throw this.emit("debug",{action:"response",error:o,request:i,provider:this}),o});return n&&(this._cache[e]=s,setTimeout(()=>{this._cache[e]=null},0)),s}prepareRequest(e,r){switch(e){case"getBlockNumber":return["eth_blockNumber",[]];case"getGasPrice":return["eth_gasPrice",[]];case"getBalance":return["eth_getBalance",[Ro(r.address),r.blockTag]];case"getTransactionCount":return["eth_getTransactionCount",[Ro(r.address),r.blockTag]];case"getCode":return["eth_getCode",[Ro(r.address),r.blockTag]];case"getStorageAt":return["eth_getStorageAt",[Ro(r.address),ut(r.position,32),r.blockTag]];case"sendTransaction":return["eth_sendRawTransaction",[r.signedTransaction]];case"getBlock":return r.blockTag?["eth_getBlockByNumber",[r.blockTag,!!r.includeTransactions]]:r.blockHash?["eth_getBlockByHash",[r.blockHash,!!r.includeTransactions]]:null;case"getTransaction":return["eth_getTransactionByHash",[r.transactionHash]];case"getTransactionReceipt":return["eth_getTransactionReceipt",[r.transactionHash]];case"call":return["eth_call",[Qo(this.constructor,"hexlifyTransaction")(r.transaction,{from:!0}),r.blockTag]];case"estimateGas":return["eth_estimateGas",[Qo(this.constructor,"hexlifyTransaction")(r.transaction,{from:!0})]];case"getLogs":return r.filter&&r.filter.address!=null&&(r.filter.address=Ro(r.filter.address)),["eth_getLogs",[r.filter]]}return null}perform(e,r){return zi(this,void 0,void 0,function*(){if(e==="call"||e==="estimateGas"){const n=r.transaction;if(n&&n.type!=null&&te.from(n.type).isZero()&&n.maxFeePerGas==null&&n.maxPriorityFeePerGas==null){const s=yield this.getFeeData();s.maxFeePerGas==null&&s.maxPriorityFeePerGas==null&&(r=cr(r),r.transaction=cr(n),delete r.transaction.type)}}const i=this.prepareRequest(e,r);i==null&&pt.throwError(e+" not implemented",K.errors.NOT_IMPLEMENTED,{operation:e});try{return yield this.send(i[0],i[1])}catch(n){return Qy(e,n,r)}})}_startEvent(e){e.tag==="pending"&&this._startPending(),super._startEvent(e)}_startPending(){if(this._pendingFilter!=null)return;const e=this,r=this.send("eth_newPendingTransactionFilter",[]);this._pendingFilter=r,r.then(function(i){function n(){e.send("eth_getFilterChanges",[i]).then(function(s){if(e._pendingFilter!=r)return null;let o=Promise.resolve();return s.forEach(function(a){e._emitted["t:"+a.toLowerCase()]="pending",o=o.then(function(){return e.getTransaction(a).then(function(c){return e.emit("pending",c),null})})}),o.then(function(){return bp(1e3)})}).then(function(){if(e._pendingFilter!=r){e.send("eth_uninstallFilter",[i]);return}return setTimeout(function(){n()},0),null}).catch(s=>{})}return n(),i}).catch(i=>{})}_stopEvent(e){e.tag==="pending"&&this.listenerCount("pending")===0&&(this._pendingFilter=null),super._stopEvent(e)}static hexlifyTransaction(e,r){const i=cr($A);if(r)for(const s in r)r[s]&&(i[s]=!0);u2(e,i);const n={};return["chainId","gasLimit","gasPrice","type","maxFeePerGas","maxPriorityFeePerGas","nonce","value"].forEach(function(s){if(e[s]==null)return;const o=Sf(te.from(e[s]));s==="gasLimit"&&(s="gas"),n[s]=o}),["from","to","data"].forEach(function(s){e[s]!=null&&(n[s]=ce(e[s]))}),e.accessList&&(n.accessList=Sa(e.accessList)),n}}const vp=new K(dl);let LA=1;function Ep(t,e){const r="Web3LegacyFetcher";return function(i,n){const s={method:i,params:n,id:LA++,jsonrpc:"2.0"};return new Promise((o,a)=>{this.emit("debug",{action:"request",fetcher:r,request:vs(s),provider:this}),e(s,(c,l)=>{if(c)return this.emit("debug",{action:"response",fetcher:r,error:c,request:s,provider:this}),a(c);if(this.emit("debug",{action:"response",fetcher:r,request:s,response:l,provider:this}),l.error){const u=new Error(l.error.message);return u.code=l.error.code,u.data=l.error.data,a(u)}o(l.result)})})}}function FA(t){return function(e,r){r==null&&(r=[]);const i={method:e,params:r};return this.emit("debug",{action:"request",fetcher:"Eip1193Fetcher",request:vs(i),provider:this}),t.request(i).then(n=>(this.emit("debug",{action:"response",fetcher:"Eip1193Fetcher",request:i,response:n,provider:this}),n),n=>{throw this.emit("debug",{action:"response",fetcher:"Eip1193Fetcher",request:i,error:n,provider:this}),n})}}class Xy extends UA{constructor(e,r){e==null&&vp.throwArgumentError("missing provider","provider",e);let i=null,n=null,s=null;typeof e=="function"?(i="unknown:",n=e):(i=e.host||e.path||"",!i&&e.isMetaMask&&(i="metamask"),s=e,e.request?(i===""&&(i="eip-1193:"),n=FA(e)):e.sendAsync?n=Ep(e,e.sendAsync.bind(e)):e.send?n=Ep(e,e.send.bind(e)):vp.throwArgumentError("unsupported provider","provider",e),i||(i="unknown:")),super(i,r),me(this,"jsonRpcFetchFunc",n),me(this,"provider",s)}send(e,r){return this.jsonRpcFetchFunc(e,r)}}function qA(t,e){return gc(t,e)}function kc(t){return qA(t,18)}const jA="modulepreload",zA=function(t){return"/NOLA/"+t},xp={},HA=function(e,r,i){let n=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));n=Promise.allSettled(r.map(c=>{if(c=zA(c),c in xp)return;xp[c]=!0;const l=c.endsWith(".css"),u=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const h=document.createElement("link");if(h.rel=l?"stylesheet":jA,l||(h.as="script"),h.crossOrigin="",h.href=c,a&&h.setAttribute("nonce",a),document.head.appendChild(h),l)return new Promise((g,y)=>{h.addEventListener("load",g),h.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return n.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})};var $f={exports:{}},ro=typeof Reflect=="object"?Reflect:null,Ap=ro&&typeof ro.apply=="function"?ro.apply:function(e,r,i){return Function.prototype.apply.call(e,r,i)},vc;ro&&typeof ro.ownKeys=="function"?vc=ro.ownKeys:Object.getOwnPropertySymbols?vc=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:vc=function(e){return Object.getOwnPropertyNames(e)};function KA(t){console&&console.warn&&console.warn(t)}var ew=Number.isNaN||function(e){return e!==e};function Pe(){Pe.init.call(this)}$f.exports=Pe;$f.exports.once=YA;Pe.EventEmitter=Pe;Pe.prototype._events=void 0;Pe.prototype._eventsCount=0;Pe.prototype._maxListeners=void 0;var _p=10;function pl(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(Pe,"defaultMaxListeners",{enumerable:!0,get:function(){return _p},set:function(t){if(typeof t!="number"||t<0||ew(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");_p=t}});Pe.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Pe.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||ew(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function tw(t){return t._maxListeners===void 0?Pe.defaultMaxListeners:t._maxListeners}Pe.prototype.getMaxListeners=function(){return tw(this)};Pe.prototype.emit=function(e){for(var r=[],i=1;i<arguments.length;i++)r.push(arguments[i]);var n=e==="error",s=this._events;if(s!==void 0)n=n&&s.error===void 0;else if(!n)return!1;if(n){var o;if(r.length>0&&(o=r[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=s[e];if(c===void 0)return!1;if(typeof c=="function")Ap(c,this,r);else for(var l=c.length,u=ow(c,l),i=0;i<l;++i)Ap(u[i],this,r);return!0};function rw(t,e,r,i){var n,s,o;if(pl(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),o=s[e]),o===void 0)o=s[e]=r,++t._eventsCount;else if(typeof o=="function"?o=s[e]=i?[r,o]:[o,r]:i?o.unshift(r):o.push(r),n=tw(t),n>0&&o.length>n&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,KA(a)}return t}Pe.prototype.addListener=function(e,r){return rw(this,e,r,!1)};Pe.prototype.on=Pe.prototype.addListener;Pe.prototype.prependListener=function(e,r){return rw(this,e,r,!0)};function VA(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function iw(t,e,r){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},n=VA.bind(i);return n.listener=r,i.wrapFn=n,n}Pe.prototype.once=function(e,r){return pl(r),this.on(e,iw(this,e,r)),this};Pe.prototype.prependOnceListener=function(e,r){return pl(r),this.prependListener(e,iw(this,e,r)),this};Pe.prototype.removeListener=function(e,r){var i,n,s,o,a;if(pl(r),n=this._events,n===void 0)return this;if(i=n[e],i===void 0)return this;if(i===r||i.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,i.listener||r));else if(typeof i!="function"){for(s=-1,o=i.length-1;o>=0;o--)if(i[o]===r||i[o].listener===r){a=i[o].listener,s=o;break}if(s<0)return this;s===0?i.shift():GA(i,s),i.length===1&&(n[e]=i[0]),n.removeListener!==void 0&&this.emit("removeListener",e,a||r)}return this};Pe.prototype.off=Pe.prototype.removeListener;Pe.prototype.removeAllListeners=function(e){var r,i,n;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete i[e]),this;if(arguments.length===0){var s=Object.keys(i),o;for(n=0;n<s.length;++n)o=s[n],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=i[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(n=r.length-1;n>=0;n--)this.removeListener(e,r[n]);return this};function nw(t,e,r){var i=t._events;if(i===void 0)return[];var n=i[e];return n===void 0?[]:typeof n=="function"?r?[n.listener||n]:[n]:r?WA(n):ow(n,n.length)}Pe.prototype.listeners=function(e){return nw(this,e,!0)};Pe.prototype.rawListeners=function(e){return nw(this,e,!1)};Pe.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):sw.call(t,e)};Pe.prototype.listenerCount=sw;function sw(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}Pe.prototype.eventNames=function(){return this._eventsCount>0?vc(this._events):[]};function ow(t,e){for(var r=new Array(e),i=0;i<e;++i)r[i]=t[i];return r}function GA(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function WA(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function YA(t,e){return new Promise(function(r,i){function n(o){t.removeListener(e,s),i(o)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",n),r([].slice.call(arguments))}aw(t,e,s,{once:!0}),e!=="error"&&JA(t,n,{once:!0})})}function JA(t,e,r){typeof t.on=="function"&&aw(t,"error",e,r)}function aw(t,e,r,i){if(typeof t.on=="function")i.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function n(s){i.once&&t.removeEventListener(e,n),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var Or=$f.exports;const Uf=Os(Or);var Ip=function(t,e,r){if(r||arguments.length===2)for(var i=0,n=e.length,s;i<n;i++)(s||!(i in e))&&(s||(s=Array.prototype.slice.call(e,0,i)),s[i]=e[i]);return t.concat(s||Array.prototype.slice.call(e))},QA=function(){function t(e,r,i){this.name=e,this.version=r,this.os=i,this.type="browser"}return t}(),ZA=function(){function t(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return t}(),XA=function(){function t(e,r,i,n){this.name=e,this.version=r,this.os=i,this.bot=n,this.type="bot-device"}return t}(),e3=function(){function t(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return t}(),t3=function(){function t(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return t}(),r3=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,i3=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Sp=3,n3=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",r3]],Pp=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function s3(t){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new t3:typeof navigator<"u"?a3(navigator.userAgent):l3()}function o3(t){return t!==""&&n3.reduce(function(e,r){var i=r[0],n=r[1];if(e)return e;var s=n.exec(t);return!!s&&[i,s]},!1)}function a3(t){var e=o3(t);if(!e)return null;var r=e[0],i=e[1];if(r==="searchbot")return new e3;var n=i[1]&&i[1].split(".").join("_").split("_").slice(0,3);n?n.length<Sp&&(n=Ip(Ip([],n,!0),u3(Sp-n.length),!0)):n=[];var s=n.join("."),o=c3(t),a=i3.exec(t);return a&&a[1]?new XA(r,s,o,a[1]):new QA(r,s,o)}function c3(t){for(var e=0,r=Pp.length;e<r;e++){var i=Pp[e],n=i[0],s=i[1],o=s.exec(t);if(o)return n}return null}function l3(){var t=typeof process<"u"&&process.version;return t?new ZA(process.version.slice(1)):null}function u3(t){for(var e=[],r=0;r<t;r++)e.push("0");return e}var Q={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Ah=function(t,e){return Ah=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n])},Ah(t,e)};function h3(t,e){Ah(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var _h=function(){return _h=Object.assign||function(e){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},_h.apply(this,arguments)};function f3(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function d3(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(n<3?o(s):n>3?o(e,r,s):o(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function p3(t,e){return function(r,i){e(r,i,t)}}function g3(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function m3(t,e,r,i){function n(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(u){try{l(i.next(u))}catch(h){o(h)}}function c(u){try{l(i.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):n(u.value).then(a,c)}l((i=i.apply(t,e||[])).next())})}function y3(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(u){return c([l,u])}}function c(l){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=l[0]&2?n.return:l[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,l[1])).done)return s;switch(n=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(u){l=[6,u],n=0}finally{i=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function w3(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function b3(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Ih(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function cw(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],o;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(a){o={error:a}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}function v3(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(cw(arguments[e]));return t}function E3(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,n++)i[n]=s[o];return i}function ga(t){return this instanceof ga?(this.v=t,this):new ga(t)}function x3(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(g){i[g]&&(n[g]=function(y){return new Promise(function(w,E){s.push([g,y,w,E])>1||a(g,y)})})}function a(g,y){try{c(i[g](y))}catch(w){h(s[0][3],w)}}function c(g){g.value instanceof ga?Promise.resolve(g.value.v).then(l,u):h(s[0][2],g)}function l(g){a("next",g)}function u(g){a("throw",g)}function h(g,y){g(y),s.shift(),s.length&&a(s[0][0],s[0][1])}}function A3(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=t[n]?function(o){return(r=!r)?{value:ga(t[n](o)),done:n==="return"}:s?s(o):o}:s}}function _3(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Ih=="function"?Ih(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(s){r[s]=t[s]&&function(o){return new Promise(function(a,c){o=t[s](o),n(a,c,o.done,o.value)})}}function n(s,o,a,c){Promise.resolve(c).then(function(l){s({value:l,done:a})},o)}}function I3(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function S3(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function P3(t){return t&&t.__esModule?t:{default:t}}function O3(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function D3(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}const N3=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return _h},__asyncDelegator:A3,__asyncGenerator:x3,__asyncValues:_3,__await:ga,__awaiter:m3,__classPrivateFieldGet:O3,__classPrivateFieldSet:D3,__createBinding:w3,__decorate:d3,__exportStar:b3,__extends:h3,__generator:y3,__importDefault:P3,__importStar:S3,__makeTemplateObject:I3,__metadata:g3,__param:p3,__read:cw,__rest:f3,__spread:v3,__spreadArrays:E3,__values:Ih},Symbol.toStringTag,{value:"Module"})),Pa=Wm(N3);var pu={},To={},Op;function C3(){if(Op)return To;Op=1,Object.defineProperty(To,"__esModule",{value:!0}),To.delay=void 0;function t(e){return new Promise(r=>{setTimeout(()=>{r(!0)},e)})}return To.delay=t,To}var es={},gu={},ts={},Dp;function B3(){return Dp||(Dp=1,Object.defineProperty(ts,"__esModule",{value:!0}),ts.ONE_THOUSAND=ts.ONE_HUNDRED=void 0,ts.ONE_HUNDRED=100,ts.ONE_THOUSAND=1e3),ts}var mu={},Np;function R3(){return Np||(Np=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=t.ONE_MINUTE*5,t.TEN_MINUTES=t.ONE_MINUTE*10,t.THIRTY_MINUTES=t.ONE_MINUTE*30,t.SIXTY_MINUTES=t.ONE_MINUTE*60,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=t.ONE_HOUR*3,t.SIX_HOURS=t.ONE_HOUR*6,t.TWELVE_HOURS=t.ONE_HOUR*12,t.TWENTY_FOUR_HOURS=t.ONE_HOUR*24,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=t.ONE_DAY*3,t.FIVE_DAYS=t.ONE_DAY*5,t.SEVEN_DAYS=t.ONE_DAY*7,t.THIRTY_DAYS=t.ONE_DAY*30,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=t.ONE_WEEK*2,t.THREE_WEEKS=t.ONE_WEEK*3,t.FOUR_WEEKS=t.ONE_WEEK*4,t.ONE_YEAR=t.ONE_DAY*365}(mu)),mu}var Cp;function lw(){return Cp||(Cp=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Pa;e.__exportStar(B3(),t),e.__exportStar(R3(),t)}(gu)),gu}var Bp;function T3(){if(Bp)return es;Bp=1,Object.defineProperty(es,"__esModule",{value:!0}),es.fromMiliseconds=es.toMiliseconds=void 0;const t=lw();function e(i){return i*t.ONE_THOUSAND}es.toMiliseconds=e;function r(i){return Math.floor(i/t.ONE_THOUSAND)}return es.fromMiliseconds=r,es}var Rp;function M3(){return Rp||(Rp=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Pa;e.__exportStar(C3(),t),e.__exportStar(T3(),t)}(pu)),pu}var $s={},Tp;function k3(){if(Tp)return $s;Tp=1,Object.defineProperty($s,"__esModule",{value:!0}),$s.Watch=void 0;class t{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const i=this.get(r);if(typeof i.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const n=Date.now()-i.started;this.timestamps.set(r,{started:i.started,elapsed:n})}get(r){const i=this.timestamps.get(r);if(typeof i>"u")throw new Error(`No timestamp found for label: ${r}`);return i}elapsed(r){const i=this.get(r);return i.elapsed||Date.now()-i.started}}return $s.Watch=t,$s.default=t,$s}var yu={},Mo={},Mp;function $3(){if(Mp)return Mo;Mp=1,Object.defineProperty(Mo,"__esModule",{value:!0}),Mo.IWatch=void 0;class t{}return Mo.IWatch=t,Mo}var kp;function U3(){return kp||(kp=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Pa.__exportStar($3(),t)}(yu)),yu}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Pa;e.__exportStar(M3(),t),e.__exportStar(k3(),t),e.__exportStar(U3(),t),e.__exportStar(lw(),t)})(Q);var ke={};Object.defineProperty(ke,"__esModule",{value:!0});ke.getLocalStorage=ke.getLocalStorageOrThrow=ke.getCrypto=ke.getCryptoOrThrow=uw=ke.getLocation=ke.getLocationOrThrow=Lf=ke.getNavigator=ke.getNavigatorOrThrow=xs=ke.getDocument=ke.getDocumentOrThrow=ke.getFromWindowOrThrow=ke.getFromWindow=void 0;function Ns(t){let e;return typeof window<"u"&&typeof window[t]<"u"&&(e=window[t]),e}ke.getFromWindow=Ns;function Io(t){const e=Ns(t);if(!e)throw new Error(`${t} is not defined in Window`);return e}ke.getFromWindowOrThrow=Io;function L3(){return Io("document")}ke.getDocumentOrThrow=L3;function F3(){return Ns("document")}var xs=ke.getDocument=F3;function q3(){return Io("navigator")}ke.getNavigatorOrThrow=q3;function j3(){return Ns("navigator")}var Lf=ke.getNavigator=j3;function z3(){return Io("location")}ke.getLocationOrThrow=z3;function H3(){return Ns("location")}var uw=ke.getLocation=H3;function K3(){return Io("crypto")}ke.getCryptoOrThrow=K3;function V3(){return Ns("crypto")}ke.getCrypto=V3;function G3(){return Io("localStorage")}ke.getLocalStorageOrThrow=G3;function W3(){return Ns("localStorage")}ke.getLocalStorage=W3;var Ff={};Object.defineProperty(Ff,"__esModule",{value:!0});var hw=Ff.getWindowMetadata=void 0;const $p=ke;function Y3(){let t,e;try{t=$p.getDocumentOrThrow(),e=$p.getLocationOrThrow()}catch{return null}function r(){const h=t.getElementsByTagName("link"),g=[];for(let y=0;y<h.length;y++){const w=h[y],E=w.getAttribute("rel");if(E&&E.toLowerCase().indexOf("icon")>-1){const P=w.getAttribute("href");if(P)if(P.toLowerCase().indexOf("https:")===-1&&P.toLowerCase().indexOf("http:")===-1&&P.indexOf("//")!==0){let N=e.protocol+"//"+e.host;if(P.indexOf("/")===0)N+=P;else{const R=e.pathname.split("/");R.pop();const D=R.join("/");N+=D+"/"+P}g.push(N)}else if(P.indexOf("//")===0){const N=e.protocol+P;g.push(N)}else g.push(P)}}return g}function i(...h){const g=t.getElementsByTagName("meta");for(let y=0;y<g.length;y++){const w=g[y],E=["itemprop","property","name"].map(P=>w.getAttribute(P)).filter(P=>P?h.includes(P):!1);if(E.length&&E){const P=w.getAttribute("content");if(P)return P}}return""}function n(){let h=i("name","og:site_name","og:title","twitter:title");return h||(h=t.title),h}function s(){return i("description","og:description","twitter:description","keywords")}const o=n(),a=s(),c=e.origin,l=r();return{description:a,url:c,icons:l,name:o}}hw=Ff.getWindowMetadata=Y3;const J3="0.1.1";function Q3(){return J3}class at extends Error{constructor(e,r={}){const i=(()=>{var c;if(r.cause instanceof at){if(r.cause.details)return r.cause.details;if(r.cause.shortMessage)return r.cause.shortMessage}return r.cause&&"details"in r.cause&&typeof r.cause.details=="string"?r.cause.details:(c=r.cause)!=null&&c.message?r.cause.message:r.details})(),n=r.cause instanceof at&&r.cause.docsPath||r.docsPath,o=`https://oxlib.sh${n??""}`,a=[e||"An error occurred.",...r.metaMessages?["",...r.metaMessages]:[],...i||n?["",i?`Details: ${i}`:void 0,n?`See: ${o}`:void 0]:[]].filter(c=>typeof c=="string").join(`
`);super(a,r.cause?{cause:r.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:`ox@${Q3()}`}),this.cause=r.cause,this.details=i,this.docs=o,this.docsPath=n,this.shortMessage=e}walk(e){return fw(this,e)}}function fw(t,e){return e!=null&&e(t)?t:t&&typeof t=="object"&&"cause"in t&&t.cause?fw(t.cause,e):e?null:t}const Us=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Z3(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function ma(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function As(t,...e){if(!Z3(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function X3(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");ma(t.outputLen),ma(t.blockLen)}function po(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function dw(t,e){As(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function e_(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function go(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function wu(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function li(t,e){return t<<32-e|t>>>e}const t_=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function r_(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}function i_(t){for(let e=0;e<t.length;e++)t[e]=r_(t[e]);return t}const Up=t_?t=>t:i_;function n_(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function gl(t){return typeof t=="string"&&(t=n_(t)),As(t),t}function s_(...t){let e=0;for(let i=0;i<t.length;i++){const n=t[i];As(n),e+=n.length}const r=new Uint8Array(e);for(let i=0,n=0;i<t.length;i++){const s=t[i];r.set(s,n),n+=s.length}return r}class qf{}function pw(t){const e=i=>t().update(gl(i)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function o_(t=32){if(Us&&typeof Us.getRandomValues=="function")return Us.getRandomValues(new Uint8Array(t));if(Us&&typeof Us.randomBytes=="function")return Uint8Array.from(Us.randomBytes(t));throw new Error("crypto.getRandomValues must be defined")}function a_(t,e,r,i){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,i);const n=BigInt(32),s=BigInt(4294967295),o=Number(r>>n&s),a=Number(r&s),c=i?4:0,l=i?0:4;t.setUint32(e+c,o,i),t.setUint32(e+l,a,i)}function c_(t,e,r){return t&e^~t&r}function l_(t,e,r){return t&e^t&r^e&r}class u_ extends qf{constructor(e,r,i,n){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=r,this.padOffset=i,this.isLE=n,this.buffer=new Uint8Array(e),this.view=wu(this.buffer)}update(e){po(this),e=gl(e),As(e);const{view:r,buffer:i,blockLen:n}=this,s=e.length;for(let o=0;o<s;){const a=Math.min(n-this.pos,s-o);if(a===n){const c=wu(e);for(;n<=s-o;o+=n)this.process(c,o);continue}i.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===n&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){po(this),dw(e,this),this.finished=!0;const{buffer:r,view:i,blockLen:n,isLE:s}=this;let{pos:o}=this;r[o++]=128,go(this.buffer.subarray(o)),this.padOffset>n-o&&(this.process(i,0),o=0);for(let h=o;h<n;h++)r[h]=0;a_(i,n-8,BigInt(this.length*8),s),this.process(i,0);const a=wu(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<l;h++)a.setUint32(4*h,u[h],s)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const i=e.slice(0,r);return this.destroy(),i}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:i,length:n,finished:s,destroyed:o,pos:a}=this;return e.destroyed=o,e.finished=s,e.length=n,e.pos=a,n%r&&e.buffer.set(i),e}clone(){return this._cloneInto()}}const pn=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),za=BigInt(2**32-1),Lp=BigInt(32);function h_(t,e=!1){return e?{h:Number(t&za),l:Number(t>>Lp&za)}:{h:Number(t>>Lp&za)|0,l:Number(t&za)|0}}function f_(t,e=!1){const r=t.length;let i=new Uint32Array(r),n=new Uint32Array(r);for(let s=0;s<r;s++){const{h:o,l:a}=h_(t[s],e);[i[s],n[s]]=[o,a]}return[i,n]}const d_=(t,e,r)=>t<<r|e>>>32-r,p_=(t,e,r)=>e<<r|t>>>32-r,g_=(t,e,r)=>e<<r-32|t>>>64-r,m_=(t,e,r)=>t<<r-32|e>>>64-r,y_=BigInt(0),ko=BigInt(1),w_=BigInt(2),b_=BigInt(7),v_=BigInt(256),E_=BigInt(113),gw=[],mw=[],yw=[];for(let t=0,e=ko,r=1,i=0;t<24;t++){[r,i]=[i,(2*r+3*i)%5],gw.push(2*(5*i+r)),mw.push((t+1)*(t+2)/2%64);let n=y_;for(let s=0;s<7;s++)e=(e<<ko^(e>>b_)*E_)%v_,e&w_&&(n^=ko<<(ko<<BigInt(s))-ko);yw.push(n)}const ww=f_(yw,!0),x_=ww[0],A_=ww[1],Fp=(t,e,r)=>r>32?g_(t,e,r):d_(t,e,r),qp=(t,e,r)=>r>32?m_(t,e,r):p_(t,e,r);function __(t,e=24){const r=new Uint32Array(10);for(let i=24-e;i<24;i++){for(let o=0;o<10;o++)r[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=r[c],u=r[c+1],h=Fp(l,u,1)^r[a],g=qp(l,u,1)^r[a+1];for(let y=0;y<50;y+=10)t[o+y]^=h,t[o+y+1]^=g}let n=t[2],s=t[3];for(let o=0;o<24;o++){const a=mw[o],c=Fp(n,s,a),l=qp(n,s,a),u=gw[o];n=t[u],s=t[u+1],t[u]=c,t[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)r[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~r[(a+2)%10]&r[(a+4)%10]}t[0]^=x_[i],t[1]^=A_[i]}go(r)}class jf extends qf{constructor(e,r,i,n=!1,s=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=r,this.outputLen=i,this.enableXOF=n,this.rounds=s,ma(i),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=e_(this.state)}clone(){return this._cloneInto()}keccak(){Up(this.state32),__(this.state32,this.rounds),Up(this.state32),this.posOut=0,this.pos=0}update(e){po(this),e=gl(e),As(e);const{blockLen:r,state:i}=this,n=e.length;for(let s=0;s<n;){const o=Math.min(r-this.pos,n-s);for(let a=0;a<o;a++)i[this.pos++]^=e[s++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:r,pos:i,blockLen:n}=this;e[i]^=r,r&128&&i===n-1&&this.keccak(),e[n-1]^=128,this.keccak()}writeInto(e){po(this,!1),As(e),this.finish();const r=this.state,{blockLen:i}=this;for(let n=0,s=e.length;n<s;){this.posOut>=i&&this.keccak();const o=Math.min(i-this.posOut,s-n);e.set(r.subarray(this.posOut,this.posOut+o),n),this.posOut+=o,n+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return ma(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(dw(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,go(this.state)}_cloneInto(e){const{blockLen:r,suffix:i,outputLen:n,rounds:s,enableXOF:o}=this;return e||(e=new jf(r,i,n,o,s)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=s,e.suffix=i,e.outputLen=n,e.enableXOF=o,e.destroyed=this.destroyed,e}}const I_=(t,e,r)=>pw(()=>new jf(e,t,r)),S_=I_(1,136,256/8),P_=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),gn=new Uint32Array(64);class O_ extends u_{constructor(e=32){super(64,e,8,!1),this.A=pn[0]|0,this.B=pn[1]|0,this.C=pn[2]|0,this.D=pn[3]|0,this.E=pn[4]|0,this.F=pn[5]|0,this.G=pn[6]|0,this.H=pn[7]|0}get(){const{A:e,B:r,C:i,D:n,E:s,F:o,G:a,H:c}=this;return[e,r,i,n,s,o,a,c]}set(e,r,i,n,s,o,a,c){this.A=e|0,this.B=r|0,this.C=i|0,this.D=n|0,this.E=s|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,r){for(let h=0;h<16;h++,r+=4)gn[h]=e.getUint32(r,!1);for(let h=16;h<64;h++){const g=gn[h-15],y=gn[h-2],w=li(g,7)^li(g,18)^g>>>3,E=li(y,17)^li(y,19)^y>>>10;gn[h]=E+gn[h-7]+w+gn[h-16]|0}let{A:i,B:n,C:s,D:o,E:a,F:c,G:l,H:u}=this;for(let h=0;h<64;h++){const g=li(a,6)^li(a,11)^li(a,25),y=u+g+c_(a,c,l)+P_[h]+gn[h]|0,E=(li(i,2)^li(i,13)^li(i,22))+l_(i,n,s)|0;u=l,l=c,c=a,a=o+y|0,o=s,s=n,n=i,i=y+E|0}i=i+this.A|0,n=n+this.B|0,s=s+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(i,n,s,o,a,c,l,u)}roundClean(){go(gn)}destroy(){this.set(0,0,0,0,0,0,0,0),go(this.buffer)}}const D_=pw(()=>new O_);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const zf=BigInt(0),Sh=BigInt(1);function Oa(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Hf(t){if(!Oa(t))throw new Error("Uint8Array expected")}function ya(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}function Ha(t){const e=t.toString(16);return e.length&1?"0"+e:e}function bw(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?zf:BigInt("0x"+t)}const vw=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",N_=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function wa(t){if(Hf(t),vw)return t.toHex();let e="";for(let r=0;r<t.length;r++)e+=N_[t[r]];return e}const Ri={_0:48,_9:57,A:65,F:70,a:97,f:102};function jp(t){if(t>=Ri._0&&t<=Ri._9)return t-Ri._0;if(t>=Ri.A&&t<=Ri.F)return t-(Ri.A-10);if(t>=Ri.a&&t<=Ri.f)return t-(Ri.a-10)}function $c(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);if(vw)return Uint8Array.fromHex(t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const i=new Uint8Array(r);for(let n=0,s=0;n<r;n++,s+=2){const o=jp(t.charCodeAt(s)),a=jp(t.charCodeAt(s+1));if(o===void 0||a===void 0){const c=t[s]+t[s+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+s)}i[n]=o*16+a}return i}function ys(t){return bw(wa(t))}function Ew(t){return Hf(t),bw(wa(Uint8Array.from(t).reverse()))}function Da(t,e){return $c(t.toString(16).padStart(e*2,"0"))}function xw(t,e){return Da(t,e).reverse()}function Mr(t,e,r){let i;if(typeof e=="string")try{i=$c(e)}catch(s){throw new Error(t+" must be hex string or Uint8Array, cause: "+s)}else if(Oa(e))i=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const n=i.length;if(typeof r=="number"&&n!==r)throw new Error(t+" of length "+r+" expected, got "+n);return i}function Uc(...t){let e=0;for(let i=0;i<t.length;i++){const n=t[i];Hf(n),e+=n.length}const r=new Uint8Array(e);for(let i=0,n=0;i<t.length;i++){const s=t[i];r.set(s,n),n+=s.length}return r}const bu=t=>typeof t=="bigint"&&zf<=t;function Kf(t,e,r){return bu(t)&&bu(e)&&bu(r)&&e<=t&&t<r}function io(t,e,r,i){if(!Kf(e,r,i))throw new Error("expected valid "+t+": "+r+" <= n < "+i+", got "+e)}function C_(t){let e;for(e=0;t>zf;t>>=Sh,e+=1);return e}const ml=t=>(Sh<<BigInt(t))-Sh,vu=t=>new Uint8Array(t),zp=t=>Uint8Array.from(t);function B_(t,e,r){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let i=vu(t),n=vu(t),s=0;const o=()=>{i.fill(1),n.fill(0),s=0},a=(...h)=>r(n,i,...h),c=(h=vu(0))=>{n=a(zp([0]),h),i=a(),h.length!==0&&(n=a(zp([1]),h),i=a())},l=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let h=0;const g=[];for(;h<e;){i=a();const y=i.slice();g.push(y),h+=i.length}return Uc(...g)};return(h,g)=>{o(),c(h);let y;for(;!(y=g(l()));)c();return o(),y}}const R_={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||Oa(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function yl(t,e,r={}){const i=(n,s,o)=>{const a=R_[s];if(typeof a!="function")throw new Error("invalid validator function");const c=t[n];if(!(o&&c===void 0)&&!a(c,t))throw new Error("param "+String(n)+" is invalid. Expected "+s+", got "+c)};for(const[n,s]of Object.entries(e))i(n,s,!1);for(const[n,s]of Object.entries(r))i(n,s,!0);return t}function Hp(t){const e=new WeakMap;return(r,...i)=>{const n=e.get(r);if(n!==void 0)return n;const s=t(r,...i);return e.set(r,s),s}}function T_(t,e){if(Wp(t)>e)throw new tI({givenSize:Wp(t),maxSize:e})}const Ti={zero:48,nine:57,A:65,F:70,a:97,f:102};function Kp(t){if(t>=Ti.zero&&t<=Ti.nine)return t-Ti.zero;if(t>=Ti.A&&t<=Ti.F)return t-(Ti.A-10);if(t>=Ti.a&&t<=Ti.f)return t-(Ti.a-10)}function M_(t,e={}){const{dir:r,size:i=32}=e;if(i===0)return t;if(t.length>i)throw new rI({size:t.length,targetSize:i,type:"Bytes"});const n=new Uint8Array(i);for(let s=0;s<i;s++){const o=r==="right";n[o?s:i-s-1]=t[o?s:t.length-s-1]}return n}function Aw(t,e){if(Un(t)>e)throw new K_({givenSize:Un(t),maxSize:e})}function k_(t,e){if(typeof e=="number"&&e>0&&e>Un(t)-1)throw new Sw({offset:e,position:"start",size:Un(t)})}function $_(t,e,r){if(typeof e=="number"&&typeof r=="number"&&Un(t)!==r-e)throw new Sw({offset:r,position:"end",size:Un(t)})}function _w(t,e={}){const{dir:r,size:i=32}=e;if(i===0)return t;const n=t.replace("0x","");if(n.length>i*2)throw new V_({size:Math.ceil(n.length/2),targetSize:i,type:"Hex"});return`0x${n[r==="right"?"padEnd":"padStart"](i*2,"0")}`}const U_="#__bigint";function Vf(t,e,r){return JSON.stringify(t,(i,n)=>typeof n=="bigint"?n.toString()+U_:n,r)}const L_=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function F_(t,e={}){const{strict:r=!1}=e;if(!t)throw new Vp(t);if(typeof t!="string")throw new Vp(t);if(r&&!/^0x[0-9a-fA-F]*$/.test(t))throw new Gp(t);if(!t.startsWith("0x"))throw new Gp(t)}function q_(...t){return`0x${t.reduce((e,r)=>e+r.replace("0x",""),"")}`}function Gf(t){return t instanceof Uint8Array?Lc(t):Array.isArray(t)?Lc(new Uint8Array(t)):t}function Lc(t,e={}){let r="";for(let n=0;n<t.length;n++)r+=L_[t[n]];const i=`0x${r}`;return typeof e.size=="number"?(Aw(i,e.size),Iw(i,e.size)):i}function Eu(t,e={}){const{signed:r,size:i}=e,n=BigInt(t);let s;i?r?s=(1n<<BigInt(i)*8n-1n)-1n:s=2n**(BigInt(i)*8n)-1n:typeof t=="number"&&(s=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof s=="bigint"&&r?-s-1n:0;if(s&&n>s||n<o){const l=typeof t=="bigint"?"n":"";throw new H_({max:s?`${s}${l}`:void 0,min:`${o}${l}`,signed:r,size:i,value:`${t}${l}`})}const c=`0x${(r&&n<0?(1n<<BigInt(i*8))+BigInt(n):n).toString(16)}`;return i?j_(c,i):c}function j_(t,e){return _w(t,{dir:"left",size:e})}function Iw(t,e){return _w(t,{dir:"right",size:e})}function Hi(t,e,r,i={}){const{strict:n}=i;k_(t,e);const s=`0x${t.replace("0x","").slice((e??0)*2,(r??t.length)*2)}`;return n&&$_(s,e,r),s}function Un(t){return Math.ceil((t.length-2)/2)}function z_(t,e={}){const{strict:r=!1}=e;try{return F_(t,{strict:r}),!0}catch{return!1}}class H_ extends at{constructor({max:e,min:r,signed:i,size:n,value:s}){super(`Number \`${s}\` is not in safe${n?` ${n*8}-bit`:""}${i?" signed":" unsigned"} integer range ${e?`(\`${r}\` to \`${e}\`)`:`(above \`${r}\`)`}`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.IntegerOutOfRangeError"})}}class Vp extends at{constructor(e){super(`Value \`${typeof e=="object"?Vf(e):e}\` of type \`${typeof e}\` is an invalid hex type.`,{metaMessages:['Hex types must be represented as `"0x${string}"`.']}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.InvalidHexTypeError"})}}class Gp extends at{constructor(e){super(`Value \`${e}\` is an invalid hex value.`,{metaMessages:['Hex values must start with `"0x"` and contain only hexadecimal characters (0-9, a-f, A-F).']}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.InvalidHexValueError"})}}let K_=class extends at{constructor({givenSize:e,maxSize:r}){super(`Size cannot exceed \`${r}\` bytes. Given size: \`${e}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeOverflowError"})}};class Sw extends at{constructor({offset:e,position:r,size:i}){super(`Slice ${r==="start"?"starting":"ending"} at offset \`${e}\` is out-of-bounds (size: \`${i}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SliceOffsetOutOfBoundsError"})}}let V_=class extends at{constructor({size:e,targetSize:r,type:i}){super(`${i.charAt(0).toUpperCase()}${i.slice(1).toLowerCase()} size (\`${e}\`) exceeds padding size (\`${r}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeExceedsPaddingSizeError"})}};const G_=new TextEncoder;function W_(t){if(!(t instanceof Uint8Array)){if(!t)throw new Ka(t);if(typeof t!="object")throw new Ka(t);if(!("BYTES_PER_ELEMENT"in t))throw new Ka(t);if(t.BYTES_PER_ELEMENT!==1||t.constructor.name!=="Uint8Array")throw new Ka(t)}}function Y_(t){return t instanceof Uint8Array?t:typeof t=="string"?Q_(t):J_(t)}function J_(t){return t instanceof Uint8Array?t:new Uint8Array(t)}function Q_(t,e={}){const{size:r}=e;let i=t;r&&(Aw(t,r),i=Iw(t,r));let n=i.slice(2);n.length%2&&(n=`0${n}`);const s=n.length/2,o=new Uint8Array(s);for(let a=0,c=0;a<s;a++){const l=Kp(n.charCodeAt(c++)),u=Kp(n.charCodeAt(c++));if(l===void 0||u===void 0)throw new at(`Invalid byte sequence ("${n[c-2]}${n[c-1]}" in "${n}").`);o[a]=l*16+u}return o}function Z_(t,e={}){const{size:r}=e,i=G_.encode(t);return typeof r=="number"?(T_(i,r),X_(i,r)):i}function X_(t,e){return M_(t,{dir:"right",size:e})}function Wp(t){return t.length}function eI(t){try{return W_(t),!0}catch{return!1}}class Ka extends at{constructor(e){super(`Value \`${typeof e=="object"?Vf(e):e}\` of type \`${typeof e}\` is an invalid Bytes value.`,{metaMessages:["Bytes values must be of type `Bytes`."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.InvalidBytesTypeError"})}}class tI extends at{constructor({givenSize:e,maxSize:r}){super(`Size cannot exceed \`${r}\` bytes. Given size: \`${e}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeOverflowError"})}}class rI extends at{constructor({size:e,targetSize:r,type:i}){super(`${i.charAt(0).toUpperCase()}${i.slice(1).toLowerCase()} size (\`${e}\`) exceeds padding size (\`${r}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeExceedsPaddingSizeError"})}}function Pw(t,e={}){const{as:r=typeof t=="string"?"Hex":"Bytes"}=e,i=S_(Y_(t));return r==="Bytes"?i:Lc(i)}class iI extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const r=super.get(e);return super.has(e)&&r!==void 0&&(this.delete(e),super.set(e,r)),r}set(e,r){if(super.set(e,r),this.maxSize&&this.size>this.maxSize){const i=this.keys().next().value;i&&this.delete(i)}return this}}const nI={checksum:new iI(8192)},xu=nI.checksum;function Ow(t,e={}){const{compressed:r}=e,{prefix:i,x:n,y:s}=t;if(r===!1||typeof n=="bigint"&&typeof s=="bigint"){if(i!==4)throw new Yp({prefix:i,cause:new uI});return}if(r===!0||typeof n=="bigint"&&typeof s>"u"){if(i!==3&&i!==2)throw new Yp({prefix:i,cause:new lI});return}throw new cI({publicKey:t})}function sI(t){const e=(()=>{if(z_(t))return Dw(t);if(eI(t))return oI(t);const{prefix:r,x:i,y:n}=t;return typeof i=="bigint"&&typeof n=="bigint"?{prefix:r??4,x:i,y:n}:{prefix:r,x:i}})();return Ow(e),e}function oI(t){return Dw(Lc(t))}function Dw(t){if(t.length!==132&&t.length!==130&&t.length!==68)throw new hI({publicKey:t});if(t.length===130){const i=BigInt(Hi(t,0,32)),n=BigInt(Hi(t,32,64));return{prefix:4,x:i,y:n}}if(t.length===132){const i=Number(Hi(t,0,1)),n=BigInt(Hi(t,1,33)),s=BigInt(Hi(t,33,65));return{prefix:i,x:n,y:s}}const e=Number(Hi(t,0,1)),r=BigInt(Hi(t,1,33));return{prefix:e,x:r}}function aI(t,e={}){Ow(t);const{prefix:r,x:i,y:n}=t,{includePrefix:s=!0}=e;return q_(s?Eu(r,{size:1}):"0x",Eu(i,{size:32}),typeof n=="bigint"?Eu(n,{size:32}):"0x")}class cI extends at{constructor({publicKey:e}){super(`Value \`${Vf(e)}\` is not a valid public key.`,{metaMessages:["Public key must contain:","- an `x` and `prefix` value (compressed)","- an `x`, `y`, and `prefix` value (uncompressed)"]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidError"})}}class Yp extends at{constructor({prefix:e,cause:r}){super(`Prefix "${e}" is invalid.`,{cause:r}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidPrefixError"})}}class lI extends at{constructor(){super("Prefix must be 2 or 3 for compressed public keys."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidCompressedPrefixError"})}}class uI extends at{constructor(){super("Prefix must be 4 for uncompressed public keys."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidUncompressedPrefixError"})}}let hI=class extends at{constructor({publicKey:e}){super(`Value \`${e}\` is an invalid public key size.`,{metaMessages:["Expected: 33 bytes (compressed + prefix), 64 bytes (uncompressed) or 65 bytes (uncompressed + prefix).",`Received ${Un(Gf(e))} bytes.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidSerializedSizeError"})}};const fI=/^0x[a-fA-F0-9]{40}$/;function Nw(t,e={}){const{strict:r=!0}=e;if(!fI.test(t))throw new Jp({address:t,cause:new gI});if(r){if(t.toLowerCase()===t)return;if(Cw(t)!==t)throw new Jp({address:t,cause:new mI})}}function Cw(t){if(xu.has(t))return xu.get(t);Nw(t,{strict:!1});const e=t.substring(2).toLowerCase(),r=Pw(Z_(e),{as:"Bytes"}),i=e.split("");for(let s=0;s<40;s+=2)r[s>>1]>>4>=8&&i[s]&&(i[s]=i[s].toUpperCase()),(r[s>>1]&15)>=8&&i[s+1]&&(i[s+1]=i[s+1].toUpperCase());const n=`0x${i.join("")}`;return xu.set(t,n),n}function dI(t,e={}){const{checksum:r=!1}=e;return Nw(t),r?Cw(t):t}function pI(t,e={}){const r=Pw(`0x${aI(t).slice(4)}`).substring(26);return dI(`0x${r}`,e)}class Jp extends at{constructor({address:e,cause:r}){super(`Address "${e}" is invalid.`,{cause:r}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidAddressError"})}}class gI extends at{constructor(){super("Address is not a 20 byte (40 hexadecimal character) value."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidInputError"})}}class mI extends at{constructor(){super("Address does not match its checksum counterpart."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidChecksumError"})}}class Bw extends qf{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,X3(e);const i=gl(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const n=this.blockLen,s=new Uint8Array(n);s.set(i.length>n?e.create().update(i).digest():i);for(let o=0;o<s.length;o++)s[o]^=54;this.iHash.update(s),this.oHash=e.create();for(let o=0;o<s.length;o++)s[o]^=106;this.oHash.update(s),go(s)}update(e){return po(this),this.iHash.update(e),this}digestInto(e){po(this),As(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:r,iHash:i,finished:n,destroyed:s,blockLen:o,outputLen:a}=this;return e=e,e.finished=n,e.destroyed=s,e.blockLen=o,e.outputLen=a,e.oHash=r._cloneInto(e.oHash),e.iHash=i._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Rw=(t,e,r)=>new Bw(t,e).update(r).digest();Rw.create=(t,e)=>new Bw(t,e);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const lr=BigInt(0),Qt=BigInt(1),fs=BigInt(2),yI=BigInt(3),Tw=BigInt(4),Mw=BigInt(5),kw=BigInt(8);function sr(t,e){const r=t%e;return r>=lr?r:e+r}function Cr(t,e,r){let i=t;for(;e-- >lr;)i*=i,i%=r;return i}function Ph(t,e){if(t===lr)throw new Error("invert: expected non-zero number");if(e<=lr)throw new Error("invert: expected positive modulus, got "+e);let r=sr(t,e),i=e,n=lr,s=Qt;for(;r!==lr;){const a=i/r,c=i%r,l=n-s*a;i=r,r=c,n=s,s=l}if(i!==Qt)throw new Error("invert: does not exist");return sr(n,e)}function $w(t,e){const r=(t.ORDER+Qt)/Tw,i=t.pow(e,r);if(!t.eql(t.sqr(i),e))throw new Error("Cannot find square root");return i}function wI(t,e){const r=(t.ORDER-Mw)/kw,i=t.mul(e,fs),n=t.pow(i,r),s=t.mul(e,n),o=t.mul(t.mul(s,fs),n),a=t.mul(s,t.sub(o,t.ONE));if(!t.eql(t.sqr(a),e))throw new Error("Cannot find square root");return a}function bI(t){if(t<BigInt(3))throw new Error("sqrt is not defined for small field");let e=t-Qt,r=0;for(;e%fs===lr;)e/=fs,r++;let i=fs;const n=Wf(t);for(;Qp(n,i)===1;)if(i++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(r===1)return $w;let s=n.pow(i,e);const o=(e+Qt)/fs;return function(c,l){if(c.is0(l))return l;if(Qp(c,l)!==1)throw new Error("Cannot find square root");let u=r,h=c.mul(c.ONE,s),g=c.pow(l,e),y=c.pow(l,o);for(;!c.eql(g,c.ONE);){if(c.is0(g))return c.ZERO;let w=1,E=c.sqr(g);for(;!c.eql(E,c.ONE);)if(w++,E=c.sqr(E),w===u)throw new Error("Cannot find square root");const P=Qt<<BigInt(u-w-1),N=c.pow(h,P);u=w,h=c.sqr(N),g=c.mul(g,h),y=c.mul(y,N)}return y}}function vI(t){return t%Tw===yI?$w:t%kw===Mw?wI:bI(t)}const EI=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function xI(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=EI.reduce((i,n)=>(i[n]="function",i),e);return yl(t,r)}function AI(t,e,r){if(r<lr)throw new Error("invalid exponent, negatives unsupported");if(r===lr)return t.ONE;if(r===Qt)return e;let i=t.ONE,n=e;for(;r>lr;)r&Qt&&(i=t.mul(i,n)),n=t.sqr(n),r>>=Qt;return i}function Uw(t,e,r=!1){const i=new Array(e.length).fill(r?t.ZERO:void 0),n=e.reduce((o,a,c)=>t.is0(a)?o:(i[c]=o,t.mul(o,a)),t.ONE),s=t.inv(n);return e.reduceRight((o,a,c)=>t.is0(a)?o:(i[c]=t.mul(o,i[c]),t.mul(o,a)),s),i}function Qp(t,e){const r=(t.ORDER-Qt)/fs,i=t.pow(e,r),n=t.eql(i,t.ONE),s=t.eql(i,t.ZERO),o=t.eql(i,t.neg(t.ONE));if(!n&&!s&&!o)throw new Error("invalid Legendre symbol result");return n?1:s?0:-1}function Lw(t,e){e!==void 0&&ma(e);const r=e!==void 0?e:t.toString(2).length,i=Math.ceil(r/8);return{nBitLength:r,nByteLength:i}}function Wf(t,e,r=!1,i={}){if(t<=lr)throw new Error("invalid field: expected ORDER > 0, got "+t);const{nBitLength:n,nByteLength:s}=Lw(t,e);if(s>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:t,isLE:r,BITS:n,BYTES:s,MASK:ml(n),ZERO:lr,ONE:Qt,create:c=>sr(c,t),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return lr<=c&&c<t},is0:c=>c===lr,isOdd:c=>(c&Qt)===Qt,neg:c=>sr(-c,t),eql:(c,l)=>c===l,sqr:c=>sr(c*c,t),add:(c,l)=>sr(c+l,t),sub:(c,l)=>sr(c-l,t),mul:(c,l)=>sr(c*l,t),pow:(c,l)=>AI(a,c,l),div:(c,l)=>sr(c*Ph(l,t),t),sqrN:c=>c*c,addN:(c,l)=>c+l,subN:(c,l)=>c-l,mulN:(c,l)=>c*l,inv:c=>Ph(c,t),sqrt:i.sqrt||(c=>(o||(o=vI(t)),o(a,c))),toBytes:c=>r?xw(c,s):Da(c,s),fromBytes:c=>{if(c.length!==s)throw new Error("Field.fromBytes: expected "+s+" bytes, got "+c.length);return r?Ew(c):ys(c)},invertBatch:c=>Uw(a,c),cmov:(c,l,u)=>u?l:c});return Object.freeze(a)}function Fw(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function qw(t){const e=Fw(t);return e+Math.ceil(e/2)}function _I(t,e,r=!1){const i=t.length,n=Fw(e),s=qw(e);if(i<16||i<s||i>1024)throw new Error("expected "+s+"-1024 bytes of input, got "+i);const o=r?Ew(t):ys(t),a=sr(o,e-Qt)+Qt;return r?xw(a,n):Da(a,n)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Zp=BigInt(0),Oh=BigInt(1);function Au(t,e){const r=e.negate();return t?r:e}function jw(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function _u(t,e){jw(t,e);const r=Math.ceil(e/t)+1,i=2**(t-1),n=2**t,s=ml(t),o=BigInt(t);return{windows:r,windowSize:i,mask:s,maxNumber:n,shiftBy:o}}function Xp(t,e,r){const{windowSize:i,mask:n,maxNumber:s,shiftBy:o}=r;let a=Number(t&n),c=t>>o;a>i&&(a-=s,c+=Oh);const l=e*i,u=l+Math.abs(a)-1,h=a===0,g=a<0,y=e%2!==0;return{nextN:c,offset:u,isZero:h,isNeg:g,isNegF:y,offsetF:l}}function II(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((r,i)=>{if(!(r instanceof e))throw new Error("invalid point at index "+i)})}function SI(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((r,i)=>{if(!e.isValid(r))throw new Error("invalid scalar at index "+i)})}const Iu=new WeakMap,zw=new WeakMap;function Su(t){return zw.get(t)||1}function PI(t,e){return{constTimeNegate:Au,hasPrecomputes(r){return Su(r)!==1},unsafeLadder(r,i,n=t.ZERO){let s=r;for(;i>Zp;)i&Oh&&(n=n.add(s)),s=s.double(),i>>=Oh;return n},precomputeWindow(r,i){const{windows:n,windowSize:s}=_u(i,e),o=[];let a=r,c=a;for(let l=0;l<n;l++){c=a,o.push(c);for(let u=1;u<s;u++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(r,i,n){let s=t.ZERO,o=t.BASE;const a=_u(r,e);for(let c=0;c<a.windows;c++){const{nextN:l,offset:u,isZero:h,isNeg:g,isNegF:y,offsetF:w}=Xp(n,c,a);n=l,h?o=o.add(Au(y,i[w])):s=s.add(Au(g,i[u]))}return{p:s,f:o}},wNAFUnsafe(r,i,n,s=t.ZERO){const o=_u(r,e);for(let a=0;a<o.windows&&n!==Zp;a++){const{nextN:c,offset:l,isZero:u,isNeg:h}=Xp(n,a,o);if(n=c,!u){const g=i[l];s=s.add(h?g.negate():g)}}return s},getPrecomputes(r,i,n){let s=Iu.get(i);return s||(s=this.precomputeWindow(i,r),r!==1&&Iu.set(i,n(s))),s},wNAFCached(r,i,n){const s=Su(r);return this.wNAF(s,this.getPrecomputes(s,r,n),i)},wNAFCachedUnsafe(r,i,n,s){const o=Su(r);return o===1?this.unsafeLadder(r,i,s):this.wNAFUnsafe(o,this.getPrecomputes(o,r,n),i,s)},setWindowSize(r,i){jw(i,e),zw.set(r,i),Iu.delete(r)}}}function OI(t,e,r,i){II(r,t),SI(i,e);const n=r.length,s=i.length;if(n!==s)throw new Error("arrays of points and scalars must have equal length");const o=t.ZERO,a=C_(BigInt(n));let c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);const l=ml(c),u=new Array(Number(l)+1).fill(o),h=Math.floor((e.BITS-1)/c)*c;let g=o;for(let y=h;y>=0;y-=c){u.fill(o);for(let E=0;E<s;E++){const P=i[E],N=Number(P>>BigInt(y)&l);u[N]=u[N].add(r[E])}let w=o;for(let E=u.length-1,P=o;E>0;E--)P=P.add(u[E]),w=w.add(P);if(g=g.add(w),y!==0)for(let E=0;E<c;E++)g=g.double()}return g}function Hw(t){return xI(t.Fp),yl(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Lw(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function e0(t){t.lowS!==void 0&&ya("lowS",t.lowS),t.prehash!==void 0&&ya("prehash",t.prehash)}function DI(t){const e=Hw(t);yl(e,{a:"field",b:"field"},{allowInfinityPoint:"boolean",allowedPrivateKeyLengths:"array",clearCofactor:"function",fromBytes:"function",isTorsionFree:"function",toBytes:"function",wrapPrivateKey:"boolean"});const{endo:r,Fp:i,a:n}=e;if(r){if(!i.eql(n,i.ZERO))throw new Error("invalid endo: CURVE.a must be 0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function')}return Object.freeze({...e})}class NI extends Error{constructor(e=""){super(e)}}const Vi={Err:NI,_tlv:{encode:(t,e)=>{const{Err:r}=Vi;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(e.length&1)throw new r("tlv.encode: unpadded data");const i=e.length/2,n=Ha(i);if(n.length/2&128)throw new r("tlv.encode: long form length too big");const s=i>127?Ha(n.length/2|128):"";return Ha(t)+s+n+e},decode(t,e){const{Err:r}=Vi;let i=0;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(e.length<2||e[i++]!==t)throw new r("tlv.decode: wrong tlv");const n=e[i++],s=!!(n&128);let o=0;if(!s)o=n;else{const c=n&127;if(!c)throw new r("tlv.decode(long): indefinite length not supported");if(c>4)throw new r("tlv.decode(long): byte length is too big");const l=e.subarray(i,i+c);if(l.length!==c)throw new r("tlv.decode: length bytes not complete");if(l[0]===0)throw new r("tlv.decode(long): zero leftmost byte");for(const u of l)o=o<<8|u;if(i+=c,o<128)throw new r("tlv.decode(long): not minimal encoding")}const a=e.subarray(i,i+o);if(a.length!==o)throw new r("tlv.decode: wrong value length");return{v:a,l:e.subarray(i+o)}}},_int:{encode(t){const{Err:e}=Vi;if(t<Wi)throw new e("integer: negative integers are not allowed");let r=Ha(t);if(Number.parseInt(r[0],16)&8&&(r="00"+r),r.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return r},decode(t){const{Err:e}=Vi;if(t[0]&128)throw new e("invalid signature integer: negative");if(t[0]===0&&!(t[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return ys(t)}},toSig(t){const{Err:e,_int:r,_tlv:i}=Vi,n=Mr("signature",t),{v:s,l:o}=i.decode(48,n);if(o.length)throw new e("invalid signature: left bytes after parsing");const{v:a,l:c}=i.decode(2,s),{v:l,l:u}=i.decode(2,c);if(u.length)throw new e("invalid signature: left bytes after parsing");return{r:r.decode(a),s:r.decode(l)}},hexFromSig(t){const{_tlv:e,_int:r}=Vi,i=e.encode(2,r.encode(t.r)),n=e.encode(2,r.encode(t.s)),s=i+n;return e.encode(48,s)}};function Pu(t,e){return wa(Da(t,e))}const Wi=BigInt(0),xt=BigInt(1);BigInt(2);const Ou=BigInt(3),CI=BigInt(4);function BI(t){const e=DI(t),{Fp:r}=e,i=Wf(e.n,e.nBitLength),n=e.toBytes||((D,C,B)=>{const M=C.toAffine();return Uc(Uint8Array.from([4]),r.toBytes(M.x),r.toBytes(M.y))}),s=e.fromBytes||(D=>{const C=D.subarray(1),B=r.fromBytes(C.subarray(0,r.BYTES)),M=r.fromBytes(C.subarray(r.BYTES,2*r.BYTES));return{x:B,y:M}});function o(D){const{a:C,b:B}=e,M=r.sqr(D),L=r.mul(M,D);return r.add(r.add(L,r.mul(D,C)),B)}function a(D,C){const B=r.sqr(C),M=o(D);return r.eql(B,M)}if(!a(e.Gx,e.Gy))throw new Error("bad curve params: generator point");const c=r.mul(r.pow(e.a,Ou),CI),l=r.mul(r.sqr(e.b),BigInt(27));if(r.is0(r.add(c,l)))throw new Error("bad curve params: a or b");function u(D){return Kf(D,xt,e.n)}function h(D){const{allowedPrivateKeyLengths:C,nByteLength:B,wrapPrivateKey:M,n:L}=e;if(C&&typeof D!="bigint"){if(Oa(D)&&(D=wa(D)),typeof D!="string"||!C.includes(D.length))throw new Error("invalid private key");D=D.padStart(B*2,"0")}let F;try{F=typeof D=="bigint"?D:ys(Mr("private key",D,B))}catch{throw new Error("invalid private key, expected hex or "+B+" bytes, got "+typeof D)}return M&&(F=sr(F,L)),io("private key",F,xt,L),F}function g(D){if(!(D instanceof E))throw new Error("ProjectivePoint expected")}const y=Hp((D,C)=>{const{px:B,py:M,pz:L}=D;if(r.eql(L,r.ONE))return{x:B,y:M};const F=D.is0();C==null&&(C=F?r.ONE:r.inv(L));const k=r.mul(B,C),V=r.mul(M,C),H=r.mul(L,C);if(F)return{x:r.ZERO,y:r.ZERO};if(!r.eql(H,r.ONE))throw new Error("invZ was invalid");return{x:k,y:V}}),w=Hp(D=>{if(D.is0()){if(e.allowInfinityPoint&&!r.is0(D.py))return;throw new Error("bad point: ZERO")}const{x:C,y:B}=D.toAffine();if(!r.isValid(C)||!r.isValid(B))throw new Error("bad point: x or y not FE");if(!a(C,B))throw new Error("bad point: equation left != right");if(!D.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class E{constructor(C,B,M){if(C==null||!r.isValid(C))throw new Error("x required");if(B==null||!r.isValid(B)||r.is0(B))throw new Error("y required");if(M==null||!r.isValid(M))throw new Error("z required");this.px=C,this.py=B,this.pz=M,Object.freeze(this)}static fromAffine(C){const{x:B,y:M}=C||{};if(!C||!r.isValid(B)||!r.isValid(M))throw new Error("invalid affine point");if(C instanceof E)throw new Error("projective point not allowed");const L=F=>r.eql(F,r.ZERO);return L(B)&&L(M)?E.ZERO:new E(B,M,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(C){const B=Uw(r,C.map(M=>M.pz));return C.map((M,L)=>M.toAffine(B[L])).map(E.fromAffine)}static fromHex(C){const B=E.fromAffine(s(Mr("pointHex",C)));return B.assertValidity(),B}static fromPrivateKey(C){return E.BASE.multiply(h(C))}static msm(C,B){return OI(E,i,C,B)}_setWindowSize(C){R.setWindowSize(this,C)}assertValidity(){w(this)}hasEvenY(){const{y:C}=this.toAffine();if(r.isOdd)return!r.isOdd(C);throw new Error("Field doesn't support isOdd")}equals(C){g(C);const{px:B,py:M,pz:L}=this,{px:F,py:k,pz:V}=C,H=r.eql(r.mul(B,V),r.mul(F,L)),$=r.eql(r.mul(M,V),r.mul(k,L));return H&&$}negate(){return new E(this.px,r.neg(this.py),this.pz)}double(){const{a:C,b:B}=e,M=r.mul(B,Ou),{px:L,py:F,pz:k}=this;let V=r.ZERO,H=r.ZERO,$=r.ZERO,A=r.mul(L,L),d=r.mul(F,F),f=r.mul(k,k),p=r.mul(L,F);return p=r.add(p,p),$=r.mul(L,k),$=r.add($,$),V=r.mul(C,$),H=r.mul(M,f),H=r.add(V,H),V=r.sub(d,H),H=r.add(d,H),H=r.mul(V,H),V=r.mul(p,V),$=r.mul(M,$),f=r.mul(C,f),p=r.sub(A,f),p=r.mul(C,p),p=r.add(p,$),$=r.add(A,A),A=r.add($,A),A=r.add(A,f),A=r.mul(A,p),H=r.add(H,A),f=r.mul(F,k),f=r.add(f,f),A=r.mul(f,p),V=r.sub(V,A),$=r.mul(f,d),$=r.add($,$),$=r.add($,$),new E(V,H,$)}add(C){g(C);const{px:B,py:M,pz:L}=this,{px:F,py:k,pz:V}=C;let H=r.ZERO,$=r.ZERO,A=r.ZERO;const d=e.a,f=r.mul(e.b,Ou);let p=r.mul(B,F),b=r.mul(M,k),x=r.mul(L,V),_=r.add(B,M),S=r.add(F,k);_=r.mul(_,S),S=r.add(p,b),_=r.sub(_,S),S=r.add(B,L);let I=r.add(F,V);return S=r.mul(S,I),I=r.add(p,x),S=r.sub(S,I),I=r.add(M,L),H=r.add(k,V),I=r.mul(I,H),H=r.add(b,x),I=r.sub(I,H),A=r.mul(d,S),H=r.mul(f,x),A=r.add(H,A),H=r.sub(b,A),A=r.add(b,A),$=r.mul(H,A),b=r.add(p,p),b=r.add(b,p),x=r.mul(d,x),S=r.mul(f,S),b=r.add(b,x),x=r.sub(p,x),x=r.mul(d,x),S=r.add(S,x),p=r.mul(b,S),$=r.add($,p),p=r.mul(I,S),H=r.mul(_,H),H=r.sub(H,p),p=r.mul(_,b),A=r.mul(I,A),A=r.add(A,p),new E(H,$,A)}subtract(C){return this.add(C.negate())}is0(){return this.equals(E.ZERO)}wNAF(C){return R.wNAFCached(this,C,E.normalizeZ)}multiplyUnsafe(C){const{endo:B,n:M}=e;io("scalar",C,Wi,M);const L=E.ZERO;if(C===Wi)return L;if(this.is0()||C===xt)return this;if(!B||R.hasPrecomputes(this))return R.wNAFCachedUnsafe(this,C,E.normalizeZ);let{k1neg:F,k1:k,k2neg:V,k2:H}=B.splitScalar(C),$=L,A=L,d=this;for(;k>Wi||H>Wi;)k&xt&&($=$.add(d)),H&xt&&(A=A.add(d)),d=d.double(),k>>=xt,H>>=xt;return F&&($=$.negate()),V&&(A=A.negate()),A=new E(r.mul(A.px,B.beta),A.py,A.pz),$.add(A)}multiply(C){const{endo:B,n:M}=e;io("scalar",C,xt,M);let L,F;if(B){const{k1neg:k,k1:V,k2neg:H,k2:$}=B.splitScalar(C);let{p:A,f:d}=this.wNAF(V),{p:f,f:p}=this.wNAF($);A=R.constTimeNegate(k,A),f=R.constTimeNegate(H,f),f=new E(r.mul(f.px,B.beta),f.py,f.pz),L=A.add(f),F=d.add(p)}else{const{p:k,f:V}=this.wNAF(C);L=k,F=V}return E.normalizeZ([L,F])[0]}multiplyAndAddUnsafe(C,B,M){const L=E.BASE,F=(V,H)=>H===Wi||H===xt||!V.equals(L)?V.multiplyUnsafe(H):V.multiply(H),k=F(this,B).add(F(C,M));return k.is0()?void 0:k}toAffine(C){return y(this,C)}isTorsionFree(){const{h:C,isTorsionFree:B}=e;if(C===xt)return!0;if(B)return B(E,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:C,clearCofactor:B}=e;return C===xt?this:B?B(E,this):this.multiplyUnsafe(e.h)}toRawBytes(C=!0){return ya("isCompressed",C),this.assertValidity(),n(E,this,C)}toHex(C=!0){return ya("isCompressed",C),wa(this.toRawBytes(C))}}E.BASE=new E(e.Gx,e.Gy,r.ONE),E.ZERO=new E(r.ZERO,r.ONE,r.ZERO);const{endo:P,nBitLength:N}=e,R=PI(E,P?Math.ceil(N/2):N);return{CURVE:e,ProjectivePoint:E,normPrivateKeyToScalar:h,weierstrassEquation:o,isWithinCurveOrder:u}}function RI(t){const e=Hw(t);return yl(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function TI(t){const e=RI(t),{Fp:r,n:i,nByteLength:n,nBitLength:s}=e,o=r.BYTES+1,a=2*r.BYTES+1;function c(f){return sr(f,i)}function l(f){return Ph(f,i)}const{ProjectivePoint:u,normPrivateKeyToScalar:h,weierstrassEquation:g,isWithinCurveOrder:y}=BI({...e,toBytes(f,p,b){const x=p.toAffine(),_=r.toBytes(x.x),S=Uc;return ya("isCompressed",b),b?S(Uint8Array.from([p.hasEvenY()?2:3]),_):S(Uint8Array.from([4]),_,r.toBytes(x.y))},fromBytes(f){const p=f.length,b=f[0],x=f.subarray(1);if(p===o&&(b===2||b===3)){const _=ys(x);if(!Kf(_,xt,r.ORDER))throw new Error("Point is not on curve");const S=g(_);let I;try{I=r.sqrt(S)}catch(j){const v=j instanceof Error?": "+j.message:"";throw new Error("Point is not on curve"+v)}const m=(I&xt)===xt;return(b&1)===1!==m&&(I=r.neg(I)),{x:_,y:I}}else if(p===a&&b===4){const _=r.fromBytes(x.subarray(0,r.BYTES)),S=r.fromBytes(x.subarray(r.BYTES,2*r.BYTES));return{x:_,y:S}}else{const _=o,S=a;throw new Error("invalid Point, expected length of "+_+", or uncompressed "+S+", got "+p)}}});function w(f){const p=i>>xt;return f>p}function E(f){return w(f)?c(-f):f}const P=(f,p,b)=>ys(f.slice(p,b));class N{constructor(p,b,x){io("r",p,xt,i),io("s",b,xt,i),this.r=p,this.s=b,x!=null&&(this.recovery=x),Object.freeze(this)}static fromCompact(p){const b=n;return p=Mr("compactSignature",p,b*2),new N(P(p,0,b),P(p,b,2*b))}static fromDER(p){const{r:b,s:x}=Vi.toSig(Mr("DER",p));return new N(b,x)}assertValidity(){}addRecoveryBit(p){return new N(this.r,this.s,p)}recoverPublicKey(p){const{r:b,s:x,recovery:_}=this,S=L(Mr("msgHash",p));if(_==null||![0,1,2,3].includes(_))throw new Error("recovery id invalid");const I=_===2||_===3?b+e.n:b;if(I>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");const m=_&1?"03":"02",O=u.fromHex(m+Pu(I,r.BYTES)),j=l(I),v=c(-S*j),T=c(x*j),U=u.BASE.multiplyAndAddUnsafe(O,v,T);if(!U)throw new Error("point at infinify");return U.assertValidity(),U}hasHighS(){return w(this.s)}normalizeS(){return this.hasHighS()?new N(this.r,c(-this.s),this.recovery):this}toDERRawBytes(){return $c(this.toDERHex())}toDERHex(){return Vi.hexFromSig(this)}toCompactRawBytes(){return $c(this.toCompactHex())}toCompactHex(){const p=n;return Pu(this.r,p)+Pu(this.s,p)}}const R={isValidPrivateKey(f){try{return h(f),!0}catch{return!1}},normPrivateKeyToScalar:h,randomPrivateKey:()=>{const f=qw(e.n);return _I(e.randomBytes(f),e.n)},precompute(f=8,p=u.BASE){return p._setWindowSize(f),p.multiply(BigInt(3)),p}};function D(f,p=!0){return u.fromPrivateKey(f).toRawBytes(p)}function C(f){if(typeof f=="bigint")return!1;if(f instanceof u)return!0;const b=Mr("key",f).length,x=r.BYTES,_=x+1,S=2*x+1;if(!(e.allowedPrivateKeyLengths||n===_))return b===_||b===S}function B(f,p,b=!0){if(C(f)===!0)throw new Error("first arg must be private key");if(C(p)===!1)throw new Error("second arg must be public key");return u.fromHex(p).multiply(h(f)).toRawBytes(b)}const M=e.bits2int||function(f){if(f.length>8192)throw new Error("input is too large");const p=ys(f),b=f.length*8-s;return b>0?p>>BigInt(b):p},L=e.bits2int_modN||function(f){return c(M(f))},F=ml(s);function k(f){return io("num < 2^"+s,f,Wi,F),Da(f,n)}function V(f,p,b=H){if(["recovered","canonical"].some(z=>z in b))throw new Error("sign() legacy options not supported");const{hash:x,randomBytes:_}=e;let{lowS:S,prehash:I,extraEntropy:m}=b;S==null&&(S=!0),f=Mr("msgHash",f),e0(b),I&&(f=Mr("prehashed msgHash",x(f)));const O=L(f),j=h(p),v=[k(j),k(O)];if(m!=null&&m!==!1){const z=m===!0?_(r.BYTES):m;v.push(Mr("extraEntropy",z))}const T=Uc(...v),U=O;function q(z){const Y=M(z);if(!y(Y))return;const J=l(Y),W=u.BASE.multiply(Y).toAffine(),oe=c(W.x);if(oe===Wi)return;const X=c(J*c(U+oe*j));if(X===Wi)return;let ie=(W.x===oe?0:2)|Number(W.y&xt),Lt=X;return S&&w(X)&&(Lt=E(X),ie^=1),new N(oe,Lt,ie)}return{seed:T,k2sig:q}}const H={lowS:e.lowS,prehash:!1},$={lowS:e.lowS,prehash:!1};function A(f,p,b=H){const{seed:x,k2sig:_}=V(f,p,b),S=e;return B_(S.hash.outputLen,S.nByteLength,S.hmac)(x,_)}u.BASE._setWindowSize(8);function d(f,p,b,x=$){var ie;const _=f;p=Mr("msgHash",p),b=Mr("publicKey",b);const{lowS:S,prehash:I,format:m}=x;if(e0(x),"strict"in x)throw new Error("options.strict was renamed to lowS");if(m!==void 0&&m!=="compact"&&m!=="der")throw new Error("format must be compact or der");const O=typeof _=="string"||Oa(_),j=!O&&!m&&typeof _=="object"&&_!==null&&typeof _.r=="bigint"&&typeof _.s=="bigint";if(!O&&!j)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let v,T;try{if(j&&(v=new N(_.r,_.s)),O){try{m!=="compact"&&(v=N.fromDER(_))}catch(Lt){if(!(Lt instanceof Vi.Err))throw Lt}!v&&m!=="der"&&(v=N.fromCompact(_))}T=u.fromHex(b)}catch{return!1}if(!v||S&&v.hasHighS())return!1;I&&(p=e.hash(p));const{r:U,s:q}=v,z=L(p),Y=l(q),J=c(z*Y),W=c(U*Y),oe=(ie=u.BASE.multiplyAndAddUnsafe(T,J,W))==null?void 0:ie.toAffine();return oe?c(oe.x)===U:!1}return{CURVE:e,getPublicKey:D,getSharedSecret:B,sign:A,verify:d,ProjectivePoint:u,Signature:N,utils:R}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function MI(t){return{hash:t,hmac:(e,...r)=>Rw(t,e,s_(...r)),randomBytes:o_}}function kI(t,e){const r=i=>TI({...t,...MI(i)});return{...r(e),create:r}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Kw=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),t0=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),$I=BigInt(0),UI=BigInt(1),Dh=BigInt(2),r0=(t,e)=>(t+e/Dh)/e;function LI(t){const e=Kw,r=BigInt(3),i=BigInt(6),n=BigInt(11),s=BigInt(22),o=BigInt(23),a=BigInt(44),c=BigInt(88),l=t*t*t%e,u=l*l*t%e,h=Cr(u,r,e)*u%e,g=Cr(h,r,e)*u%e,y=Cr(g,Dh,e)*l%e,w=Cr(y,n,e)*y%e,E=Cr(w,s,e)*w%e,P=Cr(E,a,e)*E%e,N=Cr(P,c,e)*P%e,R=Cr(N,a,e)*E%e,D=Cr(R,r,e)*u%e,C=Cr(D,o,e)*w%e,B=Cr(C,i,e)*l%e,M=Cr(B,Dh,e);if(!Nh.eql(Nh.sqr(M),t))throw new Error("Cannot find square root");return M}const Nh=Wf(Kw,void 0,void 0,{sqrt:LI}),FI=kI({a:$I,b:BigInt(7),Fp:Nh,n:t0,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const e=t0,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),i=-UI*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),n=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=r,o=BigInt("0x100000000000000000000000000000000"),a=r0(s*t,e),c=r0(-i*t,e);let l=sr(t-a*r-c*n,e),u=sr(-a*i-c*s,e);const h=l>o,g=u>o;if(h&&(l=e-l),g&&(u=e-u),l>o||u>o)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:h,k1:l,k2neg:g,k2:u}}}},D_);function qI(t){if(t.length!==130&&t.length!==132)throw new zI({signature:t});const e=BigInt(Hi(t,0,32)),r=BigInt(Hi(t,32,64)),i=(()=>{const n=+`0x${t.slice(130)}`;if(!Number.isNaN(n))try{return jI(n)}catch{throw new HI({value:n})}})();return typeof i>"u"?{r:e,s:r}:{r:e,s:r,yParity:i}}function jI(t){if(t===0||t===27)return 0;if(t===1||t===28)return 1;if(t>=35)return t%2===0?1:0;throw new KI({value:t})}class zI extends at{constructor({signature:e}){super(`Value \`${e}\` is an invalid signature size.`,{metaMessages:["Expected: 64 bytes or 65 bytes.",`Received ${Un(Gf(e))} bytes.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidSerializedSizeError"})}}class HI extends at{constructor({value:e}){super(`Value \`${e}\` is an invalid y-parity value. Y-parity must be 0 or 1.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidYParityError"})}}class KI extends at{constructor({value:e}){super(`Value \`${e}\` is an invalid v value. v must be 27, 28 or >=35.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidVError"})}}/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */function VI(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Vw(t,e){return Array.isArray(e)?e.length===0?!0:t?e.every(r=>typeof r=="string"):e.every(r=>Number.isSafeInteger(r)):!1}function Fc(t,e){if(typeof e!="string")throw new Error(`${t}: string expected`);return!0}function Yf(t){if(!Number.isSafeInteger(t))throw new Error(`invalid integer: ${t}`)}function Ch(t){if(!Array.isArray(t))throw new Error("array expected")}function qc(t,e){if(!Vw(!0,e))throw new Error(`${t}: array of strings expected`)}function GI(t,e){if(!Vw(!1,e))throw new Error(`${t}: array of numbers expected`)}function WI(...t){const e=s=>s,r=(s,o)=>a=>s(o(a)),i=t.map(s=>s.encode).reduceRight(r,e),n=t.map(s=>s.decode).reduce(r,e);return{encode:i,decode:n}}function YI(t){const e=typeof t=="string"?t.split(""):t,r=e.length;qc("alphabet",e);const i=new Map(e.map((n,s)=>[n,s]));return{encode:n=>(Ch(n),n.map(s=>{if(!Number.isSafeInteger(s)||s<0||s>=r)throw new Error(`alphabet.encode: digit index outside alphabet "${s}". Allowed: ${t}`);return e[s]})),decode:n=>(Ch(n),n.map(s=>{Fc("alphabet.decode",s);const o=i.get(s);if(o===void 0)throw new Error(`Unknown letter: "${s}". Allowed: ${t}`);return o}))}}function JI(t=""){return Fc("join",t),{encode:e=>(qc("join.decode",e),e.join(t)),decode:e=>(Fc("join.decode",e),e.split(t))}}function QI(t,e="="){return Yf(t),Fc("padding",e),{encode(r){for(qc("padding.encode",r);r.length*t%8;)r.push(e);return r},decode(r){qc("padding.decode",r);let i=r.length;if(i*t%8)throw new Error("padding: invalid, string should have whole number of bytes");for(;i>0&&r[i-1]===e;i--)if((i-1)*t%8===0)throw new Error("padding: invalid, string has too much padding");return r.slice(0,i)}}}const Gw=(t,e)=>e===0?t:Gw(e,t%e),jc=(t,e)=>t+(e-Gw(t,e)),Du=(()=>{let t=[];for(let e=0;e<40;e++)t.push(2**e);return t})();function i0(t,e,r,i){if(Ch(t),e<=0||e>32)throw new Error(`convertRadix2: wrong from=${e}`);if(r<=0||r>32)throw new Error(`convertRadix2: wrong to=${r}`);if(jc(e,r)>32)throw new Error(`convertRadix2: carry overflow from=${e} to=${r} carryBits=${jc(e,r)}`);let n=0,s=0;const o=Du[e],a=Du[r]-1,c=[];for(const l of t){if(Yf(l),l>=o)throw new Error(`convertRadix2: invalid data word=${l} from=${e}`);if(n=n<<e|l,s+e>32)throw new Error(`convertRadix2: carry overflow pos=${s} from=${e}`);for(s+=e;s>=r;s-=r)c.push((n>>s-r&a)>>>0);const u=Du[s];if(u===void 0)throw new Error("invalid carry");n&=u-1}if(n=n<<r-s&a,!i&&s>=e)throw new Error("Excess padding");if(!i&&n>0)throw new Error(`Non-zero padding: ${n}`);return i&&s>0&&c.push(n>>>0),c}function ZI(t,e=!1){if(Yf(t),t<=0||t>32)throw new Error("radix2: bits should be in (0..32]");if(jc(8,t)>32||jc(t,8)>32)throw new Error("radix2: carry overflow");return{encode:r=>{if(!VI(r))throw new Error("radix2.encode input should be Uint8Array");return i0(Array.from(r),8,t,!e)},decode:r=>(GI("radix2.decode",r),Uint8Array.from(i0(r,t,8,e)))}}const XI=WI(ZI(5),YI("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),QI(5),JI(""));function e8(t){return pI(t8(t))}function t8(t){const{payload:e,signature:r}=t,{r:i,s:n,yParity:s}=r,a=new FI.Signature(BigInt(i),BigInt(n)).addRecoveryBit(s).recoverPublicKey(Gf(e).substring(2));return sI(a)}function r8(t){if(t.length>=255)throw new TypeError("Alphabet too long");const e=new Uint8Array(256);for(let l=0;l<e.length;l++)e[l]=255;for(let l=0;l<t.length;l++){const u=t.charAt(l),h=u.charCodeAt(0);if(e[h]!==255)throw new TypeError(u+" is ambiguous");e[h]=l}const r=t.length,i=t.charAt(0),n=Math.log(r)/Math.log(256),s=Math.log(256)/Math.log(r);function o(l){if(l instanceof Uint8Array||(ArrayBuffer.isView(l)?l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength):Array.isArray(l)&&(l=Uint8Array.from(l))),!(l instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(l.length===0)return"";let u=0,h=0,g=0;const y=l.length;for(;g!==y&&l[g]===0;)g++,u++;const w=(y-g)*s+1>>>0,E=new Uint8Array(w);for(;g!==y;){let R=l[g],D=0;for(let C=w-1;(R!==0||D<h)&&C!==-1;C--,D++)R+=256*E[C]>>>0,E[C]=R%r>>>0,R=R/r>>>0;if(R!==0)throw new Error("Non-zero carry");h=D,g++}let P=w-h;for(;P!==w&&E[P]===0;)P++;let N=i.repeat(u);for(;P<w;++P)N+=t.charAt(E[P]);return N}function a(l){if(typeof l!="string")throw new TypeError("Expected String");if(l.length===0)return new Uint8Array;let u=0,h=0,g=0;for(;l[u]===i;)h++,u++;const y=(l.length-u)*n+1>>>0,w=new Uint8Array(y);for(;u<l.length;){const R=l.charCodeAt(u);if(R>255)return;let D=e[R];if(D===255)return;let C=0;for(let B=y-1;(D!==0||C<g)&&B!==-1;B--,C++)D+=r*w[B]>>>0,w[B]=D%256>>>0,D=D/256>>>0;if(D!==0)throw new Error("Non-zero carry");g=C,u++}let E=y-g;for(;E!==y&&w[E]===0;)E++;const P=new Uint8Array(h+(y-E));let N=h;for(;E!==y;)P[N++]=w[E++];return P}function c(l){const u=a(l);if(u)return u;throw new Error("Non-base"+r+" character")}return{encode:o,decodeUnsafe:a,decode:c}}var i8="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";const Na=r8(i8);function n8(t){const e=t.length;let r=0,i=0;for(;i<e;){let n=t.charCodeAt(i++);if(n&4294967168)if(!(n&4294965248))r+=2;else{if(n>=55296&&n<=56319&&i<e){const s=t.charCodeAt(i);(s&64512)===56320&&(++i,n=((n&1023)<<10)+(s&1023)+65536)}n&4294901760?r+=4:r+=3}else{r++;continue}}return r}function s8(t,e,r){const i=t.length;let n=r,s=0;for(;s<i;){let o=t.charCodeAt(s++);if(o&4294967168)if(!(o&4294965248))e[n++]=o>>6&31|192;else{if(o>=55296&&o<=56319&&s<i){const a=t.charCodeAt(s);(a&64512)===56320&&(++s,o=((o&1023)<<10)+(a&1023)+65536)}o&4294901760?(e[n++]=o>>18&7|240,e[n++]=o>>12&63|128,e[n++]=o>>6&63|128):(e[n++]=o>>12&15|224,e[n++]=o>>6&63|128)}else{e[n++]=o;continue}e[n++]=o&63|128}}const o8=new TextEncoder,a8=50;function c8(t,e,r){o8.encodeInto(t,e.subarray(r))}function l8(t,e,r){t.length>a8?c8(t,e,r):s8(t,e,r)}const u8=4096;function Ww(t,e,r){let i=e;const n=i+r,s=[];let o="";for(;i<n;){const a=t[i++];if(!(a&128))s.push(a);else if((a&224)===192){const c=t[i++]&63;s.push((a&31)<<6|c)}else if((a&240)===224){const c=t[i++]&63,l=t[i++]&63;s.push((a&31)<<12|c<<6|l)}else if((a&248)===240){const c=t[i++]&63,l=t[i++]&63,u=t[i++]&63;let h=(a&7)<<18|c<<12|l<<6|u;h>65535&&(h-=65536,s.push(h>>>10&1023|55296),h=56320|h&1023),s.push(h)}else s.push(a);s.length>=u8&&(o+=String.fromCharCode(...s),s.length=0)}return s.length>0&&(o+=String.fromCharCode(...s)),o}const h8=new TextDecoder,f8=200;function d8(t,e,r){const i=t.subarray(e,e+r);return h8.decode(i)}function p8(t,e,r){return r>f8?d8(t,e,r):Ww(t,e,r)}class Va{constructor(e,r){this.type=e,this.data=r}}class vr extends Error{constructor(e){super(e);const r=Object.create(vr.prototype);Object.setPrototypeOf(this,r),Object.defineProperty(this,"name",{configurable:!0,enumerable:!1,value:vr.name})}}const $o=4294967295;function g8(t,e,r){const i=r/4294967296,n=r;t.setUint32(e,i),t.setUint32(e+4,n)}function Yw(t,e,r){const i=Math.floor(r/4294967296),n=r;t.setUint32(e,i),t.setUint32(e+4,n)}function Jw(t,e){const r=t.getInt32(e),i=t.getUint32(e+4);return r*4294967296+i}function m8(t,e){const r=t.getUint32(e),i=t.getUint32(e+4);return r*4294967296+i}const y8=-1,w8=4294967296-1,b8=17179869184-1;function v8({sec:t,nsec:e}){if(t>=0&&e>=0&&t<=b8)if(e===0&&t<=w8){const r=new Uint8Array(4);return new DataView(r.buffer).setUint32(0,t),r}else{const r=t/4294967296,i=t&4294967295,n=new Uint8Array(8),s=new DataView(n.buffer);return s.setUint32(0,e<<2|r&3),s.setUint32(4,i),n}else{const r=new Uint8Array(12),i=new DataView(r.buffer);return i.setUint32(0,e),Yw(i,4,t),r}}function E8(t){const e=t.getTime(),r=Math.floor(e/1e3),i=(e-r*1e3)*1e6,n=Math.floor(i/1e9);return{sec:r+n,nsec:i-n*1e9}}function x8(t){if(t instanceof Date){const e=E8(t);return v8(e)}else return null}function A8(t){const e=new DataView(t.buffer,t.byteOffset,t.byteLength);switch(t.byteLength){case 4:return{sec:e.getUint32(0),nsec:0};case 8:{const r=e.getUint32(0),i=e.getUint32(4),n=(r&3)*4294967296+i,s=r>>>2;return{sec:n,nsec:s}}case 12:{const r=Jw(e,4),i=e.getUint32(0);return{sec:r,nsec:i}}default:throw new vr(`Unrecognized data size for timestamp (expected 4, 8, or 12): ${t.length}`)}}function _8(t){const e=A8(t);return new Date(e.sec*1e3+e.nsec/1e6)}const I8={type:y8,encode:x8,decode:_8};class zc{constructor(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(I8)}register({type:e,encode:r,decode:i}){if(e>=0)this.encoders[e]=r,this.decoders[e]=i;else{const n=-1-e;this.builtInEncoders[n]=r,this.builtInDecoders[n]=i}}tryToEncode(e,r){for(let i=0;i<this.builtInEncoders.length;i++){const n=this.builtInEncoders[i];if(n!=null){const s=n(e,r);if(s!=null){const o=-1-i;return new Va(o,s)}}}for(let i=0;i<this.encoders.length;i++){const n=this.encoders[i];if(n!=null){const s=n(e,r);if(s!=null){const o=i;return new Va(o,s)}}}return e instanceof Va?e:null}decode(e,r,i){const n=r<0?this.builtInDecoders[-1-r]:this.decoders[r];return n?n(e,r,i):new Va(r,e)}}zc.defaultCodec=new zc;function S8(t){return t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer}function Bh(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):S8(t)?new Uint8Array(t):Uint8Array.from(t)}const P8=100,O8=2048;let D8=class Qw{constructor(e){this.entered=!1,this.extensionCodec=(e==null?void 0:e.extensionCodec)??zc.defaultCodec,this.context=e==null?void 0:e.context,this.useBigInt64=(e==null?void 0:e.useBigInt64)??!1,this.maxDepth=(e==null?void 0:e.maxDepth)??P8,this.initialBufferSize=(e==null?void 0:e.initialBufferSize)??O8,this.sortKeys=(e==null?void 0:e.sortKeys)??!1,this.forceFloat32=(e==null?void 0:e.forceFloat32)??!1,this.ignoreUndefined=(e==null?void 0:e.ignoreUndefined)??!1,this.forceIntegerToFloat=(e==null?void 0:e.forceIntegerToFloat)??!1,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}clone(){return new Qw({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,maxDepth:this.maxDepth,initialBufferSize:this.initialBufferSize,sortKeys:this.sortKeys,forceFloat32:this.forceFloat32,ignoreUndefined:this.ignoreUndefined,forceIntegerToFloat:this.forceIntegerToFloat})}reinitializeState(){this.pos=0}encodeSharedRef(e){if(this.entered)return this.clone().encodeSharedRef(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.subarray(0,this.pos)}finally{this.entered=!1}}encode(e){if(this.entered)return this.clone().encode(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.slice(0,this.pos)}finally{this.entered=!1}}doEncode(e,r){if(r>this.maxDepth)throw new Error(`Too deep objects in depth ${r}`);e==null?this.encodeNil():typeof e=="boolean"?this.encodeBoolean(e):typeof e=="number"?this.forceIntegerToFloat?this.encodeNumberAsFloat(e):this.encodeNumber(e):typeof e=="string"?this.encodeString(e):this.useBigInt64&&typeof e=="bigint"?this.encodeBigInt64(e):this.encodeObject(e,r)}ensureBufferSizeToWrite(e){const r=this.pos+e;this.view.byteLength<r&&this.resizeBuffer(r*2)}resizeBuffer(e){const r=new ArrayBuffer(e),i=new Uint8Array(r),n=new DataView(r);i.set(this.bytes),this.view=n,this.bytes=i}encodeNil(){this.writeU8(192)}encodeBoolean(e){e===!1?this.writeU8(194):this.writeU8(195)}encodeNumber(e){!this.forceIntegerToFloat&&Number.isSafeInteger(e)?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<4294967296?(this.writeU8(206),this.writeU32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-2147483648?(this.writeU8(210),this.writeI32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(211),this.writeI64(e)):this.encodeNumberAsFloat(e)}encodeNumberAsFloat(e){this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.writeF64(e))}encodeBigInt64(e){e>=BigInt(0)?(this.writeU8(207),this.writeBigUint64(e)):(this.writeU8(211),this.writeBigInt64(e))}writeStringHeader(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else if(e<4294967296)this.writeU8(219),this.writeU32(e);else throw new Error(`Too long string: ${e} bytes in UTF-8`)}encodeString(e){const i=n8(e);this.ensureBufferSizeToWrite(5+i),this.writeStringHeader(i),l8(e,this.bytes,this.pos),this.pos+=i}encodeObject(e,r){const i=this.extensionCodec.tryToEncode(e,this.context);if(i!=null)this.encodeExtension(i);else if(Array.isArray(e))this.encodeArray(e,r);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else if(typeof e=="object")this.encodeMap(e,r);else throw new Error(`Unrecognized object: ${Object.prototype.toString.apply(e)}`)}encodeBinary(e){const r=e.byteLength;if(r<256)this.writeU8(196),this.writeU8(r);else if(r<65536)this.writeU8(197),this.writeU16(r);else if(r<4294967296)this.writeU8(198),this.writeU32(r);else throw new Error(`Too large binary: ${r}`);const i=Bh(e);this.writeU8a(i)}encodeArray(e,r){const i=e.length;if(i<16)this.writeU8(144+i);else if(i<65536)this.writeU8(220),this.writeU16(i);else if(i<4294967296)this.writeU8(221),this.writeU32(i);else throw new Error(`Too large array: ${i}`);for(const n of e)this.doEncode(n,r+1)}countWithoutUndefined(e,r){let i=0;for(const n of r)e[n]!==void 0&&i++;return i}encodeMap(e,r){const i=Object.keys(e);this.sortKeys&&i.sort();const n=this.ignoreUndefined?this.countWithoutUndefined(e,i):i.length;if(n<16)this.writeU8(128+n);else if(n<65536)this.writeU8(222),this.writeU16(n);else if(n<4294967296)this.writeU8(223),this.writeU32(n);else throw new Error(`Too large map object: ${n}`);for(const s of i){const o=e[s];this.ignoreUndefined&&o===void 0||(this.encodeString(s),this.doEncode(o,r+1))}}encodeExtension(e){if(typeof e.data=="function"){const i=e.data(this.pos+6),n=i.length;if(n>=4294967296)throw new Error(`Too large extension object: ${n}`);this.writeU8(201),this.writeU32(n),this.writeI8(e.type),this.writeU8a(i);return}const r=e.data.length;if(r===1)this.writeU8(212);else if(r===2)this.writeU8(213);else if(r===4)this.writeU8(214);else if(r===8)this.writeU8(215);else if(r===16)this.writeU8(216);else if(r<256)this.writeU8(199),this.writeU8(r);else if(r<65536)this.writeU8(200),this.writeU16(r);else if(r<4294967296)this.writeU8(201),this.writeU32(r);else throw new Error(`Too large extension object: ${r}`);this.writeI8(e.type),this.writeU8a(e.data)}writeU8(e){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,e),this.pos++}writeU8a(e){const r=e.length;this.ensureBufferSizeToWrite(r),this.bytes.set(e,this.pos),this.pos+=r}writeI8(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++}writeU16(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2}writeI16(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2}writeU32(e){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4}writeI32(e){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4}writeF32(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4}writeF64(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8}writeU64(e){this.ensureBufferSizeToWrite(8),g8(this.view,this.pos,e),this.pos+=8}writeI64(e){this.ensureBufferSizeToWrite(8),Yw(this.view,this.pos,e),this.pos+=8}writeBigUint64(e){this.ensureBufferSizeToWrite(8),this.view.setBigUint64(this.pos,e),this.pos+=8}writeBigInt64(e){this.ensureBufferSizeToWrite(8),this.view.setBigInt64(this.pos,e),this.pos+=8}};function N8(t,e){return new D8(e).encodeSharedRef(t)}function Nu(t){return`${t<0?"-":""}0x${Math.abs(t).toString(16).padStart(2,"0")}`}const C8=16,B8=16;class R8{constructor(e=C8,r=B8){this.hit=0,this.miss=0,this.maxKeyLength=e,this.maxLengthPerKey=r,this.caches=[];for(let i=0;i<this.maxKeyLength;i++)this.caches.push([])}canBeCached(e){return e>0&&e<=this.maxKeyLength}find(e,r,i){const n=this.caches[i-1];e:for(const s of n){const o=s.bytes;for(let a=0;a<i;a++)if(o[a]!==e[r+a])continue e;return s.str}return null}store(e,r){const i=this.caches[e.length-1],n={bytes:e,str:r};i.length>=this.maxLengthPerKey?i[Math.random()*i.length|0]=n:i.push(n)}decode(e,r,i){const n=this.find(e,r,i);if(n!=null)return this.hit++,n;this.miss++;const s=Ww(e,r,i),o=Uint8Array.prototype.slice.call(e,r,r+i);return this.store(o,s),s}}const Rh="array",oa="map_key",Zw="map_value",T8=t=>{if(typeof t=="string"||typeof t=="number")return t;throw new vr("The type of key must be string or number but "+typeof t)};class M8{constructor(){this.stack=[],this.stackHeadPosition=-1}get length(){return this.stackHeadPosition+1}top(){return this.stack[this.stackHeadPosition]}pushArrayState(e){const r=this.getUninitializedStateFromPool();r.type=Rh,r.position=0,r.size=e,r.array=new Array(e)}pushMapState(e){const r=this.getUninitializedStateFromPool();r.type=oa,r.readCount=0,r.size=e,r.map={}}getUninitializedStateFromPool(){if(this.stackHeadPosition++,this.stackHeadPosition===this.stack.length){const e={type:void 0,size:0,array:void 0,position:0,readCount:0,map:void 0,key:null};this.stack.push(e)}return this.stack[this.stackHeadPosition]}release(e){if(this.stack[this.stackHeadPosition]!==e)throw new Error("Invalid stack state. Released state is not on top of the stack.");if(e.type===Rh){const i=e;i.size=0,i.array=void 0,i.position=0,i.type=void 0}if(e.type===oa||e.type===Zw){const i=e;i.size=0,i.map=void 0,i.readCount=0,i.type=void 0}this.stackHeadPosition--}reset(){this.stack.length=0,this.stackHeadPosition=-1}}const Uo=-1,Jf=new DataView(new ArrayBuffer(0)),k8=new Uint8Array(Jf.buffer);try{Jf.getInt8(0)}catch(t){if(!(t instanceof RangeError))throw new Error("This module is not supported in the current JavaScript engine because DataView does not throw RangeError on out-of-bounds access")}const n0=new RangeError("Insufficient data"),$8=new R8;let U8=class Xw{constructor(e){this.totalPos=0,this.pos=0,this.view=Jf,this.bytes=k8,this.headByte=Uo,this.stack=new M8,this.entered=!1,this.extensionCodec=(e==null?void 0:e.extensionCodec)??zc.defaultCodec,this.context=e==null?void 0:e.context,this.useBigInt64=(e==null?void 0:e.useBigInt64)??!1,this.rawStrings=(e==null?void 0:e.rawStrings)??!1,this.maxStrLength=(e==null?void 0:e.maxStrLength)??$o,this.maxBinLength=(e==null?void 0:e.maxBinLength)??$o,this.maxArrayLength=(e==null?void 0:e.maxArrayLength)??$o,this.maxMapLength=(e==null?void 0:e.maxMapLength)??$o,this.maxExtLength=(e==null?void 0:e.maxExtLength)??$o,this.keyDecoder=(e==null?void 0:e.keyDecoder)!==void 0?e.keyDecoder:$8,this.mapKeyConverter=(e==null?void 0:e.mapKeyConverter)??T8}clone(){return new Xw({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,rawStrings:this.rawStrings,maxStrLength:this.maxStrLength,maxBinLength:this.maxBinLength,maxArrayLength:this.maxArrayLength,maxMapLength:this.maxMapLength,maxExtLength:this.maxExtLength,keyDecoder:this.keyDecoder})}reinitializeState(){this.totalPos=0,this.headByte=Uo,this.stack.reset()}setBuffer(e){const r=Bh(e);this.bytes=r,this.view=new DataView(r.buffer,r.byteOffset,r.byteLength),this.pos=0}appendBuffer(e){if(this.headByte===Uo&&!this.hasRemaining(1))this.setBuffer(e);else{const r=this.bytes.subarray(this.pos),i=Bh(e),n=new Uint8Array(r.length+i.length);n.set(r),n.set(i,r.length),this.setBuffer(n)}}hasRemaining(e){return this.view.byteLength-this.pos>=e}createExtraByteError(e){const{view:r,pos:i}=this;return new RangeError(`Extra ${r.byteLength-i} of ${r.byteLength} byte(s) found at buffer[${e}]`)}decode(e){if(this.entered)return this.clone().decode(e);try{this.entered=!0,this.reinitializeState(),this.setBuffer(e);const r=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return r}finally{this.entered=!1}}*decodeMulti(e){if(this.entered){yield*this.clone().decodeMulti(e);return}try{for(this.entered=!0,this.reinitializeState(),this.setBuffer(e);this.hasRemaining(1);)yield this.doDecodeSync()}finally{this.entered=!1}}async decodeAsync(e){if(this.entered)return this.clone().decodeAsync(e);try{this.entered=!0;let r=!1,i;for await(const a of e){if(r)throw this.entered=!1,this.createExtraByteError(this.totalPos);this.appendBuffer(a);try{i=this.doDecodeSync(),r=!0}catch(c){if(!(c instanceof RangeError))throw c}this.totalPos+=this.pos}if(r){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return i}const{headByte:n,pos:s,totalPos:o}=this;throw new RangeError(`Insufficient data in parsing ${Nu(n)} at ${o} (${s} in the current buffer)`)}finally{this.entered=!1}}decodeArrayStream(e){return this.decodeMultiAsync(e,!0)}decodeStream(e){return this.decodeMultiAsync(e,!1)}async*decodeMultiAsync(e,r){if(this.entered){yield*this.clone().decodeMultiAsync(e,r);return}try{this.entered=!0;let i=r,n=-1;for await(const s of e){if(r&&n===0)throw this.createExtraByteError(this.totalPos);this.appendBuffer(s),i&&(n=this.readArraySize(),i=!1,this.complete());try{for(;yield this.doDecodeSync(),--n!==0;);}catch(o){if(!(o instanceof RangeError))throw o}this.totalPos+=this.pos}}finally{this.entered=!1}}doDecodeSync(){e:for(;;){const e=this.readHeadByte();let r;if(e>=224)r=e-256;else if(e<192)if(e<128)r=e;else if(e<144){const n=e-128;if(n!==0){this.pushMapState(n),this.complete();continue e}else r={}}else if(e<160){const n=e-144;if(n!==0){this.pushArrayState(n),this.complete();continue e}else r=[]}else{const n=e-160;r=this.decodeString(n,0)}else if(e===192)r=null;else if(e===194)r=!1;else if(e===195)r=!0;else if(e===202)r=this.readF32();else if(e===203)r=this.readF64();else if(e===204)r=this.readU8();else if(e===205)r=this.readU16();else if(e===206)r=this.readU32();else if(e===207)this.useBigInt64?r=this.readU64AsBigInt():r=this.readU64();else if(e===208)r=this.readI8();else if(e===209)r=this.readI16();else if(e===210)r=this.readI32();else if(e===211)this.useBigInt64?r=this.readI64AsBigInt():r=this.readI64();else if(e===217){const n=this.lookU8();r=this.decodeString(n,1)}else if(e===218){const n=this.lookU16();r=this.decodeString(n,2)}else if(e===219){const n=this.lookU32();r=this.decodeString(n,4)}else if(e===220){const n=this.readU16();if(n!==0){this.pushArrayState(n),this.complete();continue e}else r=[]}else if(e===221){const n=this.readU32();if(n!==0){this.pushArrayState(n),this.complete();continue e}else r=[]}else if(e===222){const n=this.readU16();if(n!==0){this.pushMapState(n),this.complete();continue e}else r={}}else if(e===223){const n=this.readU32();if(n!==0){this.pushMapState(n),this.complete();continue e}else r={}}else if(e===196){const n=this.lookU8();r=this.decodeBinary(n,1)}else if(e===197){const n=this.lookU16();r=this.decodeBinary(n,2)}else if(e===198){const n=this.lookU32();r=this.decodeBinary(n,4)}else if(e===212)r=this.decodeExtension(1,0);else if(e===213)r=this.decodeExtension(2,0);else if(e===214)r=this.decodeExtension(4,0);else if(e===215)r=this.decodeExtension(8,0);else if(e===216)r=this.decodeExtension(16,0);else if(e===199){const n=this.lookU8();r=this.decodeExtension(n,1)}else if(e===200){const n=this.lookU16();r=this.decodeExtension(n,2)}else if(e===201){const n=this.lookU32();r=this.decodeExtension(n,4)}else throw new vr(`Unrecognized type byte: ${Nu(e)}`);this.complete();const i=this.stack;for(;i.length>0;){const n=i.top();if(n.type===Rh)if(n.array[n.position]=r,n.position++,n.position===n.size)r=n.array,i.release(n);else continue e;else if(n.type===oa){if(r==="__proto__")throw new vr("The key __proto__ is not allowed");n.key=this.mapKeyConverter(r),n.type=Zw;continue e}else if(n.map[n.key]=r,n.readCount++,n.readCount===n.size)r=n.map,i.release(n);else{n.key=null,n.type=oa;continue e}}return r}}readHeadByte(){return this.headByte===Uo&&(this.headByte=this.readU8()),this.headByte}complete(){this.headByte=Uo}readArraySize(){const e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:{if(e<160)return e-144;throw new vr(`Unrecognized array type byte: ${Nu(e)}`)}}}pushMapState(e){if(e>this.maxMapLength)throw new vr(`Max length exceeded: map length (${e}) > maxMapLengthLength (${this.maxMapLength})`);this.stack.pushMapState(e)}pushArrayState(e){if(e>this.maxArrayLength)throw new vr(`Max length exceeded: array length (${e}) > maxArrayLength (${this.maxArrayLength})`);this.stack.pushArrayState(e)}decodeString(e,r){return!this.rawStrings||this.stateIsMapKey()?this.decodeUtf8String(e,r):this.decodeBinary(e,r)}decodeUtf8String(e,r){var s;if(e>this.maxStrLength)throw new vr(`Max length exceeded: UTF-8 byte length (${e}) > maxStrLength (${this.maxStrLength})`);if(this.bytes.byteLength<this.pos+r+e)throw n0;const i=this.pos+r;let n;return this.stateIsMapKey()&&((s=this.keyDecoder)!=null&&s.canBeCached(e))?n=this.keyDecoder.decode(this.bytes,i,e):n=p8(this.bytes,i,e),this.pos+=r+e,n}stateIsMapKey(){return this.stack.length>0?this.stack.top().type===oa:!1}decodeBinary(e,r){if(e>this.maxBinLength)throw new vr(`Max length exceeded: bin length (${e}) > maxBinLength (${this.maxBinLength})`);if(!this.hasRemaining(e+r))throw n0;const i=this.pos+r,n=this.bytes.subarray(i,i+e);return this.pos+=r+e,n}decodeExtension(e,r){if(e>this.maxExtLength)throw new vr(`Max length exceeded: ext length (${e}) > maxExtLength (${this.maxExtLength})`);const i=this.view.getInt8(this.pos+r),n=this.decodeBinary(e,r+1);return this.extensionCodec.decode(n,i,this.context)}lookU8(){return this.view.getUint8(this.pos)}lookU16(){return this.view.getUint16(this.pos)}lookU32(){return this.view.getUint32(this.pos)}readU8(){const e=this.view.getUint8(this.pos);return this.pos++,e}readI8(){const e=this.view.getInt8(this.pos);return this.pos++,e}readU16(){const e=this.view.getUint16(this.pos);return this.pos+=2,e}readI16(){const e=this.view.getInt16(this.pos);return this.pos+=2,e}readU32(){const e=this.view.getUint32(this.pos);return this.pos+=4,e}readI32(){const e=this.view.getInt32(this.pos);return this.pos+=4,e}readU64(){const e=m8(this.view,this.pos);return this.pos+=8,e}readI64(){const e=Jw(this.view,this.pos);return this.pos+=8,e}readU64AsBigInt(){const e=this.view.getBigUint64(this.pos);return this.pos+=8,e}readI64AsBigInt(){const e=this.view.getBigInt64(this.pos);return this.pos+=8,e}readF32(){const e=this.view.getFloat32(this.pos);return this.pos+=4,e}readF64(){const e=this.view.getFloat64(this.pos);return this.pos+=8,e}};function L8(t,e){return new U8(e).decode(t)}const F8=t=>JSON.stringify(t,(e,r)=>typeof r=="bigint"?r.toString()+"n":r),q8=t=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=t.replace(e,'$1"$2n"$3');return JSON.parse(r,(i,n)=>typeof n=="string"&&n.match(/^\d+n$/)?BigInt(n.substring(0,n.length-1)):n)};function _s(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return q8(t)}catch{return t}}function rn(t){return typeof t=="string"?t:F8(t)||""}function j8(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function eb(t,...e){if(!j8(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function s0(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function z8(t,e){eb(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}const Ls=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Cu=t=>new DataView(t.buffer,t.byteOffset,t.byteLength);function H8(t){if(typeof t!="string")throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}function tb(t){return typeof t=="string"&&(t=H8(t)),eb(t),t}let K8=class{clone(){return this._cloneInto()}};function V8(t){const e=i=>t().update(tb(i)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function rb(t=32){if(Ls&&typeof Ls.getRandomValues=="function")return Ls.getRandomValues(new Uint8Array(t));if(Ls&&typeof Ls.randomBytes=="function")return Ls.randomBytes(t);throw new Error("crypto.getRandomValues must be defined")}function G8(t,e,r,i){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,i);const n=BigInt(32),s=BigInt(4294967295),o=Number(r>>n&s),a=Number(r&s),c=i?4:0,l=i?0:4;t.setUint32(e+c,o,i),t.setUint32(e+l,a,i)}let W8=class extends K8{constructor(e,r,i,n){super(),this.blockLen=e,this.outputLen=r,this.padOffset=i,this.isLE=n,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Cu(this.buffer)}update(e){s0(this);const{view:r,buffer:i,blockLen:n}=this;e=tb(e);const s=e.length;for(let o=0;o<s;){const a=Math.min(n-this.pos,s-o);if(a===n){const c=Cu(e);for(;n<=s-o;o+=n)this.process(c,o);continue}i.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===n&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){s0(this),z8(e,this),this.finished=!0;const{buffer:r,view:i,blockLen:n,isLE:s}=this;let{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>n-o&&(this.process(i,0),o=0);for(let h=o;h<n;h++)r[h]=0;G8(i,n-8,BigInt(this.length*8),s),this.process(i,0);const a=Cu(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<l;h++)a.setUint32(4*h,u[h],s)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const i=e.slice(0,r);return this.destroy(),i}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:i,length:n,finished:s,destroyed:o,pos:a}=this;return e.length=n,e.pos=a,e.finished=s,e.destroyed=o,n%r&&e.buffer.set(i),e}};const Ga=BigInt(2**32-1),Th=BigInt(32);function ib(t,e=!1){return e?{h:Number(t&Ga),l:Number(t>>Th&Ga)}:{h:Number(t>>Th&Ga)|0,l:Number(t&Ga)|0}}function Y8(t,e=!1){let r=new Uint32Array(t.length),i=new Uint32Array(t.length);for(let n=0;n<t.length;n++){const{h:s,l:o}=ib(t[n],e);[r[n],i[n]]=[s,o]}return[r,i]}const J8=(t,e)=>BigInt(t>>>0)<<Th|BigInt(e>>>0),Q8=(t,e,r)=>t>>>r,Z8=(t,e,r)=>t<<32-r|e>>>r,X8=(t,e,r)=>t>>>r|e<<32-r,e6=(t,e,r)=>t<<32-r|e>>>r,t6=(t,e,r)=>t<<64-r|e>>>r-32,r6=(t,e,r)=>t>>>r-32|e<<64-r,i6=(t,e)=>e,n6=(t,e)=>t,s6=(t,e,r)=>t<<r|e>>>32-r,o6=(t,e,r)=>e<<r|t>>>32-r,a6=(t,e,r)=>e<<r-32|t>>>64-r,c6=(t,e,r)=>t<<r-32|e>>>64-r;function l6(t,e,r,i){const n=(e>>>0)+(i>>>0);return{h:t+r+(n/2**32|0)|0,l:n|0}}const u6=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),h6=(t,e,r,i)=>e+r+i+(t/2**32|0)|0,f6=(t,e,r,i)=>(t>>>0)+(e>>>0)+(r>>>0)+(i>>>0),d6=(t,e,r,i,n)=>e+r+i+n+(t/2**32|0)|0,p6=(t,e,r,i,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(i>>>0)+(n>>>0),g6=(t,e,r,i,n,s)=>e+r+i+n+s+(t/2**32|0)|0,ue={fromBig:ib,split:Y8,toBig:J8,shrSH:Q8,shrSL:Z8,rotrSH:X8,rotrSL:e6,rotrBH:t6,rotrBL:r6,rotr32H:i6,rotr32L:n6,rotlSH:s6,rotlSL:o6,rotlBH:a6,rotlBL:c6,add:l6,add3L:u6,add3H:h6,add4L:f6,add4H:d6,add5H:g6,add5L:p6},[m6,y6]=ue.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),mn=new Uint32Array(80),yn=new Uint32Array(80);let w6=class extends W8{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:r,Bh:i,Bl:n,Ch:s,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:h,Fl:g,Gh:y,Gl:w,Hh:E,Hl:P}=this;return[e,r,i,n,s,o,a,c,l,u,h,g,y,w,E,P]}set(e,r,i,n,s,o,a,c,l,u,h,g,y,w,E,P){this.Ah=e|0,this.Al=r|0,this.Bh=i|0,this.Bl=n|0,this.Ch=s|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=h|0,this.Fl=g|0,this.Gh=y|0,this.Gl=w|0,this.Hh=E|0,this.Hl=P|0}process(e,r){for(let D=0;D<16;D++,r+=4)mn[D]=e.getUint32(r),yn[D]=e.getUint32(r+=4);for(let D=16;D<80;D++){const C=mn[D-15]|0,B=yn[D-15]|0,M=ue.rotrSH(C,B,1)^ue.rotrSH(C,B,8)^ue.shrSH(C,B,7),L=ue.rotrSL(C,B,1)^ue.rotrSL(C,B,8)^ue.shrSL(C,B,7),F=mn[D-2]|0,k=yn[D-2]|0,V=ue.rotrSH(F,k,19)^ue.rotrBH(F,k,61)^ue.shrSH(F,k,6),H=ue.rotrSL(F,k,19)^ue.rotrBL(F,k,61)^ue.shrSL(F,k,6),$=ue.add4L(L,H,yn[D-7],yn[D-16]),A=ue.add4H($,M,V,mn[D-7],mn[D-16]);mn[D]=A|0,yn[D]=$|0}let{Ah:i,Al:n,Bh:s,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:h,El:g,Fh:y,Fl:w,Gh:E,Gl:P,Hh:N,Hl:R}=this;for(let D=0;D<80;D++){const C=ue.rotrSH(h,g,14)^ue.rotrSH(h,g,18)^ue.rotrBH(h,g,41),B=ue.rotrSL(h,g,14)^ue.rotrSL(h,g,18)^ue.rotrBL(h,g,41),M=h&y^~h&E,L=g&w^~g&P,F=ue.add5L(R,B,L,y6[D],yn[D]),k=ue.add5H(F,N,C,M,m6[D],mn[D]),V=F|0,H=ue.rotrSH(i,n,28)^ue.rotrBH(i,n,34)^ue.rotrBH(i,n,39),$=ue.rotrSL(i,n,28)^ue.rotrBL(i,n,34)^ue.rotrBL(i,n,39),A=i&s^i&a^s&a,d=n&o^n&c^o&c;N=E|0,R=P|0,E=y|0,P=w|0,y=h|0,w=g|0,{h,l:g}=ue.add(l|0,u|0,k|0,V|0),l=a|0,u=c|0,a=s|0,c=o|0,s=i|0,o=n|0;const f=ue.add3L(V,$,d);i=ue.add3H(f,k,H,A),n=f|0}({h:i,l:n}=ue.add(this.Ah|0,this.Al|0,i|0,n|0)),{h:s,l:o}=ue.add(this.Bh|0,this.Bl|0,s|0,o|0),{h:a,l:c}=ue.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=ue.add(this.Dh|0,this.Dl|0,l|0,u|0),{h,l:g}=ue.add(this.Eh|0,this.El|0,h|0,g|0),{h:y,l:w}=ue.add(this.Fh|0,this.Fl|0,y|0,w|0),{h:E,l:P}=ue.add(this.Gh|0,this.Gl|0,E|0,P|0),{h:N,l:R}=ue.add(this.Hh|0,this.Hl|0,N|0,R|0),this.set(i,n,s,o,a,c,l,u,h,g,y,w,E,P,N,R)}roundClean(){mn.fill(0),yn.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};const b6=V8(()=>new w6);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Qf=BigInt(0),nb=BigInt(1),v6=BigInt(2);function Zf(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Xf(t){if(!Zf(t))throw new Error("Uint8Array expected")}function Bu(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}const E6=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function ed(t){Xf(t);let e="";for(let r=0;r<t.length;r++)e+=E6[t[r]];return e}function sb(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?Qf:BigInt("0x"+t)}const Mi={_0:48,_9:57,A:65,F:70,a:97,f:102};function o0(t){if(t>=Mi._0&&t<=Mi._9)return t-Mi._0;if(t>=Mi.A&&t<=Mi.F)return t-(Mi.A-10);if(t>=Mi.a&&t<=Mi.f)return t-(Mi.a-10)}function ob(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const i=new Uint8Array(r);for(let n=0,s=0;n<r;n++,s+=2){const o=o0(t.charCodeAt(s)),a=o0(t.charCodeAt(s+1));if(o===void 0||a===void 0){const c=t[s]+t[s+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+s)}i[n]=o*16+a}return i}function x6(t){return sb(ed(t))}function Ec(t){return Xf(t),sb(ed(Uint8Array.from(t).reverse()))}function ab(t,e){return ob(t.toString(16).padStart(e*2,"0"))}function Mh(t,e){return ab(t,e).reverse()}function ki(t,e,r){let i;if(typeof e=="string")try{i=ob(e)}catch(s){throw new Error(t+" must be hex string or Uint8Array, cause: "+s)}else if(Zf(e))i=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const n=i.length;if(typeof r=="number"&&n!==r)throw new Error(t+" of length "+r+" expected, got "+n);return i}function a0(...t){let e=0;for(let i=0;i<t.length;i++){const n=t[i];Xf(n),e+=n.length}const r=new Uint8Array(e);for(let i=0,n=0;i<t.length;i++){const s=t[i];r.set(s,n),n+=s.length}return r}const Ru=t=>typeof t=="bigint"&&Qf<=t;function A6(t,e,r){return Ru(t)&&Ru(e)&&Ru(r)&&e<=t&&t<r}function Lo(t,e,r,i){if(!A6(e,r,i))throw new Error("expected valid "+t+": "+r+" <= n < "+i+", got "+e)}function _6(t){let e;for(e=0;t>Qf;t>>=nb,e+=1);return e}const I6=t=>(v6<<BigInt(t-1))-nb,S6={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||Zf(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function td(t,e,r={}){const i=(n,s,o)=>{const a=S6[s];if(typeof a!="function")throw new Error("invalid validator function");const c=t[n];if(!(o&&c===void 0)&&!a(c,t))throw new Error("param "+String(n)+" is invalid. Expected "+s+", got "+c)};for(const[n,s]of Object.entries(e))i(n,s,!1);for(const[n,s]of Object.entries(r))i(n,s,!0);return t}function c0(t){const e=new WeakMap;return(r,...i)=>{const n=e.get(r);if(n!==void 0)return n;const s=t(r,...i);return e.set(r,s),s}}const _t=BigInt(0),ht=BigInt(1),cs=BigInt(2),P6=BigInt(3),kh=BigInt(4),l0=BigInt(5),u0=BigInt(8);function wt(t,e){const r=t%e;return r>=_t?r:e+r}function O6(t,e,r){if(e<_t)throw new Error("invalid exponent, negatives unsupported");if(r<=_t)throw new Error("invalid modulus");if(r===ht)return _t;let i=ht;for(;e>_t;)e&ht&&(i=i*t%r),t=t*t%r,e>>=ht;return i}function ui(t,e,r){let i=t;for(;e-- >_t;)i*=i,i%=r;return i}function h0(t,e){if(t===_t)throw new Error("invert: expected non-zero number");if(e<=_t)throw new Error("invert: expected positive modulus, got "+e);let r=wt(t,e),i=e,n=_t,s=ht;for(;r!==_t;){const o=i/r,a=i%r,c=n-s*o;i=r,r=a,n=s,s=c}if(i!==ht)throw new Error("invert: does not exist");return wt(n,e)}function D6(t){const e=(t-ht)/cs;let r,i,n;for(r=t-ht,i=0;r%cs===_t;r/=cs,i++);for(n=cs;n<t&&O6(n,e,t)!==t-ht;n++)if(n>1e3)throw new Error("Cannot find square root: likely non-prime P");if(i===1){const o=(t+ht)/kh;return function(a,c){const l=a.pow(c,o);if(!a.eql(a.sqr(l),c))throw new Error("Cannot find square root");return l}}const s=(r+ht)/cs;return function(o,a){if(o.pow(a,e)===o.neg(o.ONE))throw new Error("Cannot find square root");let c=i,l=o.pow(o.mul(o.ONE,n),r),u=o.pow(a,s),h=o.pow(a,r);for(;!o.eql(h,o.ONE);){if(o.eql(h,o.ZERO))return o.ZERO;let g=1;for(let w=o.sqr(h);g<c&&!o.eql(w,o.ONE);g++)w=o.sqr(w);const y=o.pow(l,ht<<BigInt(c-g-1));l=o.sqr(y),u=o.mul(u,y),h=o.mul(h,l),c=g}return u}}function N6(t){if(t%kh===P6){const e=(t+ht)/kh;return function(r,i){const n=r.pow(i,e);if(!r.eql(r.sqr(n),i))throw new Error("Cannot find square root");return n}}if(t%u0===l0){const e=(t-l0)/u0;return function(r,i){const n=r.mul(i,cs),s=r.pow(n,e),o=r.mul(i,s),a=r.mul(r.mul(o,cs),s),c=r.mul(o,r.sub(a,r.ONE));if(!r.eql(r.sqr(c),i))throw new Error("Cannot find square root");return c}}return D6(t)}const C6=(t,e)=>(wt(t,e)&ht)===ht,B6=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function R6(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=B6.reduce((i,n)=>(i[n]="function",i),e);return td(t,r)}function T6(t,e,r){if(r<_t)throw new Error("invalid exponent, negatives unsupported");if(r===_t)return t.ONE;if(r===ht)return e;let i=t.ONE,n=e;for(;r>_t;)r&ht&&(i=t.mul(i,n)),n=t.sqr(n),r>>=ht;return i}function M6(t,e){const r=new Array(e.length),i=e.reduce((s,o,a)=>t.is0(o)?s:(r[a]=s,t.mul(s,o)),t.ONE),n=t.inv(i);return e.reduceRight((s,o,a)=>t.is0(o)?s:(r[a]=t.mul(s,r[a]),t.mul(s,o)),n),r}function cb(t,e){const r=e!==void 0?e:t.toString(2).length,i=Math.ceil(r/8);return{nBitLength:r,nByteLength:i}}function lb(t,e,r=!1,i={}){if(t<=_t)throw new Error("invalid field: expected ORDER > 0, got "+t);const{nBitLength:n,nByteLength:s}=cb(t,e);if(s>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:t,isLE:r,BITS:n,BYTES:s,MASK:I6(n),ZERO:_t,ONE:ht,create:c=>wt(c,t),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return _t<=c&&c<t},is0:c=>c===_t,isOdd:c=>(c&ht)===ht,neg:c=>wt(-c,t),eql:(c,l)=>c===l,sqr:c=>wt(c*c,t),add:(c,l)=>wt(c+l,t),sub:(c,l)=>wt(c-l,t),mul:(c,l)=>wt(c*l,t),pow:(c,l)=>T6(a,c,l),div:(c,l)=>wt(c*h0(l,t),t),sqrN:c=>c*c,addN:(c,l)=>c+l,subN:(c,l)=>c-l,mulN:(c,l)=>c*l,inv:c=>h0(c,t),sqrt:i.sqrt||(c=>(o||(o=N6(t)),o(a,c))),invertBatch:c=>M6(a,c),cmov:(c,l,u)=>u?l:c,toBytes:c=>r?Mh(c,s):ab(c,s),fromBytes:c=>{if(c.length!==s)throw new Error("Field.fromBytes: expected "+s+" bytes, got "+c.length);return r?Ec(c):x6(c)}});return Object.freeze(a)}const f0=BigInt(0),Wa=BigInt(1);function Tu(t,e){const r=e.negate();return t?r:e}function ub(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function Mu(t,e){ub(t,e);const r=Math.ceil(e/t)+1,i=2**(t-1);return{windows:r,windowSize:i}}function k6(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((r,i)=>{if(!(r instanceof e))throw new Error("invalid point at index "+i)})}function $6(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((r,i)=>{if(!e.isValid(r))throw new Error("invalid scalar at index "+i)})}const ku=new WeakMap,hb=new WeakMap;function $u(t){return hb.get(t)||1}function U6(t,e){return{constTimeNegate:Tu,hasPrecomputes(r){return $u(r)!==1},unsafeLadder(r,i,n=t.ZERO){let s=r;for(;i>f0;)i&Wa&&(n=n.add(s)),s=s.double(),i>>=Wa;return n},precomputeWindow(r,i){const{windows:n,windowSize:s}=Mu(i,e),o=[];let a=r,c=a;for(let l=0;l<n;l++){c=a,o.push(c);for(let u=1;u<s;u++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(r,i,n){const{windows:s,windowSize:o}=Mu(r,e);let a=t.ZERO,c=t.BASE;const l=BigInt(2**r-1),u=2**r,h=BigInt(r);for(let g=0;g<s;g++){const y=g*o;let w=Number(n&l);n>>=h,w>o&&(w-=u,n+=Wa);const E=y,P=y+Math.abs(w)-1,N=g%2!==0,R=w<0;w===0?c=c.add(Tu(N,i[E])):a=a.add(Tu(R,i[P]))}return{p:a,f:c}},wNAFUnsafe(r,i,n,s=t.ZERO){const{windows:o,windowSize:a}=Mu(r,e),c=BigInt(2**r-1),l=2**r,u=BigInt(r);for(let h=0;h<o;h++){const g=h*a;if(n===f0)break;let y=Number(n&c);if(n>>=u,y>a&&(y-=l,n+=Wa),y===0)continue;let w=i[g+Math.abs(y)-1];y<0&&(w=w.negate()),s=s.add(w)}return s},getPrecomputes(r,i,n){let s=ku.get(i);return s||(s=this.precomputeWindow(i,r),r!==1&&ku.set(i,n(s))),s},wNAFCached(r,i,n){const s=$u(r);return this.wNAF(s,this.getPrecomputes(s,r,n),i)},wNAFCachedUnsafe(r,i,n,s){const o=$u(r);return o===1?this.unsafeLadder(r,i,s):this.wNAFUnsafe(o,this.getPrecomputes(o,r,n),i,s)},setWindowSize(r,i){ub(i,e),hb.set(r,i),ku.delete(r)}}}function L6(t,e,r,i){if(k6(r,t),$6(i,e),r.length!==i.length)throw new Error("arrays of points and scalars must have equal length");const n=t.ZERO,s=_6(BigInt(r.length)),o=s>12?s-3:s>4?s-2:s?2:1,a=(1<<o)-1,c=new Array(a+1).fill(n),l=Math.floor((e.BITS-1)/o)*o;let u=n;for(let h=l;h>=0;h-=o){c.fill(n);for(let y=0;y<i.length;y++){const w=i[y],E=Number(w>>BigInt(h)&BigInt(a));c[E]=c[E].add(r[y])}let g=n;for(let y=c.length-1,w=n;y>0;y--)w=w.add(c[y]),g=g.add(w);if(u=u.add(g),h!==0)for(let y=0;y<o;y++)u=u.double()}return u}function F6(t){return R6(t.Fp),td(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...cb(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}const Wr=BigInt(0),tr=BigInt(1),Ya=BigInt(2),q6=BigInt(8),j6={zip215:!0};function z6(t){const e=F6(t);return td(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function H6(t){const e=z6(t),{Fp:r,n:i,prehash:n,hash:s,randomBytes:o,nByteLength:a,h:c}=e,l=Ya<<BigInt(a*8)-tr,u=r.create,h=lb(e.n,e.nBitLength),g=e.uvRatio||((f,p)=>{try{return{isValid:!0,value:r.sqrt(f*r.inv(p))}}catch{return{isValid:!1,value:Wr}}}),y=e.adjustScalarBytes||(f=>f),w=e.domain||((f,p,b)=>{if(Bu("phflag",b),p.length||b)throw new Error("Contexts/pre-hash are not supported");return f});function E(f,p){Lo("coordinate "+f,p,Wr,l)}function P(f){if(!(f instanceof D))throw new Error("ExtendedPoint expected")}const N=c0((f,p)=>{const{ex:b,ey:x,ez:_}=f,S=f.is0();p==null&&(p=S?q6:r.inv(_));const I=u(b*p),m=u(x*p),O=u(_*p);if(S)return{x:Wr,y:tr};if(O!==tr)throw new Error("invZ was invalid");return{x:I,y:m}}),R=c0(f=>{const{a:p,d:b}=e;if(f.is0())throw new Error("bad point: ZERO");const{ex:x,ey:_,ez:S,et:I}=f,m=u(x*x),O=u(_*_),j=u(S*S),v=u(j*j),T=u(m*p),U=u(j*u(T+O)),q=u(v+u(b*u(m*O)));if(U!==q)throw new Error("bad point: equation left != right (1)");const z=u(x*_),Y=u(S*I);if(z!==Y)throw new Error("bad point: equation left != right (2)");return!0});class D{constructor(p,b,x,_){this.ex=p,this.ey=b,this.ez=x,this.et=_,E("x",p),E("y",b),E("z",x),E("t",_),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(p){if(p instanceof D)throw new Error("extended point not allowed");const{x:b,y:x}=p||{};return E("x",b),E("y",x),new D(b,x,tr,u(b*x))}static normalizeZ(p){const b=r.invertBatch(p.map(x=>x.ez));return p.map((x,_)=>x.toAffine(b[_])).map(D.fromAffine)}static msm(p,b){return L6(D,h,p,b)}_setWindowSize(p){M.setWindowSize(this,p)}assertValidity(){R(this)}equals(p){P(p);const{ex:b,ey:x,ez:_}=this,{ex:S,ey:I,ez:m}=p,O=u(b*m),j=u(S*_),v=u(x*m),T=u(I*_);return O===j&&v===T}is0(){return this.equals(D.ZERO)}negate(){return new D(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){const{a:p}=e,{ex:b,ey:x,ez:_}=this,S=u(b*b),I=u(x*x),m=u(Ya*u(_*_)),O=u(p*S),j=b+x,v=u(u(j*j)-S-I),T=O+I,U=T-m,q=O-I,z=u(v*U),Y=u(T*q),J=u(v*q),W=u(U*T);return new D(z,Y,W,J)}add(p){P(p);const{a:b,d:x}=e,{ex:_,ey:S,ez:I,et:m}=this,{ex:O,ey:j,ez:v,et:T}=p;if(b===BigInt(-1)){const oi=u((S-_)*(j+O)),Ae=u((S+_)*(j-O)),Ee=u(Ae-oi);if(Ee===Wr)return this.double();const ai=u(I*Ya*T),_e=u(m*Ya*v),Ie=_e+ai,ci=Ae+oi,Se=_e-ai,Ne=u(Ie*Ee),Ci=u(ci*Se),Ce=u(Ie*Se),Be=u(Ee*ci);return new D(Ne,Ci,Be,Ce)}const U=u(_*O),q=u(S*j),z=u(m*x*T),Y=u(I*v),J=u((_+S)*(O+j)-U-q),W=Y-z,oe=Y+z,X=u(q-b*U),ie=u(J*W),Lt=u(oe*X),Oe=u(J*X),De=u(W*oe);return new D(ie,Lt,De,Oe)}subtract(p){return this.add(p.negate())}wNAF(p){return M.wNAFCached(this,p,D.normalizeZ)}multiply(p){const b=p;Lo("scalar",b,tr,i);const{p:x,f:_}=this.wNAF(b);return D.normalizeZ([x,_])[0]}multiplyUnsafe(p,b=D.ZERO){const x=p;return Lo("scalar",x,Wr,i),x===Wr?B:this.is0()||x===tr?this:M.wNAFCachedUnsafe(this,x,D.normalizeZ,b)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return M.unsafeLadder(this,i).is0()}toAffine(p){return N(this,p)}clearCofactor(){const{h:p}=e;return p===tr?this:this.multiplyUnsafe(p)}static fromHex(p,b=!1){const{d:x,a:_}=e,S=r.BYTES;p=ki("pointHex",p,S),Bu("zip215",b);const I=p.slice(),m=p[S-1];I[S-1]=m&-129;const O=Ec(I),j=b?l:r.ORDER;Lo("pointHex.y",O,Wr,j);const v=u(O*O),T=u(v-tr),U=u(x*v-_);let{isValid:q,value:z}=g(T,U);if(!q)throw new Error("Point.fromHex: invalid y coordinate");const Y=(z&tr)===tr,J=(m&128)!==0;if(!b&&z===Wr&&J)throw new Error("Point.fromHex: x=0 and x_0=1");return J!==Y&&(z=u(-z)),D.fromAffine({x:z,y:O})}static fromPrivateKey(p){return k(p).point}toRawBytes(){const{x:p,y:b}=this.toAffine(),x=Mh(b,r.BYTES);return x[x.length-1]|=p&tr?128:0,x}toHex(){return ed(this.toRawBytes())}}D.BASE=new D(e.Gx,e.Gy,tr,u(e.Gx*e.Gy)),D.ZERO=new D(Wr,tr,tr,Wr);const{BASE:C,ZERO:B}=D,M=U6(D,a*8);function L(f){return wt(f,i)}function F(f){return L(Ec(f))}function k(f){const p=r.BYTES;f=ki("private key",f,p);const b=ki("hashed private key",s(f),2*p),x=y(b.slice(0,p)),_=b.slice(p,2*p),S=F(x),I=C.multiply(S),m=I.toRawBytes();return{head:x,prefix:_,scalar:S,point:I,pointBytes:m}}function V(f){return k(f).pointBytes}function H(f=new Uint8Array,...p){const b=a0(...p);return F(s(w(b,ki("context",f),!!n)))}function $(f,p,b={}){f=ki("message",f),n&&(f=n(f));const{prefix:x,scalar:_,pointBytes:S}=k(p),I=H(b.context,x,f),m=C.multiply(I).toRawBytes(),O=H(b.context,m,S,f),j=L(I+O*_);Lo("signature.s",j,Wr,i);const v=a0(m,Mh(j,r.BYTES));return ki("result",v,r.BYTES*2)}const A=j6;function d(f,p,b,x=A){const{context:_,zip215:S}=x,I=r.BYTES;f=ki("signature",f,2*I),p=ki("message",p),b=ki("publicKey",b,I),S!==void 0&&Bu("zip215",S),n&&(p=n(p));const m=Ec(f.slice(I,2*I));let O,j,v;try{O=D.fromHex(b,S),j=D.fromHex(f.slice(0,I),S),v=C.multiplyUnsafe(m)}catch{return!1}if(!S&&O.isSmallOrder())return!1;const T=H(_,j.toRawBytes(),O.toRawBytes(),p);return j.add(O.multiplyUnsafe(T)).subtract(v).clearCofactor().equals(D.ZERO)}return C._setWindowSize(8),{CURVE:e,getPublicKey:V,sign:$,verify:d,ExtendedPoint:D,utils:{getExtendedPublicKey:k,randomPrivateKey:()=>o(r.BYTES),precompute(f=8,p=D.BASE){return p._setWindowSize(f),p.multiply(BigInt(3)),p}}}}BigInt(0),BigInt(1);const rd=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),d0=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const K6=BigInt(1),p0=BigInt(2);BigInt(3);const V6=BigInt(5),G6=BigInt(8);function W6(t){const e=BigInt(10),r=BigInt(20),i=BigInt(40),n=BigInt(80),s=rd,o=t*t%s*t%s,a=ui(o,p0,s)*o%s,c=ui(a,K6,s)*t%s,l=ui(c,V6,s)*c%s,u=ui(l,e,s)*l%s,h=ui(u,r,s)*u%s,g=ui(h,i,s)*h%s,y=ui(g,n,s)*g%s,w=ui(y,n,s)*g%s,E=ui(w,e,s)*l%s;return{pow_p_5_8:ui(E,p0,s)*t%s,b2:o}}function Y6(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function J6(t,e){const r=rd,i=wt(e*e*e,r),n=wt(i*i*e,r),s=W6(t*n).pow_p_5_8;let o=wt(t*i*s,r);const a=wt(e*o*o,r),c=o,l=wt(o*d0,r),u=a===t,h=a===wt(-t,r),g=a===wt(-t*d0,r);return u&&(o=c),(h||g)&&(o=l),C6(o,r)&&(o=wt(-o,r)),{isValid:u||h,value:o}}const Q6=lb(rd,void 0,!0),Z6={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:Q6,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:G6,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:b6,randomBytes:rb,adjustScalarBytes:Y6,uvRatio:J6},fb=H6(Z6),X6="EdDSA",eS="JWT",Hc=".",wl="base64url",db="utf8",pb="utf8",tS=":",rS="did",iS="key",g0="base58btc",nS="z",sS="K36",oS=32;function id(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function gb(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?id(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function mb(t,e){e||(e=t.reduce((n,s)=>n+s.length,0));const r=gb(e);let i=0;for(const n of t)r.set(n,i),i+=n.length;return id(r)}function aS(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<t.length;n++){var s=t.charAt(n),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=n}var a=t.length,c=t.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(w){if(w instanceof Uint8Array||(ArrayBuffer.isView(w)?w=new Uint8Array(w.buffer,w.byteOffset,w.byteLength):Array.isArray(w)&&(w=Uint8Array.from(w))),!(w instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(w.length===0)return"";for(var E=0,P=0,N=0,R=w.length;N!==R&&w[N]===0;)N++,E++;for(var D=(R-N)*u+1>>>0,C=new Uint8Array(D);N!==R;){for(var B=w[N],M=0,L=D-1;(B!==0||M<P)&&L!==-1;L--,M++)B+=256*C[L]>>>0,C[L]=B%a>>>0,B=B/a>>>0;if(B!==0)throw new Error("Non-zero carry");P=M,N++}for(var F=D-P;F!==D&&C[F]===0;)F++;for(var k=c.repeat(E);F<D;++F)k+=t.charAt(C[F]);return k}function g(w){if(typeof w!="string")throw new TypeError("Expected String");if(w.length===0)return new Uint8Array;var E=0;if(w[E]!==" "){for(var P=0,N=0;w[E]===c;)P++,E++;for(var R=(w.length-E)*l+1>>>0,D=new Uint8Array(R);w[E];){var C=r[w.charCodeAt(E)];if(C===255)return;for(var B=0,M=R-1;(C!==0||B<N)&&M!==-1;M--,B++)C+=a*D[M]>>>0,D[M]=C%256>>>0,C=C/256>>>0;if(C!==0)throw new Error("Non-zero carry");N=B,E++}if(w[E]!==" "){for(var L=R-N;L!==R&&D[L]===0;)L++;for(var F=new Uint8Array(P+(R-L)),k=P;L!==R;)F[k++]=D[L++];return F}}}function y(w){var E=g(w);if(E)return E;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:g,decode:y}}var cS=aS,lS=cS;const yb=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},uS=t=>new TextEncoder().encode(t),hS=t=>new TextDecoder().decode(t);let fS=class{constructor(e,r,i){this.name=e,this.prefix=r,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},dS=class{constructor(e,r,i){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return wb(this,e)}},pS=class{constructor(e){this.decoders=e}or(e){return wb(this,e)}decode(e){const r=e[0],i=this.decoders[r];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const wb=(t,e)=>new pS({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});let gS=class{constructor(e,r,i,n){this.name=e,this.prefix=r,this.baseEncode=i,this.baseDecode=n,this.encoder=new fS(e,r,i),this.decoder=new dS(e,r,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const bl=({name:t,prefix:e,encode:r,decode:i})=>new gS(t,e,r,i),Ca=({prefix:t,name:e,alphabet:r})=>{const{encode:i,decode:n}=lS(r,e);return bl({prefix:t,name:e,encode:i,decode:s=>yb(n(s))})},mS=(t,e,r,i)=>{const n={};for(let u=0;u<e.length;++u)n[e[u]]=u;let s=t.length;for(;t[s-1]==="=";)--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,l=0;for(let u=0;u<s;++u){const h=n[t[u]];if(h===void 0)throw new SyntaxError(`Non-${i} character`);c=c<<r|h,a+=r,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},yS=(t,e,r)=>{const i=e[e.length-1]==="=",n=(1<<r)-1;let s="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,s+=e[n&a>>o];if(o&&(s+=e[n&a<<r-o]),i)for(;s.length*r&7;)s+="=";return s},kt=({name:t,prefix:e,bitsPerChar:r,alphabet:i})=>bl({prefix:e,name:t,encode(n){return yS(n,i,r)},decode(n){return mS(n,i,r,t)}}),wS=bl({prefix:"\0",name:"identity",encode:t=>hS(t),decode:t=>uS(t)});var bS=Object.freeze({__proto__:null,identity:wS});const vS=kt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var ES=Object.freeze({__proto__:null,base2:vS});const xS=kt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var AS=Object.freeze({__proto__:null,base8:xS});const _S=Ca({prefix:"9",name:"base10",alphabet:"0123456789"});var IS=Object.freeze({__proto__:null,base10:_S});const SS=kt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),PS=kt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var OS=Object.freeze({__proto__:null,base16:SS,base16upper:PS});const DS=kt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),NS=kt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),CS=kt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),BS=kt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),RS=kt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),TS=kt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),MS=kt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),kS=kt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),$S=kt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var US=Object.freeze({__proto__:null,base32:DS,base32upper:NS,base32pad:CS,base32padupper:BS,base32hex:RS,base32hexupper:TS,base32hexpad:MS,base32hexpadupper:kS,base32z:$S});const LS=Ca({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),FS=Ca({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var qS=Object.freeze({__proto__:null,base36:LS,base36upper:FS});const jS=Ca({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),zS=Ca({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var HS=Object.freeze({__proto__:null,base58btc:jS,base58flickr:zS});const KS=kt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),VS=kt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),GS=kt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),WS=kt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var YS=Object.freeze({__proto__:null,base64:KS,base64pad:VS,base64url:GS,base64urlpad:WS});const bb=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),JS=bb.reduce((t,e,r)=>(t[r]=e,t),[]),QS=bb.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function ZS(t){return t.reduce((e,r)=>(e+=JS[r],e),"")}function XS(t){const e=[];for(const r of t){const i=QS[r.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(i)}return new Uint8Array(e)}const e4=bl({prefix:"🚀",name:"base256emoji",encode:ZS,decode:XS});var t4=Object.freeze({__proto__:null,base256emoji:e4}),r4=vb,m0=128,i4=-128,n4=Math.pow(2,31);function vb(t,e,r){e=e||[],r=r||0;for(var i=r;t>=n4;)e[r++]=t&255|m0,t/=128;for(;t&i4;)e[r++]=t&255|m0,t>>>=7;return e[r]=t|0,vb.bytes=r-i+1,e}var s4=$h,o4=128,y0=127;function $h(t,i){var r=0,i=i||0,n=0,s=i,o,a=t.length;do{if(s>=a)throw $h.bytes=0,new RangeError("Could not decode varint");o=t[s++],r+=n<28?(o&y0)<<n:(o&y0)*Math.pow(2,n),n+=7}while(o>=o4);return $h.bytes=s-i,r}var a4=Math.pow(2,7),c4=Math.pow(2,14),l4=Math.pow(2,21),u4=Math.pow(2,28),h4=Math.pow(2,35),f4=Math.pow(2,42),d4=Math.pow(2,49),p4=Math.pow(2,56),g4=Math.pow(2,63),m4=function(t){return t<a4?1:t<c4?2:t<l4?3:t<u4?4:t<h4?5:t<f4?6:t<d4?7:t<p4?8:t<g4?9:10},y4={encode:r4,decode:s4,encodingLength:m4},Eb=y4;const w0=(t,e,r=0)=>(Eb.encode(t,e,r),e),b0=t=>Eb.encodingLength(t),Uh=(t,e)=>{const r=e.byteLength,i=b0(t),n=i+b0(r),s=new Uint8Array(n+r);return w0(t,s,0),w0(r,s,i),s.set(e,n),new w4(t,r,e,s)};let w4=class{constructor(e,r,i,n){this.code=e,this.size=r,this.digest=i,this.bytes=n}};const xb=({name:t,code:e,encode:r})=>new b4(t,e,r);let b4=class{constructor(e,r,i){this.name=e,this.code=r,this.encode=i}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?Uh(this.code,r):r.then(i=>Uh(this.code,i))}else throw Error("Unknown type, must be binary type")}};const Ab=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),v4=xb({name:"sha2-256",code:18,encode:Ab("SHA-256")}),E4=xb({name:"sha2-512",code:19,encode:Ab("SHA-512")});var x4=Object.freeze({__proto__:null,sha256:v4,sha512:E4});const _b=0,A4="identity",Ib=yb,_4=t=>Uh(_b,Ib(t)),I4={code:_b,name:A4,encode:Ib,digest:_4};var S4=Object.freeze({__proto__:null,identity:I4});new TextEncoder,new TextDecoder;const v0={...bS,...ES,...AS,...IS,...OS,...US,...qS,...HS,...YS,...t4};({...x4,...S4});function Sb(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}const E0=Sb("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Uu=Sb("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=gb(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Pb={utf8:E0,"utf-8":E0,hex:v0.base16,latin1:Uu,ascii:Uu,binary:Uu,...v0};function vl(t,e="utf8"){const r=Pb[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function So(t,e="utf8"){const r=Pb[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?id(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}function x0(t){return _s(vl(So(t,wl),db))}function Kc(t){return vl(So(rn(t),db),wl)}function Ob(t){const e=So(sS,g0),r=nS+vl(mb([e,t]),g0);return[rS,iS,r].join(tS)}function P4(t){return vl(t,wl)}function O4(t){return So(t,wl)}function D4(t){return So([Kc(t.header),Kc(t.payload)].join(Hc),pb)}function N4(t){return[Kc(t.header),Kc(t.payload),P4(t.signature)].join(Hc)}function Lh(t){const e=t.split(Hc),r=x0(e[0]),i=x0(e[1]),n=O4(e[2]),s=So(e.slice(0,2).join(Hc),pb);return{header:r,payload:i,signature:n,data:s}}function A0(t=rb(oS)){const e=fb.getPublicKey(t);return{secretKey:mb([t,e]),publicKey:e}}async function C4(t,e,r,i,n=Q.fromMiliseconds(Date.now())){const s={alg:X6,typ:eS},o=Ob(i.publicKey),a=n+r,c={iss:o,sub:t,aud:e,iat:n,exp:a},l=D4({header:s,payload:c}),u=fb.sign(l,i.secretKey.slice(0,32));return N4({header:s,payload:c,signature:u})}function nd(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function Db(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?nd(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function aa(t,e){e||(e=t.reduce((n,s)=>n+s.length,0));const r=Db(e);let i=0;for(const n of t)r.set(n,i),i+=n.length;return nd(r)}function B4(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<t.length;n++){var s=t.charAt(n),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=n}var a=t.length,c=t.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(w){if(w instanceof Uint8Array||(ArrayBuffer.isView(w)?w=new Uint8Array(w.buffer,w.byteOffset,w.byteLength):Array.isArray(w)&&(w=Uint8Array.from(w))),!(w instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(w.length===0)return"";for(var E=0,P=0,N=0,R=w.length;N!==R&&w[N]===0;)N++,E++;for(var D=(R-N)*u+1>>>0,C=new Uint8Array(D);N!==R;){for(var B=w[N],M=0,L=D-1;(B!==0||M<P)&&L!==-1;L--,M++)B+=256*C[L]>>>0,C[L]=B%a>>>0,B=B/a>>>0;if(B!==0)throw new Error("Non-zero carry");P=M,N++}for(var F=D-P;F!==D&&C[F]===0;)F++;for(var k=c.repeat(E);F<D;++F)k+=t.charAt(C[F]);return k}function g(w){if(typeof w!="string")throw new TypeError("Expected String");if(w.length===0)return new Uint8Array;var E=0;if(w[E]!==" "){for(var P=0,N=0;w[E]===c;)P++,E++;for(var R=(w.length-E)*l+1>>>0,D=new Uint8Array(R);w[E];){var C=r[w.charCodeAt(E)];if(C===255)return;for(var B=0,M=R-1;(C!==0||B<N)&&M!==-1;M--,B++)C+=a*D[M]>>>0,D[M]=C%256>>>0,C=C/256>>>0;if(C!==0)throw new Error("Non-zero carry");N=B,E++}if(w[E]!==" "){for(var L=R-N;L!==R&&D[L]===0;)L++;for(var F=new Uint8Array(P+(R-L)),k=P;L!==R;)F[k++]=D[L++];return F}}}function y(w){var E=g(w);if(E)return E;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:g,decode:y}}var R4=B4,T4=R4;const M4=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},k4=t=>new TextEncoder().encode(t),$4=t=>new TextDecoder().decode(t);class U4{constructor(e,r,i){this.name=e,this.prefix=r,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class L4{constructor(e,r,i){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Nb(this,e)}}class F4{constructor(e){this.decoders=e}or(e){return Nb(this,e)}decode(e){const r=e[0],i=this.decoders[r];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Nb=(t,e)=>new F4({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class q4{constructor(e,r,i,n){this.name=e,this.prefix=r,this.baseEncode=i,this.baseDecode=n,this.encoder=new U4(e,r,i),this.decoder=new L4(e,r,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const El=({name:t,prefix:e,encode:r,decode:i})=>new q4(t,e,r,i),Ba=({prefix:t,name:e,alphabet:r})=>{const{encode:i,decode:n}=T4(r,e);return El({prefix:t,name:e,encode:i,decode:s=>M4(n(s))})},j4=(t,e,r,i)=>{const n={};for(let u=0;u<e.length;++u)n[e[u]]=u;let s=t.length;for(;t[s-1]==="=";)--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,l=0;for(let u=0;u<s;++u){const h=n[t[u]];if(h===void 0)throw new SyntaxError(`Non-${i} character`);c=c<<r|h,a+=r,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},z4=(t,e,r)=>{const i=e[e.length-1]==="=",n=(1<<r)-1;let s="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,s+=e[n&a>>o];if(o&&(s+=e[n&a<<r-o]),i)for(;s.length*r&7;)s+="=";return s},$t=({name:t,prefix:e,bitsPerChar:r,alphabet:i})=>El({prefix:e,name:t,encode(n){return z4(n,i,r)},decode(n){return j4(n,i,r,t)}}),H4=El({prefix:"\0",name:"identity",encode:t=>$4(t),decode:t=>k4(t)}),K4=Object.freeze(Object.defineProperty({__proto__:null,identity:H4},Symbol.toStringTag,{value:"Module"})),V4=$t({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),G4=Object.freeze(Object.defineProperty({__proto__:null,base2:V4},Symbol.toStringTag,{value:"Module"})),W4=$t({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),Y4=Object.freeze(Object.defineProperty({__proto__:null,base8:W4},Symbol.toStringTag,{value:"Module"})),J4=Ba({prefix:"9",name:"base10",alphabet:"0123456789"}),Q4=Object.freeze(Object.defineProperty({__proto__:null,base10:J4},Symbol.toStringTag,{value:"Module"})),Z4=$t({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),X4=$t({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),e5=Object.freeze(Object.defineProperty({__proto__:null,base16:Z4,base16upper:X4},Symbol.toStringTag,{value:"Module"})),t5=$t({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),r5=$t({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),i5=$t({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),n5=$t({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),s5=$t({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),o5=$t({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),a5=$t({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),c5=$t({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),l5=$t({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),u5=Object.freeze(Object.defineProperty({__proto__:null,base32:t5,base32hex:s5,base32hexpad:a5,base32hexpadupper:c5,base32hexupper:o5,base32pad:i5,base32padupper:n5,base32upper:r5,base32z:l5},Symbol.toStringTag,{value:"Module"})),h5=Ba({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),f5=Ba({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),d5=Object.freeze(Object.defineProperty({__proto__:null,base36:h5,base36upper:f5},Symbol.toStringTag,{value:"Module"})),p5=Ba({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),g5=Ba({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),m5=Object.freeze(Object.defineProperty({__proto__:null,base58btc:p5,base58flickr:g5},Symbol.toStringTag,{value:"Module"})),y5=$t({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),w5=$t({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),b5=$t({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),v5=$t({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),E5=Object.freeze(Object.defineProperty({__proto__:null,base64:y5,base64pad:w5,base64url:b5,base64urlpad:v5},Symbol.toStringTag,{value:"Module"})),Cb=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),x5=Cb.reduce((t,e,r)=>(t[r]=e,t),[]),A5=Cb.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function _5(t){return t.reduce((e,r)=>(e+=x5[r],e),"")}function I5(t){const e=[];for(const r of t){const i=A5[r.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(i)}return new Uint8Array(e)}const S5=El({prefix:"🚀",name:"base256emoji",encode:_5,decode:I5}),P5=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:S5},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const _0={...K4,...G4,...Y4,...Q4,...e5,...u5,...d5,...m5,...E5,...P5};function Bb(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}const I0=Bb("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Lu=Bb("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=Db(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Rb={utf8:I0,"utf-8":I0,hex:_0.base16,latin1:Lu,ascii:Lu,binary:Lu,..._0};function Lr(t,e="utf8"){const r=Rb[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?nd(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}function hr(t,e="utf8"){const r=Rb[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}const O5={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}},D5="Input must be an string, Buffer or Uint8Array";function N5(t){let e;if(t instanceof Uint8Array)e=t;else if(typeof t=="string")e=new TextEncoder().encode(t);else throw new Error(D5);return e}function C5(t){return Array.prototype.map.call(t,function(e){return(e<16?"0":"")+e.toString(16)}).join("")}function Ja(t){return(4294967296+t).toString(16).substring(1)}function B5(t,e,r){let i=`
`+t+" = ";for(let n=0;n<e.length;n+=2){if(r===32)i+=Ja(e[n]).toUpperCase(),i+=" ",i+=Ja(e[n+1]).toUpperCase();else if(r===64)i+=Ja(e[n+1]).toUpperCase(),i+=Ja(e[n]).toUpperCase();else throw new Error("Invalid size "+r);n%6===4?i+=`
`+new Array(t.length+4).join(" "):n<e.length-2&&(i+=" ")}console.log(i)}function R5(t,e,r){let i=new Date().getTime();const n=new Uint8Array(e);for(let o=0;o<e;o++)n[o]=o%256;const s=new Date().getTime();console.log("Generated random input in "+(s-i)+"ms"),i=s;for(let o=0;o<r;o++){const a=t(n),c=new Date().getTime(),l=c-i;i=c,console.log("Hashed in "+l+"ms: "+a.substring(0,20)+"..."),console.log(Math.round(e/(1<<20)/(l/1e3)*100)/100+" MB PER SECOND")}}var Tb={normalizeInput:N5,toHex:C5,debugPrint:B5,testSpeed:R5};const xc=Tb;function Qa(t,e,r){const i=t[e]+t[r];let n=t[e+1]+t[r+1];i>=4294967296&&n++,t[e]=i,t[e+1]=n}function S0(t,e,r,i){let n=t[e]+r;r<0&&(n+=4294967296);let s=t[e+1]+i;n>=4294967296&&s++,t[e]=n,t[e+1]=s}function Mb(t,e){return t[e]^t[e+1]<<8^t[e+2]<<16^t[e+3]<<24}function wn(t,e,r,i,n,s){const o=Xo[n],a=Xo[n+1],c=Xo[s],l=Xo[s+1];Qa(ae,t,e),S0(ae,t,o,a);let u=ae[i]^ae[t],h=ae[i+1]^ae[t+1];ae[i]=h,ae[i+1]=u,Qa(ae,r,i),u=ae[e]^ae[r],h=ae[e+1]^ae[r+1],ae[e]=u>>>24^h<<8,ae[e+1]=h>>>24^u<<8,Qa(ae,t,e),S0(ae,t,c,l),u=ae[i]^ae[t],h=ae[i+1]^ae[t+1],ae[i]=u>>>16^h<<16,ae[i+1]=h>>>16^u<<16,Qa(ae,r,i),u=ae[e]^ae[r],h=ae[e+1]^ae[r+1],ae[e]=h>>>31^u<<1,ae[e+1]=u>>>31^h<<1}const kb=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),T5=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3],Ft=new Uint8Array(T5.map(function(t){return t*2})),ae=new Uint32Array(32),Xo=new Uint32Array(32);function $b(t,e){let r=0;for(r=0;r<16;r++)ae[r]=t.h[r],ae[r+16]=kb[r];for(ae[24]=ae[24]^t.t,ae[25]=ae[25]^t.t/4294967296,e&&(ae[28]=~ae[28],ae[29]=~ae[29]),r=0;r<32;r++)Xo[r]=Mb(t.b,4*r);for(r=0;r<12;r++)wn(0,8,16,24,Ft[r*16+0],Ft[r*16+1]),wn(2,10,18,26,Ft[r*16+2],Ft[r*16+3]),wn(4,12,20,28,Ft[r*16+4],Ft[r*16+5]),wn(6,14,22,30,Ft[r*16+6],Ft[r*16+7]),wn(0,10,20,30,Ft[r*16+8],Ft[r*16+9]),wn(2,12,22,24,Ft[r*16+10],Ft[r*16+11]),wn(4,14,16,26,Ft[r*16+12],Ft[r*16+13]),wn(6,8,18,28,Ft[r*16+14],Ft[r*16+15]);for(r=0;r<16;r++)t.h[r]=t.h[r]^ae[r]^ae[r+16]}const bn=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);function Ub(t,e,r,i){if(t===0||t>64)throw new Error("Illegal output length, expected 0 < length <= 64");if(e&&e.length>64)throw new Error("Illegal key, expected Uint8Array with 0 < length <= 64");if(r&&r.length!==16)throw new Error("Illegal salt, expected Uint8Array with length is 16");if(i&&i.length!==16)throw new Error("Illegal personal, expected Uint8Array with length is 16");const n={b:new Uint8Array(128),h:new Uint32Array(16),t:0,c:0,outlen:t};bn.fill(0),bn[0]=t,e&&(bn[1]=e.length),bn[2]=1,bn[3]=1,r&&bn.set(r,32),i&&bn.set(i,48);for(let s=0;s<16;s++)n.h[s]=kb[s]^Mb(bn,s*4);return e&&(sd(n,e),n.c=128),n}function sd(t,e){for(let r=0;r<e.length;r++)t.c===128&&(t.t+=t.c,$b(t,!1),t.c=0),t.b[t.c++]=e[r]}function Lb(t){for(t.t+=t.c;t.c<128;)t.b[t.c++]=0;$b(t,!0);const e=new Uint8Array(t.outlen);for(let r=0;r<t.outlen;r++)e[r]=t.h[r>>2]>>8*(r&3);return e}function Fb(t,e,r,i,n){r=r||64,t=xc.normalizeInput(t),i&&(i=xc.normalizeInput(i)),n&&(n=xc.normalizeInput(n));const s=Ub(r,e,i,n);return sd(s,t),Lb(s)}function M5(t,e,r,i,n){const s=Fb(t,e,r,i,n);return xc.toHex(s)}var k5={blake2b:Fb,blake2bHex:M5,blake2bInit:Ub,blake2bUpdate:sd,blake2bFinal:Lb};const qb=Tb;function $5(t,e){return t[e]^t[e+1]<<8^t[e+2]<<16^t[e+3]<<24}function vn(t,e,r,i,n,s){be[t]=be[t]+be[e]+n,be[i]=Za(be[i]^be[t],16),be[r]=be[r]+be[i],be[e]=Za(be[e]^be[r],12),be[t]=be[t]+be[e]+s,be[i]=Za(be[i]^be[t],8),be[r]=be[r]+be[i],be[e]=Za(be[e]^be[r],7)}function Za(t,e){return t>>>e^t<<32-e}const jb=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),qt=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0]),be=new Uint32Array(16),St=new Uint32Array(16);function zb(t,e){let r=0;for(r=0;r<8;r++)be[r]=t.h[r],be[r+8]=jb[r];for(be[12]^=t.t,be[13]^=t.t/4294967296,e&&(be[14]=~be[14]),r=0;r<16;r++)St[r]=$5(t.b,4*r);for(r=0;r<10;r++)vn(0,4,8,12,St[qt[r*16+0]],St[qt[r*16+1]]),vn(1,5,9,13,St[qt[r*16+2]],St[qt[r*16+3]]),vn(2,6,10,14,St[qt[r*16+4]],St[qt[r*16+5]]),vn(3,7,11,15,St[qt[r*16+6]],St[qt[r*16+7]]),vn(0,5,10,15,St[qt[r*16+8]],St[qt[r*16+9]]),vn(1,6,11,12,St[qt[r*16+10]],St[qt[r*16+11]]),vn(2,7,8,13,St[qt[r*16+12]],St[qt[r*16+13]]),vn(3,4,9,14,St[qt[r*16+14]],St[qt[r*16+15]]);for(r=0;r<8;r++)t.h[r]^=be[r]^be[r+8]}function Hb(t,e){if(!(t>0&&t<=32))throw new Error("Incorrect output length, should be in [1, 32]");const r=e?e.length:0;if(e&&!(r>0&&r<=32))throw new Error("Incorrect key length, should be in [1, 32]");const i={h:new Uint32Array(jb),b:new Uint8Array(64),c:0,t:0,outlen:t};return i.h[0]^=16842752^r<<8^t,r>0&&(od(i,e),i.c=64),i}function od(t,e){for(let r=0;r<e.length;r++)t.c===64&&(t.t+=t.c,zb(t,!1),t.c=0),t.b[t.c++]=e[r]}function Kb(t){for(t.t+=t.c;t.c<64;)t.b[t.c++]=0;zb(t,!0);const e=new Uint8Array(t.outlen);for(let r=0;r<t.outlen;r++)e[r]=t.h[r>>2]>>8*(r&3)&255;return e}function Vb(t,e,r){r=r||32,t=qb.normalizeInput(t);const i=Hb(r,e);return od(i,t),Kb(i)}function U5(t,e,r){const i=Vb(t,e,r);return qb.toHex(i)}var L5={blake2s:Vb,blake2sHex:U5,blake2sInit:Hb,blake2sUpdate:od,blake2sFinal:Kb};const Fo=k5,qo=L5;var F5={blake2b:Fo.blake2b,blake2bHex:Fo.blake2bHex,blake2bInit:Fo.blake2bInit,blake2bUpdate:Fo.blake2bUpdate,blake2bFinal:Fo.blake2bFinal,blake2s:qo.blake2s,blake2sHex:qo.blake2sHex,blake2sInit:qo.blake2sInit,blake2sUpdate:qo.blake2sUpdate,blake2sFinal:qo.blake2sFinal},xl={exports:{}};function q5(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}var j5=z5;function z5(t,e,r){var i=r&&r.stringify||q5,n=1;if(typeof t=="object"&&t!==null){var s=e.length+n;if(s===1)return t;var o=new Array(s);o[0]=i(t);for(var a=1;a<s;a++)o[a]=i(e[a]);return o.join(" ")}if(typeof t!="string")return t;var c=e.length;if(c===0)return t;for(var l="",u=1-n,h=-1,g=t&&t.length||0,y=0;y<g;){if(t.charCodeAt(y)===37&&y+1<g){switch(h=h>-1?h:0,t.charCodeAt(y+1)){case 100:case 102:if(u>=c||e[u]==null)break;h<y&&(l+=t.slice(h,y)),l+=Number(e[u]),h=y+2,y++;break;case 105:if(u>=c||e[u]==null)break;h<y&&(l+=t.slice(h,y)),l+=Math.floor(Number(e[u])),h=y+2,y++;break;case 79:case 111:case 106:if(u>=c||e[u]===void 0)break;h<y&&(l+=t.slice(h,y));var w=typeof e[u];if(w==="string"){l+="'"+e[u]+"'",h=y+2,y++;break}if(w==="function"){l+=e[u].name||"<anonymous>",h=y+2,y++;break}l+=i(e[u]),h=y+2,y++;break;case 115:if(u>=c)break;h<y&&(l+=t.slice(h,y)),l+=String(e[u]),h=y+2,y++;break;case 37:h<y&&(l+=t.slice(h,y)),l+="%",h=y+2,y++,u--;break}++u}++y}return h===-1?t:(h<g&&(l+=t.slice(h)),l)}const P0=j5;xl.exports=nn;const ba=nP().console||{},H5={mapHttpRequest:Xa,mapHttpResponse:Xa,wrapRequestSerializer:Fu,wrapResponseSerializer:Fu,wrapErrorSerializer:Fu,req:Xa,res:Xa,err:D0,errWithCause:D0};function Tn(t,e){return t==="silent"?1/0:e.levels.values[t]}const ad=Symbol("pino.logFuncs"),Fh=Symbol("pino.hierarchy"),K5={error:"log",fatal:"error",warn:"error",info:"log",debug:"log",trace:"log"};function O0(t,e){const r={logger:e,parent:t[Fh]};e[Fh]=r}function V5(t,e,r){const i={};e.forEach(n=>{i[n]=r[n]?r[n]:ba[n]||ba[K5[n]||"log"]||no}),t[ad]=i}function G5(t,e){return Array.isArray(t)?t.filter(function(i){return i!=="!stdSerializers.err"}):t===!0?Object.keys(e):!1}function nn(t){t=t||{},t.browser=t.browser||{};const e=t.browser.transmit;if(e&&typeof e.send!="function")throw Error("pino: transmit option must have a send function");const r=t.browser.write||ba;t.browser.write&&(t.browser.asObject=!0);const i=t.serializers||{},n=G5(t.browser.serialize,i);let s=t.browser.serialize;Array.isArray(t.browser.serialize)&&t.browser.serialize.indexOf("!stdSerializers.err")>-1&&(s=!1);const o=Object.keys(t.customLevels||{}),a=["error","fatal","warn","info","debug","trace"].concat(o);typeof r=="function"&&a.forEach(function(E){r[E]=r}),(t.enabled===!1||t.browser.disabled)&&(t.level="silent");const c=t.level||"info",l=Object.create(r);l.log||(l.log=no),V5(l,a,r),O0({},l),Object.defineProperty(l,"levelVal",{get:h}),Object.defineProperty(l,"level",{get:g,set:y});const u={transmit:e,serialize:n,asObject:t.browser.asObject,asObjectBindingsOnly:t.browser.asObjectBindingsOnly,formatters:t.browser.formatters,levels:a,timestamp:tP(t),messageKey:t.messageKey||"msg",onChild:t.onChild||no};l.levels=W5(t),l.level=c,l.isLevelEnabled=function(E){return this.levels.values[E]?this.levels.values[E]>=this.levels.values[this.level]:!1},l.setMaxListeners=l.getMaxListeners=l.emit=l.addListener=l.on=l.prependListener=l.once=l.prependOnceListener=l.removeListener=l.removeAllListeners=l.listeners=l.listenerCount=l.eventNames=l.write=l.flush=no,l.serializers=i,l._serialize=n,l._stdErrSerialize=s,l.child=function(...E){return w.call(this,u,...E)},e&&(l._logEvent=qh());function h(){return Tn(this.level,this)}function g(){return this._level}function y(E){if(E!=="silent"&&!this.levels.values[E])throw Error("unknown level "+E);this._level=E,rs(this,u,l,"error"),rs(this,u,l,"fatal"),rs(this,u,l,"warn"),rs(this,u,l,"info"),rs(this,u,l,"debug"),rs(this,u,l,"trace"),o.forEach(P=>{rs(this,u,l,P)})}function w(E,P,N){if(!P)throw new Error("missing bindings for child Pino");N=N||{},n&&P.serializers&&(N.serializers=P.serializers);const R=N.serializers;if(n&&R){var D=Object.assign({},i,R),C=t.browser.serialize===!0?Object.keys(D):n;delete P.serializers,cd([P],C,D,this._stdErrSerialize)}function B(L){this._childLevel=(L._childLevel|0)+1,this.bindings=P,D&&(this.serializers=D,this._serialize=C),e&&(this._logEvent=qh([].concat(L._logEvent.bindings,P)))}B.prototype=this;const M=new B(this);return O0(this,M),M.child=function(...L){return w.call(this,E,...L)},M.level=N.level||this.level,E.onChild(M),M}return l}function W5(t){const e=t.customLevels||{},r=Object.assign({},nn.levels.values,e),i=Object.assign({},nn.levels.labels,Y5(e));return{values:r,labels:i}}function Y5(t){const e={};return Object.keys(t).forEach(function(r){e[t[r]]=r}),e}nn.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};nn.stdSerializers=H5;nn.stdTimeFunctions=Object.assign({},{nullTime:Gb,epochTime:Wb,unixTime:rP,isoTime:iP});function J5(t){const e=[];t.bindings&&e.push(t.bindings);let r=t[Fh];for(;r.parent;)r=r.parent,r.logger.bindings&&e.push(r.logger.bindings);return e.reverse()}function rs(t,e,r,i){if(Object.defineProperty(t,i,{value:Tn(t.level,r)>Tn(i,r)?no:r[ad][i],writable:!0,enumerable:!0,configurable:!0}),t[i]===no){if(!e.transmit)return;const s=e.transmit.level||t.level,o=Tn(s,r);if(Tn(i,r)<o)return}t[i]=Z5(t,e,r,i);const n=J5(t);n.length!==0&&(t[i]=Q5(n,t[i]))}function Q5(t,e){return function(){return e.apply(this,[...t,...arguments])}}function Z5(t,e,r,i){return function(n){return function(){const o=e.timestamp(),a=new Array(arguments.length),c=Object.getPrototypeOf&&Object.getPrototypeOf(this)===ba?ba:this;for(var l=0;l<a.length;l++)a[l]=arguments[l];var u=!1;if(e.serialize&&(cd(a,this._serialize,this.serializers,this._stdErrSerialize),u=!0),e.asObject||e.formatters?n.call(c,...X5(this,i,a,o,e)):n.apply(c,a),e.transmit){const h=e.transmit.level||t._level,g=Tn(h,r),y=Tn(i,r);if(y<g)return;eP(this,{ts:o,methodLevel:i,methodValue:y,transmitValue:r.levels.values[e.transmit.level||t._level],send:e.transmit.send,val:Tn(t._level,r)},a,u)}}}(t[ad][i])}function X5(t,e,r,i,n){const{level:s,log:o=h=>h}=n.formatters||{},a=r.slice();let c=a[0];const l={};let u=(t._childLevel|0)+1;if(u<1&&(u=1),i&&(l.time=i),s){const h=s(e,t.levels.values[e]);Object.assign(l,h)}else l.level=t.levels.values[e];if(n.asObjectBindingsOnly){if(c!==null&&typeof c=="object")for(;u--&&typeof a[0]=="object";)Object.assign(l,a.shift());return[o(l),...a]}else{if(c!==null&&typeof c=="object"){for(;u--&&typeof a[0]=="object";)Object.assign(l,a.shift());c=a.length?P0(a.shift(),a):void 0}else typeof c=="string"&&(c=P0(a.shift(),a));return c!==void 0&&(l[n.messageKey]=c),[o(l)]}}function cd(t,e,r,i){for(const n in t)if(i&&t[n]instanceof Error)t[n]=nn.stdSerializers.err(t[n]);else if(typeof t[n]=="object"&&!Array.isArray(t[n])&&e)for(const s in t[n])e.indexOf(s)>-1&&s in r&&(t[n][s]=r[s](t[n][s]))}function eP(t,e,r,i=!1){const n=e.send,s=e.ts,o=e.methodLevel,a=e.methodValue,c=e.val,l=t._logEvent.bindings;i||cd(r,t._serialize||Object.keys(t.serializers),t.serializers,t._stdErrSerialize===void 0?!0:t._stdErrSerialize),t._logEvent.ts=s,t._logEvent.messages=r.filter(function(u){return l.indexOf(u)===-1}),t._logEvent.level.label=o,t._logEvent.level.value=a,n(o,t._logEvent,c),t._logEvent=qh(l)}function qh(t){return{ts:0,messages:[],bindings:t||[],level:{label:"",value:0}}}function D0(t){const e={type:t.constructor.name,msg:t.message,stack:t.stack};for(const r in t)e[r]===void 0&&(e[r]=t[r]);return e}function tP(t){return typeof t.timestamp=="function"?t.timestamp:t.timestamp===!1?Gb:Wb}function Xa(){return{}}function Fu(t){return t}function no(){}function Gb(){return!1}function Wb(){return Date.now()}function rP(){return Math.round(Date.now()/1e3)}function iP(){return new Date(Date.now()).toISOString()}function nP(){function t(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return t(self)||t(window)||t(this)||{}}}xl.exports.default=nn;xl.exports.pino=nn;var Vs=xl.exports;const Yb=Os(Vs),sP={level:"info"},Al="custom_context",ld=1e3*1024;var oP=Object.defineProperty,aP=(t,e,r)=>e in t?oP(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Cn=(t,e,r)=>aP(t,typeof e!="symbol"?e+"":e,r);let cP=class{constructor(e){Cn(this,"nodeValue"),Cn(this,"sizeInBytes"),Cn(this,"next"),this.nodeValue=e,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}},N0=class{constructor(e){Cn(this,"lengthInNodes"),Cn(this,"sizeInBytes"),Cn(this,"head"),Cn(this,"tail"),Cn(this,"maxSizeInBytes"),this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}append(e){const r=new cP(e);if(r.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${e} with size ${r.size}`);for(;this.size+r.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=r),this.tail=r):(this.head=r,this.tail=r),this.lengthInNodes++,this.sizeInBytes+=r.size}shift(){if(!this.head)return;const e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}toArray(){const e=[];let r=this.head;for(;r!==null;)e.push(r.value),r=r.next;return e}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let e=this.head;return{next:()=>{if(!e)return{done:!0,value:null};const r=e.value;return e=e.next,{done:!1,value:r}}}}};var lP=Object.defineProperty,uP=(t,e,r)=>e in t?lP(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ec=(t,e,r)=>uP(t,typeof e!="symbol"?e+"":e,r);let Jb=class{constructor(e,r=ld){ec(this,"logs"),ec(this,"level"),ec(this,"levelValue"),ec(this,"MAX_LOG_SIZE_IN_BYTES"),this.level=e??"error",this.levelValue=Vs.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=r,this.logs=new N0(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(e,r){r===Vs.levels.values.error?console.error(e):r===Vs.levels.values.warn?console.warn(e):r===Vs.levels.values.debug?console.debug(e):r===Vs.levels.values.trace?console.trace(e):console.log(e)}appendToLogs(e){this.logs.append(rn({timestamp:new Date().toISOString(),log:e}));const r=typeof e=="string"?JSON.parse(e).level:e.level;r>=this.levelValue&&this.forwardToConsole(e,r)}getLogs(){return this.logs}clearLogs(){this.logs=new N0(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(e){const r=this.getLogArray();return r.push(rn({extraMetadata:e})),new Blob(r,{type:"application/json"})}};var hP=Object.defineProperty,fP=(t,e,r)=>e in t?hP(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,dP=(t,e,r)=>fP(t,e+"",r);let pP=class{constructor(e,r=ld){dP(this,"baseChunkLogger"),this.baseChunkLogger=new Jb(e,r)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}downloadLogsBlobInBrowser(e){const r=URL.createObjectURL(this.logsToBlob(e)),i=document.createElement("a");i.href=r,i.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(r)}};var gP=Object.defineProperty,mP=(t,e,r)=>e in t?gP(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,yP=(t,e,r)=>mP(t,e+"",r);let wP=class{constructor(e,r=ld){yP(this,"baseChunkLogger"),this.baseChunkLogger=new Jb(e,r)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}};var bP=Object.defineProperty,vP=Object.defineProperties,EP=Object.getOwnPropertyDescriptors,C0=Object.getOwnPropertySymbols,xP=Object.prototype.hasOwnProperty,AP=Object.prototype.propertyIsEnumerable,B0=(t,e,r)=>e in t?bP(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Vc=(t,e)=>{for(var r in e||(e={}))xP.call(e,r)&&B0(t,r,e[r]);if(C0)for(var r of C0(e))AP.call(e,r)&&B0(t,r,e[r]);return t},Gc=(t,e)=>vP(t,EP(e));function _P(t){return Gc(Vc({},t),{level:(t==null?void 0:t.level)||sP.level})}function IP(t,e,r=Al){return t[r]=e,t}function pr(t,e=Al){return t[e]||""}function SP(t,e,r=Al){const i=pr(t,r);return i.trim()?`${i}/${e}`:e}function Dr(t,e,r=Al){const i=SP(t,e,r),n=t.child({context:i});return IP(n,i,r)}function PP(t){var e,r;const i=new pP((e=t.opts)==null?void 0:e.level,t.maxSizeInBytes);return{logger:Yb(Gc(Vc({},t.opts),{level:"trace",browser:Gc(Vc({},(r=t.opts)==null?void 0:r.browser),{write:n=>i.write(n)})})),chunkLoggerController:i}}function OP(t){var e;const r=new wP((e=t.opts)==null?void 0:e.level,t.maxSizeInBytes);return{logger:Yb(Gc(Vc({},t.opts),{level:"trace"}),r),chunkLoggerController:r}}function Qb(t){return typeof t.loggerOverride<"u"&&typeof t.loggerOverride!="string"?{logger:t.loggerOverride,chunkLoggerController:null}:typeof window<"u"?PP(t):OP(t)}var DP={};const NP=":";function Qi(t){const[e,r]=t.split(NP);return{namespace:e,reference:r}}function R0(t,e=[]){const r=[];return Object.keys(t).forEach(i=>{if(e.length&&!e.includes(i))return;const n=t[i];r.push(...n.accounts)}),r}function Zb(t,e){return t.includes(":")?[t]:e.chains||[]}var CP=Object.defineProperty,BP=Object.defineProperties,RP=Object.getOwnPropertyDescriptors,T0=Object.getOwnPropertySymbols,TP=Object.prototype.hasOwnProperty,MP=Object.prototype.propertyIsEnumerable,jh=(t,e,r)=>e in t?CP(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,M0=(t,e)=>{for(var r in e||(e={}))TP.call(e,r)&&jh(t,r,e[r]);if(T0)for(var r of T0(e))MP.call(e,r)&&jh(t,r,e[r]);return t},kP=(t,e)=>BP(t,RP(e)),k0=(t,e,r)=>jh(t,typeof e!="symbol"?e+"":e,r);const $P="ReactNative",Ir={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},UP="js";function Wc(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function qn(){return!xs()&&!!Lf()&&navigator.product===$P}function LP(){return qn()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="android"}function FP(){return qn()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="ios"}function Po(){return!Wc()&&!!Lf()&&!!xs()}function Ra(){return qn()?Ir.reactNative:Wc()?Ir.node:Po()?Ir.browser:Ir.unknown}function $0(){var t;try{return qn()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(t=global.Application)==null?void 0:t.applicationId:void 0}catch{return}}function qP(t,e){const r=new URLSearchParams(t);return Object.entries(e).sort(([i],[n])=>i.localeCompare(n)).forEach(([i,n])=>{n!=null&&r.set(i,String(n))}),r.toString()}function jP(t){var e,r;const i=Xb();try{return t!=null&&t.url&&i.url&&new URL(t.url).host!==new URL(i.url).host&&(console.warn(`The configured WalletConnect 'metadata.url':${t.url} differs from the actual page url:${i.url}. This is probably unintended and can lead to issues.`),t.url=i.url),(e=t==null?void 0:t.icons)!=null&&e.length&&t.icons.length>0&&(t.icons=t.icons.filter(n=>n!=="")),kP(M0(M0({},i),t),{url:(t==null?void 0:t.url)||i.url,name:(t==null?void 0:t.name)||i.name,description:(t==null?void 0:t.description)||i.description,icons:(r=t==null?void 0:t.icons)!=null&&r.length&&t.icons.length>0?t.icons:i.icons})}catch(n){return console.warn("Error populating app metadata",n),t||i}}function Xb(){return hw()||{name:"",description:"",url:"",icons:[""]}}function zP(){if(Ra()===Ir.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:r,Version:i}=global.Platform;return[r,i].join("-")}const t=s3();if(t===null)return"unknown";const e=t.os?t.os.replace(" ","").toLowerCase():"unknown";return t.type==="browser"?[e,t.name,t.version].join("-"):[e,t.version].join("-")}function HP(){var t;const e=Ra();return e===Ir.browser?[e,((t=uw())==null?void 0:t.host)||"unknown"].join(":"):e}function e1(t,e,r){const i=zP(),n=HP();return[[t,e].join("-"),[UP,r].join("-"),i,n].join("/")}function KP({protocol:t,version:e,relayUrl:r,sdkVersion:i,auth:n,projectId:s,useOnCloseEvent:o,bundleId:a,packageName:c}){const l=r.split("?"),u=e1(t,e,i),h={auth:n,ua:u,projectId:s,useOnCloseEvent:o,packageName:c||void 0,bundleId:a||void 0},g=qP(l[1]||"",h);return l[0]+"?"+g}function ds(t,e){return t.filter(r=>e.includes(r)).length===t.length}function zh(t){return Object.fromEntries(t.entries())}function Hh(t){return new Map(Object.entries(t))}function os(t=Q.FIVE_MINUTES,e){const r=Q.toMiliseconds(t||Q.FIVE_MINUTES);let i,n,s,o;return{resolve:a=>{s&&i&&(clearTimeout(s),i(a),o=Promise.resolve(a))},reject:a=>{s&&n&&(clearTimeout(s),n(a))},done:()=>new Promise((a,c)=>{if(o)return a(o);s=setTimeout(()=>{const l=new Error(e);o=Promise.reject(l),c(l)},r),i=a,n=c})}}function vi(t,e,r){return new Promise(async(i,n)=>{const s=setTimeout(()=>n(new Error(r)),e);try{const o=await t;i(o)}catch(o){n(o)}clearTimeout(s)})}function t1(t,e){if(typeof e=="string"&&e.startsWith(`${t}:`))return e;if(t.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(t.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${t}`)}function VP(t){return t1("topic",t)}function GP(t){return t1("id",t)}function r1(t){const[e,r]=t.split(":"),i={id:void 0,topic:void 0};if(e==="topic"&&typeof r=="string")i.topic=r;else if(e==="id"&&Number.isInteger(Number(r)))i.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${r}`);return i}function dt(t,e){return Q.fromMiliseconds(Date.now()+Q.toMiliseconds(t))}function bi(t){return Date.now()>=Q.toMiliseconds(t)}function xe(t,e){return`${t}${e?`:${e}`:""}`}function _i(t=[],e=[]){return[...new Set([...t,...e])]}async function WP({id:t,topic:e,wcDeepLink:r}){var i;try{if(!r)return;const n=typeof r=="string"?JSON.parse(r):r,s=n==null?void 0:n.href;if(typeof s!="string")return;const o=YP(s,t,e),a=Ra();if(a===Ir.browser){if(!((i=xs())!=null&&i.hasFocus())){console.warn("Document does not have focus, skipping deeplink.");return}JP(o)}else a===Ir.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(o)}catch(n){console.error(n)}}function YP(t,e,r){const i=`requestId=${e}&sessionTopic=${r}`;t.endsWith("/")&&(t=t.slice(0,-1));let n=`${t}`;if(t.startsWith("https://t.me")){const s=t.includes("?")?"&startapp=":"?startapp=";n=`${n}${s}${eO(i,!0)}`}else n=`${n}/wc?${i}`;return n}function JP(t){let e="_self";XP()?e="_top":(ZP()||t.startsWith("https://")||t.startsWith("http://"))&&(e="_blank"),window.open(t,e,"noreferrer noopener")}async function QP(t,e){let r="";try{if(Po()&&(r=localStorage.getItem(e),r))return r;r=await t.getItem(e)}catch(i){console.error(i)}return r}function U0(t,e){if(!t.includes(e))return null;const r=t.split(/([&,?,=])/),i=r.indexOf(e);return r[i+2]}function L0(){return typeof crypto<"u"&&crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})}function ud(){return typeof process<"u"&&DP.IS_VITEST==="true"}function ZP(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)}function XP(){try{return window.self!==window.top}catch{return!1}}function eO(t,e=!1){const r=Buffer.from(t).toString("base64");return e?r.replace(/[=]/g,""):r}function i1(t){return Buffer.from(t,"base64").toString("utf-8")}function tO(t){return new Promise(e=>setTimeout(e,t))}let rO=class{constructor({limit:e}){k0(this,"limit"),k0(this,"set"),this.limit=e,this.set=new Set}add(e){if(!this.set.has(e)){if(this.set.size>=this.limit){const r=this.set.values().next().value;r&&this.set.delete(r)}this.set.add(e)}}has(e){return this.set.has(e)}};const tc=BigInt(2**32-1),F0=BigInt(32);function n1(t,e=!1){return e?{h:Number(t&tc),l:Number(t>>F0&tc)}:{h:Number(t>>F0&tc)|0,l:Number(t&tc)|0}}function s1(t,e=!1){const r=t.length;let i=new Uint32Array(r),n=new Uint32Array(r);for(let s=0;s<r;s++){const{h:o,l:a}=n1(t[s],e);[i[s],n[s]]=[o,a]}return[i,n]}const q0=(t,e,r)=>t>>>r,j0=(t,e,r)=>t<<32-r|e>>>r,On=(t,e,r)=>t>>>r|e<<32-r,Dn=(t,e,r)=>t<<32-r|e>>>r,ea=(t,e,r)=>t<<64-r|e>>>r-32,ta=(t,e,r)=>t>>>r-32|e<<64-r,iO=(t,e)=>e,nO=(t,e)=>t,sO=(t,e,r)=>t<<r|e>>>32-r,oO=(t,e,r)=>e<<r|t>>>32-r,aO=(t,e,r)=>e<<r-32|t>>>64-r,cO=(t,e,r)=>t<<r-32|e>>>64-r;function Xr(t,e,r,i){const n=(e>>>0)+(i>>>0);return{h:t+r+(n/2**32|0)|0,l:n|0}}const hd=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),fd=(t,e,r,i)=>e+r+i+(t/2**32|0)|0,lO=(t,e,r,i)=>(t>>>0)+(e>>>0)+(r>>>0)+(i>>>0),uO=(t,e,r,i,n)=>e+r+i+n+(t/2**32|0)|0,hO=(t,e,r,i,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(i>>>0)+(n>>>0),fO=(t,e,r,i,n,s)=>e+r+i+n+s+(t/2**32|0)|0,Fs=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function _l(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function sn(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function si(t,...e){if(!_l(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function Il(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");sn(t.outputLen),sn(t.blockLen)}function Ln(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function dd(t,e){si(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function va(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function jr(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function qu(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function hi(t,e){return t<<32-e|t>>>e}const o1=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function a1(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}const Fi=o1?t=>t:t=>a1(t);function dO(t){for(let e=0;e<t.length;e++)t[e]=a1(t[e]);return t}const Nn=o1?t=>t:dO,c1=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",pO=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function so(t){if(si(t),c1)return t.toHex();let e="";for(let r=0;r<t.length;r++)e+=pO[t[r]];return e}const $i={_0:48,_9:57,A:65,F:70,a:97,f:102};function z0(t){if(t>=$i._0&&t<=$i._9)return t-$i._0;if(t>=$i.A&&t<=$i.F)return t-($i.A-10);if(t>=$i.a&&t<=$i.f)return t-($i.a-10)}function Yc(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);if(c1)return Uint8Array.fromHex(t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const i=new Uint8Array(r);for(let n=0,s=0;n<r;n++,s+=2){const o=z0(t.charCodeAt(s)),a=z0(t.charCodeAt(s+1));if(o===void 0||a===void 0){const c=t[s]+t[s+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+s)}i[n]=o*16+a}return i}function l1(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function ii(t){return typeof t=="string"&&(t=l1(t)),si(t),t}function Bn(...t){let e=0;for(let i=0;i<t.length;i++){const n=t[i];si(n),e+=n.length}const r=new Uint8Array(e);for(let i=0,n=0;i<t.length;i++){const s=t[i];r.set(s,n),n+=s.length}return r}let Sl=class{};function Ta(t){const e=i=>t().update(ii(i)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function gO(t){const e=(i,n)=>t(n).update(ii(i)).digest(),r=t({});return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=i=>t(i),e}function Cs(t=32){if(Fs&&typeof Fs.getRandomValues=="function")return Fs.getRandomValues(new Uint8Array(t));if(Fs&&typeof Fs.randomBytes=="function")return Uint8Array.from(Fs.randomBytes(t));throw new Error("crypto.getRandomValues must be defined")}const mO=BigInt(0),jo=BigInt(1),yO=BigInt(2),wO=BigInt(7),bO=BigInt(256),vO=BigInt(113),u1=[],h1=[],f1=[];for(let t=0,e=jo,r=1,i=0;t<24;t++){[r,i]=[i,(2*r+3*i)%5],u1.push(2*(5*i+r)),h1.push((t+1)*(t+2)/2%64);let n=mO;for(let s=0;s<7;s++)e=(e<<jo^(e>>wO)*vO)%bO,e&yO&&(n^=jo<<(jo<<BigInt(s))-jo);f1.push(n)}const d1=s1(f1,!0),EO=d1[0],xO=d1[1],H0=(t,e,r)=>r>32?aO(t,e,r):sO(t,e,r),K0=(t,e,r)=>r>32?cO(t,e,r):oO(t,e,r);function AO(t,e=24){const r=new Uint32Array(10);for(let i=24-e;i<24;i++){for(let o=0;o<10;o++)r[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=r[c],u=r[c+1],h=H0(l,u,1)^r[a],g=K0(l,u,1)^r[a+1];for(let y=0;y<50;y+=10)t[o+y]^=h,t[o+y+1]^=g}let n=t[2],s=t[3];for(let o=0;o<24;o++){const a=h1[o],c=H0(n,s,a),l=K0(n,s,a),u=u1[o];n=t[u],s=t[u+1],t[u]=c,t[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)r[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~r[(a+2)%10]&r[(a+4)%10]}t[0]^=EO[i],t[1]^=xO[i]}jr(r)}let _O=class p1 extends Sl{constructor(e,r,i,n=!1,s=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=r,this.outputLen=i,this.enableXOF=n,this.rounds=s,sn(i),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=va(this.state)}clone(){return this._cloneInto()}keccak(){Nn(this.state32),AO(this.state32,this.rounds),Nn(this.state32),this.posOut=0,this.pos=0}update(e){Ln(this),e=ii(e),si(e);const{blockLen:r,state:i}=this,n=e.length;for(let s=0;s<n;){const o=Math.min(r-this.pos,n-s);for(let a=0;a<o;a++)i[this.pos++]^=e[s++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:r,pos:i,blockLen:n}=this;e[i]^=r,r&128&&i===n-1&&this.keccak(),e[n-1]^=128,this.keccak()}writeInto(e){Ln(this,!1),si(e),this.finish();const r=this.state,{blockLen:i}=this;for(let n=0,s=e.length;n<s;){this.posOut>=i&&this.keccak();const o=Math.min(i-this.posOut,s-n);e.set(r.subarray(this.posOut,this.posOut+o),n),this.posOut+=o,n+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return sn(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(dd(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,jr(this.state)}_cloneInto(e){const{blockLen:r,suffix:i,outputLen:n,rounds:s,enableXOF:o}=this;return e||(e=new p1(r,i,n,o,s)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=s,e.suffix=i,e.outputLen=n,e.enableXOF=o,e.destroyed=this.destroyed,e}};const IO=(t,e,r)=>Ta(()=>new _O(e,t,r)),SO=IO(1,136,256/8);function PO(t,e,r,i){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,i);const n=BigInt(32),s=BigInt(4294967295),o=Number(r>>n&s),a=Number(r&s),c=i?4:0,l=i?0:4;t.setUint32(e+c,o,i),t.setUint32(e+l,a,i)}function OO(t,e,r){return t&e^~t&r}function DO(t,e,r){return t&e^t&r^e&r}let g1=class extends Sl{constructor(e,r,i,n){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=r,this.padOffset=i,this.isLE=n,this.buffer=new Uint8Array(e),this.view=qu(this.buffer)}update(e){Ln(this),e=ii(e),si(e);const{view:r,buffer:i,blockLen:n}=this,s=e.length;for(let o=0;o<s;){const a=Math.min(n-this.pos,s-o);if(a===n){const c=qu(e);for(;n<=s-o;o+=n)this.process(c,o);continue}i.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===n&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Ln(this),dd(e,this),this.finished=!0;const{buffer:r,view:i,blockLen:n,isLE:s}=this;let{pos:o}=this;r[o++]=128,jr(this.buffer.subarray(o)),this.padOffset>n-o&&(this.process(i,0),o=0);for(let h=o;h<n;h++)r[h]=0;PO(i,n-8,BigInt(this.length*8),s),this.process(i,0);const a=qu(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<l;h++)a.setUint32(4*h,u[h],s)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const i=e.slice(0,r);return this.destroy(),i}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:i,length:n,finished:s,destroyed:o,pos:a}=this;return e.destroyed=o,e.finished=s,e.length=n,e.pos=a,n%r&&e.buffer.set(i),e}clone(){return this._cloneInto()}};const En=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),jt=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),zt=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),NO=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),xn=new Uint32Array(64);class CO extends g1{constructor(e=32){super(64,e,8,!1),this.A=En[0]|0,this.B=En[1]|0,this.C=En[2]|0,this.D=En[3]|0,this.E=En[4]|0,this.F=En[5]|0,this.G=En[6]|0,this.H=En[7]|0}get(){const{A:e,B:r,C:i,D:n,E:s,F:o,G:a,H:c}=this;return[e,r,i,n,s,o,a,c]}set(e,r,i,n,s,o,a,c){this.A=e|0,this.B=r|0,this.C=i|0,this.D=n|0,this.E=s|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,r){for(let h=0;h<16;h++,r+=4)xn[h]=e.getUint32(r,!1);for(let h=16;h<64;h++){const g=xn[h-15],y=xn[h-2],w=hi(g,7)^hi(g,18)^g>>>3,E=hi(y,17)^hi(y,19)^y>>>10;xn[h]=E+xn[h-7]+w+xn[h-16]|0}let{A:i,B:n,C:s,D:o,E:a,F:c,G:l,H:u}=this;for(let h=0;h<64;h++){const g=hi(a,6)^hi(a,11)^hi(a,25),y=u+g+OO(a,c,l)+NO[h]+xn[h]|0,w=(hi(i,2)^hi(i,13)^hi(i,22))+DO(i,n,s)|0;u=l,l=c,c=a,a=o+y|0,o=s,s=n,n=i,i=y+w|0}i=i+this.A|0,n=n+this.B|0,s=s+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(i,n,s,o,a,c,l,u)}roundClean(){jr(xn)}destroy(){this.set(0,0,0,0,0,0,0,0),jr(this.buffer)}}const m1=s1(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),BO=m1[0],RO=m1[1],An=new Uint32Array(80),_n=new Uint32Array(80);let pd=class extends g1{constructor(e=64){super(128,e,16,!1),this.Ah=zt[0]|0,this.Al=zt[1]|0,this.Bh=zt[2]|0,this.Bl=zt[3]|0,this.Ch=zt[4]|0,this.Cl=zt[5]|0,this.Dh=zt[6]|0,this.Dl=zt[7]|0,this.Eh=zt[8]|0,this.El=zt[9]|0,this.Fh=zt[10]|0,this.Fl=zt[11]|0,this.Gh=zt[12]|0,this.Gl=zt[13]|0,this.Hh=zt[14]|0,this.Hl=zt[15]|0}get(){const{Ah:e,Al:r,Bh:i,Bl:n,Ch:s,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:h,Fl:g,Gh:y,Gl:w,Hh:E,Hl:P}=this;return[e,r,i,n,s,o,a,c,l,u,h,g,y,w,E,P]}set(e,r,i,n,s,o,a,c,l,u,h,g,y,w,E,P){this.Ah=e|0,this.Al=r|0,this.Bh=i|0,this.Bl=n|0,this.Ch=s|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=h|0,this.Fl=g|0,this.Gh=y|0,this.Gl=w|0,this.Hh=E|0,this.Hl=P|0}process(e,r){for(let D=0;D<16;D++,r+=4)An[D]=e.getUint32(r),_n[D]=e.getUint32(r+=4);for(let D=16;D<80;D++){const C=An[D-15]|0,B=_n[D-15]|0,M=On(C,B,1)^On(C,B,8)^q0(C,B,7),L=Dn(C,B,1)^Dn(C,B,8)^j0(C,B,7),F=An[D-2]|0,k=_n[D-2]|0,V=On(F,k,19)^ea(F,k,61)^q0(F,k,6),H=Dn(F,k,19)^ta(F,k,61)^j0(F,k,6),$=lO(L,H,_n[D-7],_n[D-16]),A=uO($,M,V,An[D-7],An[D-16]);An[D]=A|0,_n[D]=$|0}let{Ah:i,Al:n,Bh:s,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:h,El:g,Fh:y,Fl:w,Gh:E,Gl:P,Hh:N,Hl:R}=this;for(let D=0;D<80;D++){const C=On(h,g,14)^On(h,g,18)^ea(h,g,41),B=Dn(h,g,14)^Dn(h,g,18)^ta(h,g,41),M=h&y^~h&E,L=g&w^~g&P,F=hO(R,B,L,RO[D],_n[D]),k=fO(F,N,C,M,BO[D],An[D]),V=F|0,H=On(i,n,28)^ea(i,n,34)^ea(i,n,39),$=Dn(i,n,28)^ta(i,n,34)^ta(i,n,39),A=i&s^i&a^s&a,d=n&o^n&c^o&c;N=E|0,R=P|0,E=y|0,P=w|0,y=h|0,w=g|0,{h,l:g}=Xr(l|0,u|0,k|0,V|0),l=a|0,u=c|0,a=s|0,c=o|0,s=i|0,o=n|0;const f=hd(V,$,d);i=fd(f,k,H,A),n=f|0}({h:i,l:n}=Xr(this.Ah|0,this.Al|0,i|0,n|0)),{h:s,l:o}=Xr(this.Bh|0,this.Bl|0,s|0,o|0),{h:a,l:c}=Xr(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=Xr(this.Dh|0,this.Dl|0,l|0,u|0),{h,l:g}=Xr(this.Eh|0,this.El|0,h|0,g|0),{h:y,l:w}=Xr(this.Fh|0,this.Fl|0,y|0,w|0),{h:E,l:P}=Xr(this.Gh|0,this.Gl|0,E|0,P|0),{h:N,l:R}=Xr(this.Hh|0,this.Hl|0,N|0,R|0),this.set(i,n,s,o,a,c,l,u,h,g,y,w,E,P,N,R)}roundClean(){jr(An,_n)}destroy(){jr(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};class TO extends pd{constructor(){super(48),this.Ah=jt[0]|0,this.Al=jt[1]|0,this.Bh=jt[2]|0,this.Bl=jt[3]|0,this.Ch=jt[4]|0,this.Cl=jt[5]|0,this.Dh=jt[6]|0,this.Dl=jt[7]|0,this.Eh=jt[8]|0,this.El=jt[9]|0,this.Fh=jt[10]|0,this.Fl=jt[11]|0,this.Gh=jt[12]|0,this.Gl=jt[13]|0,this.Hh=jt[14]|0,this.Hl=jt[15]|0}}const Ht=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]);class MO extends pd{constructor(){super(32),this.Ah=Ht[0]|0,this.Al=Ht[1]|0,this.Bh=Ht[2]|0,this.Bl=Ht[3]|0,this.Ch=Ht[4]|0,this.Cl=Ht[5]|0,this.Dh=Ht[6]|0,this.Dl=Ht[7]|0,this.Eh=Ht[8]|0,this.El=Ht[9]|0,this.Fh=Ht[10]|0,this.Fl=Ht[11]|0,this.Gh=Ht[12]|0,this.Gl=Ht[13]|0,this.Hh=Ht[14]|0,this.Hl=Ht[15]|0}}const Pl=Ta(()=>new CO),kO=Ta(()=>new pd),$O=Ta(()=>new TO),UO=Ta(()=>new MO),LO=Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]),yt=Uint32Array.from([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),ee=new Uint32Array(32);function In(t,e,r,i,n,s){const o=n[s],a=n[s+1];let c=ee[2*t],l=ee[2*t+1],u=ee[2*e],h=ee[2*e+1],g=ee[2*r],y=ee[2*r+1],w=ee[2*i],E=ee[2*i+1],P=hd(c,u,o);l=fd(P,l,h,a),c=P|0,{Dh:E,Dl:w}={Dh:E^l,Dl:w^c},{Dh:E,Dl:w}={Dh:iO(E,w),Dl:nO(E)},{h:y,l:g}=Xr(y,g,E,w),{Bh:h,Bl:u}={Bh:h^y,Bl:u^g},{Bh:h,Bl:u}={Bh:On(h,u,24),Bl:Dn(h,u,24)},ee[2*t]=c,ee[2*t+1]=l,ee[2*e]=u,ee[2*e+1]=h,ee[2*r]=g,ee[2*r+1]=y,ee[2*i]=w,ee[2*i+1]=E}function Sn(t,e,r,i,n,s){const o=n[s],a=n[s+1];let c=ee[2*t],l=ee[2*t+1],u=ee[2*e],h=ee[2*e+1],g=ee[2*r],y=ee[2*r+1],w=ee[2*i],E=ee[2*i+1],P=hd(c,u,o);l=fd(P,l,h,a),c=P|0,{Dh:E,Dl:w}={Dh:E^l,Dl:w^c},{Dh:E,Dl:w}={Dh:On(E,w,16),Dl:Dn(E,w,16)},{h:y,l:g}=Xr(y,g,E,w),{Bh:h,Bl:u}={Bh:h^y,Bl:u^g},{Bh:h,Bl:u}={Bh:ea(h,u,63),Bl:ta(h,u,63)},ee[2*t]=c,ee[2*t+1]=l,ee[2*e]=u,ee[2*e+1]=h,ee[2*r]=g,ee[2*r+1]=y,ee[2*i]=w,ee[2*i+1]=E}function FO(t,e={},r,i,n){if(sn(r),t<0||t>r)throw new Error("outputLen bigger than keyLen");const{key:s,salt:o,personalization:a}=e;if(s!==void 0&&(s.length<1||s.length>r))throw new Error("key length must be undefined or 1.."+r);if(o!==void 0&&o.length!==i)throw new Error("salt must be undefined or "+i);if(a!==void 0&&a.length!==n)throw new Error("personalization must be undefined or "+n)}class qO extends Sl{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,this.length=0,this.pos=0,sn(e),sn(r),this.blockLen=e,this.outputLen=r,this.buffer=new Uint8Array(e),this.buffer32=va(this.buffer)}update(e){Ln(this),e=ii(e),si(e);const{blockLen:r,buffer:i,buffer32:n}=this,s=e.length,o=e.byteOffset,a=e.buffer;for(let c=0;c<s;){this.pos===r&&(Nn(n),this.compress(n,0,!1),Nn(n),this.pos=0);const l=Math.min(r-this.pos,s-c),u=o+c;if(l===r&&!(u%4)&&c+l<s){const h=new Uint32Array(a,u,Math.floor((s-c)/4));Nn(h);for(let g=0;c+r<s;g+=n.length,c+=r)this.length+=r,this.compress(h,g,!1);Nn(h);continue}i.set(e.subarray(c,c+l),this.pos),this.pos+=l,this.length+=l,c+=l}return this}digestInto(e){Ln(this),dd(e,this);const{pos:r,buffer32:i}=this;this.finished=!0,jr(this.buffer.subarray(r)),Nn(i),this.compress(i,0,!0),Nn(i);const n=va(e);this.get().forEach((s,o)=>n[o]=Fi(s))}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const i=e.slice(0,r);return this.destroy(),i}_cloneInto(e){const{buffer:r,length:i,finished:n,destroyed:s,outputLen:o,pos:a}=this;return e||(e=new this.constructor({dkLen:o})),e.set(...this.get()),e.buffer.set(r),e.destroyed=s,e.finished=n,e.length=i,e.pos=a,e.outputLen=o,e}clone(){return this._cloneInto()}}class jO extends qO{constructor(e={}){const r=e.dkLen===void 0?64:e.dkLen;super(128,r),this.v0l=yt[0]|0,this.v0h=yt[1]|0,this.v1l=yt[2]|0,this.v1h=yt[3]|0,this.v2l=yt[4]|0,this.v2h=yt[5]|0,this.v3l=yt[6]|0,this.v3h=yt[7]|0,this.v4l=yt[8]|0,this.v4h=yt[9]|0,this.v5l=yt[10]|0,this.v5h=yt[11]|0,this.v6l=yt[12]|0,this.v6h=yt[13]|0,this.v7l=yt[14]|0,this.v7h=yt[15]|0,FO(r,e,64,16,16);let{key:i,personalization:n,salt:s}=e,o=0;if(i!==void 0&&(i=ii(i),o=i.length),this.v0l^=this.outputLen|o<<8|65536|1<<24,s!==void 0){s=ii(s);const a=va(s);this.v4l^=Fi(a[0]),this.v4h^=Fi(a[1]),this.v5l^=Fi(a[2]),this.v5h^=Fi(a[3])}if(n!==void 0){n=ii(n);const a=va(n);this.v6l^=Fi(a[0]),this.v6h^=Fi(a[1]),this.v7l^=Fi(a[2]),this.v7h^=Fi(a[3])}if(i!==void 0){const a=new Uint8Array(this.blockLen);a.set(i),this.update(a)}}get(){let{v0l:e,v0h:r,v1l:i,v1h:n,v2l:s,v2h:o,v3l:a,v3h:c,v4l:l,v4h:u,v5l:h,v5h:g,v6l:y,v6h:w,v7l:E,v7h:P}=this;return[e,r,i,n,s,o,a,c,l,u,h,g,y,w,E,P]}set(e,r,i,n,s,o,a,c,l,u,h,g,y,w,E,P){this.v0l=e|0,this.v0h=r|0,this.v1l=i|0,this.v1h=n|0,this.v2l=s|0,this.v2h=o|0,this.v3l=a|0,this.v3h=c|0,this.v4l=l|0,this.v4h=u|0,this.v5l=h|0,this.v5h=g|0,this.v6l=y|0,this.v6h=w|0,this.v7l=E|0,this.v7h=P|0}compress(e,r,i){this.get().forEach((c,l)=>ee[l]=c),ee.set(yt,16);let{h:n,l:s}=n1(BigInt(this.length));ee[24]=yt[8]^s,ee[25]=yt[9]^n,i&&(ee[28]=~ee[28],ee[29]=~ee[29]);let o=0;const a=LO;for(let c=0;c<12;c++)In(0,4,8,12,e,r+2*a[o++]),Sn(0,4,8,12,e,r+2*a[o++]),In(1,5,9,13,e,r+2*a[o++]),Sn(1,5,9,13,e,r+2*a[o++]),In(2,6,10,14,e,r+2*a[o++]),Sn(2,6,10,14,e,r+2*a[o++]),In(3,7,11,15,e,r+2*a[o++]),Sn(3,7,11,15,e,r+2*a[o++]),In(0,5,10,15,e,r+2*a[o++]),Sn(0,5,10,15,e,r+2*a[o++]),In(1,6,11,12,e,r+2*a[o++]),Sn(1,6,11,12,e,r+2*a[o++]),In(2,7,8,13,e,r+2*a[o++]),Sn(2,7,8,13,e,r+2*a[o++]),In(3,4,9,14,e,r+2*a[o++]),Sn(3,4,9,14,e,r+2*a[o++]);this.v0l^=ee[0]^ee[16],this.v0h^=ee[1]^ee[17],this.v1l^=ee[2]^ee[18],this.v1h^=ee[3]^ee[19],this.v2l^=ee[4]^ee[20],this.v2h^=ee[5]^ee[21],this.v3l^=ee[6]^ee[22],this.v3h^=ee[7]^ee[23],this.v4l^=ee[8]^ee[24],this.v4h^=ee[9]^ee[25],this.v5l^=ee[10]^ee[26],this.v5h^=ee[11]^ee[27],this.v6l^=ee[12]^ee[28],this.v6h^=ee[13]^ee[29],this.v7l^=ee[14]^ee[30],this.v7h^=ee[15]^ee[31],jr(ee)}destroy(){this.destroyed=!0,jr(this.buffer32),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const zO=gO(t=>new jO(t)),HO="https://rpc.walletconnect.org/v1";function y1(t){const e=`Ethereum Signed Message:
${t.length}`,r=new TextEncoder().encode(e+t);return"0x"+Buffer.from(SO(r)).toString("hex")}async function KO(t,e,r,i,n,s){switch(r.t){case"eip191":return await VO(t,e,r.s);case"eip1271":return await GO(t,e,r.s,i,n,s);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${r.t}`)}}function VO(t,e,r){const i=qI(r);return e8({payload:y1(e),signature:i}).toLowerCase()===t.toLowerCase()}async function GO(t,e,r,i,n,s){const o=Qi(i);if(!o.namespace||!o.reference)throw new Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${i}`);try{const a="0x1626ba7e",c="0000000000000000000000000000000000000000000000000000000000000040",l=r.substring(2),u=(l.length/2).toString(16).padStart(64,"0"),h=(e.startsWith("0x")?e:y1(e)).substring(2),g=a+h+c+u+l,y=await fetch(`${s||HO}/?chainId=${i}&projectId=${n}`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({id:WO(),jsonrpc:"2.0",method:"eth_call",params:[{to:t,data:g},"latest"]})}),{result:w}=await y.json();return w?w.slice(0,a.length).toLowerCase()===a.toLowerCase():!1}catch(a){return console.error("isValidEip1271Signature: ",a),!1}}function WO(){return Date.now()+Math.floor(Math.random()*1e3)}function YO(t){const e=atob(t),r=new Uint8Array(e.length);for(let o=0;o<e.length;o++)r[o]=e.charCodeAt(o);const i=r[0];if(i===0)throw new Error("No signatures found");const n=1+i*64;if(r.length<n)throw new Error("Transaction data too short for claimed signature count");if(r.length<100)throw new Error("Transaction too short");const s=Buffer.from(t,"base64").slice(1,65);return Na.encode(s)}function JO(t){const e=new Uint8Array(Buffer.from(t,"base64")),r=Array.from("TransactionData::").map(s=>s.charCodeAt(0)),i=new Uint8Array(r.length+e.length);i.set(r),i.set(e,r.length);const n=zO(i,{dkLen:32});return Na.encode(n)}function V0(t){const e=new Uint8Array(Pl(QO(t)));return Na.encode(e)}function QO(t){if(t instanceof Uint8Array)return t;if(Array.isArray(t))return new Uint8Array(t);if(typeof t=="object"&&t!=null&&t.data)return new Uint8Array(Object.values(t.data));if(typeof t=="object"&&t)return new Uint8Array(Object.values(t));throw new Error("getNearUint8ArrayFromBytes: Unexpected result type from bytes array")}function G0(t){const e=Buffer.from(t,"base64"),r=L8(e).txn;if(!r)throw new Error("Invalid signed transaction: missing 'txn' field");const i=N8(r),n=Buffer.from("TX"),s=Buffer.concat([n,Buffer.from(i)]),o=UO(s);return XI.encode(o).replace(/=+$/,"")}function ju(t){const e=[];let r=BigInt(t);for(;r>=BigInt(128);)e.push(Number(r&BigInt(127)|BigInt(128))),r>>=BigInt(7);return e.push(Number(r)),Buffer.from(e)}function ZO(t){const e=Buffer.from(t.signed.bodyBytes,"base64"),r=Buffer.from(t.signed.authInfoBytes,"base64"),i=Buffer.from(t.signature.signature,"base64"),n=[];n.push(Buffer.from([10])),n.push(ju(e.length)),n.push(e),n.push(Buffer.from([18])),n.push(ju(r.length)),n.push(r),n.push(Buffer.from([26])),n.push(ju(i.length)),n.push(i);const s=Buffer.concat(n),o=Pl(s);return Buffer.from(o).toString("hex").toUpperCase()}function XO(t){var e,r;const i=[];try{if(typeof t=="string")return i.push(t),i;if(typeof t!="object")return i;t!=null&&t.id&&i.push(t.id);const n=(r=(e=t==null?void 0:t.capabilities)==null?void 0:e.caip345)==null?void 0:r.transactionHashes;n&&i.push(...n)}catch(n){console.warn("getWalletSendCallsHashes failed: ",n)}return i}var eD=Object.defineProperty,tD=Object.defineProperties,rD=Object.getOwnPropertyDescriptors,W0=Object.getOwnPropertySymbols,iD=Object.prototype.hasOwnProperty,nD=Object.prototype.propertyIsEnumerable,Y0=(t,e,r)=>e in t?eD(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,sD=(t,e)=>{for(var r in e||(e={}))iD.call(e,r)&&Y0(t,r,e[r]);if(W0)for(var r of W0(e))nD.call(e,r)&&Y0(t,r,e[r]);return t},oD=(t,e)=>tD(t,rD(e));const w1="did:pkh:",aD={eip155:"Ethereum",solana:"Solana",bip122:"Bitcoin"},cD=t=>t?aD[t]||t:"",Ol=t=>t==null?void 0:t.split(":"),lD=t=>{const e=t&&Ol(t);if(e)return t.includes(w1)?e[3]:e[1]},uD=t=>{const e=t&&Ol(t);if(e)return t.includes(w1)?e[2]:e[0]},Kh=t=>{const e=t&&Ol(t);if(e)return e[2]+":"+e[3]},Jc=t=>{const e=t&&Ol(t);if(e)return e.pop()};async function J0(t){const{cacao:e,projectId:r}=t,{s:i,p:n}=e,s=b1(n,n.iss),o=Jc(n.iss);return await KO(o,s,i,Kh(n.iss),r)}const b1=(t,e)=>{const r=uD(e);if(!r)throw new Error("Invalid issuer: "+e);const i=`${t.domain} wants you to sign in with your ${cD(r)} account:`,n=Jc(e);if(!t.aud&&!t.uri)throw new Error("Either `aud` or `uri` is required to construct the message");let s=t.statement||void 0;const o=`URI: ${t.aud||t.uri}`,a=`Version: ${t.version}`,c=`Chain ID: ${lD(e)}`,l=`Nonce: ${t.nonce}`,u=`Issued At: ${t.iat}`,h=t.exp?`Expiration Time: ${t.exp}`:void 0,g=t.nbf?`Not Before: ${t.nbf}`:void 0,y=t.requestId?`Request ID: ${t.requestId}`:void 0,w=t.resources?`Resources:${t.resources.map(P=>`
- ${P}`).join("")}`:void 0,E=Ac(t.resources);if(E){const P=Ea(E);s=bD(s,P)}return[i,n,"",s,"",o,a,c,l,u,h,g,y,w].filter(P=>P!=null).join(`
`)};function hD(t){return Buffer.from(JSON.stringify(t)).toString("base64")}function fD(t){return JSON.parse(Buffer.from(t,"base64").toString("utf-8"))}function Is(t){if(!t)throw new Error("No recap provided, value is undefined");if(!t.att)throw new Error("No `att` property found");const e=Object.keys(t.att);if(!(e!=null&&e.length))throw new Error("No resources found in `att` property");e.forEach(r=>{const i=t.att[r];if(Array.isArray(i))throw new Error(`Resource must be an object: ${r}`);if(typeof i!="object")throw new Error(`Resource must be an object: ${r}`);if(!Object.keys(i).length)throw new Error(`Resource object is empty: ${r}`);Object.keys(i).forEach(n=>{const s=i[n];if(!Array.isArray(s))throw new Error(`Ability limits ${n} must be an array of objects, found: ${s}`);if(!s.length)throw new Error(`Value of ${n} is empty array, must be an array with objects`);s.forEach(o=>{if(typeof o!="object")throw new Error(`Ability limits (${n}) must be an array of objects, found: ${o}`)})})})}function dD(t,e,r,i={}){return r==null||r.sort((n,s)=>n.localeCompare(s)),{att:{[t]:pD(e,r,i)}}}function pD(t,e,r={}){e=e==null?void 0:e.sort((n,s)=>n.localeCompare(s));const i=e.map(n=>({[`${t}/${n}`]:[r]}));return Object.assign({},...i)}function v1(t){return Is(t),`urn:recap:${hD(t).replace(/=/g,"")}`}function Ea(t){const e=fD(t.replace("urn:recap:",""));return Is(e),e}function gD(t,e,r){const i=dD(t,e,r);return v1(i)}function mD(t){return t&&t.includes("urn:recap:")}function yD(t,e){const r=Ea(t),i=Ea(e),n=wD(r,i);return v1(n)}function wD(t,e){Is(t),Is(e);const r=Object.keys(t.att).concat(Object.keys(e.att)).sort((n,s)=>n.localeCompare(s)),i={att:{}};return r.forEach(n=>{var s,o;Object.keys(((s=t.att)==null?void 0:s[n])||{}).concat(Object.keys(((o=e.att)==null?void 0:o[n])||{})).sort((a,c)=>a.localeCompare(c)).forEach(a=>{var c,l;i.att[n]=oD(sD({},i.att[n]),{[a]:((c=t.att[n])==null?void 0:c[a])||((l=e.att[n])==null?void 0:l[a])})})}),i}function bD(t="",e){Is(e);const r="I further authorize the stated URI to perform the following actions on my behalf: ";if(t.includes(r))return t;const i=[];let n=0;Object.keys(e.att).forEach(a=>{const c=Object.keys(e.att[a]).map(h=>({ability:h.split("/")[0],action:h.split("/")[1]}));c.sort((h,g)=>h.action.localeCompare(g.action));const l={};c.forEach(h=>{l[h.ability]||(l[h.ability]=[]),l[h.ability].push(h.action)});const u=Object.keys(l).map(h=>(n++,`(${n}) '${h}': '${l[h].join("', '")}' for '${a}'.`));i.push(u.join(", ").replace(".,","."))});const s=i.join(" "),o=`${r}${s}`;return`${t?t+" ":""}${o}`}function Q0(t){var e;const r=Ea(t);Is(r);const i=(e=r.att)==null?void 0:e.eip155;return i?Object.keys(i).map(n=>n.split("/")[1]):[]}function Z0(t){const e=Ea(t);Is(e);const r=[];return Object.values(e.att).forEach(i=>{Object.values(i).forEach(n=>{var s;(s=n==null?void 0:n[0])!=null&&s.chains&&r.push(n[0].chains)})}),[...new Set(r.flat())]}function Ac(t){if(!t)return;const e=t==null?void 0:t[t.length-1];return mD(e)?e:void 0}/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */function E1(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Vh(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}function zu(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function or(t,...e){if(!E1(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function X0(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function vD(t,e){or(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function kn(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function mo(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function ED(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}const xD=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function AD(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function Gh(t){if(typeof t=="string")t=AD(t);else if(E1(t))t=Wh(t);else throw new Error("Uint8Array expected, got "+typeof t);return t}function _D(t,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(t,e)}function ID(t,e){if(t.length!==e.length)return!1;let r=0;for(let i=0;i<t.length;i++)r|=t[i]^e[i];return r===0}const SD=(t,e)=>{function r(i,...n){if(or(i),!xD)throw new Error("Non little-endian hardware is not yet supported");if(t.nonceLength!==void 0){const l=n[0];if(!l)throw new Error("nonce / iv required");t.varSizeNonce?or(l):or(l,t.nonceLength)}const s=t.tagLength;s&&n[1]!==void 0&&or(n[1]);const o=e(i,...n),a=(l,u)=>{if(u!==void 0){if(l!==2)throw new Error("cipher output not supported");or(u)}};let c=!1;return{encrypt(l,u){if(c)throw new Error("cannot encrypt() twice with same key + nonce");return c=!0,or(l),a(o.encrypt.length,u),o.encrypt(l,u)},decrypt(l,u){if(or(l),s&&l.length<s)throw new Error("invalid ciphertext length: smaller than tagLength="+s);return a(o.decrypt.length,u),o.decrypt(l,u)}}}return Object.assign(r,t),r};function eg(t,e,r=!0){if(e===void 0)return new Uint8Array(t);if(e.length!==t)throw new Error("invalid output length, expected "+t+", got: "+e.length);if(r&&!OD(e))throw new Error("invalid output, must be aligned");return e}function tg(t,e,r,i){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,i);const n=BigInt(32),s=BigInt(4294967295),o=Number(r>>n&s),a=Number(r&s);t.setUint32(e+4,o,i),t.setUint32(e+0,a,i)}function PD(t,e,r){Vh(r);const i=new Uint8Array(16),n=ED(i);return tg(n,0,BigInt(e),r),tg(n,8,BigInt(t),r),i}function OD(t){return t.byteOffset%4===0}function Wh(t){return Uint8Array.from(t)}const x1=t=>Uint8Array.from(t.split("").map(e=>e.charCodeAt(0))),DD=x1("expand 16-byte k"),ND=x1("expand 32-byte k"),CD=kn(DD),BD=kn(ND);function ye(t,e){return t<<e|t>>>32-e}function Yh(t){return t.byteOffset%4===0}const rc=64,RD=16,A1=2**32-1,rg=new Uint32Array;function TD(t,e,r,i,n,s,o,a){const c=n.length,l=new Uint8Array(rc),u=kn(l),h=Yh(n)&&Yh(s),g=h?kn(n):rg,y=h?kn(s):rg;for(let w=0;w<c;o++){if(t(e,r,i,u,o,a),o>=A1)throw new Error("arx: counter overflow");const E=Math.min(rc,c-w);if(h&&E===rc){const P=w/4;if(w%4!==0)throw new Error("arx: invalid block position");for(let N=0,R;N<RD;N++)R=P+N,y[R]=g[R]^u[N];w+=rc;continue}for(let P=0,N;P<E;P++)N=w+P,s[N]=n[N]^l[P];w+=E}}function MD(t,e){const{allowShortKeys:r,extendNonceFn:i,counterLength:n,counterRight:s,rounds:o}=_D({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof t!="function")throw new Error("core must be a function");return zu(n),zu(o),Vh(s),Vh(r),(a,c,l,u,h=0)=>{or(a),or(c),or(l);const g=l.length;if(u===void 0&&(u=new Uint8Array(g)),or(u),zu(h),h<0||h>=A1)throw new Error("arx: counter overflow");if(u.length<g)throw new Error(`arx: output (${u.length}) is shorter than data (${g})`);const y=[];let w=a.length,E,P;if(w===32)y.push(E=Wh(a)),P=BD;else if(w===16&&r)E=new Uint8Array(32),E.set(a),E.set(a,16),P=CD,y.push(E);else throw new Error(`arx: invalid 32-byte key, got length=${w}`);Yh(c)||y.push(c=Wh(c));const N=kn(E);if(i){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");i(P,N,kn(c.subarray(0,16)),N),c=c.subarray(16)}const R=16-n;if(R!==c.length)throw new Error(`arx: nonce must be ${R} or 16 bytes`);if(R!==12){const C=new Uint8Array(12);C.set(c,s?0:12-c.length),c=C,y.push(c)}const D=kn(c);return TD(t,P,N,D,l,u,h,o),mo(...y),u}}const Pt=(t,e)=>t[e++]&255|(t[e++]&255)<<8;class kD{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=Gh(e),or(e,32);const r=Pt(e,0),i=Pt(e,2),n=Pt(e,4),s=Pt(e,6),o=Pt(e,8),a=Pt(e,10),c=Pt(e,12),l=Pt(e,14);this.r[0]=r&8191,this.r[1]=(r>>>13|i<<3)&8191,this.r[2]=(i>>>10|n<<6)&7939,this.r[3]=(n>>>7|s<<9)&8191,this.r[4]=(s>>>4|o<<12)&255,this.r[5]=o>>>1&8190,this.r[6]=(o>>>14|a<<2)&8191,this.r[7]=(a>>>11|c<<5)&8065,this.r[8]=(c>>>8|l<<8)&8191,this.r[9]=l>>>5&127;for(let u=0;u<8;u++)this.pad[u]=Pt(e,16+2*u)}process(e,r,i=!1){const n=i?0:2048,{h:s,r:o}=this,a=o[0],c=o[1],l=o[2],u=o[3],h=o[4],g=o[5],y=o[6],w=o[7],E=o[8],P=o[9],N=Pt(e,r+0),R=Pt(e,r+2),D=Pt(e,r+4),C=Pt(e,r+6),B=Pt(e,r+8),M=Pt(e,r+10),L=Pt(e,r+12),F=Pt(e,r+14);let k=s[0]+(N&8191),V=s[1]+((N>>>13|R<<3)&8191),H=s[2]+((R>>>10|D<<6)&8191),$=s[3]+((D>>>7|C<<9)&8191),A=s[4]+((C>>>4|B<<12)&8191),d=s[5]+(B>>>1&8191),f=s[6]+((B>>>14|M<<2)&8191),p=s[7]+((M>>>11|L<<5)&8191),b=s[8]+((L>>>8|F<<8)&8191),x=s[9]+(F>>>5|n),_=0,S=_+k*a+V*(5*P)+H*(5*E)+$*(5*w)+A*(5*y);_=S>>>13,S&=8191,S+=d*(5*g)+f*(5*h)+p*(5*u)+b*(5*l)+x*(5*c),_+=S>>>13,S&=8191;let I=_+k*c+V*a+H*(5*P)+$*(5*E)+A*(5*w);_=I>>>13,I&=8191,I+=d*(5*y)+f*(5*g)+p*(5*h)+b*(5*u)+x*(5*l),_+=I>>>13,I&=8191;let m=_+k*l+V*c+H*a+$*(5*P)+A*(5*E);_=m>>>13,m&=8191,m+=d*(5*w)+f*(5*y)+p*(5*g)+b*(5*h)+x*(5*u),_+=m>>>13,m&=8191;let O=_+k*u+V*l+H*c+$*a+A*(5*P);_=O>>>13,O&=8191,O+=d*(5*E)+f*(5*w)+p*(5*y)+b*(5*g)+x*(5*h),_+=O>>>13,O&=8191;let j=_+k*h+V*u+H*l+$*c+A*a;_=j>>>13,j&=8191,j+=d*(5*P)+f*(5*E)+p*(5*w)+b*(5*y)+x*(5*g),_+=j>>>13,j&=8191;let v=_+k*g+V*h+H*u+$*l+A*c;_=v>>>13,v&=8191,v+=d*a+f*(5*P)+p*(5*E)+b*(5*w)+x*(5*y),_+=v>>>13,v&=8191;let T=_+k*y+V*g+H*h+$*u+A*l;_=T>>>13,T&=8191,T+=d*c+f*a+p*(5*P)+b*(5*E)+x*(5*w),_+=T>>>13,T&=8191;let U=_+k*w+V*y+H*g+$*h+A*u;_=U>>>13,U&=8191,U+=d*l+f*c+p*a+b*(5*P)+x*(5*E),_+=U>>>13,U&=8191;let q=_+k*E+V*w+H*y+$*g+A*h;_=q>>>13,q&=8191,q+=d*u+f*l+p*c+b*a+x*(5*P),_+=q>>>13,q&=8191;let z=_+k*P+V*E+H*w+$*y+A*g;_=z>>>13,z&=8191,z+=d*h+f*u+p*l+b*c+x*a,_+=z>>>13,z&=8191,_=(_<<2)+_|0,_=_+S|0,S=_&8191,_=_>>>13,I+=_,s[0]=S,s[1]=I,s[2]=m,s[3]=O,s[4]=j,s[5]=v,s[6]=T,s[7]=U,s[8]=q,s[9]=z}finalize(){const{h:e,pad:r}=this,i=new Uint16Array(10);let n=e[1]>>>13;e[1]&=8191;for(let a=2;a<10;a++)e[a]+=n,n=e[a]>>>13,e[a]&=8191;e[0]+=n*5,n=e[0]>>>13,e[0]&=8191,e[1]+=n,n=e[1]>>>13,e[1]&=8191,e[2]+=n,i[0]=e[0]+5,n=i[0]>>>13,i[0]&=8191;for(let a=1;a<10;a++)i[a]=e[a]+n,n=i[a]>>>13,i[a]&=8191;i[9]-=8192;let s=(n^1)-1;for(let a=0;a<10;a++)i[a]&=s;s=~s;for(let a=0;a<10;a++)e[a]=e[a]&s|i[a];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let o=e[0]+r[0];e[0]=o&65535;for(let a=1;a<8;a++)o=(e[a]+r[a]|0)+(o>>>16)|0,e[a]=o&65535;mo(i)}update(e){X0(this),e=Gh(e),or(e);const{buffer:r,blockLen:i}=this,n=e.length;for(let s=0;s<n;){const o=Math.min(i-this.pos,n-s);if(o===i){for(;i<=n-s;s+=i)this.process(e,s);continue}r.set(e.subarray(s,s+o),this.pos),this.pos+=o,s+=o,this.pos===i&&(this.process(r,0,!1),this.pos=0)}return this}destroy(){mo(this.h,this.r,this.buffer,this.pad)}digestInto(e){X0(this),vD(e,this),this.finished=!0;const{buffer:r,h:i}=this;let{pos:n}=this;if(n){for(r[n++]=1;n<16;n++)r[n]=0;this.process(r,0,!0)}this.finalize();let s=0;for(let o=0;o<8;o++)e[s++]=i[o]>>>0,e[s++]=i[o]>>>8;return e}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const i=e.slice(0,r);return this.destroy(),i}}function $D(t){const e=(i,n)=>t(n).update(Gh(i)).digest(),r=t(new Uint8Array(32));return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=i=>t(i),e}const UD=$D(t=>new kD(t));function LD(t,e,r,i,n,s=20){let o=t[0],a=t[1],c=t[2],l=t[3],u=e[0],h=e[1],g=e[2],y=e[3],w=e[4],E=e[5],P=e[6],N=e[7],R=n,D=r[0],C=r[1],B=r[2],M=o,L=a,F=c,k=l,V=u,H=h,$=g,A=y,d=w,f=E,p=P,b=N,x=R,_=D,S=C,I=B;for(let O=0;O<s;O+=2)M=M+V|0,x=ye(x^M,16),d=d+x|0,V=ye(V^d,12),M=M+V|0,x=ye(x^M,8),d=d+x|0,V=ye(V^d,7),L=L+H|0,_=ye(_^L,16),f=f+_|0,H=ye(H^f,12),L=L+H|0,_=ye(_^L,8),f=f+_|0,H=ye(H^f,7),F=F+$|0,S=ye(S^F,16),p=p+S|0,$=ye($^p,12),F=F+$|0,S=ye(S^F,8),p=p+S|0,$=ye($^p,7),k=k+A|0,I=ye(I^k,16),b=b+I|0,A=ye(A^b,12),k=k+A|0,I=ye(I^k,8),b=b+I|0,A=ye(A^b,7),M=M+H|0,I=ye(I^M,16),p=p+I|0,H=ye(H^p,12),M=M+H|0,I=ye(I^M,8),p=p+I|0,H=ye(H^p,7),L=L+$|0,x=ye(x^L,16),b=b+x|0,$=ye($^b,12),L=L+$|0,x=ye(x^L,8),b=b+x|0,$=ye($^b,7),F=F+A|0,_=ye(_^F,16),d=d+_|0,A=ye(A^d,12),F=F+A|0,_=ye(_^F,8),d=d+_|0,A=ye(A^d,7),k=k+V|0,S=ye(S^k,16),f=f+S|0,V=ye(V^f,12),k=k+V|0,S=ye(S^k,8),f=f+S|0,V=ye(V^f,7);let m=0;i[m++]=o+M|0,i[m++]=a+L|0,i[m++]=c+F|0,i[m++]=l+k|0,i[m++]=u+V|0,i[m++]=h+H|0,i[m++]=g+$|0,i[m++]=y+A|0,i[m++]=w+d|0,i[m++]=E+f|0,i[m++]=P+p|0,i[m++]=N+b|0,i[m++]=R+x|0,i[m++]=D+_|0,i[m++]=C+S|0,i[m++]=B+I|0}const FD=MD(LD,{counterRight:!1,counterLength:4,allowShortKeys:!1}),qD=new Uint8Array(16),ig=(t,e)=>{t.update(e);const r=e.length%16;r&&t.update(qD.subarray(r))},jD=new Uint8Array(32);function ng(t,e,r,i,n){const s=t(e,r,jD),o=UD.create(s);n&&ig(o,n),ig(o,i);const a=PD(i.length,n?n.length:0,!0);o.update(a);const c=o.digest();return mo(s,a),c}const zD=t=>(e,r,i)=>({encrypt(n,s){const o=n.length;s=eg(o+16,s,!1),s.set(n);const a=s.subarray(0,-16);t(e,r,a,a,1);const c=ng(t,e,r,a,i);return s.set(c,o),mo(c),s},decrypt(n,s){s=eg(n.length-16,s,!1);const o=n.subarray(0,-16),a=n.subarray(-16),c=ng(t,e,r,o,i);if(!ID(a,c))throw new Error("invalid tag");return s.set(n.subarray(0,-16)),t(e,r,s,s,1),mo(c),s}}),_1=SD({blockSize:64,nonceLength:12,tagLength:16},zD(FD));let I1=class extends Sl{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,Il(e);const i=ii(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const n=this.blockLen,s=new Uint8Array(n);s.set(i.length>n?e.create().update(i).digest():i);for(let o=0;o<s.length;o++)s[o]^=54;this.iHash.update(s),this.oHash=e.create();for(let o=0;o<s.length;o++)s[o]^=106;this.oHash.update(s),jr(s)}update(e){return Ln(this),this.iHash.update(e),this}digestInto(e){Ln(this),si(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:r,iHash:i,finished:n,destroyed:s,blockLen:o,outputLen:a}=this;return e=e,e.finished=n,e.destroyed=s,e.blockLen=o,e.outputLen=a,e.oHash=r._cloneInto(e.oHash),e.iHash=i._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const Dl=(t,e,r)=>new I1(t,e).update(r).digest();Dl.create=(t,e)=>new I1(t,e);function HD(t,e,r){return Il(t),r===void 0&&(r=new Uint8Array(t.outputLen)),Dl(t,ii(r),ii(e))}const Hu=Uint8Array.from([0]),sg=Uint8Array.of();function KD(t,e,r,i=32){Il(t),sn(i);const n=t.outputLen;if(i>255*n)throw new Error("Length should be <= 255*HashLen");const s=Math.ceil(i/n);r===void 0&&(r=sg);const o=new Uint8Array(s*n),a=Dl.create(t,e),c=a._cloneInto(),l=new Uint8Array(a.outputLen);for(let u=0;u<s;u++)Hu[0]=u+1,c.update(u===0?sg:l).update(r).update(Hu).digestInto(l),o.set(l,n*u),a._cloneInto(c);return a.destroy(),c.destroy(),jr(l,Hu),o.slice(0,i)}const VD=(t,e,r,i,n)=>KD(t,HD(t,e,r),i,n),Nl=Pl,gd=BigInt(0),Jh=BigInt(1);function Qc(t,e=""){if(typeof t!="boolean"){const r=e&&`"${e}"`;throw new Error(r+"expected boolean, got type="+typeof t)}return t}function ps(t,e,r=""){const i=_l(t),n=t==null?void 0:t.length,s=e!==void 0;if(!i||s&&n!==e){const o=r&&`"${r}" `,a=s?` of length ${e}`:"",c=i?`length=${n}`:`type=${typeof t}`;throw new Error(o+"expected Uint8Array"+a+", got "+c)}return t}function ic(t){const e=t.toString(16);return e.length&1?"0"+e:e}function S1(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?gd:BigInt("0x"+t)}function Cl(t){return S1(so(t))}function Zc(t){return si(t),S1(so(Uint8Array.from(t).reverse()))}function md(t,e){return Yc(t.toString(16).padStart(e*2,"0"))}function yd(t,e){return md(t,e).reverse()}function Vt(t,e,r){let i;if(typeof e=="string")try{i=Yc(e)}catch(s){throw new Error(t+" must be hex string or Uint8Array, cause: "+s)}else if(_l(e))i=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const n=i.length;if(typeof r=="number"&&n!==r)throw new Error(t+" of length "+r+" expected, got "+n);return i}const Ku=t=>typeof t=="bigint"&&gd<=t;function GD(t,e,r){return Ku(t)&&Ku(e)&&Ku(r)&&e<=t&&t<r}function Qh(t,e,r,i){if(!GD(e,r,i))throw new Error("expected valid "+t+": "+r+" <= n < "+i+", got "+e)}function P1(t){let e;for(e=0;t>gd;t>>=Jh,e+=1);return e}const Ma=t=>(Jh<<BigInt(t))-Jh;function WD(t,e,r){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");const i=g=>new Uint8Array(g),n=g=>Uint8Array.of(g);let s=i(t),o=i(t),a=0;const c=()=>{s.fill(1),o.fill(0),a=0},l=(...g)=>r(o,s,...g),u=(g=i(0))=>{o=l(n(0),g),s=l(),g.length!==0&&(o=l(n(1),g),s=l())},h=()=>{if(a++>=1e3)throw new Error("drbg: tried 1000 values");let g=0;const y=[];for(;g<e;){s=l();const w=s.slice();y.push(w),g+=s.length}return Bn(...y)};return(g,y)=>{c(),u(g);let w;for(;!(w=y(h()));)u();return c(),w}}function Bl(t,e,r={}){if(!t||typeof t!="object")throw new Error("expected valid options object");function i(n,s,o){const a=t[n];if(o&&a===void 0)return;const c=typeof a;if(c!==s||a===null)throw new Error(`param "${n}" is invalid: expected ${s}, got ${c}`)}Object.entries(e).forEach(([n,s])=>i(n,s,!1)),Object.entries(r).forEach(([n,s])=>i(n,s,!0))}function og(t){const e=new WeakMap;return(r,...i)=>{const n=e.get(r);if(n!==void 0)return n;const s=t(r,...i);return e.set(r,s),s}}const ur=BigInt(0),Zt=BigInt(1),gs=BigInt(2),O1=BigInt(3),D1=BigInt(4),N1=BigInt(5),YD=BigInt(7),C1=BigInt(8),JD=BigInt(9),B1=BigInt(16);function Er(t,e){const r=t%e;return r>=ur?r:e+r}function Zr(t,e,r){let i=t;for(;e-- >ur;)i*=i,i%=r;return i}function ag(t,e){if(t===ur)throw new Error("invert: expected non-zero number");if(e<=ur)throw new Error("invert: expected positive modulus, got "+e);let r=Er(t,e),i=e,n=ur,s=Zt;for(;r!==ur;){const o=i/r,a=i%r,c=n-s*o;i=r,r=a,n=s,s=c}if(i!==Zt)throw new Error("invert: does not exist");return Er(n,e)}function wd(t,e,r){if(!t.eql(t.sqr(e),r))throw new Error("Cannot find square root")}function R1(t,e){const r=(t.ORDER+Zt)/D1,i=t.pow(e,r);return wd(t,i,e),i}function QD(t,e){const r=(t.ORDER-N1)/C1,i=t.mul(e,gs),n=t.pow(i,r),s=t.mul(e,n),o=t.mul(t.mul(s,gs),n),a=t.mul(s,t.sub(o,t.ONE));return wd(t,a,e),a}function ZD(t){const e=jn(t),r=T1(t),i=r(e,e.neg(e.ONE)),n=r(e,i),s=r(e,e.neg(i)),o=(t+YD)/B1;return(a,c)=>{let l=a.pow(c,o),u=a.mul(l,i);const h=a.mul(l,n),g=a.mul(l,s),y=a.eql(a.sqr(u),c),w=a.eql(a.sqr(h),c);l=a.cmov(l,u,y),u=a.cmov(g,h,w);const E=a.eql(a.sqr(u),c),P=a.cmov(l,u,E);return wd(a,P,c),P}}function T1(t){if(t<O1)throw new Error("sqrt is not defined for small field");let e=t-Zt,r=0;for(;e%gs===ur;)e/=gs,r++;let i=gs;const n=jn(t);for(;cg(n,i)===1;)if(i++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(r===1)return R1;let s=n.pow(i,e);const o=(e+Zt)/gs;return function(a,c){if(a.is0(c))return c;if(cg(a,c)!==1)throw new Error("Cannot find square root");let l=r,u=a.mul(a.ONE,s),h=a.pow(c,e),g=a.pow(c,o);for(;!a.eql(h,a.ONE);){if(a.is0(h))return a.ZERO;let y=1,w=a.sqr(h);for(;!a.eql(w,a.ONE);)if(y++,w=a.sqr(w),y===l)throw new Error("Cannot find square root");const E=Zt<<BigInt(l-y-1),P=a.pow(u,E);l=y,u=a.sqr(P),h=a.mul(h,u),g=a.mul(g,P)}return g}}function XD(t){return t%D1===O1?R1:t%C1===N1?QD:t%B1===JD?ZD(t):T1(t)}const eN=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function tN(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},r=eN.reduce((i,n)=>(i[n]="function",i),e);return Bl(t,r),t}function rN(t,e,r){if(r<ur)throw new Error("invalid exponent, negatives unsupported");if(r===ur)return t.ONE;if(r===Zt)return e;let i=t.ONE,n=e;for(;r>ur;)r&Zt&&(i=t.mul(i,n)),n=t.sqr(n),r>>=Zt;return i}function M1(t,e,r=!1){const i=new Array(e.length).fill(r?t.ZERO:void 0),n=e.reduce((o,a,c)=>t.is0(a)?o:(i[c]=o,t.mul(o,a)),t.ONE),s=t.inv(n);return e.reduceRight((o,a,c)=>t.is0(a)?o:(i[c]=t.mul(o,i[c]),t.mul(o,a)),s),i}function cg(t,e){const r=(t.ORDER-Zt)/gs,i=t.pow(e,r),n=t.eql(i,t.ONE),s=t.eql(i,t.ZERO),o=t.eql(i,t.neg(t.ONE));if(!n&&!s&&!o)throw new Error("invalid Legendre symbol result");return n?1:s?0:-1}function k1(t,e){e!==void 0&&sn(e);const r=e!==void 0?e:t.toString(2).length,i=Math.ceil(r/8);return{nBitLength:r,nByteLength:i}}function jn(t,e,r=!1,i={}){if(t<=ur)throw new Error("invalid field: expected ORDER > 0, got "+t);let n,s,o=!1,a;if(typeof e=="object"&&e!=null){if(i.sqrt||r)throw new Error("cannot specify opts in two arguments");const g=e;g.BITS&&(n=g.BITS),g.sqrt&&(s=g.sqrt),typeof g.isLE=="boolean"&&(r=g.isLE),typeof g.modFromBytes=="boolean"&&(o=g.modFromBytes),a=g.allowedLengths}else typeof e=="number"&&(n=e),i.sqrt&&(s=i.sqrt);const{nBitLength:c,nByteLength:l}=k1(t,n);if(l>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let u;const h=Object.freeze({ORDER:t,isLE:r,BITS:c,BYTES:l,MASK:Ma(c),ZERO:ur,ONE:Zt,allowedLengths:a,create:g=>Er(g,t),isValid:g=>{if(typeof g!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof g);return ur<=g&&g<t},is0:g=>g===ur,isValidNot0:g=>!h.is0(g)&&h.isValid(g),isOdd:g=>(g&Zt)===Zt,neg:g=>Er(-g,t),eql:(g,y)=>g===y,sqr:g=>Er(g*g,t),add:(g,y)=>Er(g+y,t),sub:(g,y)=>Er(g-y,t),mul:(g,y)=>Er(g*y,t),pow:(g,y)=>rN(h,g,y),div:(g,y)=>Er(g*ag(y,t),t),sqrN:g=>g*g,addN:(g,y)=>g+y,subN:(g,y)=>g-y,mulN:(g,y)=>g*y,inv:g=>ag(g,t),sqrt:s||(g=>(u||(u=XD(t)),u(h,g))),toBytes:g=>r?yd(g,l):md(g,l),fromBytes:(g,y=!0)=>{if(a){if(!a.includes(g.length)||g.length>l)throw new Error("Field.fromBytes: expected "+a+" bytes, got "+g.length);const E=new Uint8Array(l);E.set(g,r?0:E.length-g.length),g=E}if(g.length!==l)throw new Error("Field.fromBytes: expected "+l+" bytes, got "+g.length);let w=r?Zc(g):Cl(g);if(o&&(w=Er(w,t)),!y&&!h.isValid(w))throw new Error("invalid field element: outside of range 0..ORDER");return w},invertBatch:g=>M1(h,g),cmov:(g,y,w)=>w?y:g});return Object.freeze(h)}function $1(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function U1(t){const e=$1(t);return e+Math.ceil(e/2)}function iN(t,e,r=!1){const i=t.length,n=$1(e),s=U1(e);if(i<16||i<s||i>1024)throw new Error("expected "+s+"-1024 bytes of input, got "+i);const o=r?Zc(t):Cl(t),a=Er(o,e-Zt)+Zt;return r?yd(a,n):md(a,n)}const yo=BigInt(0),ms=BigInt(1);function Xc(t,e){const r=e.negate();return t?r:e}function Vu(t,e){const r=M1(t.Fp,e.map(i=>i.Z));return e.map((i,n)=>t.fromAffine(i.toAffine(r[n])))}function L1(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function Gu(t,e){L1(t,e);const r=Math.ceil(e/t)+1,i=2**(t-1),n=2**t,s=Ma(t),o=BigInt(t);return{windows:r,windowSize:i,mask:s,maxNumber:n,shiftBy:o}}function lg(t,e,r){const{windowSize:i,mask:n,maxNumber:s,shiftBy:o}=r;let a=Number(t&n),c=t>>o;a>i&&(a-=s,c+=ms);const l=e*i,u=l+Math.abs(a)-1,h=a===0,g=a<0,y=e%2!==0;return{nextN:c,offset:u,isZero:h,isNeg:g,isNegF:y,offsetF:l}}function nN(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((r,i)=>{if(!(r instanceof e))throw new Error("invalid point at index "+i)})}function sN(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((r,i)=>{if(!e.isValid(r))throw new Error("invalid scalar at index "+i)})}const Wu=new WeakMap,F1=new WeakMap;function Yu(t){return F1.get(t)||1}function ug(t){if(t!==yo)throw new Error("invalid wNAF")}class oN{constructor(e,r){this.BASE=e.BASE,this.ZERO=e.ZERO,this.Fn=e.Fn,this.bits=r}_unsafeLadder(e,r,i=this.ZERO){let n=e;for(;r>yo;)r&ms&&(i=i.add(n)),n=n.double(),r>>=ms;return i}precomputeWindow(e,r){const{windows:i,windowSize:n}=Gu(r,this.bits),s=[];let o=e,a=o;for(let c=0;c<i;c++){a=o,s.push(a);for(let l=1;l<n;l++)a=a.add(o),s.push(a);o=a.double()}return s}wNAF(e,r,i){if(!this.Fn.isValid(i))throw new Error("invalid scalar");let n=this.ZERO,s=this.BASE;const o=Gu(e,this.bits);for(let a=0;a<o.windows;a++){const{nextN:c,offset:l,isZero:u,isNeg:h,isNegF:g,offsetF:y}=lg(i,a,o);i=c,u?s=s.add(Xc(g,r[y])):n=n.add(Xc(h,r[l]))}return ug(i),{p:n,f:s}}wNAFUnsafe(e,r,i,n=this.ZERO){const s=Gu(e,this.bits);for(let o=0;o<s.windows&&i!==yo;o++){const{nextN:a,offset:c,isZero:l,isNeg:u}=lg(i,o,s);if(i=a,!l){const h=r[c];n=n.add(u?h.negate():h)}}return ug(i),n}getPrecomputes(e,r,i){let n=Wu.get(r);return n||(n=this.precomputeWindow(r,e),e!==1&&(typeof i=="function"&&(n=i(n)),Wu.set(r,n))),n}cached(e,r,i){const n=Yu(e);return this.wNAF(n,this.getPrecomputes(n,e,i),r)}unsafe(e,r,i,n){const s=Yu(e);return s===1?this._unsafeLadder(e,r,n):this.wNAFUnsafe(s,this.getPrecomputes(s,e,i),r,n)}createCache(e,r){L1(r,this.bits),F1.set(e,r),Wu.delete(e)}hasCache(e){return Yu(e)!==1}}function aN(t,e,r,i){let n=e,s=t.ZERO,o=t.ZERO;for(;r>yo||i>yo;)r&ms&&(s=s.add(n)),i&ms&&(o=o.add(n)),n=n.double(),r>>=ms,i>>=ms;return{p1:s,p2:o}}function cN(t,e,r,i){nN(r,t),sN(i,e);const n=r.length,s=i.length;if(n!==s)throw new Error("arrays of points and scalars must have equal length");const o=t.ZERO,a=P1(BigInt(n));let c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);const l=Ma(c),u=new Array(Number(l)+1).fill(o),h=Math.floor((e.BITS-1)/c)*c;let g=o;for(let y=h;y>=0;y-=c){u.fill(o);for(let E=0;E<s;E++){const P=i[E],N=Number(P>>BigInt(y)&l);u[N]=u[N].add(r[E])}let w=o;for(let E=u.length-1,P=o;E>0;E--)P=P.add(u[E]),w=w.add(P);if(g=g.add(w),y!==0)for(let E=0;E<c;E++)g=g.double()}return g}function hg(t,e,r){if(e){if(e.ORDER!==t)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return tN(e),e}else return jn(t,{isLE:r})}function lN(t,e,r={},i){if(i===void 0&&(i=t==="edwards"),!e||typeof e!="object")throw new Error(`expected valid ${t} CURVE object`);for(const a of["p","n","h"]){const c=e[a];if(!(typeof c=="bigint"&&c>yo))throw new Error(`CURVE.${a} must be positive bigint`)}const n=hg(e.p,r.Fp,i),s=hg(e.n,r.Fn,i),o=["Gx","Gy","a","b"];for(const a of o)if(!n.isValid(e[a]))throw new Error(`CURVE.${a} must be valid field element of CURVE.Fp`);return e=Object.freeze(Object.assign({},e)),{CURVE:e,Fp:n,Fn:s}}BigInt(0),BigInt(1),BigInt(2),BigInt(8),l1("HashToScalar-");const zo=BigInt(0),qs=BigInt(1),nc=BigInt(2);function uN(t){return Bl(t,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...t})}function hN(t){const e=uN(t),{P:r,type:i,adjustScalarBytes:n,powPminus2:s,randomBytes:o}=e,a=i==="x25519";if(!a&&i!=="x448")throw new Error("invalid type");const c=o||Cs,l=a?255:448,u=a?32:56,h=BigInt(a?9:5),g=BigInt(a?121665:39081),y=a?nc**BigInt(254):nc**BigInt(447),w=a?BigInt(8)*nc**BigInt(251)-qs:BigInt(4)*nc**BigInt(445)-qs,E=y+w+qs,P=$=>Er($,r),N=R(h);function R($){return yd(P($),u)}function D($){const A=Vt("u coordinate",$,u);return a&&(A[31]&=127),P(Zc(A))}function C($){return Zc(n(Vt("scalar",$,u)))}function B($,A){const d=F(D(A),C($));if(d===zo)throw new Error("invalid private or public key received");return R(d)}function M($){return B($,N)}function L($,A,d){const f=P($*(A-d));return A=P(A-f),d=P(d+f),{x_2:A,x_3:d}}function F($,A){Qh("u",$,zo,r),Qh("scalar",A,y,E);const d=A,f=$;let p=qs,b=zo,x=$,_=qs,S=zo;for(let m=BigInt(l-1);m>=zo;m--){const O=d>>m&qs;S^=O,{x_2:p,x_3:x}=L(S,p,x),{x_2:b,x_3:_}=L(S,b,_),S=O;const j=p+b,v=P(j*j),T=p-b,U=P(T*T),q=v-U,z=x+_,Y=x-_,J=P(Y*j),W=P(z*T),oe=J+W,X=J-W;x=P(oe*oe),_=P(f*P(X*X)),p=P(v*U),b=P(q*(v+P(g*q)))}({x_2:p,x_3:x}=L(S,p,x)),{x_2:b,x_3:_}=L(S,b,_);const I=s(b);return P(p*I)}const k={secretKey:u,publicKey:u,seed:u},V=($=c(u))=>(si($,k.seed),$);function H($){const A=V($);return{secretKey:A,publicKey:M(A)}}return{keygen:H,getSharedSecret:($,A)=>B($,A),getPublicKey:$=>M($),scalarMult:B,scalarMultBase:M,utils:{randomSecretKey:V,randomPrivateKey:V},GuBytes:N.slice(),lengths:k}}const fN=BigInt(1),fg=BigInt(2),dN=BigInt(3),pN=BigInt(5);BigInt(8);const q1=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),gN={p:q1,n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function mN(t){const e=BigInt(10),r=BigInt(20),i=BigInt(40),n=BigInt(80),s=q1,o=t*t%s*t%s,a=Zr(o,fg,s)*o%s,c=Zr(a,fN,s)*t%s,l=Zr(c,pN,s)*c%s,u=Zr(l,e,s)*l%s,h=Zr(u,r,s)*u%s,g=Zr(h,i,s)*h%s,y=Zr(g,n,s)*g%s,w=Zr(y,n,s)*g%s,E=Zr(w,e,s)*l%s;return{pow_p_5_8:Zr(E,fg,s)*t%s,b2:o}}function yN(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}const wN=jn(gN.p,{isLE:!0}),Zh=(()=>{const t=wN.ORDER;return hN({P:t,type:"x25519",powPminus2:e=>{const{pow_p_5_8:r,b2:i}=mN(e);return Er(Zr(r,dN,t)*i,t)},adjustScalarBytes:yN})})(),dg=(t,e)=>(t+(t>=0?e:-e)/j1)/e;function bN(t,e,r){const[[i,n],[s,o]]=e,a=dg(o*t,r),c=dg(-n*t,r);let l=t-a*i-c*s,u=-a*n-c*o;const h=l<Yi,g=u<Yi;h&&(l=-l),g&&(u=-u);const y=Ma(Math.ceil(P1(r)/2))+oo;if(l<Yi||l>=y||u<Yi||u>=y)throw new Error("splitScalar (endomorphism): failed, k="+t);return{k1neg:h,k1:l,k2neg:g,k2:u}}function Xh(t){if(!["compact","recovered","der"].includes(t))throw new Error('Signature format must be "compact", "recovered", or "der"');return t}function Ju(t,e){const r={};for(let i of Object.keys(e))r[i]=t[i]===void 0?e[i]:t[i];return Qc(r.lowS,"lowS"),Qc(r.prehash,"prehash"),r.format!==void 0&&Xh(r.format),r}class vN extends Error{constructor(e=""){super(e)}}const Gi={Err:vN,_tlv:{encode:(t,e)=>{const{Err:r}=Gi;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(e.length&1)throw new r("tlv.encode: unpadded data");const i=e.length/2,n=ic(i);if(n.length/2&128)throw new r("tlv.encode: long form length too big");const s=i>127?ic(n.length/2|128):"";return ic(t)+s+n+e},decode(t,e){const{Err:r}=Gi;let i=0;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(e.length<2||e[i++]!==t)throw new r("tlv.decode: wrong tlv");const n=e[i++],s=!!(n&128);let o=0;if(!s)o=n;else{const c=n&127;if(!c)throw new r("tlv.decode(long): indefinite length not supported");if(c>4)throw new r("tlv.decode(long): byte length is too big");const l=e.subarray(i,i+c);if(l.length!==c)throw new r("tlv.decode: length bytes not complete");if(l[0]===0)throw new r("tlv.decode(long): zero leftmost byte");for(const u of l)o=o<<8|u;if(i+=c,o<128)throw new r("tlv.decode(long): not minimal encoding")}const a=e.subarray(i,i+o);if(a.length!==o)throw new r("tlv.decode: wrong value length");return{v:a,l:e.subarray(i+o)}}},_int:{encode(t){const{Err:e}=Gi;if(t<Yi)throw new e("integer: negative integers are not allowed");let r=ic(t);if(Number.parseInt(r[0],16)&8&&(r="00"+r),r.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return r},decode(t){const{Err:e}=Gi;if(t[0]&128)throw new e("invalid signature integer: negative");if(t[0]===0&&!(t[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return Cl(t)}},toSig(t){const{Err:e,_int:r,_tlv:i}=Gi,n=Vt("signature",t),{v:s,l:o}=i.decode(48,n);if(o.length)throw new e("invalid signature: left bytes after parsing");const{v:a,l:c}=i.decode(2,s),{v:l,l:u}=i.decode(2,c);if(u.length)throw new e("invalid signature: left bytes after parsing");return{r:r.decode(a),s:r.decode(l)}},hexFromSig(t){const{_tlv:e,_int:r}=Gi,i=e.encode(2,r.encode(t.r)),n=e.encode(2,r.encode(t.s)),s=i+n;return e.encode(48,s)}},Yi=BigInt(0),oo=BigInt(1),j1=BigInt(2),sc=BigInt(3),EN=BigInt(4);function Ws(t,e){const{BYTES:r}=t;let i;if(typeof e=="bigint")i=e;else{let n=Vt("private key",e);try{i=t.fromBytes(n)}catch{throw new Error(`invalid private key: expected ui8a of size ${r}, got ${typeof e}`)}}if(!t.isValidNot0(i))throw new Error("invalid private key: out of range [1..N-1]");return i}function xN(t,e={}){const r=lN("weierstrass",t,e),{Fp:i,Fn:n}=r;let s=r.CURVE;const{h:o,n:a}=s;Bl(e,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:c}=e;if(c&&(!i.is0(s.a)||typeof c.beta!="bigint"||!Array.isArray(c.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');const l=H1(i,n);function u(){if(!i.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function h($,A,d){const{x:f,y:p}=A.toAffine(),b=i.toBytes(f);if(Qc(d,"isCompressed"),d){u();const x=!i.isOdd(p);return Bn(z1(x),b)}else return Bn(Uint8Array.of(4),b,i.toBytes(p))}function g($){ps($,void 0,"Point");const{publicKey:A,publicKeyUncompressed:d}=l,f=$.length,p=$[0],b=$.subarray(1);if(f===A&&(p===2||p===3)){const x=i.fromBytes(b);if(!i.isValid(x))throw new Error("bad point: is not on curve, wrong x");const _=E(x);let S;try{S=i.sqrt(_)}catch(m){const O=m instanceof Error?": "+m.message:"";throw new Error("bad point: is not on curve, sqrt error"+O)}u();const I=i.isOdd(S);return(p&1)===1!==I&&(S=i.neg(S)),{x,y:S}}else if(f===d&&p===4){const x=i.BYTES,_=i.fromBytes(b.subarray(0,x)),S=i.fromBytes(b.subarray(x,x*2));if(!P(_,S))throw new Error("bad point: is not on curve");return{x:_,y:S}}else throw new Error(`bad point: got length ${f}, expected compressed=${A} or uncompressed=${d}`)}const y=e.toBytes||h,w=e.fromBytes||g;function E($){const A=i.sqr($),d=i.mul(A,$);return i.add(i.add(d,i.mul($,s.a)),s.b)}function P($,A){const d=i.sqr(A),f=E($);return i.eql(d,f)}if(!P(s.Gx,s.Gy))throw new Error("bad curve params: generator point");const N=i.mul(i.pow(s.a,sc),EN),R=i.mul(i.sqr(s.b),BigInt(27));if(i.is0(i.add(N,R)))throw new Error("bad curve params: a or b");function D($,A,d=!1){if(!i.isValid(A)||d&&i.is0(A))throw new Error(`bad point coordinate ${$}`);return A}function C($){if(!($ instanceof k))throw new Error("ProjectivePoint expected")}function B($){if(!c||!c.basises)throw new Error("no endo");return bN($,c.basises,n.ORDER)}const M=og(($,A)=>{const{X:d,Y:f,Z:p}=$;if(i.eql(p,i.ONE))return{x:d,y:f};const b=$.is0();A==null&&(A=b?i.ONE:i.inv(p));const x=i.mul(d,A),_=i.mul(f,A),S=i.mul(p,A);if(b)return{x:i.ZERO,y:i.ZERO};if(!i.eql(S,i.ONE))throw new Error("invZ was invalid");return{x,y:_}}),L=og($=>{if($.is0()){if(e.allowInfinityPoint&&!i.is0($.Y))return;throw new Error("bad point: ZERO")}const{x:A,y:d}=$.toAffine();if(!i.isValid(A)||!i.isValid(d))throw new Error("bad point: x or y not field elements");if(!P(A,d))throw new Error("bad point: equation left != right");if(!$.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function F($,A,d,f,p){return d=new k(i.mul(d.X,$),d.Y,d.Z),A=Xc(f,A),d=Xc(p,d),A.add(d)}class k{constructor(A,d,f){this.X=D("x",A),this.Y=D("y",d,!0),this.Z=D("z",f),Object.freeze(this)}static CURVE(){return s}static fromAffine(A){const{x:d,y:f}=A||{};if(!A||!i.isValid(d)||!i.isValid(f))throw new Error("invalid affine point");if(A instanceof k)throw new Error("projective point not allowed");return i.is0(d)&&i.is0(f)?k.ZERO:new k(d,f,i.ONE)}static fromBytes(A){const d=k.fromAffine(w(ps(A,void 0,"point")));return d.assertValidity(),d}static fromHex(A){return k.fromBytes(Vt("pointHex",A))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(A=8,d=!0){return H.createCache(this,A),d||this.multiply(sc),this}assertValidity(){L(this)}hasEvenY(){const{y:A}=this.toAffine();if(!i.isOdd)throw new Error("Field doesn't support isOdd");return!i.isOdd(A)}equals(A){C(A);const{X:d,Y:f,Z:p}=this,{X:b,Y:x,Z:_}=A,S=i.eql(i.mul(d,_),i.mul(b,p)),I=i.eql(i.mul(f,_),i.mul(x,p));return S&&I}negate(){return new k(this.X,i.neg(this.Y),this.Z)}double(){const{a:A,b:d}=s,f=i.mul(d,sc),{X:p,Y:b,Z:x}=this;let _=i.ZERO,S=i.ZERO,I=i.ZERO,m=i.mul(p,p),O=i.mul(b,b),j=i.mul(x,x),v=i.mul(p,b);return v=i.add(v,v),I=i.mul(p,x),I=i.add(I,I),_=i.mul(A,I),S=i.mul(f,j),S=i.add(_,S),_=i.sub(O,S),S=i.add(O,S),S=i.mul(_,S),_=i.mul(v,_),I=i.mul(f,I),j=i.mul(A,j),v=i.sub(m,j),v=i.mul(A,v),v=i.add(v,I),I=i.add(m,m),m=i.add(I,m),m=i.add(m,j),m=i.mul(m,v),S=i.add(S,m),j=i.mul(b,x),j=i.add(j,j),m=i.mul(j,v),_=i.sub(_,m),I=i.mul(j,O),I=i.add(I,I),I=i.add(I,I),new k(_,S,I)}add(A){C(A);const{X:d,Y:f,Z:p}=this,{X:b,Y:x,Z:_}=A;let S=i.ZERO,I=i.ZERO,m=i.ZERO;const O=s.a,j=i.mul(s.b,sc);let v=i.mul(d,b),T=i.mul(f,x),U=i.mul(p,_),q=i.add(d,f),z=i.add(b,x);q=i.mul(q,z),z=i.add(v,T),q=i.sub(q,z),z=i.add(d,p);let Y=i.add(b,_);return z=i.mul(z,Y),Y=i.add(v,U),z=i.sub(z,Y),Y=i.add(f,p),S=i.add(x,_),Y=i.mul(Y,S),S=i.add(T,U),Y=i.sub(Y,S),m=i.mul(O,z),S=i.mul(j,U),m=i.add(S,m),S=i.sub(T,m),m=i.add(T,m),I=i.mul(S,m),T=i.add(v,v),T=i.add(T,v),U=i.mul(O,U),z=i.mul(j,z),T=i.add(T,U),U=i.sub(v,U),U=i.mul(O,U),z=i.add(z,U),v=i.mul(T,z),I=i.add(I,v),v=i.mul(Y,z),S=i.mul(q,S),S=i.sub(S,v),v=i.mul(q,T),m=i.mul(Y,m),m=i.add(m,v),new k(S,I,m)}subtract(A){return this.add(A.negate())}is0(){return this.equals(k.ZERO)}multiply(A){const{endo:d}=e;if(!n.isValidNot0(A))throw new Error("invalid scalar: out of range");let f,p;const b=x=>H.cached(this,x,_=>Vu(k,_));if(d){const{k1neg:x,k1:_,k2neg:S,k2:I}=B(A),{p:m,f:O}=b(_),{p:j,f:v}=b(I);p=O.add(v),f=F(d.beta,m,j,x,S)}else{const{p:x,f:_}=b(A);f=x,p=_}return Vu(k,[f,p])[0]}multiplyUnsafe(A){const{endo:d}=e,f=this;if(!n.isValid(A))throw new Error("invalid scalar: out of range");if(A===Yi||f.is0())return k.ZERO;if(A===oo)return f;if(H.hasCache(this))return this.multiply(A);if(d){const{k1neg:p,k1:b,k2neg:x,k2:_}=B(A),{p1:S,p2:I}=aN(k,f,b,_);return F(d.beta,S,I,p,x)}else return H.unsafe(f,A)}multiplyAndAddUnsafe(A,d,f){const p=this.multiplyUnsafe(d).add(A.multiplyUnsafe(f));return p.is0()?void 0:p}toAffine(A){return M(this,A)}isTorsionFree(){const{isTorsionFree:A}=e;return o===oo?!0:A?A(k,this):H.unsafe(this,a).is0()}clearCofactor(){const{clearCofactor:A}=e;return o===oo?this:A?A(k,this):this.multiplyUnsafe(o)}isSmallOrder(){return this.multiplyUnsafe(o).is0()}toBytes(A=!0){return Qc(A,"isCompressed"),this.assertValidity(),y(k,this,A)}toHex(A=!0){return so(this.toBytes(A))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(A=!0){return this.toBytes(A)}_setWindowSize(A){this.precompute(A)}static normalizeZ(A){return Vu(k,A)}static msm(A,d){return cN(k,n,A,d)}static fromPrivateKey(A){return k.BASE.multiply(Ws(n,A))}}k.BASE=new k(s.Gx,s.Gy,i.ONE),k.ZERO=new k(i.ZERO,i.ONE,i.ZERO),k.Fp=i,k.Fn=n;const V=n.BITS,H=new oN(k,e.endo?Math.ceil(V/2):V);return k.BASE.precompute(8),k}function z1(t){return Uint8Array.of(t?2:3)}function H1(t,e){return{secretKey:e.BYTES,publicKey:1+t.BYTES,publicKeyUncompressed:1+2*t.BYTES,publicKeyHasPrefix:!0,signature:2*e.BYTES}}function AN(t,e={}){const{Fn:r}=t,i=e.randomBytes||Cs,n=Object.assign(H1(t.Fp,r),{seed:U1(r.ORDER)});function s(g){try{return!!Ws(r,g)}catch{return!1}}function o(g,y){const{publicKey:w,publicKeyUncompressed:E}=n;try{const P=g.length;return y===!0&&P!==w||y===!1&&P!==E?!1:!!t.fromBytes(g)}catch{return!1}}function a(g=i(n.seed)){return iN(ps(g,n.seed,"seed"),r.ORDER)}function c(g,y=!0){return t.BASE.multiply(Ws(r,g)).toBytes(y)}function l(g){const y=a(g);return{secretKey:y,publicKey:c(y)}}function u(g){if(typeof g=="bigint")return!1;if(g instanceof t)return!0;const{secretKey:y,publicKey:w,publicKeyUncompressed:E}=n;if(r.allowedLengths||y===w)return;const P=Vt("key",g).length;return P===w||P===E}function h(g,y,w=!0){if(u(g)===!0)throw new Error("first arg must be private key");if(u(y)===!1)throw new Error("second arg must be public key");const E=Ws(r,g);return t.fromHex(y).multiply(E).toBytes(w)}return Object.freeze({getPublicKey:c,getSharedSecret:h,keygen:l,Point:t,utils:{isValidSecretKey:s,isValidPublicKey:o,randomSecretKey:a,isValidPrivateKey:s,randomPrivateKey:a,normPrivateKeyToScalar:g=>Ws(r,g),precompute(g=8,y=t.BASE){return y.precompute(g,!1)}},lengths:n})}function _N(t,e,r={}){Il(e),Bl(r,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const i=r.randomBytes||Cs,n=r.hmac||((d,...f)=>Dl(e,d,Bn(...f))),{Fp:s,Fn:o}=t,{ORDER:a,BITS:c}=o,{keygen:l,getPublicKey:u,getSharedSecret:h,utils:g,lengths:y}=AN(t,r),w={prehash:!1,lowS:typeof r.lowS=="boolean"?r.lowS:!1,format:void 0,extraEntropy:!1},E="compact";function P(d){const f=a>>oo;return d>f}function N(d,f){if(!o.isValidNot0(f))throw new Error(`invalid signature ${d}: out of range 1..Point.Fn.ORDER`);return f}function R(d,f){Xh(f);const p=y.signature,b=f==="compact"?p:f==="recovered"?p+1:void 0;return ps(d,b,`${f} signature`)}class D{constructor(f,p,b){this.r=N("r",f),this.s=N("s",p),b!=null&&(this.recovery=b),Object.freeze(this)}static fromBytes(f,p=E){R(f,p);let b;if(p==="der"){const{r:I,s:m}=Gi.toSig(ps(f));return new D(I,m)}p==="recovered"&&(b=f[0],p="compact",f=f.subarray(1));const x=o.BYTES,_=f.subarray(0,x),S=f.subarray(x,x*2);return new D(o.fromBytes(_),o.fromBytes(S),b)}static fromHex(f,p){return this.fromBytes(Yc(f),p)}addRecoveryBit(f){return new D(this.r,this.s,f)}recoverPublicKey(f){const p=s.ORDER,{r:b,s:x,recovery:_}=this;if(_==null||![0,1,2,3].includes(_))throw new Error("recovery id invalid");if(a*j1<p&&_>1)throw new Error("recovery id is ambiguous for h>1 curve");const S=_===2||_===3?b+a:b;if(!s.isValid(S))throw new Error("recovery id 2 or 3 invalid");const I=s.toBytes(S),m=t.fromBytes(Bn(z1((_&1)===0),I)),O=o.inv(S),j=B(Vt("msgHash",f)),v=o.create(-j*O),T=o.create(x*O),U=t.BASE.multiplyUnsafe(v).add(m.multiplyUnsafe(T));if(U.is0())throw new Error("point at infinify");return U.assertValidity(),U}hasHighS(){return P(this.s)}toBytes(f=E){if(Xh(f),f==="der")return Yc(Gi.hexFromSig(this));const p=o.toBytes(this.r),b=o.toBytes(this.s);if(f==="recovered"){if(this.recovery==null)throw new Error("recovery bit must be present");return Bn(Uint8Array.of(this.recovery),p,b)}return Bn(p,b)}toHex(f){return so(this.toBytes(f))}assertValidity(){}static fromCompact(f){return D.fromBytes(Vt("sig",f),"compact")}static fromDER(f){return D.fromBytes(Vt("sig",f),"der")}normalizeS(){return this.hasHighS()?new D(this.r,o.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return so(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return so(this.toBytes("compact"))}}const C=r.bits2int||function(d){if(d.length>8192)throw new Error("input is too large");const f=Cl(d),p=d.length*8-c;return p>0?f>>BigInt(p):f},B=r.bits2int_modN||function(d){return o.create(C(d))},M=Ma(c);function L(d){return Qh("num < 2^"+c,d,Yi,M),o.toBytes(d)}function F(d,f){return ps(d,void 0,"message"),f?ps(e(d),void 0,"prehashed message"):d}function k(d,f,p){if(["recovered","canonical"].some(T=>T in p))throw new Error("sign() legacy options not supported");const{lowS:b,prehash:x,extraEntropy:_}=Ju(p,w);d=F(d,x);const S=B(d),I=Ws(o,f),m=[L(I),L(S)];if(_!=null&&_!==!1){const T=_===!0?i(y.secretKey):_;m.push(Vt("extraEntropy",T))}const O=Bn(...m),j=S;function v(T){const U=C(T);if(!o.isValidNot0(U))return;const q=o.inv(U),z=t.BASE.multiply(U).toAffine(),Y=o.create(z.x);if(Y===Yi)return;const J=o.create(q*o.create(j+Y*I));if(J===Yi)return;let W=(z.x===Y?0:2)|Number(z.y&oo),oe=J;return b&&P(J)&&(oe=o.neg(J),W^=1),new D(Y,oe,W)}return{seed:O,k2sig:v}}function V(d,f,p={}){d=Vt("message",d);const{seed:b,k2sig:x}=k(d,f,p);return WD(e.outputLen,o.BYTES,n)(b,x)}function H(d){let f;const p=typeof d=="string"||_l(d),b=!p&&d!==null&&typeof d=="object"&&typeof d.r=="bigint"&&typeof d.s=="bigint";if(!p&&!b)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(b)f=new D(d.r,d.s);else if(p){try{f=D.fromBytes(Vt("sig",d),"der")}catch(x){if(!(x instanceof Gi.Err))throw x}if(!f)try{f=D.fromBytes(Vt("sig",d),"compact")}catch{return!1}}return f||!1}function $(d,f,p,b={}){const{lowS:x,prehash:_,format:S}=Ju(b,w);if(p=Vt("publicKey",p),f=F(Vt("message",f),_),"strict"in b)throw new Error("options.strict was renamed to lowS");const I=S===void 0?H(d):D.fromBytes(Vt("sig",d),S);if(I===!1)return!1;try{const m=t.fromBytes(p);if(x&&I.hasHighS())return!1;const{r:O,s:j}=I,v=B(f),T=o.inv(j),U=o.create(v*T),q=o.create(O*T),z=t.BASE.multiplyUnsafe(U).add(m.multiplyUnsafe(q));return z.is0()?!1:o.create(z.x)===O}catch{return!1}}function A(d,f,p={}){const{prehash:b}=Ju(p,w);return f=F(f,b),D.fromBytes(d,"recovered").recoverPublicKey(f).toBytes()}return Object.freeze({keygen:l,getPublicKey:u,getSharedSecret:h,utils:g,lengths:y,Point:t,sign:V,verify:$,recoverPublicKey:A,Signature:D,hash:e})}function IN(t){const e={a:t.a,b:t.b,p:t.Fp.ORDER,n:t.n,h:t.h,Gx:t.Gx,Gy:t.Gy},r=t.Fp;let i=t.allowedPrivateKeyLengths?Array.from(new Set(t.allowedPrivateKeyLengths.map(o=>Math.ceil(o/2)))):void 0;const n=jn(e.n,{BITS:t.nBitLength,allowedLengths:i,modFromBytes:t.wrapPrivateKey}),s={Fp:r,Fn:n,allowInfinityPoint:t.allowInfinityPoint,endo:t.endo,isTorsionFree:t.isTorsionFree,clearCofactor:t.clearCofactor,fromBytes:t.fromBytes,toBytes:t.toBytes};return{CURVE:e,curveOpts:s}}function SN(t){const{CURVE:e,curveOpts:r}=IN(t),i={hmac:t.hmac,randomBytes:t.randomBytes,lowS:t.lowS,bits2int:t.bits2int,bits2int_modN:t.bits2int_modN};return{CURVE:e,curveOpts:r,hash:t.hash,ecdsaOpts:i}}function PN(t,e){const r=e.Point;return Object.assign({},e,{ProjectivePoint:r,CURVE:Object.assign({},t,k1(r.Fn.ORDER,r.Fn.BITS))})}function ON(t){const{CURVE:e,curveOpts:r,hash:i,ecdsaOpts:n}=SN(t),s=xN(e,r),o=_N(s,i,n);return PN(t,o)}function ef(t,e){const r=i=>ON({...t,hash:i});return{...r(e),create:r}}const K1={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},V1={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},G1={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},DN=jn(K1.p),NN=jn(V1.p),CN=jn(G1.p),BN=ef({...K1,Fp:DN,lowS:!1},Pl);ef({...V1,Fp:NN,lowS:!1},$O),ef({...G1,Fp:CN,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},kO);const RN=BN,W1="base10",Xt="base16",ar="base64pad",Rn="base64url",ka="utf8",Y1=0,Zi=1,$a=2,TN=0,pg=1,ca=12,bd=32;function MN(){const t=Zh.utils.randomPrivateKey(),e=Zh.getPublicKey(t);return{privateKey:hr(t,Xt),publicKey:hr(e,Xt)}}function tf(){const t=Cs(bd);return hr(t,Xt)}function kN(t,e){const r=Zh.getSharedSecret(Lr(t,Xt),Lr(e,Xt)),i=VD(Nl,r,void 0,void 0,bd);return hr(i,Xt)}function _c(t){const e=Nl(Lr(t,Xt));return hr(e,Xt)}function kr(t){const e=Nl(Lr(t,ka));return hr(e,Xt)}function J1(t){return Lr(`${t}`,W1)}function Ss(t){return Number(hr(t,W1))}function Q1(t){return t.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function Z1(t){const e=t.replace(/-/g,"+").replace(/_/g,"/"),r=(4-e.length%4)%4;return e+"=".repeat(r)}function $N(t){const e=J1(typeof t.type<"u"?t.type:Y1);if(Ss(e)===Zi&&typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof t.senderPublicKey<"u"?Lr(t.senderPublicKey,Xt):void 0,i=typeof t.iv<"u"?Lr(t.iv,Xt):Cs(ca),n=Lr(t.symKey,Xt),s=_1(n,i).encrypt(Lr(t.message,ka)),o=X1({type:e,sealed:s,iv:i,senderPublicKey:r});return t.encoding===Rn?Q1(o):o}function UN(t){const e=Lr(t.symKey,Xt),{sealed:r,iv:i}=xa({encoded:t.encoded,encoding:t.encoding}),n=_1(e,i).decrypt(r);if(n===null)throw new Error("Failed to decrypt");return hr(n,ka)}function LN(t,e){const r=J1($a),i=Cs(ca),n=Lr(t,ka),s=X1({type:r,sealed:n,iv:i});return e===Rn?Q1(s):s}function FN(t,e){const{sealed:r}=xa({encoded:t,encoding:e});return hr(r,ka)}function X1(t){if(Ss(t.type)===$a)return hr(aa([t.type,t.sealed]),ar);if(Ss(t.type)===Zi){if(typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return hr(aa([t.type,t.senderPublicKey,t.iv,t.sealed]),ar)}return hr(aa([t.type,t.iv,t.sealed]),ar)}function xa(t){const e=(t.encoding||ar)===Rn?Z1(t.encoded):t.encoded,r=Lr(e,ar),i=r.slice(TN,pg),n=pg;if(Ss(i)===Zi){const c=n+bd,l=c+ca,u=r.slice(n,c),h=r.slice(c,l),g=r.slice(l);return{type:i,sealed:g,iv:h,senderPublicKey:u}}if(Ss(i)===$a){const c=r.slice(n),l=Cs(ca);return{type:i,sealed:c,iv:l}}const s=n+ca,o=r.slice(n,s),a=r.slice(s);return{type:i,sealed:a,iv:o}}function qN(t,e){const r=xa({encoded:t,encoding:e==null?void 0:e.encoding});return ev({type:Ss(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?hr(r.senderPublicKey,Xt):void 0,receiverPublicKey:e==null?void 0:e.receiverPublicKey})}function ev(t){const e=(t==null?void 0:t.type)||Y1;if(e===Zi){if(typeof(t==null?void 0:t.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(t==null?void 0:t.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:t==null?void 0:t.senderPublicKey,receiverPublicKey:t==null?void 0:t.receiverPublicKey}}function gg(t){return t.type===Zi&&typeof t.senderPublicKey=="string"&&typeof t.receiverPublicKey=="string"}function mg(t){return t.type===$a}function jN(t){const e=Buffer.from(t.x,"base64"),r=Buffer.from(t.y,"base64");return aa([new Uint8Array([4]),e,r])}function zN(t,e){const[r,i,n]=t.split("."),s=Buffer.from(Z1(n),"base64");if(s.length!==64)throw new Error("Invalid signature length");const o=s.slice(0,32),a=s.slice(32,64),c=`${r}.${i}`,l=Nl(c),u=jN(e);if(!RN.verify(aa([o,a]),l,u))throw new Error("Invalid signature");return Lh(t).payload}const HN="irn";function el(t){return(t==null?void 0:t.relay)||{protocol:HN}}function Ys(t){const e=O5[t];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${t}`);return e}var KN=Object.defineProperty,VN=Object.defineProperties,GN=Object.getOwnPropertyDescriptors,yg=Object.getOwnPropertySymbols,WN=Object.prototype.hasOwnProperty,YN=Object.prototype.propertyIsEnumerable,wg=(t,e,r)=>e in t?KN(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Qu=(t,e)=>{for(var r in e||(e={}))WN.call(e,r)&&wg(t,r,e[r]);if(yg)for(var r of yg(e))YN.call(e,r)&&wg(t,r,e[r]);return t},JN=(t,e)=>VN(t,GN(e));function QN(t,e="-"){const r={},i="relay"+e;return Object.keys(t).forEach(n=>{if(n.startsWith(i)){const s=n.replace(i,""),o=t[n];r[s]=o}}),r}function bg(t){if(!t.includes("wc:")){const l=i1(t);l!=null&&l.includes("wc:")&&(t=l)}t=t.includes("wc://")?t.replace("wc://",""):t,t=t.includes("wc:")?t.replace("wc:",""):t;const e=t.indexOf(":"),r=t.indexOf("?")!==-1?t.indexOf("?"):void 0,i=t.substring(0,e),n=t.substring(e+1,r).split("@"),s=typeof r<"u"?t.substring(r):"",o=new URLSearchParams(s),a=Object.fromEntries(o.entries()),c=typeof a.methods=="string"?a.methods.split(","):void 0;return{protocol:i,topic:ZN(n[0]),version:parseInt(n[1],10),symKey:a.symKey,relay:QN(a),methods:c,expiryTimestamp:a.expiryTimestamp?parseInt(a.expiryTimestamp,10):void 0}}function ZN(t){return t.startsWith("//")?t.substring(2):t}function XN(t,e="-"){const r="relay",i={};return Object.keys(t).forEach(n=>{const s=n,o=r+e+s;t[s]&&(i[o]=t[s])}),i}function vg(t){const e=new URLSearchParams,r=Qu(Qu(JN(Qu({},XN(t.relay)),{symKey:t.symKey}),t.expiryTimestamp&&{expiryTimestamp:t.expiryTimestamp.toString()}),t.methods&&{methods:t.methods.join(",")});return Object.entries(r).sort(([i],[n])=>i.localeCompare(n)).forEach(([i,n])=>{n!==void 0&&e.append(i,String(n))}),`${t.protocol}:${t.topic}@${t.version}?${e}`}function oc(t,e,r){return`${t}?wc_ev=${r}&topic=${e}`}var eC=Object.defineProperty,tC=Object.defineProperties,rC=Object.getOwnPropertyDescriptors,Eg=Object.getOwnPropertySymbols,iC=Object.prototype.hasOwnProperty,nC=Object.prototype.propertyIsEnumerable,xg=(t,e,r)=>e in t?eC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,sC=(t,e)=>{for(var r in e||(e={}))iC.call(e,r)&&xg(t,r,e[r]);if(Eg)for(var r of Eg(e))nC.call(e,r)&&xg(t,r,e[r]);return t},oC=(t,e)=>tC(t,rC(e));function Oo(t){const e=[];return t.forEach(r=>{const[i,n]=r.split(":");e.push(`${i}:${n}`)}),e}function tv(t){const e=[];return Object.values(t).forEach(r=>{e.push(...Oo(r.accounts))}),[...new Set(e)]}function aC(t){const e=[];return Object.values(t).forEach(r=>{e.push(...r.methods)}),[...new Set(e)]}function cC(t){const e=[];return Object.values(t).forEach(r=>{e.push(...r.events)}),[...new Set(e)]}function lC(t,e){const r=[];return Object.values(t).forEach(i=>{Oo(i.accounts).includes(e)&&r.push(...i.methods)}),r}function uC(t,e){const r=[];return Object.values(t).forEach(i=>{Oo(i.accounts).includes(e)&&r.push(...i.events)}),r}function Rl(t){return t.includes(":")}function Js(t){return Rl(t)?t.split(":")[0]:t}function Ag(t){var e,r,i;const n={};if(!Ii(t))return n;for(const[s,o]of Object.entries(t)){const a=Rl(s)?[s]:o.chains,c=o.methods||[],l=o.events||[],u=Js(s);n[u]=oC(sC({},n[u]),{chains:_i(a,(e=n[u])==null?void 0:e.chains),methods:_i(c,(r=n[u])==null?void 0:r.methods),events:_i(l,(i=n[u])==null?void 0:i.events)})}return n}function hC(t){const e={};return t==null||t.forEach(r=>{var i;const[n,s]=r.split(":");e[n]||(e[n]={accounts:[],chains:[],events:[],methods:[]}),e[n].accounts.push(r),(i=e[n].chains)==null||i.push(`${n}:${s}`)}),e}function _g(t,e){e=e.map(i=>i.replace("did:pkh:",""));const r=hC(e);for(const[i,n]of Object.entries(r))n.methods?n.methods=_i(n.methods,t):n.methods=t,n.events=["chainChanged","accountsChanged"];return r}function fC(t,e){var r,i,n,s,o,a;const c=Ag(t),l=Ag(e),u={},h=Object.keys(c).concat(Object.keys(l));for(const g of h)u[g]={chains:_i((r=c[g])==null?void 0:r.chains,(i=l[g])==null?void 0:i.chains),methods:_i((n=c[g])==null?void 0:n.methods,(s=l[g])==null?void 0:s.methods),events:_i((o=c[g])==null?void 0:o.events,(a=l[g])==null?void 0:a.events)};return u}const dC={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},pC={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function Z(t,e){const{message:r,code:i}=pC[t];return{message:e?`${r} ${e}`:r,code:i}}function ot(t,e){const{message:r,code:i}=dC[t];return{message:e?`${r} ${e}`:r,code:i}}function Fr(t,e){return!!Array.isArray(t)}function Ii(t){return Object.getPrototypeOf(t)===Object.prototype&&Object.keys(t).length}function At(t){return typeof t>"u"}function mt(t,e){return e&&At(t)?!0:typeof t=="string"&&!!t.trim().length}function vd(t,e){return typeof t=="number"&&!isNaN(t)}function gC(t,e){const{requiredNamespaces:r}=e,i=Object.keys(t.namespaces),n=Object.keys(r);let s=!0;return ds(n,i)?(i.forEach(o=>{const{accounts:a,methods:c,events:l}=t.namespaces[o],u=Oo(a),h=r[o];(!ds(Zb(o,h),u)||!ds(h.methods,c)||!ds(h.events,l))&&(s=!1)}),s):!1}function tl(t){return mt(t,!1)&&t.includes(":")?t.split(":").length===2:!1}function mC(t){if(mt(t,!1)&&t.includes(":")){const e=t.split(":");if(e.length===3){const r=e[0]+":"+e[1];return!!e[2]&&tl(r)}}return!1}function yC(t){function e(r){try{return typeof new URL(r)<"u"}catch{return!1}}try{if(mt(t,!1)){if(e(t))return!0;const r=i1(t);return e(r)}}catch{}return!1}function wC(t){var e;return(e=t==null?void 0:t.proposer)==null?void 0:e.publicKey}function bC(t){return t==null?void 0:t.topic}function vC(t,e){let r=null;return mt(t==null?void 0:t.publicKey,!1)||(r=Z("MISSING_OR_INVALID",`${e} controller public key should be a string`)),r}function Ig(t){let e=!0;return Fr(t)?t.length&&(e=t.every(r=>mt(r,!1))):e=!1,e}function EC(t,e,r){let i=null;return Fr(e)&&e.length?e.forEach(n=>{i||tl(n)||(i=ot("UNSUPPORTED_CHAINS",`${r}, chain ${n} should be a string and conform to "namespace:chainId" format`))}):tl(t)||(i=ot("UNSUPPORTED_CHAINS",`${r}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),i}function xC(t,e,r){let i=null;return Object.entries(t).forEach(([n,s])=>{if(i)return;const o=EC(n,Zb(n,s),`${e} ${r}`);o&&(i=o)}),i}function AC(t,e){let r=null;return Fr(t)?t.forEach(i=>{r||mC(i)||(r=ot("UNSUPPORTED_ACCOUNTS",`${e}, account ${i} should be a string and conform to "namespace:chainId:address" format`))}):r=ot("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function _C(t,e){let r=null;return Object.values(t).forEach(i=>{if(r)return;const n=AC(i==null?void 0:i.accounts,`${e} namespace`);n&&(r=n)}),r}function IC(t,e){let r=null;return Ig(t==null?void 0:t.methods)?Ig(t==null?void 0:t.events)||(r=ot("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):r=ot("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),r}function rv(t,e){let r=null;return Object.values(t).forEach(i=>{if(r)return;const n=IC(i,`${e}, namespace`);n&&(r=n)}),r}function SC(t,e,r){let i=null;if(t&&Ii(t)){const n=rv(t,e);n&&(i=n);const s=xC(t,e,r);s&&(i=s)}else i=Z("MISSING_OR_INVALID",`${e}, ${r} should be an object with data`);return i}function Zu(t,e){let r=null;if(t&&Ii(t)){const i=rv(t,e);i&&(r=i);const n=_C(t,e);n&&(r=n)}else r=Z("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return r}function iv(t){return mt(t.protocol,!0)}function PC(t,e){let r=!1;return t?t&&Fr(t)&&t.length&&t.forEach(i=>{r=iv(i)}):r=!0,r}function OC(t){return typeof t=="number"}function nr(t){return typeof t<"u"&&typeof t!==null}function DC(t){return!(!t||typeof t!="object"||!t.code||!vd(t.code)||!t.message||!mt(t.message,!1))}function NC(t){return!(At(t)||!mt(t.method,!1))}function CC(t){return!(At(t)||At(t.result)&&At(t.error)||!vd(t.id)||!mt(t.jsonrpc,!1))}function BC(t){return!(At(t)||!mt(t.name,!1))}function Sg(t,e){return!(!tl(e)||!tv(t).includes(e))}function RC(t,e,r){return mt(r,!1)?lC(t,e).includes(r):!1}function TC(t,e,r){return mt(r,!1)?uC(t,e).includes(r):!1}function Pg(t,e,r){let i=null;const n=MC(t),s=kC(e),o=Object.keys(n),a=Object.keys(s),c=Og(Object.keys(t)),l=Og(Object.keys(e)),u=c.filter(h=>!l.includes(h));return u.length&&(i=Z("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${u.toString()}
      Received: ${Object.keys(e).toString()}`)),ds(o,a)||(i=Z("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${o.toString()}
      Approved: ${a.toString()}`)),Object.keys(e).forEach(h=>{if(!h.includes(":")||i)return;const g=Oo(e[h].accounts);g.includes(h)||(i=Z("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${h}
        Required: ${h}
        Approved: ${g.toString()}`))}),o.forEach(h=>{i||(ds(n[h].methods,s[h].methods)?ds(n[h].events,s[h].events)||(i=Z("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${h}`)):i=Z("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${h}`))}),i}function MC(t){const e={};return Object.keys(t).forEach(r=>{var i;r.includes(":")?e[r]=t[r]:(i=t[r].chains)==null||i.forEach(n=>{e[n]={methods:t[r].methods,events:t[r].events}})}),e}function Og(t){return[...new Set(t.map(e=>e.includes(":")?e.split(":")[0]:e))]}function kC(t){const e={};return Object.keys(t).forEach(r=>{if(r.includes(":"))e[r]=t[r];else{const i=Oo(t[r].accounts);i==null||i.forEach(n=>{e[n]={accounts:t[r].accounts.filter(s=>s.includes(`${n}:`)),methods:t[r].methods,events:t[r].events}})}}),e}function $C(t,e){return vd(t)&&t<=e.max&&t>=e.min}function Dg(){const t=Ra();return new Promise(e=>{switch(t){case Ir.browser:e(UC());break;case Ir.reactNative:e(LC());break;case Ir.node:e(FC());break;default:e(!0)}})}function UC(){return Po()&&(navigator==null?void 0:navigator.onLine)}async function LC(){if(qn()&&typeof global<"u"&&global!=null&&global.NetInfo){const t=await(global==null?void 0:global.NetInfo.fetch());return t==null?void 0:t.isConnected}return!0}function FC(){return!0}function qC(t){switch(Ra()){case Ir.browser:jC(t);break;case Ir.reactNative:zC(t);break}}function jC(t){!qn()&&Po()&&(window.addEventListener("online",()=>t(!0)),window.addEventListener("offline",()=>t(!1)))}function zC(t){qn()&&typeof global<"u"&&global!=null&&global.NetInfo&&(global==null||global.NetInfo.addEventListener(e=>t(e==null?void 0:e.isConnected)))}function HC(){var t;return Po()&&xs()?((t=xs())==null?void 0:t.visibilityState)==="visible":!0}const Xu={};class Ho{static get(e){return Xu[e]}static set(e,r){Xu[e]=r}static delete(e){delete Xu[e]}}function KC(t){const e=Na.decode(t);if(e.length<33)throw new Error("Too short to contain a public key");return e.slice(1,33)}function VC({publicKey:t,signature:e,payload:r}){var i;const n=rf(r.method),s=128|parseInt(((i=r.version)==null?void 0:i.toString())||"4"),o=YC(r.address),a=r.era==="00"?new Uint8Array([0]):rf(r.era);if(a.length!==1&&a.length!==2)throw new Error("Invalid era length");const c=parseInt(r.nonce,16),l=new Uint8Array([c&255,c>>8&255]),u=BigInt(`0x${WC(r.tip)}`),h=QC(u),g=new Uint8Array([0,...t,o,...e,...a,...l,...h,...n]),y=JC(g.length+1);return new Uint8Array([...y,s,...g])}function GC(t){const e=rf(t),r=F5.blake2b(e,void 0,32);return"0x"+Buffer.from(r).toString("hex")}function rf(t){return new Uint8Array(t.replace(/^0x/,"").match(/.{1,2}/g).map(e=>parseInt(e,16)))}function WC(t){return t.startsWith("0x")?t.slice(2):t}function YC(t){const e=Na.decode(t)[0];return e===42?0:e===60?2:1}function JC(t){if(t<64)return new Uint8Array([t<<2]);if(t<16384){const e=t<<2|1;return new Uint8Array([e&255,e>>8&255])}else if(t<1<<30){const e=t<<2|2;return new Uint8Array([e&255,e>>8&255,e>>16&255,e>>24&255])}else throw new Error("Compact encoding > 2^30 not supported")}function QC(t){if(t<BigInt(1)<<BigInt(6))return new Uint8Array([Number(t<<BigInt(2))]);if(t<BigInt(1)<<BigInt(14)){const e=t<<BigInt(2)|BigInt(1);return new Uint8Array([Number(e&BigInt(255)),Number(e>>BigInt(8)&BigInt(255))])}else if(t<BigInt(1)<<BigInt(30)){const e=t<<BigInt(2)|BigInt(2);return new Uint8Array([Number(e&BigInt(255)),Number(e>>BigInt(8)&BigInt(255)),Number(e>>BigInt(16)&BigInt(255)),Number(e>>BigInt(24)&BigInt(255))])}else throw new Error("BigInt compact encoding not supported > 2^30")}function ZC(t){const e=Uint8Array.from(Buffer.from(t.signature,"hex")),r=KC(t.transaction.address),i=VC({publicKey:r,signature:e,payload:t.transaction}),n=Buffer.from(i).toString("hex");return GC(n)}function Ed({logger:t,name:e}){const r=typeof t=="string"?Qb({opts:{level:t,name:e}}).logger:t;return r.level=typeof t=="string"?t:t.level,r}class Bs{}let XC=class extends Bs{constructor(e){super()}};const Ng=Q.FIVE_SECONDS,Rs={pulse:"heartbeat_pulse"};let eB=class nv extends XC{constructor(e){super(e),this.events=new Or.EventEmitter,this.interval=Ng,this.interval=(e==null?void 0:e.interval)||Ng}static async init(e){const r=new nv(e);return await r.init(),r}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async initialize(){this.intervalRef=setInterval(()=>this.pulse(),Q.toMiliseconds(this.interval))}pulse(){this.events.emit(Rs.pulse)}};const tB=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,rB=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,iB=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function nB(t,e){if(t==="__proto__"||t==="constructor"&&e&&typeof e=="object"&&"prototype"in e){sB(t);return}return e}function sB(t){console.warn(`[destr] Dropping "${t}" key to prevent prototype pollution.`)}function ac(t,e={}){if(typeof t!="string")return t;if(t[0]==='"'&&t[t.length-1]==='"'&&t.indexOf("\\")===-1)return t.slice(1,-1);const r=t.trim();if(r.length<=9)switch(r.toLowerCase()){case"true":return!0;case"false":return!1;case"undefined":return;case"null":return null;case"nan":return Number.NaN;case"infinity":return Number.POSITIVE_INFINITY;case"-infinity":return Number.NEGATIVE_INFINITY}if(!iB.test(t)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return t}try{if(tB.test(t)||rB.test(t)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(t,nB)}return JSON.parse(t)}catch(i){if(e.strict)throw i;return t}}function oB(t){return!t||typeof t.then!="function"?Promise.resolve(t):t}function Et(t,...e){try{return oB(t(...e))}catch(r){return Promise.reject(r)}}function aB(t){const e=typeof t;return t===null||e!=="object"&&e!=="function"}function cB(t){const e=Object.getPrototypeOf(t);return!e||e.isPrototypeOf(Object)}function Ic(t){if(aB(t))return String(t);if(cB(t)||Array.isArray(t))return JSON.stringify(t);if(typeof t.toJSON=="function")return Ic(t.toJSON());throw new Error("[unstorage] Cannot stringify value!")}const nf="base64:";function lB(t){return typeof t=="string"?t:nf+fB(t)}function uB(t){return typeof t!="string"||!t.startsWith(nf)?t:hB(t.slice(nf.length))}function hB(t){return globalThis.Buffer?Buffer.from(t,"base64"):Uint8Array.from(globalThis.atob(t),e=>e.codePointAt(0))}function fB(t){return globalThis.Buffer?Buffer.from(t).toString("base64"):globalThis.btoa(String.fromCodePoint(...t))}function ir(t){var e;return t&&((e=t.split("?")[0])==null?void 0:e.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""))||""}function dB(...t){return ir(t.join(":"))}function cc(t){return t=ir(t),t?t+":":""}function pB(t,e){if(e===void 0)return!0;let r=0,i=t.indexOf(":");for(;i>-1;)r++,i=t.indexOf(":",i+1);return r<=e}function gB(t,e){return e?t.startsWith(e)&&t[t.length-1]!=="$":t[t.length-1]!=="$"}const mB="memory",yB=()=>{const t=new Map;return{name:mB,getInstance:()=>t,hasItem(e){return t.has(e)},getItem(e){return t.get(e)??null},getItemRaw(e){return t.get(e)??null},setItem(e,r){t.set(e,r)},setItemRaw(e,r){t.set(e,r)},removeItem(e){t.delete(e)},getKeys(){return[...t.keys()]},clear(){t.clear()},dispose(){t.clear()}}};function wB(t={}){const e={mounts:{"":t.driver||yB()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},r=l=>{for(const u of e.mountpoints)if(l.startsWith(u))return{base:u,relativeKey:l.slice(u.length),driver:e.mounts[u]};return{base:"",relativeKey:l,driver:e.mounts[""]}},i=(l,u)=>e.mountpoints.filter(h=>h.startsWith(l)||u&&l.startsWith(h)).map(h=>({relativeBase:l.length>h.length?l.slice(h.length):void 0,mountpoint:h,driver:e.mounts[h]})),n=(l,u)=>{if(e.watching){u=ir(u);for(const h of e.watchListeners)h(l,u)}},s=async()=>{if(!e.watching){e.watching=!0;for(const l in e.mounts)e.unwatch[l]=await Cg(e.mounts[l],n,l)}},o=async()=>{if(e.watching){for(const l in e.unwatch)await e.unwatch[l]();e.unwatch={},e.watching=!1}},a=(l,u,h)=>{const g=new Map,y=w=>{let E=g.get(w.base);return E||(E={driver:w.driver,base:w.base,items:[]},g.set(w.base,E)),E};for(const w of l){const E=typeof w=="string",P=ir(E?w:w.key),N=E?void 0:w.value,R=E||!w.options?u:{...u,...w.options},D=r(P);y(D).items.push({key:P,value:N,relativeKey:D.relativeKey,options:R})}return Promise.all([...g.values()].map(w=>h(w))).then(w=>w.flat())},c={hasItem(l,u={}){l=ir(l);const{relativeKey:h,driver:g}=r(l);return Et(g.hasItem,h,u)},getItem(l,u={}){l=ir(l);const{relativeKey:h,driver:g}=r(l);return Et(g.getItem,h,u).then(y=>ac(y))},getItems(l,u={}){return a(l,u,h=>h.driver.getItems?Et(h.driver.getItems,h.items.map(g=>({key:g.relativeKey,options:g.options})),u).then(g=>g.map(y=>({key:dB(h.base,y.key),value:ac(y.value)}))):Promise.all(h.items.map(g=>Et(h.driver.getItem,g.relativeKey,g.options).then(y=>({key:g.key,value:ac(y)})))))},getItemRaw(l,u={}){l=ir(l);const{relativeKey:h,driver:g}=r(l);return g.getItemRaw?Et(g.getItemRaw,h,u):Et(g.getItem,h,u).then(y=>uB(y))},async setItem(l,u,h={}){if(u===void 0)return c.removeItem(l);l=ir(l);const{relativeKey:g,driver:y}=r(l);y.setItem&&(await Et(y.setItem,g,Ic(u),h),y.watch||n("update",l))},async setItems(l,u){await a(l,u,async h=>{if(h.driver.setItems)return Et(h.driver.setItems,h.items.map(g=>({key:g.relativeKey,value:Ic(g.value),options:g.options})),u);h.driver.setItem&&await Promise.all(h.items.map(g=>Et(h.driver.setItem,g.relativeKey,Ic(g.value),g.options)))})},async setItemRaw(l,u,h={}){if(u===void 0)return c.removeItem(l,h);l=ir(l);const{relativeKey:g,driver:y}=r(l);if(y.setItemRaw)await Et(y.setItemRaw,g,u,h);else if(y.setItem)await Et(y.setItem,g,lB(u),h);else return;y.watch||n("update",l)},async removeItem(l,u={}){typeof u=="boolean"&&(u={removeMeta:u}),l=ir(l);const{relativeKey:h,driver:g}=r(l);g.removeItem&&(await Et(g.removeItem,h,u),(u.removeMeta||u.removeMata)&&await Et(g.removeItem,h+"$",u),g.watch||n("remove",l))},async getMeta(l,u={}){typeof u=="boolean"&&(u={nativeOnly:u}),l=ir(l);const{relativeKey:h,driver:g}=r(l),y=Object.create(null);if(g.getMeta&&Object.assign(y,await Et(g.getMeta,h,u)),!u.nativeOnly){const w=await Et(g.getItem,h+"$",u).then(E=>ac(E));w&&typeof w=="object"&&(typeof w.atime=="string"&&(w.atime=new Date(w.atime)),typeof w.mtime=="string"&&(w.mtime=new Date(w.mtime)),Object.assign(y,w))}return y},setMeta(l,u,h={}){return this.setItem(l+"$",u,h)},removeMeta(l,u={}){return this.removeItem(l+"$",u)},async getKeys(l,u={}){var P;l=cc(l);const h=i(l,!0);let g=[];const y=[];let w=!0;for(const N of h){(P=N.driver.flags)!=null&&P.maxDepth||(w=!1);const R=await Et(N.driver.getKeys,N.relativeBase,u);for(const D of R){const C=N.mountpoint+ir(D);g.some(B=>C.startsWith(B))||y.push(C)}g=[N.mountpoint,...g.filter(D=>!D.startsWith(N.mountpoint))]}const E=u.maxDepth!==void 0&&!w;return y.filter(N=>(!E||pB(N,u.maxDepth))&&gB(N,l))},async clear(l,u={}){l=cc(l),await Promise.all(i(l,!1).map(async h=>{if(h.driver.clear)return Et(h.driver.clear,h.relativeBase,u);if(h.driver.removeItem){const g=await h.driver.getKeys(h.relativeBase||"",u);return Promise.all(g.map(y=>h.driver.removeItem(y,u)))}}))},async dispose(){await Promise.all(Object.values(e.mounts).map(l=>Bg(l)))},async watch(l){return await s(),e.watchListeners.push(l),async()=>{e.watchListeners=e.watchListeners.filter(u=>u!==l),e.watchListeners.length===0&&await o()}},async unwatch(){e.watchListeners=[],await o()},mount(l,u){if(l=cc(l),l&&e.mounts[l])throw new Error(`already mounted at ${l}`);return l&&(e.mountpoints.push(l),e.mountpoints.sort((h,g)=>g.length-h.length)),e.mounts[l]=u,e.watching&&Promise.resolve(Cg(u,n,l)).then(h=>{e.unwatch[l]=h}).catch(console.error),c},async unmount(l,u=!0){var h,g;l=cc(l),!(!l||!e.mounts[l])&&(e.watching&&l in e.unwatch&&((g=(h=e.unwatch)[l])==null||g.call(h),delete e.unwatch[l]),u&&await Bg(e.mounts[l]),e.mountpoints=e.mountpoints.filter(y=>y!==l),delete e.mounts[l])},getMount(l=""){l=ir(l)+":";const u=r(l);return{driver:u.driver,base:u.base}},getMounts(l="",u={}){return l=ir(l),i(l,u.parents).map(g=>({driver:g.driver,base:g.mountpoint}))},keys:(l,u={})=>c.getKeys(l,u),get:(l,u={})=>c.getItem(l,u),set:(l,u,h={})=>c.setItem(l,u,h),has:(l,u={})=>c.hasItem(l,u),del:(l,u={})=>c.removeItem(l,u),remove:(l,u={})=>c.removeItem(l,u)};return c}function Cg(t,e,r){return t.watch?t.watch((i,n)=>e(i,r+n)):()=>{}}async function Bg(t){typeof t.dispose=="function"&&await Et(t.dispose)}function Ts(t){return new Promise((e,r)=>{t.oncomplete=t.onsuccess=()=>e(t.result),t.onabort=t.onerror=()=>r(t.error)})}function sv(t,e){let r;const i=()=>{if(r)return r;const n=indexedDB.open(t);return n.onupgradeneeded=()=>n.result.createObjectStore(e),r=Ts(n),r.then(s=>{s.onclose=()=>r=void 0},()=>{}),r};return(n,s)=>i().then(o=>s(o.transaction(e,n).objectStore(e)))}let eh;function Ua(){return eh||(eh=sv("keyval-store","keyval")),eh}function Rg(t,e=Ua()){return e("readonly",r=>Ts(r.get(t)))}function bB(t,e,r=Ua()){return r("readwrite",i=>(i.put(e,t),Ts(i.transaction)))}function vB(t,e=Ua()){return e("readwrite",r=>(r.delete(t),Ts(r.transaction)))}function EB(t=Ua()){return t("readwrite",e=>(e.clear(),Ts(e.transaction)))}function xB(t,e){return t.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},Ts(t.transaction)}function AB(t=Ua()){return t("readonly",e=>{if(e.getAllKeys)return Ts(e.getAllKeys());const r=[];return xB(e,i=>r.push(i.key)).then(()=>r)})}const _B="idb-keyval";var IB=(t={})=>{const e=t.base&&t.base.length>0?`${t.base}:`:"",r=n=>e+n;let i;return t.dbName&&t.storeName&&(i=sv(t.dbName,t.storeName)),{name:_B,options:t,async hasItem(n){return!(typeof await Rg(r(n),i)>"u")},async getItem(n){return await Rg(r(n),i)??null},setItem(n,s){return bB(r(n),s,i)},removeItem(n){return vB(r(n),i)},getKeys(){return AB(i)},clear(){return EB(i)}}};const SB="WALLET_CONNECT_V2_INDEXED_DB",PB="keyvaluestorage";let OB=class{constructor(){this.indexedDb=wB({driver:IB({dbName:SB,storeName:PB})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const r=await this.indexedDb.getItem(e);if(r!==null)return r}async setItem(e,r){await this.indexedDb.setItem(e,rn(r))}async removeItem(e){await this.indexedDb.removeItem(e)}};var th=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Sc={exports:{}};(function(){let t;function e(){}t=e,t.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},t.prototype.setItem=function(r,i){this[r]=String(i)},t.prototype.removeItem=function(r){delete this[r]},t.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(i){r[i]=void 0,delete r[i]})},t.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},t.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof th<"u"&&th.localStorage?Sc.exports=th.localStorage:typeof window<"u"&&window.localStorage?Sc.exports=window.localStorage:Sc.exports=new e})();function DB(t){var e;return[t[0],_s((e=t[1])!=null?e:"")]}let NB=class{constructor(){this.localStorage=Sc.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(DB)}async getItem(e){const r=this.localStorage.getItem(e);if(r!==null)return _s(r)}async setItem(e,r){this.localStorage.setItem(e,rn(r))}async removeItem(e){this.localStorage.removeItem(e)}};const CB="wc_storage_version",Tg=1,BB=async(t,e,r)=>{const i=CB,n=await e.getItem(i);if(n&&n>=Tg){r(e);return}const s=await t.getKeys();if(!s.length){r(e);return}const o=[];for(;s.length;){const a=s.shift();if(!a)continue;const c=a.toLowerCase();if(c.includes("wc@")||c.includes("walletconnect")||c.includes("wc_")||c.includes("wallet_connect")){const l=await t.getItem(a);await e.setItem(a,l),o.push(a)}}await e.setItem(i,Tg),r(e),RB(t,o)},RB=async(t,e)=>{e.length&&e.forEach(async r=>{await t.removeItem(r)})};let TB=class{constructor(){this.initialized=!1,this.setInitialized=r=>{this.storage=r,this.initialized=!0};const e=new NB;this.storage=e;try{const r=new OB;BB(e,r,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,r){return await this.initialize(),this.storage.setItem(e,r)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const r=setInterval(()=>{this.initialized&&(clearInterval(r),e())},20)})}};var MB=Object.defineProperty,kB=(t,e,r)=>e in t?MB(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Mg=(t,e,r)=>kB(t,typeof e!="symbol"?e+"":e,r);let $B=class extends Bs{constructor(e){super(),this.opts=e,Mg(this,"protocol","wc"),Mg(this,"version",2)}};var UB=Object.defineProperty,LB=(t,e,r)=>e in t?UB(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,FB=(t,e,r)=>LB(t,e+"",r);let qB=class extends Bs{constructor(e,r){super(),this.core=e,this.logger=r,FB(this,"records",new Map)}},jB=class{constructor(e,r){this.logger=e,this.core=r}},zB=class extends Bs{constructor(e,r){super(),this.relayer=e,this.logger=r}},HB=class extends Bs{constructor(e){super()}},KB=class{constructor(e,r,i,n){this.core=e,this.logger=r,this.name=i}},VB=class extends Bs{constructor(e,r){super(),this.relayer=e,this.logger=r}},GB=class extends Bs{constructor(e,r){super(),this.core=e,this.logger=r}},WB=class{constructor(e,r,i){this.core=e,this.logger=r,this.store=i}},YB=class{constructor(e,r){this.projectId=e,this.logger=r}},JB=class{constructor(e,r,i){this.core=e,this.logger=r,this.telemetryEnabled=i}};var QB=Object.defineProperty,ZB=(t,e,r)=>e in t?QB(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,kg=(t,e,r)=>ZB(t,typeof e!="symbol"?e+"":e,r);let XB=class{constructor(e){this.opts=e,kg(this,"protocol","wc"),kg(this,"version",2)}},eR=class{constructor(e){this.client=e}};const tR="PARSE_ERROR",rR="INVALID_REQUEST",iR="METHOD_NOT_FOUND",nR="INVALID_PARAMS",ov="INTERNAL_ERROR",xd="SERVER_ERROR",sR=[-32700,-32600,-32601,-32602,-32603],la={[tR]:{code:-32700,message:"Parse error"},[rR]:{code:-32600,message:"Invalid Request"},[iR]:{code:-32601,message:"Method not found"},[nR]:{code:-32602,message:"Invalid params"},[ov]:{code:-32603,message:"Internal error"},[xd]:{code:-32e3,message:"Server error"}},av=xd;function oR(t){return sR.includes(t)}function $g(t){return Object.keys(la).includes(t)?la[t]:la[av]}function aR(t){const e=Object.values(la).find(r=>r.code===t);return e||la[av]}function cv(t,e,r){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${e}`):t}var lv={},Ui={},Ug;function cR(){if(Ug)return Ui;Ug=1,Object.defineProperty(Ui,"__esModule",{value:!0}),Ui.isBrowserCryptoAvailable=Ui.getSubtleCrypto=Ui.getBrowerCrypto=void 0;function t(){return(Ur==null?void 0:Ur.crypto)||(Ur==null?void 0:Ur.msCrypto)||{}}Ui.getBrowerCrypto=t;function e(){const i=t();return i.subtle||i.webkitSubtle}Ui.getSubtleCrypto=e;function r(){return!!t()&&!!e()}return Ui.isBrowserCryptoAvailable=r,Ui}var Li={},Lg;function lR(){if(Lg)return Li;Lg=1,Object.defineProperty(Li,"__esModule",{value:!0}),Li.isBrowser=Li.isNode=Li.isReactNative=void 0;function t(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}Li.isReactNative=t;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}Li.isNode=e;function r(){return!t()&&!e()}return Li.isBrowser=r,Li}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Pa;e.__exportStar(cR(),t),e.__exportStar(lR(),t)})(lv);function mi(t=3){const e=Date.now()*Math.pow(10,t),r=Math.floor(Math.random()*Math.pow(10,t));return e+r}function Mn(t=6){return BigInt(mi(t))}function ti(t,e,r){return{id:r||mi(),jsonrpc:"2.0",method:t,params:e}}function Aa(t,e){return{id:t,jsonrpc:"2.0",result:e}}function Tl(t,e,r){return{id:t,jsonrpc:"2.0",error:uR(e)}}function uR(t,e){return typeof t>"u"?$g(ov):(typeof t=="string"&&(t=Object.assign(Object.assign({},$g(xd)),{message:t})),oR(t.code)&&(t=aR(t.code)),t)}class hR{}class fR extends hR{constructor(){super()}}class dR extends fR{constructor(e){super()}}const pR="^https?:",gR="^wss?:";function mR(t){const e=t.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function uv(t,e){const r=mR(t);return typeof r>"u"?!1:new RegExp(e).test(r)}function Fg(t){return uv(t,pR)}function qg(t){return uv(t,gR)}function yR(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function hv(t){return typeof t=="object"&&"id"in t&&"jsonrpc"in t&&t.jsonrpc==="2.0"}function Ad(t){return hv(t)&&"method"in t}function Ml(t){return hv(t)&&(yi(t)||$r(t))}function yi(t){return"result"in t}function $r(t){return"error"in t}let _d=class extends dR{constructor(e){super(e),this.events=new Or.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async request(e,r){return this.requestStrict(ti(e.method,e.params||[],e.id||Mn().toString()),r)}async requestStrict(e,r){return new Promise(async(i,n)=>{if(!this.connection.connected)try{await this.open()}catch(s){n(s)}this.events.on(`${e.id}`,s=>{$r(s)?n(s.error):i(s.result)});try{await this.connection.send(e,r)}catch(s){n(s)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),Ml(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}};const wR=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),bR=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",jg=t=>t.split("?")[0],zg=10,vR=wR();let ER=class{constructor(e){if(this.url=e,this.events=new Or.EventEmitter,this.registering=!1,!qg(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=i=>{this.onClose(i),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(rn(e))}catch(r){this.onError(e.id,r)}}register(e=this.url){if(!qg(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((i,n)=>{this.events.once("register_error",s=>{this.resetMaxListeners(),n(s)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return n(new Error("WebSocket connection is missing or invalid"));i(this.socket)})})}return this.url=e,this.registering=!0,new Promise((r,i)=>{const n=lv.isReactNative()?void 0:{rejectUnauthorized:!yR(e)},s=new vR(e,[],n);bR()?s.onerror=o=>{const a=o;i(this.emitError(a.error))}:s.on("error",o=>{i(this.emitError(o))}),s.onopen=()=>{this.onOpen(s),r(s)}})}onOpen(e){e.onmessage=r=>this.onPayload(r),e.onclose=r=>this.onClose(r),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?_s(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const i=this.parseError(r),n=i.message||i.toString(),s=Tl(e,n);this.events.emit("payload",s)}parseError(e,r=this.url){return cv(e,jg(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>zg&&this.events.setMaxListeners(zg)}emitError(e){const r=this.parseError(new Error((e==null?void 0:e.message)||`WebSocket connection failed for host: ${jg(this.url)}`));return this.events.emit("register_error",r),r}};var xR={};const fv="wc",dv=2,sf="core",Di=`${fv}@2:${sf}:`,AR={logger:"error"},_R={database:":memory:"},IR="crypto",Hg="client_ed25519_seed",SR=Q.ONE_DAY,PR="keychain",OR="0.3",DR="messages",NR="0.3",CR=Q.SIX_HOURS,BR="publisher",pv="irn",RR="error",gv="wss://relay.walletconnect.org",TR="relayer",gt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},MR="_subscription",Br={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},kR=.1,of="2.23.0",st={link_mode:"link_mode",relay:"relay"},Pc={inbound:"inbound",outbound:"outbound"},$R="0.3",UR="WALLETCONNECT_CLIENT_ID",Kg="WALLETCONNECT_LINK_MODE_APPS",wr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},LR="subscription",FR="0.3",qR="pairing",jR="0.3",Ko={wc_pairingDelete:{req:{ttl:Q.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:Q.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:Q.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:Q.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:Q.ONE_DAY,prompt:!1,tag:0},res:{ttl:Q.ONE_DAY,prompt:!1,tag:0}}},ls={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Yr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},zR="history",HR="0.3",KR="expirer",Tr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},VR="0.3",GR="verify-api",WR="https://verify.walletconnect.com",mv="https://verify.walletconnect.org",ua=mv,YR=`${ua}/v3`,JR=[WR,mv],QR="echo",ZR="https://echo.walletconnect.com",pi={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal",subscribing_to_pairing_topic:"subscribing_to_pairing_topic"},qi={no_wss_connection:"no_wss_connection",no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_expired:"proposal_expired",proposal_listener_not_found:"proposal_listener_not_found"},Jr={session_approve_started:"session_approve_started",proposal_not_expired:"proposal_not_expired",session_namespaces_validation_success:"session_namespaces_validation_success",create_session_topic:"create_session_topic",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success",session_request_response_started:"session_request_response_started",session_request_response_validation_success:"session_request_response_validation_success",session_request_response_publish_started:"session_request_response_publish_started"},is={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found",session_request_response_validation_failure:"session_request_response_validation_failure",session_request_response_publish_failure:"session_request_response_publish_failure"},ns={authenticated_session_approve_started:"authenticated_session_approve_started",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve"},Vo={no_internet_connection:"no_internet_connection",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"},XR=.1,eT="event-client",tT=86400,rT="https://pulse.walletconnect.org/batch";function iT(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<t.length;n++){var s=t.charAt(n),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=n}var a=t.length,c=t.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(w){if(w instanceof Uint8Array||(ArrayBuffer.isView(w)?w=new Uint8Array(w.buffer,w.byteOffset,w.byteLength):Array.isArray(w)&&(w=Uint8Array.from(w))),!(w instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(w.length===0)return"";for(var E=0,P=0,N=0,R=w.length;N!==R&&w[N]===0;)N++,E++;for(var D=(R-N)*u+1>>>0,C=new Uint8Array(D);N!==R;){for(var B=w[N],M=0,L=D-1;(B!==0||M<P)&&L!==-1;L--,M++)B+=256*C[L]>>>0,C[L]=B%a>>>0,B=B/a>>>0;if(B!==0)throw new Error("Non-zero carry");P=M,N++}for(var F=D-P;F!==D&&C[F]===0;)F++;for(var k=c.repeat(E);F<D;++F)k+=t.charAt(C[F]);return k}function g(w){if(typeof w!="string")throw new TypeError("Expected String");if(w.length===0)return new Uint8Array;var E=0;if(w[E]!==" "){for(var P=0,N=0;w[E]===c;)P++,E++;for(var R=(w.length-E)*l+1>>>0,D=new Uint8Array(R);w[E];){var C=r[w.charCodeAt(E)];if(C===255)return;for(var B=0,M=R-1;(C!==0||B<N)&&M!==-1;M--,B++)C+=a*D[M]>>>0,D[M]=C%256>>>0,C=C/256>>>0;if(C!==0)throw new Error("Non-zero carry");N=B,E++}if(w[E]!==" "){for(var L=R-N;L!==R&&D[L]===0;)L++;for(var F=new Uint8Array(P+(R-L)),k=P;L!==R;)F[k++]=D[L++];return F}}}function y(w){var E=g(w);if(E)return E;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:g,decode:y}}var nT=iT,sT=nT;const yv=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},oT=t=>new TextEncoder().encode(t),aT=t=>new TextDecoder().decode(t);class cT{constructor(e,r,i){this.name=e,this.prefix=r,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class lT{constructor(e,r,i){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return wv(this,e)}}class uT{constructor(e){this.decoders=e}or(e){return wv(this,e)}decode(e){const r=e[0],i=this.decoders[r];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const wv=(t,e)=>new uT({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class hT{constructor(e,r,i,n){this.name=e,this.prefix=r,this.baseEncode=i,this.baseDecode=n,this.encoder=new cT(e,r,i),this.decoder=new lT(e,r,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const kl=({name:t,prefix:e,encode:r,decode:i})=>new hT(t,e,r,i),La=({prefix:t,name:e,alphabet:r})=>{const{encode:i,decode:n}=sT(r,e);return kl({prefix:t,name:e,encode:i,decode:s=>yv(n(s))})},fT=(t,e,r,i)=>{const n={};for(let u=0;u<e.length;++u)n[e[u]]=u;let s=t.length;for(;t[s-1]==="=";)--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,l=0;for(let u=0;u<s;++u){const h=n[t[u]];if(h===void 0)throw new SyntaxError(`Non-${i} character`);c=c<<r|h,a+=r,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},dT=(t,e,r)=>{const i=e[e.length-1]==="=",n=(1<<r)-1;let s="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,s+=e[n&a>>o];if(o&&(s+=e[n&a<<r-o]),i)for(;s.length*r&7;)s+="=";return s},Ut=({name:t,prefix:e,bitsPerChar:r,alphabet:i})=>kl({prefix:e,name:t,encode(n){return dT(n,i,r)},decode(n){return fT(n,i,r,t)}}),pT=kl({prefix:"\0",name:"identity",encode:t=>aT(t),decode:t=>oT(t)});var gT=Object.freeze({__proto__:null,identity:pT});const mT=Ut({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var yT=Object.freeze({__proto__:null,base2:mT});const wT=Ut({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var bT=Object.freeze({__proto__:null,base8:wT});const vT=La({prefix:"9",name:"base10",alphabet:"0123456789"});var ET=Object.freeze({__proto__:null,base10:vT});const xT=Ut({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),AT=Ut({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var _T=Object.freeze({__proto__:null,base16:xT,base16upper:AT});const IT=Ut({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),ST=Ut({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),PT=Ut({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),OT=Ut({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),DT=Ut({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),NT=Ut({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),CT=Ut({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),BT=Ut({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),RT=Ut({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var TT=Object.freeze({__proto__:null,base32:IT,base32upper:ST,base32pad:PT,base32padupper:OT,base32hex:DT,base32hexupper:NT,base32hexpad:CT,base32hexpadupper:BT,base32z:RT});const MT=La({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),kT=La({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var $T=Object.freeze({__proto__:null,base36:MT,base36upper:kT});const UT=La({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),LT=La({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var FT=Object.freeze({__proto__:null,base58btc:UT,base58flickr:LT});const qT=Ut({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),jT=Ut({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),zT=Ut({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),HT=Ut({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var KT=Object.freeze({__proto__:null,base64:qT,base64pad:jT,base64url:zT,base64urlpad:HT});const bv=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),VT=bv.reduce((t,e,r)=>(t[r]=e,t),[]),GT=bv.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function WT(t){return t.reduce((e,r)=>(e+=VT[r],e),"")}function YT(t){const e=[];for(const r of t){const i=GT[r.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(i)}return new Uint8Array(e)}const JT=kl({prefix:"🚀",name:"base256emoji",encode:WT,decode:YT});var QT=Object.freeze({__proto__:null,base256emoji:JT}),ZT=vv,Vg=128,XT=-128,eM=Math.pow(2,31);function vv(t,e,r){e=e||[],r=r||0;for(var i=r;t>=eM;)e[r++]=t&255|Vg,t/=128;for(;t&XT;)e[r++]=t&255|Vg,t>>>=7;return e[r]=t|0,vv.bytes=r-i+1,e}var tM=af,rM=128,Gg=127;function af(t,i){var r=0,i=i||0,n=0,s=i,o,a=t.length;do{if(s>=a)throw af.bytes=0,new RangeError("Could not decode varint");o=t[s++],r+=n<28?(o&Gg)<<n:(o&Gg)*Math.pow(2,n),n+=7}while(o>=rM);return af.bytes=s-i,r}var iM=Math.pow(2,7),nM=Math.pow(2,14),sM=Math.pow(2,21),oM=Math.pow(2,28),aM=Math.pow(2,35),cM=Math.pow(2,42),lM=Math.pow(2,49),uM=Math.pow(2,56),hM=Math.pow(2,63),fM=function(t){return t<iM?1:t<nM?2:t<sM?3:t<oM?4:t<aM?5:t<cM?6:t<lM?7:t<uM?8:t<hM?9:10},dM={encode:ZT,decode:tM,encodingLength:fM},Ev=dM;const Wg=(t,e,r=0)=>(Ev.encode(t,e,r),e),Yg=t=>Ev.encodingLength(t),cf=(t,e)=>{const r=e.byteLength,i=Yg(t),n=i+Yg(r),s=new Uint8Array(n+r);return Wg(t,s,0),Wg(r,s,i),s.set(e,n),new pM(t,r,e,s)};class pM{constructor(e,r,i,n){this.code=e,this.size=r,this.digest=i,this.bytes=n}}const xv=({name:t,code:e,encode:r})=>new gM(t,e,r);class gM{constructor(e,r,i){this.name=e,this.code=r,this.encode=i}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?cf(this.code,r):r.then(i=>cf(this.code,i))}else throw Error("Unknown type, must be binary type")}}const Av=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),mM=xv({name:"sha2-256",code:18,encode:Av("SHA-256")}),yM=xv({name:"sha2-512",code:19,encode:Av("SHA-512")});var wM=Object.freeze({__proto__:null,sha256:mM,sha512:yM});const _v=0,bM="identity",Iv=yv,vM=t=>cf(_v,Iv(t)),EM={code:_v,name:bM,encode:Iv,digest:vM};var xM=Object.freeze({__proto__:null,identity:EM});new TextEncoder,new TextDecoder;const Jg={...gT,...yT,...bT,...ET,..._T,...TT,...$T,...FT,...KT,...QT};({...wM,...xM});function Sv(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function AM(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Sv(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function Pv(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}const Qg=Pv("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),rh=Pv("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=AM(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),_M={utf8:Qg,"utf-8":Qg,hex:Jg.base16,latin1:rh,ascii:rh,binary:rh,...Jg};function IM(t,e="utf8"){const r=_M[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Sv(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}var SM=Object.defineProperty,PM=(t,e,r)=>e in t?SM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,fi=(t,e,r)=>PM(t,typeof e!="symbol"?e+"":e,r);class OM{constructor(e,r){this.core=e,this.logger=r,fi(this,"keychain",new Map),fi(this,"name",PR),fi(this,"version",OR),fi(this,"initialized",!1),fi(this,"storagePrefix",Di),fi(this,"init",async()=>{if(!this.initialized){const i=await this.getKeyChain();typeof i<"u"&&(this.keychain=i),this.initialized=!0}}),fi(this,"has",i=>(this.isInitialized(),this.keychain.has(i))),fi(this,"set",async(i,n)=>{this.isInitialized(),this.keychain.set(i,n),await this.persist()}),fi(this,"get",i=>{this.isInitialized();const n=this.keychain.get(i);if(typeof n>"u"){const{message:s}=Z("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(s)}return n}),fi(this,"del",async i=>{this.isInitialized(),this.keychain.delete(i),await this.persist()}),this.core=e,this.logger=Dr(r,this.name)}get context(){return pr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,zh(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Hh(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=Z("NOT_INITIALIZED",this.name);throw new Error(e)}}}var DM=Object.defineProperty,NM=(t,e,r)=>e in t?DM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,bt=(t,e,r)=>NM(t,typeof e!="symbol"?e+"":e,r);class CM{constructor(e,r,i){this.core=e,this.logger=r,bt(this,"name",IR),bt(this,"keychain"),bt(this,"randomSessionIdentifier",tf()),bt(this,"initialized",!1),bt(this,"clientId"),bt(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),bt(this,"hasKeys",n=>(this.isInitialized(),this.keychain.has(n))),bt(this,"getClientId",async()=>{if(this.isInitialized(),this.clientId)return this.clientId;const n=await this.getClientSeed(),s=A0(n),o=Ob(s.publicKey);return this.clientId=o,o}),bt(this,"generateKeyPair",()=>{this.isInitialized();const n=MN();return this.setPrivateKey(n.publicKey,n.privateKey)}),bt(this,"signJWT",async n=>{this.isInitialized();const s=await this.getClientSeed(),o=A0(s),a=this.randomSessionIdentifier;return await C4(a,n,SR,o)}),bt(this,"generateSharedKey",(n,s,o)=>{this.isInitialized();const a=this.getPrivateKey(n),c=kN(a,s);return this.setSymKey(c,o)}),bt(this,"setSymKey",async(n,s)=>{this.isInitialized();const o=s||_c(n);return await this.keychain.set(o,n),o}),bt(this,"deleteKeyPair",async n=>{this.isInitialized(),await this.keychain.del(n)}),bt(this,"deleteSymKey",async n=>{this.isInitialized(),await this.keychain.del(n)}),bt(this,"encode",async(n,s,o)=>{this.isInitialized();const a=ev(o),c=rn(s);if(mg(a))return LN(c,o==null?void 0:o.encoding);if(gg(a)){const g=a.senderPublicKey,y=a.receiverPublicKey;n=await this.generateSharedKey(g,y)}const l=this.getSymKey(n),{type:u,senderPublicKey:h}=a;return $N({type:u,symKey:l,message:c,senderPublicKey:h,encoding:o==null?void 0:o.encoding})}),bt(this,"decode",async(n,s,o)=>{this.isInitialized();const a=qN(s,o);if(mg(a)){const c=FN(s,o==null?void 0:o.encoding);return _s(c)}if(gg(a)){const c=a.receiverPublicKey,l=a.senderPublicKey;n=await this.generateSharedKey(c,l)}try{const c=this.getSymKey(n),l=UN({symKey:c,encoded:s,encoding:o==null?void 0:o.encoding});return _s(l)}catch(c){this.logger.error(`Failed to decode message from topic: '${n}', clientId: '${await this.getClientId()}'`),this.logger.error(c)}}),bt(this,"getPayloadType",(n,s=ar)=>{const o=xa({encoded:n,encoding:s});return Ss(o.type)}),bt(this,"getPayloadSenderPublicKey",(n,s=ar)=>{const o=xa({encoded:n,encoding:s});return o.senderPublicKey?hr(o.senderPublicKey,Xt):void 0}),this.core=e,this.logger=Dr(r,this.name),this.keychain=i||new OM(this.core,this.logger)}get context(){return pr(this.logger)}async setPrivateKey(e,r){return await this.keychain.set(e,r),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Hg)}catch{e=tf(),await this.keychain.set(Hg,e)}return IM(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=Z("NOT_INITIALIZED",this.name);throw new Error(e)}}}var BM=Object.defineProperty,RM=Object.defineProperties,TM=Object.getOwnPropertyDescriptors,Zg=Object.getOwnPropertySymbols,MM=Object.prototype.hasOwnProperty,kM=Object.prototype.propertyIsEnumerable,lf=(t,e,r)=>e in t?BM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,$M=(t,e)=>{for(var r in e||(e={}))MM.call(e,r)&&lf(t,r,e[r]);if(Zg)for(var r of Zg(e))kM.call(e,r)&&lf(t,r,e[r]);return t},UM=(t,e)=>RM(t,TM(e)),gr=(t,e,r)=>lf(t,typeof e!="symbol"?e+"":e,r);class LM extends jB{constructor(e,r){super(e,r),this.logger=e,this.core=r,gr(this,"messages",new Map),gr(this,"messagesWithoutClientAck",new Map),gr(this,"name",DR),gr(this,"version",NR),gr(this,"initialized",!1),gr(this,"storagePrefix",Di),gr(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const i=await this.getRelayerMessages();typeof i<"u"&&(this.messages=i);const n=await this.getRelayerMessagesWithoutClientAck();typeof n<"u"&&(this.messagesWithoutClientAck=n),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(i){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(i)}finally{this.initialized=!0}}}),gr(this,"set",async(i,n,s)=>{this.isInitialized();const o=kr(n);let a=this.messages.get(i);if(typeof a>"u"&&(a={}),typeof a[o]<"u")return o;if(a[o]=n,this.messages.set(i,a),s===Pc.inbound){const c=this.messagesWithoutClientAck.get(i)||{};this.messagesWithoutClientAck.set(i,UM($M({},c),{[o]:n}))}return await this.persist(),o}),gr(this,"get",i=>{this.isInitialized();let n=this.messages.get(i);return typeof n>"u"&&(n={}),n}),gr(this,"getWithoutAck",i=>{this.isInitialized();const n={};for(const s of i){const o=this.messagesWithoutClientAck.get(s)||{};n[s]=Object.values(o)}return n}),gr(this,"has",(i,n)=>{this.isInitialized();const s=this.get(i),o=kr(n);return typeof s[o]<"u"}),gr(this,"ack",async(i,n)=>{this.isInitialized();const s=this.messagesWithoutClientAck.get(i);if(typeof s>"u")return;const o=kr(n);delete s[o],Object.keys(s).length===0?this.messagesWithoutClientAck.delete(i):this.messagesWithoutClientAck.set(i,s),await this.persist()}),gr(this,"del",async i=>{this.isInitialized(),this.messages.delete(i),this.messagesWithoutClientAck.delete(i),await this.persist()}),this.logger=Dr(e,this.name),this.core=r}get context(){return pr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get storageKeyWithoutClientAck(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name+"_withoutClientAck"}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,zh(e))}async setRelayerMessagesWithoutClientAck(e){await this.core.storage.setItem(this.storageKeyWithoutClientAck,zh(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Hh(e):void 0}async getRelayerMessagesWithoutClientAck(){const e=await this.core.storage.getItem(this.storageKeyWithoutClientAck);return typeof e<"u"?Hh(e):void 0}async persist(){await this.setRelayerMessages(this.messages),await this.setRelayerMessagesWithoutClientAck(this.messagesWithoutClientAck)}isInitialized(){if(!this.initialized){const{message:e}=Z("NOT_INITIALIZED",this.name);throw new Error(e)}}}var FM=Object.defineProperty,qM=Object.defineProperties,jM=Object.getOwnPropertyDescriptors,Xg=Object.getOwnPropertySymbols,zM=Object.prototype.hasOwnProperty,HM=Object.prototype.propertyIsEnumerable,uf=(t,e,r)=>e in t?FM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,js=(t,e)=>{for(var r in e||(e={}))zM.call(e,r)&&uf(t,r,e[r]);if(Xg)for(var r of Xg(e))HM.call(e,r)&&uf(t,r,e[r]);return t},em=(t,e)=>qM(t,jM(e)),Rr=(t,e,r)=>uf(t,typeof e!="symbol"?e+"":e,r);class KM extends zB{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,Rr(this,"events",new Or.EventEmitter),Rr(this,"name",BR),Rr(this,"queue",new Map),Rr(this,"publishTimeout",Q.toMiliseconds(Q.ONE_MINUTE)),Rr(this,"initialPublishTimeout",Q.toMiliseconds(Q.ONE_SECOND*15)),Rr(this,"needsTransportRestart",!1),Rr(this,"publish",async(i,n,s)=>{var o,a,c,l,u;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:n,opts:s}});const h=(s==null?void 0:s.ttl)||CR,g=(s==null?void 0:s.prompt)||!1,y=(s==null?void 0:s.tag)||0,w=(s==null?void 0:s.id)||Mn().toString(),E=Ys(el().protocol),P={id:w,method:(s==null?void 0:s.publishMethod)||E.publish,params:js({topic:i,message:n,ttl:h,prompt:g,tag:y,attestation:s==null?void 0:s.attestation},s==null?void 0:s.tvf)},N=`Failed to publish payload, please try again. id:${w} tag:${y}`;try{At((o=P.params)==null?void 0:o.prompt)&&((a=P.params)==null||delete a.prompt),At((c=P.params)==null?void 0:c.tag)&&((l=P.params)==null||delete l.tag);const R=new Promise(async D=>{const C=({id:M})=>{var L;((L=P.id)==null?void 0:L.toString())===M.toString()&&(this.removeRequestFromQueue(M),this.relayer.events.removeListener(gt.publish,C),D())};this.relayer.events.on(gt.publish,C);const B=vi(new Promise((M,L)=>{this.rpcPublish(P,s).then(M).catch(F=>{this.logger.warn(F,F==null?void 0:F.message),L(F)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${w} tag:${y}`);try{await B,this.events.removeListener(gt.publish,C)}catch(M){this.queue.set(w,{request:P,opts:s,attempt:1}),this.logger.warn(M,M==null?void 0:M.message)}});this.logger.trace({type:"method",method:"publish",params:{id:w,topic:i,message:n,opts:s}}),await vi(R,this.publishTimeout,N)}catch(R){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(R),(u=s==null?void 0:s.internal)!=null&&u.throwOnFailedPublish)throw R}finally{this.queue.delete(w)}}),Rr(this,"publishCustom",async i=>{var n,s,o,a,c;this.logger.debug("Publishing custom payload"),this.logger.trace({type:"method",method:"publishCustom",params:i});const{payload:l,opts:u={}}=i,{attestation:h,tvf:g,publishMethod:y,prompt:w,tag:E,ttl:P=Q.FIVE_MINUTES}=u,N=u.id||Mn().toString(),R=Ys(el().protocol),D=y||R.publish,C={id:N,method:D,params:js(em(js({},l),{ttl:P,prompt:w,tag:E,attestation:h}),g)},B=`Failed to publish custom payload, please try again. id:${N} tag:${E}`;try{At((n=C.params)==null?void 0:n.prompt)&&((s=C.params)==null||delete s.prompt),At((o=C.params)==null?void 0:o.tag)&&((a=C.params)==null||delete a.tag);const M=new Promise(async L=>{const F=({id:V})=>{var H;((H=C.id)==null?void 0:H.toString())===V.toString()&&(this.removeRequestFromQueue(V),this.relayer.events.removeListener(gt.publish,F),L())};this.relayer.events.on(gt.publish,F);const k=vi(new Promise((V,H)=>{this.rpcPublish(C,u).then(V).catch($=>{this.logger.warn($,$==null?void 0:$.message),H($)})}),this.initialPublishTimeout,`Failed initial custom payload publish, retrying.... method:${D} id:${N} tag:${E}`);try{await k,this.events.removeListener(gt.publish,F)}catch(V){this.queue.set(N,{request:C,opts:u,attempt:1}),this.logger.warn(V,V==null?void 0:V.message)}});this.logger.trace({type:"method",method:"publish",params:{id:N,payload:l,opts:u}}),await vi(M,this.publishTimeout,B)}catch(M){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(M),(c=u==null?void 0:u.internal)!=null&&c.throwOnFailedPublish)throw M}finally{this.queue.delete(N)}}),Rr(this,"on",(i,n)=>{this.events.on(i,n)}),Rr(this,"once",(i,n)=>{this.events.once(i,n)}),Rr(this,"off",(i,n)=>{this.events.off(i,n)}),Rr(this,"removeListener",(i,n)=>{this.events.removeListener(i,n)}),this.relayer=e,this.logger=Dr(r,this.name),this.registerEventListeners()}get context(){return pr(this.logger)}async rpcPublish(e,r){this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:e});const i=await this.relayer.request(e);return this.relayer.events.emit(gt.publish,js(js({},e),r)),this.logger.debug("Successfully Published Payload"),i}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async(e,r)=>{var i;const n=e.attempt+1;this.queue.set(r,em(js({},e),{attempt:n})),this.logger.warn({},`Publisher: queue->publishing: ${e.request.id}, tag: ${(i=e.request.params)==null?void 0:i.tag}, attempt: ${n}`),await this.rpcPublish(e.request,e.opts),this.logger.warn({},`Publisher: queue->published: ${e.request.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(Rs.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(gt.connection_stalled);return}this.checkQueue()}),this.relayer.on(gt.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}var VM=Object.defineProperty,GM=(t,e,r)=>e in t?VM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,zs=(t,e,r)=>GM(t,typeof e!="symbol"?e+"":e,r);class WM{constructor(){zs(this,"map",new Map),zs(this,"set",(e,r)=>{const i=this.get(e);this.exists(e,r)||this.map.set(e,[...i,r])}),zs(this,"get",e=>this.map.get(e)||[]),zs(this,"exists",(e,r)=>this.get(e).includes(r)),zs(this,"delete",(e,r)=>{if(typeof r>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const i=this.get(e);if(!this.exists(e,r))return;const n=i.filter(s=>s!==r);if(!n.length){this.map.delete(e);return}this.map.set(e,n)}),zs(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}}var YM=Object.defineProperty,JM=Object.defineProperties,QM=Object.getOwnPropertyDescriptors,tm=Object.getOwnPropertySymbols,ZM=Object.prototype.hasOwnProperty,XM=Object.prototype.propertyIsEnumerable,hf=(t,e,r)=>e in t?YM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Go=(t,e)=>{for(var r in e||(e={}))ZM.call(e,r)&&hf(t,r,e[r]);if(tm)for(var r of tm(e))XM.call(e,r)&&hf(t,r,e[r]);return t},ih=(t,e)=>JM(t,QM(e)),Re=(t,e,r)=>hf(t,typeof e!="symbol"?e+"":e,r);class ek extends VB{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,Re(this,"subscriptions",new Map),Re(this,"topicMap",new WM),Re(this,"events",new Or.EventEmitter),Re(this,"name",LR),Re(this,"version",FR),Re(this,"pending",new Map),Re(this,"cached",[]),Re(this,"initialized",!1),Re(this,"storagePrefix",Di),Re(this,"subscribeTimeout",Q.toMiliseconds(Q.ONE_MINUTE)),Re(this,"initialSubscribeTimeout",Q.toMiliseconds(Q.ONE_SECOND*15)),Re(this,"clientId"),Re(this,"batchSubscribeTopicsLimit",500),Re(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),Re(this,"subscribe",async(i,n)=>{var s;this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:n}});try{const o=el(n),a={topic:i,relay:o,transportType:n==null?void 0:n.transportType};(s=n==null?void 0:n.internal)!=null&&s.skipSubscribe||this.pending.set(i,a);const c=await this.rpcSubscribe(i,o,n);return typeof c=="string"&&(this.onSubscribe(c,a),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:n}})),c}catch(o){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(o),o}}),Re(this,"unsubscribe",async(i,n)=>{this.isInitialized(),typeof(n==null?void 0:n.id)<"u"?await this.unsubscribeById(i,n.id,n):await this.unsubscribeByTopic(i,n)}),Re(this,"isSubscribed",i=>new Promise(n=>{n(this.topicMap.topics.includes(i))})),Re(this,"isKnownTopic",i=>new Promise(n=>{n(this.topicMap.topics.includes(i)||this.pending.has(i)||this.cached.some(s=>s.topic===i))})),Re(this,"on",(i,n)=>{this.events.on(i,n)}),Re(this,"once",(i,n)=>{this.events.once(i,n)}),Re(this,"off",(i,n)=>{this.events.off(i,n)}),Re(this,"removeListener",(i,n)=>{this.events.removeListener(i,n)}),Re(this,"start",async()=>{await this.onConnect()}),Re(this,"stop",async()=>{await this.onDisconnect()}),Re(this,"restart",async()=>{await this.restore(),await this.onRestart()}),Re(this,"checkPending",async()=>{if(this.pending.size===0&&(!this.initialized||!this.relayer.connected))return;const i=[];this.pending.forEach(n=>{i.push(n)}),await this.batchSubscribe(i)}),Re(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(Rs.pulse,async()=>{await this.checkPending()}),this.events.on(wr.created,async i=>{const n=wr.created;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:i}),await this.persist()}),this.events.on(wr.deleted,async i=>{const n=wr.deleted;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:i}),await this.persist()})}),this.relayer=e,this.logger=Dr(r,this.name),this.clientId=""}get context(){return pr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(e,r){let i=!1;try{i=this.getSubscription(e).topic===r}catch{}return i}reset(){this.cached=[],this.initialized=!0}onDisable(){this.values.length>0&&(this.cached=this.values),this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,r){const i=this.topicMap.get(e);await Promise.all(i.map(async n=>await this.unsubscribeById(e,n,r)))}async unsubscribeById(e,r,i){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:i}});try{const n=el(i);await this.restartToComplete({topic:e,id:r,relay:n}),await this.rpcUnsubscribe(e,r,n);const s=ot("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,r,s),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:i}})}catch(n){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(n),n}}async rpcSubscribe(e,r,i){var n,s;const o=await this.getSubscriptionId(e);if((n=i==null?void 0:i.internal)!=null&&n.skipSubscribe)return o;(!i||(i==null?void 0:i.transportType)===st.relay)&&await this.restartToComplete({topic:e,id:e,relay:r});const a={method:Ys(r.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a});const c=(s=i==null?void 0:i.internal)==null?void 0:s.throwOnFailedPublish;try{if((i==null?void 0:i.transportType)===st.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(a).catch(h=>this.logger.warn(h))},Q.toMiliseconds(Q.ONE_SECOND)),o;const l=new Promise(async h=>{const g=y=>{y.topic===e&&(this.events.removeListener(wr.created,g),h(y.id))};this.events.on(wr.created,g);try{const y=await vi(new Promise((w,E)=>{this.relayer.request(a).catch(P=>{this.logger.warn(P,P==null?void 0:P.message),E(P)}).then(w)}),this.initialSubscribeTimeout,`Subscribing to ${e} failed, please try again`);this.events.removeListener(wr.created,g),h(y)}catch{}}),u=await vi(l,this.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!u&&c)throw new Error(`Subscribing to ${e} failed, please try again`);return u?o:null}catch(l){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(gt.connection_stalled),c)throw l}return null}async rpcBatchSubscribe(e){if(!e.length)return;const r=e[0].relay,i={method:Ys(r.protocol).batchSubscribe,params:{topics:e.map(n=>n.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});try{await await vi(new Promise(n=>{this.relayer.request(i).catch(s=>this.logger.warn(s)).then(n)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(gt.connection_stalled)}}async rpcBatchFetchMessages(e){if(!e.length)return;const r=e[0].relay,i={method:Ys(r.protocol).batchFetchMessages,params:{topics:e.map(s=>s.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});let n;try{n=await await vi(new Promise((s,o)=>{this.relayer.request(i).catch(a=>{this.logger.warn(a),o(a)}).then(s)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(gt.connection_stalled)}return n}rpcUnsubscribe(e,r,i){const n={method:Ys(i.protocol).unsubscribe,params:{topic:e,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n}),this.relayer.request(n)}onSubscribe(e,r){this.setSubscription(e,ih(Go({},r),{id:e})),this.pending.delete(r.topic)}onBatchSubscribe(e){e.length&&e.forEach(r=>{this.setSubscription(r.id,Go({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(e,r,i){this.events.removeAllListeners(r),this.hasSubscription(r,e)&&this.deleteSubscription(r,i),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,r){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:r}),this.addSubscription(e,r)}addSubscription(e,r){this.subscriptions.set(e,Go({},r)),this.topicMap.set(r.topic,e),this.events.emit(wr.created,r)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const r=this.subscriptions.get(e);if(!r){const{message:i}=Z("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return r}deleteSubscription(e,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:r});const i=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(i.topic,e),this.events.emit(wr.deleted,ih(Go({},i),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(wr.sync)}async onRestart(){if(this.cached.length){const e=[...this.cached],r=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let i=0;i<r;i++){const n=e.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(n)}}this.events.emit(wr.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size&&!e.every(r=>{var i;return r.topic===((i=this.subscriptions.get(r.id))==null?void 0:i.topic)})){const{message:r}=Z("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){e.length&&(await this.rpcBatchSubscribe(e),this.onBatchSubscribe(await Promise.all(e.map(async r=>ih(Go({},r),{id:await this.getSubscriptionId(r.topic)})))))}async batchFetchMessages(e){if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);const r=await this.rpcBatchFetchMessages(e);r&&r.messages&&(await tO(Q.toMiliseconds(Q.ONE_SECOND)),await this.relayer.handleBatchMessageEvents(r.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){const{message:e}=Z("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(e){!this.relayer.connected&&!this.relayer.connecting&&(this.cached.push(e),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(e){return kr(e+await this.getClientId())}}var tk=Object.defineProperty,rm=Object.getOwnPropertySymbols,rk=Object.prototype.hasOwnProperty,ik=Object.prototype.propertyIsEnumerable,ff=(t,e,r)=>e in t?tk(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,im=(t,e)=>{for(var r in e||(e={}))rk.call(e,r)&&ff(t,r,e[r]);if(rm)for(var r of rm(e))ik.call(e,r)&&ff(t,r,e[r]);return t},we=(t,e,r)=>ff(t,typeof e!="symbol"?e+"":e,r);class nk extends HB{constructor(e){var r;super(e),we(this,"protocol","wc"),we(this,"version",2),we(this,"core"),we(this,"logger"),we(this,"events",new Or.EventEmitter),we(this,"provider"),we(this,"messages"),we(this,"subscriber"),we(this,"publisher"),we(this,"name",TR),we(this,"transportExplicitlyClosed",!1),we(this,"initialized",!1),we(this,"connectionAttemptInProgress",!1),we(this,"relayUrl"),we(this,"projectId"),we(this,"packageName"),we(this,"bundleId"),we(this,"hasExperiencedNetworkDisruption",!1),we(this,"pingTimeout"),we(this,"heartBeatTimeout",Q.toMiliseconds(Q.THIRTY_SECONDS+Q.FIVE_SECONDS)),we(this,"reconnectTimeout"),we(this,"connectPromise"),we(this,"reconnectInProgress",!1),we(this,"requestsInFlight",[]),we(this,"connectTimeout",Q.toMiliseconds(Q.ONE_SECOND*15)),we(this,"request",async i=>{var n,s;this.logger.debug("Publishing Request Payload");const o=i.id||Mn().toString();await this.toEstablishConnection();try{this.logger.trace({id:o,method:i.method,topic:(n=i.params)==null?void 0:n.topic},"relayer.request - publishing...");const a=`${o}:${((s=i.params)==null?void 0:s.tag)||""}`;this.requestsInFlight.push(a);const c=await this.provider.request(i);return this.requestsInFlight=this.requestsInFlight.filter(l=>l!==a),c}catch(a){throw this.logger.debug(`Failed to Publish Request: ${o}`),a}}),we(this,"resetPingTimeout",()=>{Wc()&&(clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var i,n,s,o;try{this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),(o=(s=(n=(i=this.provider)==null?void 0:i.connection)==null?void 0:n.socket)==null?void 0:s.terminate)==null||o.call(s)}catch(a){this.logger.warn(a,a==null?void 0:a.message)}},this.heartBeatTimeout))}),we(this,"onPayloadHandler",i=>{this.onProviderPayload(i),this.resetPingTimeout()}),we(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected 🛜"),this.startPingTimeout(),this.events.emit(gt.connect)}),we(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected 🛑"),this.requestsInFlight=[],this.onProviderDisconnect()}),we(this,"onProviderErrorHandler",i=>{this.logger.fatal(`Fatal socket error: ${i.message}`),this.events.emit(gt.error,i),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()}),we(this,"registerProviderListeners",()=>{this.provider.on(Br.payload,this.onPayloadHandler),this.provider.on(Br.connect,this.onConnectHandler),this.provider.on(Br.disconnect,this.onDisconnectHandler),this.provider.on(Br.error,this.onProviderErrorHandler)}),this.core=e.core,this.logger=Ed({logger:(r=e.logger)!=null?r:RR,name:this.name}),this.messages=new LM(this.logger,e.core),this.subscriber=new ek(this,this.logger),this.publisher=new KM(this,this.logger),this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||gv,LP()?this.packageName=$0():FP()&&(this.bundleId=$0()),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.transportOpen().catch(e=>this.logger.warn(e,e==null?void 0:e.message))}get context(){return pr(this.logger)}get connected(){var e,r,i;return((i=(r=(e=this.provider)==null?void 0:e.connection)==null?void 0:r.socket)==null?void 0:i.readyState)===1||!1}get connecting(){var e,r,i;return((i=(r=(e=this.provider)==null?void 0:e.connection)==null?void 0:r.socket)==null?void 0:i.readyState)===0||this.connectPromise!==void 0||!1}async publish(e,r,i){this.isInitialized(),await this.publisher.publish(e,r,i),await this.recordMessageEvent({topic:e,message:r,publishedAt:Date.now(),transportType:st.relay},Pc.outbound)}async publishCustom(e){this.isInitialized(),await this.publisher.publishCustom(e)}async subscribe(e,r){var i,n,s;this.isInitialized(),(!(r!=null&&r.transportType)||(r==null?void 0:r.transportType)==="relay")&&await this.toEstablishConnection();const o=typeof((i=r==null?void 0:r.internal)==null?void 0:i.throwOnFailedPublish)>"u"?!0:(n=r==null?void 0:r.internal)==null?void 0:n.throwOnFailedPublish;let a=((s=this.subscriber.topicMap.get(e))==null?void 0:s[0])||"",c;const l=u=>{u.topic===e&&(this.subscriber.off(wr.created,l),c())};return await Promise.all([new Promise(u=>{c=u,this.subscriber.on(wr.created,l)}),new Promise(async(u,h)=>{a=await this.subscriber.subscribe(e,im({internal:{throwOnFailedPublish:o}},r)).catch(g=>{o&&h(g)})||a,u()})]),a}async unsubscribe(e,r){this.isInitialized(),await this.subscriber.unsubscribe(e,r)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await vi(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){if(!this.subscriber.hasAnyTopics){this.logger.info("Starting WS connection skipped because the client has no topics to work with.");return}if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(r,i)=>{await this.connect(e).then(r).catch(i).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw new Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(e){this.logger.debug({},"Restarting transport..."),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await Dg())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if((e==null?void 0:e.length)===0){this.logger.trace("Batch message events is empty. Ignoring...");return}const r=e.sort((i,n)=>i.publishedAt-n.publishedAt);this.logger.debug(`Batch of ${r.length} message events sorted`);for(const i of r)try{await this.onMessageEvent(i)}catch(n){this.logger.warn(n,"Error while processing batch message event: "+(n==null?void 0:n.message))}this.logger.trace(`Batch of ${r.length} message events processed`)}async onLinkMessageEvent(e,r){const{topic:i}=e;if(!r.sessionExists){const n=dt(Q.FIVE_MINUTES),s={topic:i,expiry:n,relay:{protocol:"irn"},active:!1};await this.core.pairing.pairings.set(i,s)}this.events.emit(gt.message,e),await this.recordMessageEvent(e,Pc.inbound)}async connect(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let r=1;for(;r<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${r}...`),await this.createProvider(),await new Promise(async(i,n)=>{const s=()=>{n(new Error("Connection interrupted while trying to connect"))};this.provider.once(Br.disconnect,s),await vi(new Promise((o,a)=>{this.provider.connect().then(o).catch(a)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(o=>{n(o)}).finally(()=>{this.provider.off(Br.disconnect,s),clearTimeout(this.reconnectTimeout)}),await new Promise(async(o,a)=>{const c=()=>{n(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(Br.disconnect,c),await this.subscriber.start().then(o).catch(a).finally(()=>{this.provider.off(Br.disconnect,c)})}),this.hasExperiencedNetworkDisruption=!1,i()})}catch(i){await this.subscriber.stop();const n=i;this.logger.warn({},n.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${r}`);break}await new Promise(i=>setTimeout(i,Q.toMiliseconds(r*1))),r++}}startPingTimeout(){var e,r,i,n,s;if(Wc())try{(r=(e=this.provider)==null?void 0:e.connection)!=null&&r.socket&&((s=(n=(i=this.provider)==null?void 0:i.connection)==null?void 0:n.socket)==null||s.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(o){this.logger.warn(o,o==null?void 0:o.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new _d(new ER(KP({sdkVersion:of,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(e,r){const{topic:i,message:n}=e;await this.messages.set(i,n,r)}async shouldIgnoreMessageEvent(e){const{topic:r,message:i}=e;if(!i||i.length===0)return this.logger.warn(`Ignoring invalid/empty message: ${i}`),!0;if(!await this.subscriber.isKnownTopic(r))return this.logger.warn(`Ignoring message for unknown topic ${r}`),!0;const n=this.messages.has(r,i);return n&&this.logger.warn(`Ignoring duplicate message: ${i}`),n}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),Ad(e)){if(!e.method.endsWith(MR))return;const r=e.params,{topic:i,message:n,publishedAt:s,attestation:o}=r.data,a={topic:i,message:n,publishedAt:s,transportType:st.relay,attestation:o};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(im({type:"event",event:r.id},a)),this.events.emit(r.id,a),await this.acknowledgePayload(e),await this.onMessageEvent(a)}else Ml(e)&&this.events.emit(gt.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(await this.recordMessageEvent(e,Pc.inbound),this.events.emit(gt.message,e))}async acknowledgePayload(e){const r=Aa(e.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(Br.payload,this.onPayloadHandler),this.provider.off(Br.connect,this.onConnectHandler),this.provider.off(Br.disconnect,this.onDisconnectHandler),this.provider.off(Br.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await Dg();qC(async r=>{e!==r&&(e=r,r?await this.transportOpen().catch(i=>this.logger.error(i,i==null?void 0:i.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))}),this.core.heartbeat.on(Rs.pulse,async()=>{if(!this.transportExplicitlyClosed&&!this.connected&&HC())try{await this.confirmOnlineStateOrThrow(),await this.transportOpen()}catch(r){this.logger.warn(r,r==null?void 0:r.message)}})}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit(gt.disconnect),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(e=>this.logger.error(e,e==null?void 0:e.message)),this.reconnectTimeout=void 0,this.reconnectInProgress=!1},Q.toMiliseconds(kR)))))}isInitialized(){if(!this.initialized){const{message:e}=Z("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectPromise){await this.connectPromise;return}await this.connect()}}}function sk(t,e){return t===e||Number.isNaN(t)&&Number.isNaN(e)}function nm(t){return Object.getOwnPropertySymbols(t).filter(e=>Object.prototype.propertyIsEnumerable.call(t,e))}function sm(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const ok="[object RegExp]",ak="[object String]",ck="[object Number]",lk="[object Boolean]",om="[object Arguments]",uk="[object Symbol]",hk="[object Date]",fk="[object Map]",dk="[object Set]",pk="[object Array]",gk="[object Function]",mk="[object ArrayBuffer]",nh="[object Object]",yk="[object Error]",wk="[object DataView]",bk="[object Uint8Array]",vk="[object Uint8ClampedArray]",Ek="[object Uint16Array]",xk="[object Uint32Array]",Ak="[object BigUint64Array]",_k="[object Int8Array]",Ik="[object Int16Array]",Sk="[object Int32Array]",Pk="[object BigInt64Array]",Ok="[object Float32Array]",Dk="[object Float64Array]";function Nk(){}function am(t){if(!t||typeof t!="object")return!1;const e=Object.getPrototypeOf(t);return e===null||e===Object.prototype||Object.getPrototypeOf(e)===null?Object.prototype.toString.call(t)==="[object Object]":!1}function Ck(t,e,r){return ra(t,e,void 0,void 0,void 0,void 0,r)}function ra(t,e,r,i,n,s,o){const a=o(t,e,r,i,n,s);if(a!==void 0)return a;if(typeof t==typeof e)switch(typeof t){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return t===e;case"number":return t===e||Object.is(t,e);case"function":return t===e;case"object":return ha(t,e,s,o)}return ha(t,e,s,o)}function ha(t,e,r,i){if(Object.is(t,e))return!0;let n=sm(t),s=sm(e);if(n===om&&(n=nh),s===om&&(s=nh),n!==s)return!1;switch(n){case ak:return t.toString()===e.toString();case ck:{const c=t.valueOf(),l=e.valueOf();return sk(c,l)}case lk:case hk:case uk:return Object.is(t.valueOf(),e.valueOf());case ok:return t.source===e.source&&t.flags===e.flags;case gk:return t===e}r=r??new Map;const o=r.get(t),a=r.get(e);if(o!=null&&a!=null)return o===e;r.set(t,e),r.set(e,t);try{switch(n){case fk:{if(t.size!==e.size)return!1;for(const[c,l]of t.entries())if(!e.has(c)||!ra(l,e.get(c),c,t,e,r,i))return!1;return!0}case dk:{if(t.size!==e.size)return!1;const c=Array.from(t.values()),l=Array.from(e.values());for(let u=0;u<c.length;u++){const h=c[u],g=l.findIndex(y=>ra(h,y,void 0,t,e,r,i));if(g===-1)return!1;l.splice(g,1)}return!0}case pk:case bk:case vk:case Ek:case xk:case Ak:case _k:case Ik:case Sk:case Pk:case Ok:case Dk:{if(typeof Buffer<"u"&&Buffer.isBuffer(t)!==Buffer.isBuffer(e)||t.length!==e.length)return!1;for(let c=0;c<t.length;c++)if(!ra(t[c],e[c],c,t,e,r,i))return!1;return!0}case mk:return t.byteLength!==e.byteLength?!1:ha(new Uint8Array(t),new Uint8Array(e),r,i);case wk:return t.byteLength!==e.byteLength||t.byteOffset!==e.byteOffset?!1:ha(new Uint8Array(t),new Uint8Array(e),r,i);case yk:return t.name===e.name&&t.message===e.message;case nh:{if(!(ha(t.constructor,e.constructor,r,i)||am(t)&&am(e)))return!1;const c=[...Object.keys(t),...nm(t)],l=[...Object.keys(e),...nm(e)];if(c.length!==l.length)return!1;for(let u=0;u<c.length;u++){const h=c[u],g=t[h];if(!Object.hasOwn(e,h))return!1;const y=e[h];if(!ra(g,y,h,t,e,r,i))return!1}return!0}default:return!1}}finally{r.delete(t),r.delete(e)}}function Bk(t,e){return Ck(t,e,Nk)}var Rk=Object.defineProperty,cm=Object.getOwnPropertySymbols,Tk=Object.prototype.hasOwnProperty,Mk=Object.prototype.propertyIsEnumerable,df=(t,e,r)=>e in t?Rk(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,lm=(t,e)=>{for(var r in e||(e={}))Tk.call(e,r)&&df(t,r,e[r]);if(cm)for(var r of cm(e))Mk.call(e,r)&&df(t,r,e[r]);return t},rr=(t,e,r)=>df(t,typeof e!="symbol"?e+"":e,r);class Ms extends KB{constructor(e,r,i,n=Di,s=void 0){super(e,r,i,n),this.core=e,this.logger=r,this.name=i,rr(this,"map",new Map),rr(this,"version",$R),rr(this,"cached",[]),rr(this,"initialized",!1),rr(this,"getKey"),rr(this,"storagePrefix",Di),rr(this,"recentlyDeleted",[]),rr(this,"recentlyDeletedLimit",200),rr(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(o=>{this.getKey&&o!==null&&!At(o)?this.map.set(this.getKey(o),o):wC(o)?this.map.set(o.id,o):bC(o)&&this.map.set(o.topic,o)}),this.cached=[],this.initialized=!0)}),rr(this,"set",async(o,a)=>{this.isInitialized(),this.map.has(o)?await this.update(o,a):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:o,value:a}),this.map.set(o,a),await this.persist())}),rr(this,"get",o=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:o}),this.getData(o))),rr(this,"getAll",o=>(this.isInitialized(),o?this.values.filter(a=>Object.keys(o).every(c=>Bk(a[c],o[c]))):this.values)),rr(this,"update",async(o,a)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:o,update:a});const c=lm(lm({},this.getData(o)),a);this.map.set(o,c),await this.persist()}),rr(this,"delete",async(o,a)=>{this.isInitialized(),this.map.has(o)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:o,reason:a}),this.map.delete(o),this.addToRecentlyDeleted(o),await this.persist())}),this.logger=Dr(r,this.name),this.storagePrefix=n,this.getKey=s}get context(){return pr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const r=this.map.get(e);if(!r){if(this.recentlyDeleted.includes(e)){const{message:n}=Z("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(n),new Error(n)}const{message:i}=Z("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:r}=Z("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=Z("NOT_INITIALIZED",this.name);throw new Error(e)}}}var kk=Object.defineProperty,$k=(t,e,r)=>e in t?kk(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,pe=(t,e,r)=>$k(t,typeof e!="symbol"?e+"":e,r);class Uk{constructor(e,r){this.core=e,this.logger=r,pe(this,"name",qR),pe(this,"version",jR),pe(this,"events",new Uf),pe(this,"pairings"),pe(this,"initialized",!1),pe(this,"storagePrefix",Di),pe(this,"ignoredPayloadTypes",[Zi]),pe(this,"registeredMethods",[]),pe(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),pe(this,"register",({methods:i})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...i])]}),pe(this,"create",async i=>{this.isInitialized();const n=tf(),s=await this.core.crypto.setSymKey(n),o=dt(Q.FIVE_MINUTES),a={protocol:pv},c={topic:s,expiry:o,relay:a,active:!1,methods:i==null?void 0:i.methods},l=vg({protocol:this.core.protocol,version:this.core.version,topic:s,symKey:n,relay:a,expiryTimestamp:o,methods:i==null?void 0:i.methods});return this.events.emit(ls.create,c),this.core.expirer.set(s,o),await this.pairings.set(s,c),await this.core.relayer.subscribe(s,{transportType:i==null?void 0:i.transportType,internal:i==null?void 0:i.internal}),{topic:s,uri:l}}),pe(this,"pair",async i=>{this.isInitialized();const n=this.core.eventClient.createEvent({properties:{topic:i==null?void 0:i.uri,trace:[pi.pairing_started]}});this.isValidPair(i,n);const{topic:s,symKey:o,relay:a,expiryTimestamp:c,methods:l}=bg(i.uri);n.props.properties.topic=s,n.addTrace(pi.pairing_uri_validation_success),n.addTrace(pi.pairing_uri_not_expired);let u;if(this.pairings.keys.includes(s)){if(u=this.pairings.get(s),n.addTrace(pi.existing_pairing),u.active)throw n.setError(qi.active_pairing_already_exists),new Error(`Pairing already exists: ${s}. Please try again with a new connection URI.`);n.addTrace(pi.pairing_not_expired)}const h=c||dt(Q.FIVE_MINUTES),g={topic:s,relay:a,expiry:h,active:!1,methods:l};this.core.expirer.set(s,h),await this.pairings.set(s,g),n.addTrace(pi.store_new_pairing),i.activatePairing&&await this.activate({topic:s}),this.events.emit(ls.create,g),n.addTrace(pi.emit_inactive_pairing),this.core.crypto.keychain.has(s)||await this.core.crypto.setSymKey(o,s),n.addTrace(pi.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{n.setError(qi.no_internet_connection)}try{await this.core.relayer.subscribe(s,{relay:a})}catch(y){throw n.setError(qi.subscribe_pairing_topic_failure),y}return n.addTrace(pi.subscribe_pairing_topic_success),g}),pe(this,"activate",async({topic:i})=>{this.isInitialized();const n=dt(Q.FIVE_MINUTES);this.core.expirer.set(i,n),await this.pairings.update(i,{active:!0,expiry:n})}),pe(this,"ping",async i=>{this.isInitialized(),await this.isValidPing(i),this.logger.warn("ping() is deprecated and will be removed in the next major release.");const{topic:n}=i;if(this.pairings.keys.includes(n)){const s=await this.sendRequest(n,"wc_pairingPing",{}),{done:o,resolve:a,reject:c}=os();this.events.once(xe("pairing_ping",s),({error:l})=>{l?c(l):a()}),await o()}}),pe(this,"updateExpiry",async({topic:i,expiry:n})=>{this.isInitialized(),await this.pairings.update(i,{expiry:n})}),pe(this,"updateMetadata",async({topic:i,metadata:n})=>{this.isInitialized(),await this.pairings.update(i,{peerMetadata:n})}),pe(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),pe(this,"disconnect",async i=>{this.isInitialized(),await this.isValidDisconnect(i);const{topic:n}=i;this.pairings.keys.includes(n)&&(await this.sendRequest(n,"wc_pairingDelete",ot("USER_DISCONNECTED")),await this.deletePairing(n))}),pe(this,"formatUriFromPairing",i=>{this.isInitialized();const{topic:n,relay:s,expiry:o,methods:a}=i,c=this.core.crypto.keychain.get(n);return vg({protocol:this.core.protocol,version:this.core.version,topic:n,symKey:c,relay:s,expiryTimestamp:o,methods:a})}),pe(this,"sendRequest",async(i,n,s)=>{const o=ti(n,s),a=await this.core.crypto.encode(i,o),c=Ko[n].req;return this.core.history.set(i,o),this.core.relayer.publish(i,a,c),o.id}),pe(this,"sendResult",async(i,n,s)=>{const o=Aa(i,s),a=await this.core.crypto.encode(n,o),c=(await this.core.history.get(n,i)).request.method,l=Ko[c].res;await this.core.relayer.publish(n,a,l),await this.core.history.resolve(o)}),pe(this,"sendError",async(i,n,s)=>{const o=Tl(i,s),a=await this.core.crypto.encode(n,o),c=(await this.core.history.get(n,i)).request.method,l=Ko[c]?Ko[c].res:Ko.unregistered_method.res;await this.core.relayer.publish(n,a,l),await this.core.history.resolve(o)}),pe(this,"deletePairing",async(i,n)=>{await this.core.relayer.unsubscribe(i),await Promise.all([this.pairings.delete(i,ot("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(i),n?Promise.resolve():this.core.expirer.del(i)])}),pe(this,"cleanup",async()=>{const i=this.pairings.getAll().filter(n=>bi(n.expiry));await Promise.all(i.map(n=>this.deletePairing(n.topic)))}),pe(this,"onRelayEventRequest",async i=>{const{topic:n,payload:s}=i;switch(s.method){case"wc_pairingPing":return await this.onPairingPingRequest(n,s);case"wc_pairingDelete":return await this.onPairingDeleteRequest(n,s);default:return await this.onUnknownRpcMethodRequest(n,s)}}),pe(this,"onRelayEventResponse",async i=>{const{topic:n,payload:s}=i,o=(await this.core.history.get(n,s.id)).request.method;switch(o){case"wc_pairingPing":return this.onPairingPingResponse(n,s);default:return this.onUnknownRpcMethodResponse(o)}}),pe(this,"onPairingPingRequest",async(i,n)=>{const{id:s}=n;try{this.isValidPing({topic:i}),await this.sendResult(s,i,!0),this.events.emit(ls.ping,{id:s,topic:i})}catch(o){await this.sendError(s,i,o),this.logger.error(o)}}),pe(this,"onPairingPingResponse",(i,n)=>{const{id:s}=n;setTimeout(()=>{yi(n)?this.events.emit(xe("pairing_ping",s),{}):$r(n)&&this.events.emit(xe("pairing_ping",s),{error:n.error})},500)}),pe(this,"onPairingDeleteRequest",async(i,n)=>{const{id:s}=n;try{this.isValidDisconnect({topic:i}),await this.deletePairing(i),this.events.emit(ls.delete,{id:s,topic:i})}catch(o){await this.sendError(s,i,o),this.logger.error(o)}}),pe(this,"onUnknownRpcMethodRequest",async(i,n)=>{const{id:s,method:o}=n;try{if(this.registeredMethods.includes(o))return;const a=ot("WC_METHOD_UNSUPPORTED",o);await this.sendError(s,i,a),this.logger.error(a)}catch(a){await this.sendError(s,i,a),this.logger.error(a)}}),pe(this,"onUnknownRpcMethodResponse",i=>{this.registeredMethods.includes(i)||this.logger.error(ot("WC_METHOD_UNSUPPORTED",i))}),pe(this,"isValidPair",(i,n)=>{var s;if(!nr(i)){const{message:a}=Z("MISSING_OR_INVALID",`pair() params: ${i}`);throw n.setError(qi.malformed_pairing_uri),new Error(a)}if(!yC(i.uri)){const{message:a}=Z("MISSING_OR_INVALID",`pair() uri: ${i.uri}`);throw n.setError(qi.malformed_pairing_uri),new Error(a)}const o=bg(i==null?void 0:i.uri);if(!((s=o==null?void 0:o.relay)!=null&&s.protocol)){const{message:a}=Z("MISSING_OR_INVALID","pair() uri#relay-protocol");throw n.setError(qi.malformed_pairing_uri),new Error(a)}if(!(o!=null&&o.symKey)){const{message:a}=Z("MISSING_OR_INVALID","pair() uri#symKey");throw n.setError(qi.malformed_pairing_uri),new Error(a)}if(o!=null&&o.expiryTimestamp&&Q.toMiliseconds(o==null?void 0:o.expiryTimestamp)<Date.now()){n.setError(qi.pairing_expired);const{message:a}=Z("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(a)}}),pe(this,"isValidPing",async i=>{if(!nr(i)){const{message:s}=Z("MISSING_OR_INVALID",`ping() params: ${i}`);throw new Error(s)}const{topic:n}=i;await this.isValidPairingTopic(n)}),pe(this,"isValidDisconnect",async i=>{if(!nr(i)){const{message:s}=Z("MISSING_OR_INVALID",`disconnect() params: ${i}`);throw new Error(s)}const{topic:n}=i;await this.isValidPairingTopic(n)}),pe(this,"isValidPairingTopic",async i=>{if(!mt(i,!1)){const{message:n}=Z("MISSING_OR_INVALID",`pairing topic should be a string: ${i}`);throw new Error(n)}if(!this.pairings.keys.includes(i)){const{message:n}=Z("NO_MATCHING_KEY",`pairing topic doesn't exist: ${i}`);throw new Error(n)}if(bi(this.pairings.get(i).expiry)){await this.deletePairing(i);const{message:n}=Z("EXPIRED",`pairing topic: ${i}`);throw new Error(n)}}),this.core=e,this.logger=Dr(r,this.name),this.pairings=new Ms(this.core,this.logger,this.name,this.storagePrefix)}get context(){return pr(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=Z("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(gt.message,async e=>{const{topic:r,message:i,transportType:n}=e;if(this.pairings.keys.includes(r)&&n!==st.link_mode&&!this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(i)))try{const s=await this.core.crypto.decode(r,i);Ad(s)?(this.core.history.set(r,s),await this.onRelayEventRequest({topic:r,payload:s})):Ml(s)&&(await this.core.history.resolve(s),await this.onRelayEventResponse({topic:r,payload:s}),this.core.history.delete(r,s.id)),await this.core.relayer.messages.ack(r,i)}catch(s){this.logger.error(s)}})}registerExpirerEvents(){this.core.expirer.on(Tr.expired,async e=>{const{topic:r}=r1(e.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit(ls.expire,{topic:r}))})}}var Lk=Object.defineProperty,Fk=(t,e,r)=>e in t?Lk(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ot=(t,e,r)=>Fk(t,typeof e!="symbol"?e+"":e,r);class qk extends qB{constructor(e,r){super(e,r),this.core=e,this.logger=r,Ot(this,"records",new Map),Ot(this,"events",new Or.EventEmitter),Ot(this,"name",zR),Ot(this,"version",HR),Ot(this,"cached",[]),Ot(this,"initialized",!1),Ot(this,"storagePrefix",Di),Ot(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.records.set(i.id,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),Ot(this,"set",(i,n,s)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:i,request:n,chainId:s}),this.records.has(n.id))return;const o={id:n.id,topic:i,request:{method:n.method,params:n.params||null},chainId:s,expiry:dt(Q.THIRTY_DAYS)};this.records.set(o.id,o),this.persist(),this.events.emit(Yr.created,o)}),Ot(this,"resolve",async i=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:i}),!this.records.has(i.id))return;const n=await this.getRecord(i.id);typeof n.response>"u"&&(n.response=$r(i)?{error:i.error}:{result:i.result},this.records.set(n.id,n),this.persist(),this.events.emit(Yr.updated,n))}),Ot(this,"get",async(i,n)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:i,id:n}),await this.getRecord(n))),Ot(this,"delete",(i,n)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:n}),this.values.forEach(s=>{if(s.topic===i){if(typeof n<"u"&&s.id!==n)return;this.records.delete(s.id),this.events.emit(Yr.deleted,s)}}),this.persist()}),Ot(this,"exists",async(i,n)=>(this.isInitialized(),this.records.has(n)?(await this.getRecord(n)).topic===i:!1)),Ot(this,"on",(i,n)=>{this.events.on(i,n)}),Ot(this,"once",(i,n)=>{this.events.once(i,n)}),Ot(this,"off",(i,n)=>{this.events.off(i,n)}),Ot(this,"removeListener",(i,n)=>{this.events.removeListener(i,n)}),this.logger=Dr(r,this.name)}get context(){return pr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const i={topic:r.topic,request:ti(r.request.method,r.request.params,r.id),chainId:r.chainId};return e.push(i)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const r=this.records.get(e);if(!r){const{message:i}=Z("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Yr.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:r}=Z("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(Yr.created,e=>{const r=Yr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e})}),this.events.on(Yr.updated,e=>{const r=Yr.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e})}),this.events.on(Yr.deleted,e=>{const r=Yr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e})}),this.core.heartbeat.on(Rs.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(r=>{Q.toMiliseconds(r.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${r.id}`),this.records.delete(r.id),this.events.emit(Yr.deleted,r,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=Z("NOT_INITIALIZED",this.name);throw new Error(e)}}}var jk=Object.defineProperty,zk=(t,e,r)=>e in t?jk(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Kt=(t,e,r)=>zk(t,typeof e!="symbol"?e+"":e,r);class Hk extends GB{constructor(e,r){super(e,r),this.core=e,this.logger=r,Kt(this,"expirations",new Map),Kt(this,"events",new Or.EventEmitter),Kt(this,"name",KR),Kt(this,"version",VR),Kt(this,"cached",[]),Kt(this,"initialized",!1),Kt(this,"storagePrefix",Di),Kt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.expirations.set(i.target,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),Kt(this,"has",i=>{try{const n=this.formatTarget(i);return typeof this.getExpiration(n)<"u"}catch{return!1}}),Kt(this,"set",(i,n)=>{this.isInitialized();const s=this.formatTarget(i),o={target:s,expiry:n};this.expirations.set(s,o),this.checkExpiry(s,o),this.events.emit(Tr.created,{target:s,expiration:o})}),Kt(this,"get",i=>{this.isInitialized();const n=this.formatTarget(i);return this.getExpiration(n)}),Kt(this,"del",i=>{if(this.isInitialized(),this.has(i)){const n=this.formatTarget(i),s=this.getExpiration(n);this.expirations.delete(n),this.events.emit(Tr.deleted,{target:n,expiration:s})}}),Kt(this,"on",(i,n)=>{this.events.on(i,n)}),Kt(this,"once",(i,n)=>{this.events.once(i,n)}),Kt(this,"off",(i,n)=>{this.events.off(i,n)}),Kt(this,"removeListener",(i,n)=>{this.events.removeListener(i,n)}),this.logger=Dr(r,this.name)}get context(){return pr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return VP(e);if(typeof e=="number")return GP(e);const{message:r}=Z("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(r)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Tr.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:r}=Z("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const r=this.expirations.get(e);if(!r){const{message:i}=Z("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(i),new Error(i)}return r}checkExpiry(e,r){const{expiry:i}=r;Q.toMiliseconds(i)-Date.now()<=0&&this.expire(e,r)}expire(e,r){this.expirations.delete(e),this.events.emit(Tr.expired,{target:e,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,r)=>this.checkExpiry(r,e))}registerEventListeners(){this.core.heartbeat.on(Rs.pulse,()=>this.checkExpirations()),this.events.on(Tr.created,e=>{const r=Tr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(Tr.expired,e=>{const r=Tr.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(Tr.deleted,e=>{const r=Tr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=Z("NOT_INITIALIZED",this.name);throw new Error(e)}}}var Kk=Object.defineProperty,Vk=(t,e,r)=>e in t?Kk(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ft=(t,e,r)=>Vk(t,typeof e!="symbol"?e+"":e,r);class Gk extends WB{constructor(e,r,i){super(e,r,i),this.core=e,this.logger=r,this.store=i,ft(this,"name",GR),ft(this,"abortController"),ft(this,"isDevEnv"),ft(this,"verifyUrlV3",YR),ft(this,"storagePrefix",Di),ft(this,"version",dv),ft(this,"publicKey"),ft(this,"fetchPromise"),ft(this,"init",async()=>{var n;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&Q.toMiliseconds((n=this.publicKey)==null?void 0:n.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),ft(this,"register",async n=>{if(!Po()||this.isDevEnv)return;const s=window.location.origin,{id:o,decryptedId:a}=n,c=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${s}&id=${o}&decryptedId=${a}`;try{const l=xs(),u=this.startAbortTimer(Q.ONE_SECOND*5),h=await new Promise((g,y)=>{const w=()=>{window.removeEventListener("message",P),l.body.removeChild(E),y("attestation aborted")};this.abortController.signal.addEventListener("abort",w);const E=l.createElement("iframe");E.src=c,E.style.display="none",E.addEventListener("error",w,{signal:this.abortController.signal});const P=N=>{if(N.data&&typeof N.data=="string")try{const R=JSON.parse(N.data);if(R.type==="verify_attestation"){if(Lh(R.attestation).payload.id!==o)return;clearInterval(u),l.body.removeChild(E),this.abortController.signal.removeEventListener("abort",w),window.removeEventListener("message",P),g(R.attestation===null?"":R.attestation)}}catch(R){this.logger.warn(R)}};l.body.appendChild(E),window.addEventListener("message",P,{signal:this.abortController.signal})});return this.logger.debug(h,"jwt attestation"),h}catch(l){this.logger.warn(l)}return""}),ft(this,"resolve",async n=>{if(this.isDevEnv)return"";const{attestationId:s,hash:o,encryptedId:a}=n;if(s===""){this.logger.debug("resolve: attestationId is empty, skipping");return}if(s){if(Lh(s).payload.id!==a)return;const l=await this.isValidJwtAttestation(s);if(l){if(!l.isVerified){this.logger.warn("resolve: jwt attestation: origin url not verified");return}return l}}if(!o)return;const c=this.getVerifyUrl(n==null?void 0:n.verifyUrl);return this.fetchAttestation(o,c)}),ft(this,"fetchAttestation",async(n,s)=>{this.logger.debug(`resolving attestation: ${n} from url: ${s}`);const o=this.startAbortTimer(Q.ONE_SECOND*5),a=await fetch(`${s}/attestation/${n}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(o),a.status===200?await a.json():void 0}),ft(this,"getVerifyUrl",n=>{let s=n||ua;return JR.includes(s)||(this.logger.info(`verify url: ${s}, not included in trusted list, assigning default: ${ua}`),s=ua),s}),ft(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);const n=this.startAbortTimer(Q.FIVE_SECONDS),s=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(n),await s.json()}catch(n){this.logger.warn(n)}}),ft(this,"persistPublicKey",async n=>{this.logger.debug(n,"persisting public key to local storage"),await this.store.setItem(this.storeKey,n),this.publicKey=n}),ft(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),ft(this,"isValidJwtAttestation",async n=>{const s=await this.getPublicKey();try{if(s)return this.validateAttestation(n,s)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}const o=await this.fetchAndPersistPublicKey();try{if(o)return this.validateAttestation(n,o)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}}),ft(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),ft(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async s=>{const o=await this.fetchPublicKey();o&&(await this.persistPublicKey(o),s(o))});const n=await this.fetchPromise;return this.fetchPromise=void 0,n}),ft(this,"validateAttestation",(n,s)=>{const o=zN(n,s.publicKey),a={hasExpired:Q.toMiliseconds(o.exp)<Date.now(),payload:o};if(a.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:a.payload.origin,isScam:a.payload.isScam,isVerified:a.payload.isVerified}}),this.logger=Dr(r,this.name),this.abortController=new AbortController,this.isDevEnv=ud(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return pr(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),Q.toMiliseconds(e))}}var Wk=Object.defineProperty,Yk=(t,e,r)=>e in t?Wk(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,um=(t,e,r)=>Yk(t,typeof e!="symbol"?e+"":e,r);class Jk extends YB{constructor(e,r){super(e,r),this.projectId=e,this.logger=r,um(this,"context",QR),um(this,"registerDeviceToken",async i=>{const{clientId:n,token:s,notificationType:o,enableEncrypted:a=!1}=i,c=`${ZR}/${this.projectId}/clients`;await fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:n,type:o,token:s,always_raw:a})})}),this.logger=Dr(r,this.context)}}var Qk=Object.defineProperty,hm=Object.getOwnPropertySymbols,Zk=Object.prototype.hasOwnProperty,Xk=Object.prototype.propertyIsEnumerable,pf=(t,e,r)=>e in t?Qk(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Wo=(t,e)=>{for(var r in e||(e={}))Zk.call(e,r)&&pf(t,r,e[r]);if(hm)for(var r of hm(e))Xk.call(e,r)&&pf(t,r,e[r]);return t},vt=(t,e,r)=>pf(t,typeof e!="symbol"?e+"":e,r);class e$ extends JB{constructor(e,r,i=!0){super(e,r,i),this.core=e,this.logger=r,vt(this,"context",eT),vt(this,"storagePrefix",Di),vt(this,"storageVersion",XR),vt(this,"events",new Map),vt(this,"shouldPersist",!1),vt(this,"init",async()=>{if(!ud())try{const n={eventId:L0(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:e1(this.core.relayer.protocol,this.core.relayer.version,of)}}};await this.sendEvent([n])}catch(n){this.logger.warn(n)}}),vt(this,"createEvent",n=>{const{event:s="ERROR",type:o="",properties:{topic:a,trace:c}}=n,l=L0(),u=this.core.projectId||"",h=Date.now(),g=Wo({eventId:l,timestamp:h,props:{event:s,type:o,properties:{topic:a,trace:c}},bundleId:u,domain:this.getAppDomain()},this.setMethods(l));return this.telemetryEnabled&&(this.events.set(l,g),this.shouldPersist=!0),g}),vt(this,"getEvent",n=>{const{eventId:s,topic:o}=n;if(s)return this.events.get(s);const a=Array.from(this.events.values()).find(c=>c.props.properties.topic===o);if(a)return Wo(Wo({},a),this.setMethods(a.eventId))}),vt(this,"deleteEvent",n=>{const{eventId:s}=n;this.events.delete(s),this.shouldPersist=!0}),vt(this,"setEventListeners",()=>{this.core.heartbeat.on(Rs.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(n=>{Q.fromMiliseconds(Date.now())-Q.fromMiliseconds(n.timestamp)>tT&&(this.events.delete(n.eventId),this.shouldPersist=!0)})})}),vt(this,"setMethods",n=>({addTrace:s=>this.addTrace(n,s),setError:s=>this.setError(n,s)})),vt(this,"addTrace",(n,s)=>{const o=this.events.get(n);o&&(o.props.properties.trace.push(s),this.events.set(n,o),this.shouldPersist=!0)}),vt(this,"setError",(n,s)=>{const o=this.events.get(n);o&&(o.props.type=s,o.timestamp=Date.now(),this.events.set(n,o),this.shouldPersist=!0)}),vt(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),vt(this,"restore",async()=>{try{const n=await this.core.storage.getItem(this.storageKey)||[];if(!n.length)return;n.forEach(s=>{this.events.set(s.eventId,Wo(Wo({},s),this.setMethods(s.eventId)))})}catch(n){this.logger.warn(n)}}),vt(this,"submit",async()=>{if(!this.telemetryEnabled||this.events.size===0)return;const n=[];for(const[s,o]of this.events)o.props.type&&n.push(o);if(n.length!==0)try{if((await this.sendEvent(n)).ok)for(const s of n)this.events.delete(s.eventId),this.shouldPersist=!0}catch(s){this.logger.warn(s)}}),vt(this,"sendEvent",async n=>{const s=this.getAppDomain()?"":"&sp=desktop";return await fetch(`${rT}?projectId=${this.core.projectId}&st=events_sdk&sv=js-${of}${s}`,{method:"POST",body:JSON.stringify(n)})}),vt(this,"getAppDomain",()=>Xb().url),this.logger=Dr(r,this.context),this.telemetryEnabled=i,i?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var t$=Object.defineProperty,fm=Object.getOwnPropertySymbols,r$=Object.prototype.hasOwnProperty,i$=Object.prototype.propertyIsEnumerable,gf=(t,e,r)=>e in t?t$(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,dm=(t,e)=>{for(var r in e||(e={}))r$.call(e,r)&&gf(t,r,e[r]);if(fm)for(var r of fm(e))i$.call(e,r)&&gf(t,r,e[r]);return t},Me=(t,e,r)=>gf(t,typeof e!="symbol"?e+"":e,r);let n$=class Ov extends $B{constructor(e){var r;super(e),Me(this,"protocol",fv),Me(this,"version",dv),Me(this,"name",sf),Me(this,"relayUrl"),Me(this,"projectId"),Me(this,"customStoragePrefix"),Me(this,"events",new Or.EventEmitter),Me(this,"logger"),Me(this,"heartbeat"),Me(this,"relayer"),Me(this,"crypto"),Me(this,"storage"),Me(this,"history"),Me(this,"expirer"),Me(this,"pairing"),Me(this,"verify"),Me(this,"echoClient"),Me(this,"linkModeSupportedApps"),Me(this,"eventClient"),Me(this,"initialized",!1),Me(this,"logChunkController"),Me(this,"on",(a,c)=>this.events.on(a,c)),Me(this,"once",(a,c)=>this.events.once(a,c)),Me(this,"off",(a,c)=>this.events.off(a,c)),Me(this,"removeListener",(a,c)=>this.events.removeListener(a,c)),Me(this,"dispatchEnvelope",({topic:a,message:c,sessionExists:l})=>{if(!a||!c)return;const u={topic:a,message:c,publishedAt:Date.now(),transportType:st.link_mode};this.relayer.onLinkMessageEvent(u,{sessionExists:l})});const i=this.getGlobalCore(e==null?void 0:e.customStoragePrefix);if(i)try{return this.customStoragePrefix=i.customStoragePrefix,this.logger=i.logger,this.heartbeat=i.heartbeat,this.crypto=i.crypto,this.history=i.history,this.expirer=i.expirer,this.storage=i.storage,this.relayer=i.relayer,this.pairing=i.pairing,this.verify=i.verify,this.echoClient=i.echoClient,this.linkModeSupportedApps=i.linkModeSupportedApps,this.eventClient=i.eventClient,this.initialized=i.initialized,this.logChunkController=i.logChunkController,i}catch(a){console.warn("Failed to copy global core",a)}this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||gv,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const n=_P({level:typeof(e==null?void 0:e.logger)=="string"&&e.logger?e.logger:AR.logger,name:sf}),{logger:s,chunkLoggerController:o}=Qb({opts:n,maxSizeInBytes:e==null?void 0:e.maxLogBlobSizeInBytes,loggerOverride:e==null?void 0:e.logger});this.logChunkController=o,(r=this.logChunkController)!=null&&r.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var a,c;(a=this.logChunkController)!=null&&a.downloadLogsBlobInBrowser&&((c=this.logChunkController)==null||c.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=Dr(s,this.name),this.heartbeat=new eB,this.crypto=new CM(this,this.logger,e==null?void 0:e.keychain),this.history=new qk(this,this.logger),this.expirer=new Hk(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new TB(dm(dm({},_R),e==null?void 0:e.storageOptions)),this.relayer=new nk({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new Uk(this,this.logger),this.verify=new Gk(this,this.logger,this.storage),this.echoClient=new Jk(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new e$(this,this.logger,e==null?void 0:e.telemetryEnabled),this.setGlobalCore(this)}static async init(e){const r=new Ov(e);await r.initialize();const i=await r.crypto.getClientId();return await r.storage.setItem(UR,i),r}get context(){return pr(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return(e=this.logChunkController)==null?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(Kg,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(Kg)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(e,`Core Initialization Failure at epoch ${Date.now()}`),this.logger.error(e.message),e}}getGlobalCore(e=""){try{if(this.isGlobalCoreDisabled())return;const r=`_walletConnectCore_${e}`,i=`${r}_count`;return globalThis[i]=(globalThis[i]||0)+1,globalThis[i]>1&&console.warn(`WalletConnect Core is already initialized. This is probably a mistake and can lead to unexpected behavior. Init() was called ${globalThis[i]} times.`),globalThis[r]}catch(r){console.warn("Failed to get global WalletConnect core",r);return}}setGlobalCore(e){var r;try{if(this.isGlobalCoreDisabled())return;const i=`_walletConnectCore_${((r=e.opts)==null?void 0:r.customStoragePrefix)||""}`;globalThis[i]=e}catch(i){console.warn("Failed to set global WalletConnect core",i)}}isGlobalCoreDisabled(){try{return typeof process<"u"&&xR.DISABLE_GLOBAL_CORE==="true"}catch{return!0}}};const s$=n$,Dv="wc",Nv=2,Cv="client",Id=`${Dv}@${Nv}:${Cv}:`,sh={name:Cv,logger:"error"},pm="WALLETCONNECT_DEEPLINK_CHOICE",o$="proposal",gm="Proposal expired",a$="session",Hs=Q.SEVEN_DAYS,c$="engine",Dt={wc_sessionPropose:{req:{ttl:Q.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:Q.ONE_DAY,prompt:!1,tag:1104},res:{ttl:Q.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:Q.ONE_DAY,prompt:!1,tag:1106},res:{ttl:Q.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:Q.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:Q.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:Q.ONE_DAY,prompt:!1,tag:1112},res:{ttl:Q.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:Q.ONE_DAY,prompt:!1,tag:1114},res:{ttl:Q.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:Q.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:Q.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1119}}},oh={min:Q.FIVE_MINUTES,max:Q.SEVEN_DAYS},di={idle:"IDLE",active:"ACTIVE"},l$={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"},sui_signAndExecuteTransaction:{key:"digest"},sui_signTransaction:{key:""},hedera_signAndExecuteTransaction:{key:"transactionId"},hedera_executeTransaction:{key:"transactionId"},near_signTransaction:{key:""},near_signTransactions:{key:""},tron_signTransaction:{key:"txID"},xrpl_signTransaction:{key:""},xrpl_signTransactionFor:{key:""},algo_signTxn:{key:""},sendTransfer:{key:"txid"},stacks_stxTransfer:{key:"txId"},polkadot_signTransaction:{key:""},cosmos_signDirect:{key:""}},u$="request",h$=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],f$="wc",d$="auth",p$="authKeys",g$="pairingTopics",m$="requests",$l=`${f$}@${1.5}:${d$}:`,Oc=`${$l}:PUB_KEY`;var y$=Object.defineProperty,w$=Object.defineProperties,b$=Object.getOwnPropertyDescriptors,mm=Object.getOwnPropertySymbols,v$=Object.prototype.hasOwnProperty,E$=Object.prototype.propertyIsEnumerable,mf=(t,e,r)=>e in t?y$(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ve=(t,e)=>{for(var r in e||(e={}))v$.call(e,r)&&mf(t,r,e[r]);if(mm)for(var r of mm(e))E$.call(e,r)&&mf(t,r,e[r]);return t},Nt=(t,e)=>w$(t,b$(e)),G=(t,e,r)=>mf(t,typeof e!="symbol"?e+"":e,r);class x$ extends eR{constructor(e){super(e),G(this,"name",c$),G(this,"events",new Uf),G(this,"initialized",!1),G(this,"requestQueue",{state:di.idle,queue:[]}),G(this,"sessionRequestQueue",{state:di.idle,queue:[]}),G(this,"emittedSessionRequests",new rO({limit:500})),G(this,"requestQueueDelay",Q.ONE_SECOND),G(this,"expectedPairingMethodMap",new Map),G(this,"recentlyDeletedMap",new Map),G(this,"recentlyDeletedLimit",200),G(this,"relayMessageCache",[]),G(this,"pendingSessions",new Map),G(this,"init",async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(Dt)}),this.initialized=!0,setTimeout(async()=>{await this.processPendingMessageEvents(),this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},Q.toMiliseconds(this.requestQueueDelay)))}),G(this,"connect",async r=>{var i;this.isInitialized(),await this.confirmOnlineStateOrThrow();const n=Nt(ve({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(n),n.optionalNamespaces=fC(n.requiredNamespaces,n.optionalNamespaces),n.requiredNamespaces={};const{pairingTopic:s,requiredNamespaces:o,optionalNamespaces:a,sessionProperties:c,scopedProperties:l,relays:u,authentication:h,walletPay:g}=n,y=((i=h==null?void 0:h[0])==null?void 0:i.ttl)||Dt.wc_sessionPropose.req.ttl||Q.FIVE_MINUTES;this.validateRequestExpiry(y);let w=s,E,P=!1;try{if(w){const k=this.client.core.pairing.pairings.get(w);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),P=k.active}}catch(k){throw this.client.logger.error(`connect() -> pairing.get(${w}) failed`),k}if(!w||!P){const{topic:k,uri:V}=await this.client.core.pairing.create({internal:{skipSubscribe:!0}});w=k,E=V}if(!w){const{message:k}=Z("NO_MATCHING_KEY",`connect() pairing topic: ${w}`);throw new Error(k)}const N=await this.client.core.crypto.generateKeyPair(),R=dt(y),D=ve(Nt(ve(ve({requiredNamespaces:o,optionalNamespaces:a,relays:u??[{protocol:pv}],proposer:{publicKey:N,metadata:this.client.metadata},expiryTimestamp:R,pairingTopic:w},c&&{sessionProperties:c}),l&&{scopedProperties:l}),{id:mi()}),(h||g)&&{requests:{authentication:h==null?void 0:h.map(k=>{const{domain:V,chains:H,nonce:$,uri:A,exp:d,nbf:f,type:p,statement:b,requestId:x,resources:_,signatureTypes:S}=k;return{domain:V,chains:H,nonce:$,type:p??"caip122",aud:A,version:"1",iat:new Date().toISOString(),exp:d,nbf:f,statement:b,requestId:x,resources:_,signatureTypes:S}}),walletPay:g}}),C=xe("session_connect",D.id),{reject:B,resolve:M,done:L}=os(y,gm),F=({id:k})=>{k===D.id&&(this.client.events.off("proposal_expire",F),this.pendingSessions.delete(D.id),this.events.emit(C,{error:{message:gm,code:0}}))};return this.client.events.on("proposal_expire",F),this.events.once(C,({error:k,session:V})=>{this.client.events.off("proposal_expire",F),k?B(k):V&&M(V)}),await this.setProposal(D.id,D),await this.sendProposeSession({proposal:D,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:{correlationId:D.id}}}).catch(k=>{throw this.deleteProposal(D.id),k}),{uri:E,approval:L}}),G(this,"pair",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(r)}catch(i){throw this.client.logger.error("pair() failed"),i}}),G(this,"approve",async r=>{var i,n,s;const o=this.client.core.eventClient.createEvent({properties:{topic:(i=r==null?void 0:r.id)==null?void 0:i.toString(),trace:[Jr.session_approve_started]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(V){throw o.setError(is.no_internet_connection),V}try{await this.isValidProposalId(r==null?void 0:r.id)}catch(V){throw this.client.logger.error(`approve() -> proposal.get(${r==null?void 0:r.id}) failed`),o.setError(is.proposal_not_found),V}try{await this.isValidApprove(r)}catch(V){throw this.client.logger.error("approve() -> isValidApprove() failed"),o.setError(is.session_approve_namespace_validation_failure),V}const{id:a,relayProtocol:c,namespaces:l,sessionProperties:u,scopedProperties:h,sessionConfig:g,proposalRequestsResponses:y}=r,w=this.client.proposal.get(a);this.client.core.eventClient.deleteEvent({eventId:o.eventId});const{pairingTopic:E,proposer:P,requiredNamespaces:N,optionalNamespaces:R}=w;let D=(n=this.client.core.eventClient)==null?void 0:n.getEvent({topic:E});D||(D=(s=this.client.core.eventClient)==null?void 0:s.createEvent({type:Jr.session_approve_started,properties:{topic:E,trace:[Jr.session_approve_started,Jr.session_namespaces_validation_success]}}));const C=await this.client.core.crypto.generateKeyPair(),B=P.publicKey,M=await this.client.core.crypto.generateSharedKey(C,B),L=Nt(ve(ve(ve({relay:{protocol:c??"irn"},namespaces:l,controller:{publicKey:C,metadata:this.client.metadata},expiry:dt(Hs)},u&&{sessionProperties:u}),h&&{scopedProperties:h}),g&&{sessionConfig:g}),{proposalRequestsResponses:y}),F=st.relay;D.addTrace(Jr.subscribing_session_topic);try{await this.client.core.relayer.subscribe(M,{transportType:F,internal:{skipSubscribe:!0}})}catch(V){throw D.setError(is.subscribe_session_topic_failure),V}D.addTrace(Jr.subscribe_session_topic_success);const k=Nt(ve({},L),{topic:M,requiredNamespaces:N,optionalNamespaces:R,pairingTopic:E,acknowledged:!1,self:L.controller,peer:{publicKey:P.publicKey,metadata:P.metadata},controller:C,transportType:st.relay,authentication:y==null?void 0:y.authentication,walletPayResult:y==null?void 0:y.walletPay});await this.client.session.set(M,k),D.addTrace(Jr.store_session);try{await this.sendApproveSession({sessionTopic:M,proposal:w,pairingProposalResponse:{relay:{protocol:c??"irn"},responderPublicKey:C},sessionSettleRequest:L,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:ve({correlationId:a},this.getTVFApproveParams(k))}}),D.addTrace(Jr.session_approve_publish_success)}catch(V){throw this.client.logger.error(V),this.client.session.delete(M,ot("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(M),V}return this.client.core.eventClient.deleteEvent({eventId:D.eventId}),await this.client.core.pairing.updateMetadata({topic:E,metadata:P.metadata}),await this.deleteProposal(a),await this.client.core.pairing.activate({topic:E}),await this.setExpiry(M,dt(Hs)),{topic:M,acknowledged:()=>Promise.resolve(this.client.session.get(M))}}),G(this,"reject",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(r)}catch(o){throw this.client.logger.error("reject() -> isValidReject() failed"),o}const{id:i,reason:n}=r;let s;try{s=this.client.proposal.get(i).pairingTopic}catch(o){throw this.client.logger.error(`reject() -> proposal.get(${i}) failed`),o}s&&await this.sendError({id:i,topic:s,error:n,rpcOpts:Dt.wc_sessionPropose.reject}),await this.deleteProposal(i)}),G(this,"update",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(r)}catch(h){throw this.client.logger.error("update() -> isValidUpdate() failed"),h}const{topic:i,namespaces:n}=r,{done:s,resolve:o,reject:a}=os(Q.FIVE_MINUTES,"Session update request expired without receiving any acknowledgement"),c=mi(),l=Mn().toString(),u=this.client.session.get(i).namespaces;return this.events.once(xe("session_update",c),({error:h})=>{h?a(h):o()}),await this.client.session.update(i,{namespaces:n}),await this.sendRequest({topic:i,method:"wc_sessionUpdate",params:{namespaces:n},throwOnFailedPublish:!0,clientRpcId:c,relayRpcId:l}).catch(h=>{this.client.logger.error(h),this.client.session.update(i,{namespaces:u}),a(h)}),{acknowledged:s}}),G(this,"extend",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(r)}catch(c){throw this.client.logger.error("extend() -> isValidExtend() failed"),c}const{topic:i}=r,n=mi(),{done:s,resolve:o,reject:a}=os(Q.FIVE_MINUTES,"Session extend request expired without receiving any acknowledgement");return this.events.once(xe("session_extend",n),({error:c})=>{c?a(c):o()}),await this.setExpiry(i,dt(Hs)),this.sendRequest({topic:i,method:"wc_sessionExtend",params:{},clientRpcId:n,throwOnFailedPublish:!0}).catch(c=>{a(c)}),{acknowledged:s}}),G(this,"request",async r=>{this.isInitialized();try{await this.isValidRequest(r)}catch(P){throw this.client.logger.error("request() -> isValidRequest() failed"),P}const{chainId:i,request:n,topic:s,expiry:o=Dt.wc_sessionRequest.req.ttl}=r,a=this.client.session.get(s);(a==null?void 0:a.transportType)===st.relay&&await this.confirmOnlineStateOrThrow();const c=mi(),l=Mn().toString(),{done:u,resolve:h,reject:g}=os(o,"Request expired. Please try again.");this.events.once(xe("session_request",c),({error:P,result:N})=>{P?g(P):h(N)});const y="wc_sessionRequest",w=this.getAppLinkIfEnabled(a.peer.metadata,a.transportType);if(w)return await this.sendRequest({clientRpcId:c,relayRpcId:l,topic:s,method:y,params:{request:Nt(ve({},n),{expiryTimestamp:dt(o)}),chainId:i},expiry:o,throwOnFailedPublish:!0,appLink:w}).catch(P=>g(P)),this.client.events.emit("session_request_sent",{topic:s,request:n,chainId:i,id:c}),await u();const E={request:Nt(ve({},n),{expiryTimestamp:dt(o)}),chainId:i};return await Promise.all([new Promise(async P=>{await this.sendRequest({clientRpcId:c,relayRpcId:l,topic:s,method:y,params:E,expiry:o,throwOnFailedPublish:!0,tvf:this.getTVFParams(c,E)}).catch(N=>g(N)),this.client.events.emit("session_request_sent",{topic:s,request:n,chainId:i,id:c}),P()}),new Promise(async P=>{var N;if(!((N=a.sessionConfig)!=null&&N.disableDeepLink)){const R=await QP(this.client.core.storage,pm);await WP({id:c,topic:s,wcDeepLink:R})}P()}),u()]).then(P=>P[2])}),G(this,"respond",async r=>{var i,n;this.isInitialized();const s=this.client.core.eventClient.createEvent({properties:{topic:(r==null?void 0:r.topic)||((n=(i=r==null?void 0:r.response)==null?void 0:i.id)==null?void 0:n.toString()),trace:[Jr.session_request_response_started]}});try{await this.isValidRespond(r)}catch(h){throw s.addTrace(h==null?void 0:h.message),s.setError(is.session_request_response_validation_failure),h}s.addTrace(Jr.session_request_response_validation_success);const{topic:o,response:a}=r,{id:c}=a,l=this.client.session.get(o);l.transportType===st.relay&&await this.confirmOnlineStateOrThrow();const u=this.getAppLinkIfEnabled(l.peer.metadata,l.transportType);try{s.addTrace(Jr.session_request_response_publish_started),yi(a)?await this.sendResult({id:c,topic:o,result:a.result,throwOnFailedPublish:!0,appLink:u}):$r(a)&&await this.sendError({id:c,topic:o,error:a.error,appLink:u}),this.cleanupAfterResponse(r)}catch(h){throw s.addTrace(h==null?void 0:h.message),s.setError(is.session_request_response_publish_failure),h}}),G(this,"ping",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(r)}catch(n){throw this.client.logger.error("ping() -> isValidPing() failed"),n}const{topic:i}=r;if(this.client.session.keys.includes(i)){const n=mi(),s=Mn().toString(),{done:o,resolve:a,reject:c}=os(Q.FIVE_MINUTES,"Ping request expired without receiving any acknowledgement");this.events.once(xe("session_ping",n),({error:l})=>{l?c(l):a()}),await Promise.all([this.sendRequest({topic:i,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:n,relayRpcId:s}),o()])}else this.client.core.pairing.pairings.keys.includes(i)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:i}))}),G(this,"emit",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(r);const{topic:i,event:n,chainId:s}=r,o=Mn().toString(),a=mi();await this.sendRequest({topic:i,method:"wc_sessionEvent",params:{event:n,chainId:s},throwOnFailedPublish:!0,relayRpcId:o,clientRpcId:a})}),G(this,"disconnect",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(r);const{topic:i}=r;if(this.client.session.keys.includes(i))await this.sendRequest({topic:i,method:"wc_sessionDelete",params:ot("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:i,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(i))await this.client.core.pairing.disconnect({topic:i});else{const{message:n}=Z("MISMATCHED_TOPIC",`Session or pairing topic not found: ${i}`);throw new Error(n)}}),G(this,"find",r=>(this.isInitialized(),this.client.session.getAll().filter(i=>gC(i,r)))),G(this,"getPendingSessionRequests",()=>this.client.pendingRequest.getAll()),G(this,"authenticate",async(r,i)=>{var n;this.isInitialized(),this.isValidAuthenticate(r);const s=i&&this.client.core.linkModeSupportedApps.includes(i)&&((n=this.client.metadata.redirect)==null?void 0:n.linkMode),o=s?st.link_mode:st.relay;o===st.relay&&await this.confirmOnlineStateOrThrow();const{chains:a,statement:c="",uri:l,domain:u,nonce:h,type:g,exp:y,nbf:w,methods:E=[],expiry:P}=r,N=[...r.resources||[]],{topic:R,uri:D}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:o});this.client.logger.info({message:"Generated new pairing",pairing:{topic:R,uri:D}});const C=await this.client.core.crypto.generateKeyPair(),B=_c(C);if(await Promise.all([this.client.auth.authKeys.set(Oc,{responseTopic:B,publicKey:C}),this.client.auth.pairingTopics.set(B,{topic:B,pairingTopic:R})]),await this.client.core.relayer.subscribe(B,{transportType:o}),this.client.logger.info(`sending request to new pairing topic: ${R}`),E.length>0){const{namespace:_}=Qi(a[0]);let S=gD(_,"request",E);Ac(N)&&(S=yD(S,N.pop())),N.push(S)}const M=P&&P>Dt.wc_sessionAuthenticate.req.ttl?P:Dt.wc_sessionAuthenticate.req.ttl,L={authPayload:{type:g??"caip122",chains:a,statement:c,aud:l,domain:u,version:"1",nonce:h,iat:new Date().toISOString(),exp:y,nbf:w,resources:N},requester:{publicKey:C,metadata:this.client.metadata},expiryTimestamp:dt(M)},F={eip155:{chains:a,methods:[...new Set(["personal_sign",...E])],events:["chainChanged","accountsChanged"]}},k={requiredNamespaces:{},optionalNamespaces:F,relays:[{protocol:"irn"}],pairingTopic:R,proposer:{publicKey:C,metadata:this.client.metadata},expiryTimestamp:dt(Dt.wc_sessionPropose.req.ttl),id:mi()},{done:V,resolve:H,reject:$}=os(M,"Request expired"),A=mi(),d=xe("session_connect",k.id),f=xe("session_request",A),p=async({error:_,session:S})=>{this.events.off(f,b),_?$(_):S&&H({session:S})},b=async _=>{var S,I,m;if(await this.deletePendingAuthRequest(A,{message:"fulfilled",code:0}),_.error){const z=ot("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return _.error.code===z.code?void 0:(this.events.off(d,p),$(_.error.message))}await this.deleteProposal(k.id),this.events.off(d,p);const{cacaos:O,responder:j}=_.result,v=[],T=[];for(const z of O){await J0({cacao:z,projectId:this.client.core.projectId})||(this.client.logger.error(z,"Signature verification failed"),$(ot("SESSION_SETTLEMENT_FAILED","Signature verification failed")));const{p:Y}=z,J=Ac(Y.resources),W=[Kh(Y.iss)],oe=Jc(Y.iss);if(J){const X=Q0(J),ie=Z0(J);v.push(...X),W.push(...ie)}for(const X of W)T.push(`${X}:${oe}`)}const U=await this.client.core.crypto.generateSharedKey(C,j.publicKey);let q;v.length>0&&(q={topic:U,acknowledged:!0,self:{publicKey:C,metadata:this.client.metadata},peer:j,controller:j.publicKey,expiry:dt(Hs),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:R,namespaces:_g([...new Set(v)],[...new Set(T)]),transportType:o},await this.client.core.relayer.subscribe(U,{transportType:o}),await this.client.session.set(U,q),R&&await this.client.core.pairing.updateMetadata({topic:R,metadata:j.metadata}),q=this.client.session.get(U)),(S=this.client.metadata.redirect)!=null&&S.linkMode&&(I=j.metadata.redirect)!=null&&I.linkMode&&(m=j.metadata.redirect)!=null&&m.universal&&i&&(this.client.core.addLinkModeSupportedApp(j.metadata.redirect.universal),this.client.session.update(U,{transportType:st.link_mode})),H({auths:O,session:q})};this.events.once(d,p),this.events.once(f,b);let x;try{if(s){const _=ti("wc_sessionAuthenticate",L,A);this.client.core.history.set(R,_);const S=await this.client.core.crypto.encode("",_,{type:$a,encoding:Rn});x=oc(i,R,S)}else await Promise.all([this.sendRequest({topic:R,method:"wc_sessionAuthenticate",params:L,expiry:r.expiry,throwOnFailedPublish:!0,clientRpcId:A}),this.sendRequest({topic:R,method:"wc_sessionPropose",params:k,expiry:Dt.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:k.id})])}catch(_){throw this.events.off(d,p),this.events.off(f,b),_}return await this.setProposal(k.id,k),await this.setAuthRequest(A,{request:Nt(ve({},L),{verifyContext:{}}),pairingTopic:R,transportType:o}),{uri:x??D,response:V}}),G(this,"approveSessionAuthenticate",async r=>{const{id:i,auths:n}=r,s=this.client.core.eventClient.createEvent({properties:{topic:i.toString(),trace:[ns.authenticated_session_approve_started]}});try{this.isInitialized()}catch(P){throw s.setError(Vo.no_internet_connection),P}const o=this.getPendingAuthRequest(i);if(!o)throw s.setError(Vo.authenticated_session_pending_request_not_found),new Error(`Could not find pending auth request with id ${i}`);const a=o.transportType||st.relay;a===st.relay&&await this.confirmOnlineStateOrThrow();const c=o.requester.publicKey,l=await this.client.core.crypto.generateKeyPair(),u=_c(c),h={type:Zi,receiverPublicKey:c,senderPublicKey:l},g=[],y=[];for(const P of n){if(!await J0({cacao:P,projectId:this.client.core.projectId})){s.setError(Vo.invalid_cacao);const B=ot("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:i,topic:u,error:B,encodeOpts:h}),new Error(B.message)}s.addTrace(ns.cacaos_verified);const{p:N}=P,R=Ac(N.resources),D=[Kh(N.iss)],C=Jc(N.iss);if(R){const B=Q0(R),M=Z0(R);g.push(...B),D.push(...M)}for(const B of D)y.push(`${B}:${C}`)}const w=await this.client.core.crypto.generateSharedKey(l,c);s.addTrace(ns.create_authenticated_session_topic);let E;if((g==null?void 0:g.length)>0){E={topic:w,acknowledged:!0,self:{publicKey:l,metadata:this.client.metadata},peer:{publicKey:c,metadata:o.requester.metadata},controller:c,expiry:dt(Hs),authentication:n,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:o.pairingTopic,namespaces:_g([...new Set(g)],[...new Set(y)]),transportType:a},s.addTrace(ns.subscribing_authenticated_session_topic);try{await this.client.core.relayer.subscribe(w,{transportType:a})}catch(P){throw s.setError(Vo.subscribe_authenticated_session_topic_failure),P}s.addTrace(ns.subscribe_authenticated_session_topic_success),await this.client.session.set(w,E),s.addTrace(ns.store_authenticated_session),await this.client.core.pairing.updateMetadata({topic:o.pairingTopic,metadata:o.requester.metadata})}s.addTrace(ns.publishing_authenticated_session_approve);try{await this.sendResult({topic:u,id:i,result:{cacaos:n,responder:{publicKey:l,metadata:this.client.metadata}},encodeOpts:h,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(o.requester.metadata,a)})}catch(P){throw s.setError(Vo.authenticated_session_approve_publish_failure),P}return await this.client.auth.requests.delete(i,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:o.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:s.eventId}),{session:E}}),G(this,"rejectSessionAuthenticate",async r=>{this.isInitialized();const{id:i,reason:n}=r,s=this.getPendingAuthRequest(i);if(!s)throw new Error(`Could not find pending auth request with id ${i}`);s.transportType===st.relay&&await this.confirmOnlineStateOrThrow();const o=s.requester.publicKey,a=await this.client.core.crypto.generateKeyPair(),c=_c(o),l={type:Zi,receiverPublicKey:o,senderPublicKey:a};await this.sendError({id:i,topic:c,error:n,encodeOpts:l,rpcOpts:Dt.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(s.requester.metadata,s.transportType)}),await this.client.auth.requests.delete(i,{message:"rejected",code:0}),await this.deleteProposal(i)}),G(this,"formatAuthMessage",r=>{this.isInitialized();const{request:i,iss:n}=r;return b1(i,n)}),G(this,"processRelayMessageCache",()=>{setTimeout(async()=>{if(this.relayMessageCache.length!==0)for(;this.relayMessageCache.length>0;)try{const r=this.relayMessageCache.shift();r&&await this.onRelayMessage(r)}catch(r){this.client.logger.error(r)}},50)}),G(this,"cleanupDuplicatePairings",async r=>{if(r.pairingTopic)try{const i=this.client.core.pairing.pairings.get(r.pairingTopic),n=this.client.core.pairing.pairings.getAll().filter(s=>{var o,a;return((o=s.peerMetadata)==null?void 0:o.url)&&((a=s.peerMetadata)==null?void 0:a.url)===r.peer.metadata.url&&s.topic&&s.topic!==i.topic});if(n.length===0)return;this.client.logger.info(`Cleaning up ${n.length} duplicate pairing(s)`),await Promise.all(n.map(s=>this.client.core.pairing.disconnect({topic:s.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(i){this.client.logger.error(i)}}),G(this,"deleteSession",async r=>{var i;const{topic:n,expirerHasDeleted:s=!1,emitEvent:o=!0,id:a=0}=r,{self:c}=this.client.session.get(n);await this.client.core.relayer.unsubscribe(n),await this.client.session.delete(n,ot("USER_DISCONNECTED")),this.addToRecentlyDeleted(n,"session"),this.client.core.crypto.keychain.has(c.publicKey)&&await this.client.core.crypto.deleteKeyPair(c.publicKey),this.client.core.crypto.keychain.has(n)&&await this.client.core.crypto.deleteSymKey(n),s||this.client.core.expirer.del(n),this.client.core.storage.removeItem(pm).catch(l=>this.client.logger.warn(l)),n===((i=this.sessionRequestQueue.queue[0])==null?void 0:i.topic)&&(this.sessionRequestQueue.state=di.idle),await Promise.all(this.getPendingSessionRequests().filter(l=>l.topic===n).map(l=>this.deletePendingSessionRequest(l.id,ot("USER_DISCONNECTED")))),o&&this.client.events.emit("session_delete",{id:a,topic:n})}),G(this,"deleteProposal",async(r,i)=>{if(i)try{const n=this.client.proposal.get(r),s=this.client.core.eventClient.getEvent({topic:n.pairingTopic});s==null||s.setError(is.proposal_expired)}catch{}await Promise.all([this.client.proposal.delete(r,ot("USER_DISCONNECTED")),i?Promise.resolve():this.client.core.expirer.del(r)]),this.addToRecentlyDeleted(r,"proposal")}),G(this,"deletePendingSessionRequest",async(r,i,n=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,i),n?Promise.resolve():this.client.core.expirer.del(r)]),this.addToRecentlyDeleted(r,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(s=>s.id!==r),n&&(this.sessionRequestQueue.state=di.idle,this.client.events.emit("session_request_expire",{id:r}))}),G(this,"deletePendingAuthRequest",async(r,i,n=!1)=>{await Promise.all([this.client.auth.requests.delete(r,i),n?Promise.resolve():this.client.core.expirer.del(r)])}),G(this,"setExpiry",async(r,i)=>{this.client.session.keys.includes(r)&&(this.client.core.expirer.set(r,i),await this.client.session.update(r,{expiry:i}))}),G(this,"setProposal",async(r,i)=>{this.client.core.expirer.set(r,dt(Dt.wc_sessionPropose.req.ttl)),await this.client.proposal.set(r,i)}),G(this,"setAuthRequest",async(r,i)=>{const{request:n,pairingTopic:s,transportType:o=st.relay}=i;this.client.core.expirer.set(r,n.expiryTimestamp),await this.client.auth.requests.set(r,{authPayload:n.authPayload,requester:n.requester,expiryTimestamp:n.expiryTimestamp,id:r,pairingTopic:s,verifyContext:n.verifyContext,transportType:o})}),G(this,"setPendingSessionRequest",async r=>{const{id:i,topic:n,params:s,verifyContext:o}=r,a=s.request.expiryTimestamp||dt(Dt.wc_sessionRequest.req.ttl);this.client.core.expirer.set(i,a),await this.client.pendingRequest.set(i,{id:i,topic:n,params:s,verifyContext:o})}),G(this,"sendRequest",async r=>{const{topic:i,method:n,params:s,expiry:o,relayRpcId:a,clientRpcId:c,throwOnFailedPublish:l,appLink:u,tvf:h,publishOpts:g={}}=r,y=ti(n,s,c);let w;const E=!!u;try{const R=E?Rn:ar;w=await this.client.core.crypto.encode(i,y,{encoding:R})}catch(R){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${i} failed`),R}let P;if(h$.includes(n)){const R=kr(JSON.stringify(y)),D=kr(w);P=await this.client.core.verify.register({id:D,decryptedId:R})}const N=ve(ve({},Dt[n].req),g);if(N.attestation=P,o&&(N.ttl=o),a&&(N.id=a),this.client.core.history.set(i,y),E){const R=oc(u,i,w);await global.Linking.openURL(R,this.client.name)}else N.tvf=Nt(ve({},h),{correlationId:y.id}),l?(N.internal=Nt(ve({},N.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(i,w,N)):this.client.core.relayer.publish(i,w,N).catch(R=>this.client.logger.error(R));return y.id}),G(this,"sendProposeSession",async r=>{const{proposal:i,publishOpts:n}=r,s=ti("wc_sessionPropose",i,i.id);this.client.core.history.set(i.pairingTopic,s);const o=await this.client.core.crypto.encode(i.pairingTopic,s,{encoding:ar}),a=kr(JSON.stringify(s)),c=kr(o),l=await this.client.core.verify.register({id:c,decryptedId:a});await this.client.core.relayer.publishCustom({payload:{pairingTopic:i.pairingTopic,sessionProposal:o},opts:Nt(ve({},n),{publishMethod:"wc_proposeSession",attestation:l})})}),G(this,"sendApproveSession",async r=>{const{sessionTopic:i,pairingProposalResponse:n,proposal:s,sessionSettleRequest:o,publishOpts:a}=r,c=Aa(s.id,n),l=await this.client.core.crypto.encode(s.pairingTopic,c,{encoding:ar}),u=ti("wc_sessionSettle",o,a==null?void 0:a.id),h=await this.client.core.crypto.encode(i,u,{encoding:ar});this.client.core.history.set(i,u),await this.client.core.relayer.publishCustom({payload:{sessionTopic:i,pairingTopic:s.pairingTopic,sessionProposalResponse:l,sessionSettlementRequest:h},opts:Nt(ve({},a),{publishMethod:"wc_approveSession"})})}),G(this,"sendResult",async r=>{const{id:i,topic:n,result:s,throwOnFailedPublish:o,encodeOpts:a,appLink:c}=r,l=Aa(i,s);let u;const h=c&&typeof(global==null?void 0:global.Linking)<"u";try{const w=h?Rn:ar;u=await this.client.core.crypto.encode(n,l,Nt(ve({},a||{}),{encoding:w}))}catch(w){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${n} failed`),w}let g,y;try{g=await this.client.core.history.get(n,i);const w=g.request;try{y=this.getTVFParams(i,w.params,s)}catch(E){this.client.logger.warn(`sendResult() -> getTVFParams() failed: ${E==null?void 0:E.message}`)}}catch(w){throw this.client.logger.error(`sendResult() -> history.get(${n}, ${i}) failed`),w}if(h){const w=oc(c,n,u);await global.Linking.openURL(w,this.client.name)}else{const w=g.request.method,E=Dt[w].res;E.tvf=Nt(ve({},y),{correlationId:i}),o?(E.internal=Nt(ve({},E.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,u,E)):this.client.core.relayer.publish(n,u,E).catch(P=>this.client.logger.error(P))}await this.client.core.history.resolve(l)}),G(this,"sendError",async r=>{const{id:i,topic:n,error:s,encodeOpts:o,rpcOpts:a,appLink:c}=r,l=Tl(i,s);let u;const h=c&&typeof(global==null?void 0:global.Linking)<"u";try{const y=h?Rn:ar;u=await this.client.core.crypto.encode(n,l,Nt(ve({},o||{}),{encoding:y}))}catch(y){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${n} failed`),y}let g;try{g=await this.client.core.history.get(n,i)}catch(y){throw this.client.logger.error(`sendError() -> history.get(${n}, ${i}) failed`),y}if(h){const y=oc(c,n,u);await global.Linking.openURL(y,this.client.name)}else{const y=g.request.method,w=a||Dt[y].res;this.client.core.relayer.publish(n,u,w)}await this.client.core.history.resolve(l)}),G(this,"cleanup",async()=>{const r=[],i=[];this.client.session.getAll().forEach(n=>{let s=!1;bi(n.expiry)&&(s=!0),this.client.core.crypto.keychain.has(n.topic)||(s=!0),s&&r.push(n.topic)}),this.client.proposal.getAll().forEach(n=>{bi(n.expiryTimestamp)&&i.push(n.id)}),await Promise.all([...r.map(n=>this.deleteSession({topic:n})),...i.map(n=>this.deleteProposal(n))])}),G(this,"onProviderMessageEvent",async r=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(r):await this.onRelayMessage(r)}),G(this,"onRelayEventRequest",async r=>{this.requestQueue.queue.push(r),await this.processRequestsQueue()}),G(this,"processRequestsQueue",async()=>{if(this.requestQueue.state===di.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=di.active;const r=this.requestQueue.queue.shift();if(r)try{await this.processRequest(r)}catch(i){this.client.logger.warn(i)}}this.requestQueue.state=di.idle}),G(this,"processRequest",async r=>{const{topic:i,payload:n,attestation:s,transportType:o,encryptedId:a}=r,c=n.method;if(!this.shouldIgnorePairingRequest({topic:i,requestMethod:c}))switch(c){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:i,payload:n,attestation:s,encryptedId:a});case"wc_sessionSettle":return await this.onSessionSettleRequest(i,n);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(i,n);case"wc_sessionExtend":return await this.onSessionExtendRequest(i,n);case"wc_sessionPing":return await this.onSessionPingRequest(i,n);case"wc_sessionDelete":return await this.onSessionDeleteRequest(i,n);case"wc_sessionRequest":return await this.onSessionRequest({topic:i,payload:n,attestation:s,encryptedId:a,transportType:o});case"wc_sessionEvent":return await this.onSessionEventRequest(i,n);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:i,payload:n,attestation:s,encryptedId:a,transportType:o});default:return this.client.logger.info(`Unsupported request method ${c}`)}}),G(this,"onRelayEventResponse",async r=>{const{topic:i,payload:n,transportType:s}=r,o=(await this.client.core.history.get(i,n.id)).request.method;switch(o){case"wc_sessionPropose":return this.onSessionProposeResponse(i,n,s);case"wc_sessionSettle":return this.onSessionSettleResponse(i,n);case"wc_sessionUpdate":return this.onSessionUpdateResponse(i,n);case"wc_sessionExtend":return this.onSessionExtendResponse(i,n);case"wc_sessionPing":return this.onSessionPingResponse(i,n);case"wc_sessionRequest":return this.onSessionRequestResponse(i,n);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(i,n);default:return this.client.logger.info(`Unsupported response method ${o}`)}}),G(this,"onRelayEventUnknownPayload",r=>{const{topic:i}=r,{message:n}=Z("MISSING_OR_INVALID",`Decoded payload on topic ${i} is not identifiable as a JSON-RPC request or a response.`);throw new Error(n)}),G(this,"shouldIgnorePairingRequest",r=>{const{topic:i,requestMethod:n}=r,s=this.expectedPairingMethodMap.get(i);return!s||s.includes(n)?!1:!!(s.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)}),G(this,"onSessionProposeRequest",async r=>{const{topic:i,payload:n,attestation:s,encryptedId:o}=r,{params:a,id:c}=n;try{const l=this.client.core.eventClient.getEvent({topic:i});this.client.events.listenerCount("session_proposal")===0&&(console.warn("No listener for session_proposal event"),l==null||l.setError(qi.proposal_listener_not_found)),this.isValidConnect(ve({},n.params));const u=a.expiryTimestamp||dt(Dt.wc_sessionPropose.req.ttl),h=ve({id:c,pairingTopic:i,expiryTimestamp:u,attestation:s,encryptedId:o},a);await this.setProposal(c,h);const g=await this.getVerifyContext({attestationId:s,hash:kr(JSON.stringify(n)),encryptedId:o,metadata:h.proposer.metadata});l==null||l.addTrace(pi.emit_session_proposal),this.client.events.emit("session_proposal",{id:c,params:h,verifyContext:g})}catch(l){await this.sendError({id:c,topic:i,error:l,rpcOpts:Dt.wc_sessionPropose.autoReject}),this.client.logger.error(l)}}),G(this,"onSessionProposeResponse",async(r,i,n)=>{const{id:s}=i;if(yi(i)){const{result:o}=i;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:o});const a=this.client.proposal.get(s);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:a});const c=a.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:c});const l=o.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:l});const u=await this.client.core.crypto.generateSharedKey(c,l);this.pendingSessions.set(s,{sessionTopic:u,pairingTopic:r,proposalId:s,publicKey:c});const h=await this.client.core.relayer.subscribe(u,{transportType:n});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:h}),await this.client.core.pairing.activate({topic:r})}else if($r(i)){await this.deleteProposal(s);const o=xe("session_connect",s);if(this.events.listenerCount(o)===0)throw new Error(`emitting ${o} without any listeners, 954`);this.events.emit(o,{error:i.error})}}),G(this,"onSessionSettleRequest",async(r,i)=>{const{id:n,params:s}=i;try{this.isValidSessionSettleRequest(s);const{relay:o,controller:a,expiry:c,namespaces:l,sessionProperties:u,scopedProperties:h,sessionConfig:g,proposalRequestsResponses:y}=i.params,w=[...this.pendingSessions.values()].find(N=>N.sessionTopic===r);if(!w)return this.client.logger.error(`Pending session not found for topic ${r}`);const E=this.client.proposal.get(w.proposalId),P=Nt(ve(ve(ve({topic:r,relay:o,expiry:c,namespaces:l,acknowledged:!0,pairingTopic:w.pairingTopic,requiredNamespaces:E.requiredNamespaces,optionalNamespaces:E.optionalNamespaces,controller:a.publicKey,self:{publicKey:w.publicKey,metadata:this.client.metadata},peer:{publicKey:a.publicKey,metadata:a.metadata}},u&&{sessionProperties:u}),h&&{scopedProperties:h}),g&&{sessionConfig:g}),{transportType:st.relay,authentication:y==null?void 0:y.authentication,walletPayResult:y==null?void 0:y.walletPay});await this.client.session.set(P.topic,P),await this.setExpiry(P.topic,P.expiry),await this.client.core.pairing.updateMetadata({topic:w.pairingTopic,metadata:P.peer.metadata}),this.pendingSessions.delete(w.proposalId),this.deleteProposal(w.proposalId,!1),this.cleanupDuplicatePairings(P),await this.sendResult({id:i.id,topic:r,throwOnFailedPublish:!0,result:!0}),this.client.events.emit("session_connect",{session:P}),this.events.emit(xe("session_connect",w.proposalId),{session:P})}catch(o){await this.sendError({id:n,topic:r,error:o}),this.client.logger.error(o)}}),G(this,"onSessionSettleResponse",async(r,i)=>{const{id:n}=i;yi(i)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(xe("session_approve",n),{})):$r(i)&&(await this.client.session.delete(r,ot("USER_DISCONNECTED")),this.events.emit(xe("session_approve",n),{error:i.error}))}),G(this,"onSessionUpdateRequest",async(r,i)=>{const{params:n,id:s}=i;try{const o=`${r}_session_update`,a=Ho.get(o);if(a&&this.isRequestOutOfSync(a,s)){this.client.logger.warn(`Discarding out of sync request - ${s}`),this.sendError({id:s,topic:r,error:ot("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(ve({topic:r},n));try{Ho.set(o,s),await this.client.session.update(r,{namespaces:n.namespaces}),await this.sendResult({id:s,topic:r,result:!0})}catch(c){throw Ho.delete(o),c}this.client.events.emit("session_update",{id:s,topic:r,params:n})}catch(o){await this.sendError({id:s,topic:r,error:o}),this.client.logger.error(o)}}),G(this,"isRequestOutOfSync",(r,i)=>i.toString().slice(0,-3)<r.toString().slice(0,-3)),G(this,"onSessionUpdateResponse",(r,i)=>{const{id:n}=i,s=xe("session_update",n);if(this.events.listenerCount(s)===0)throw new Error(`emitting ${s} without any listeners`);yi(i)?this.events.emit(xe("session_update",n),{}):$r(i)&&this.events.emit(xe("session_update",n),{error:i.error})}),G(this,"onSessionExtendRequest",async(r,i)=>{const{id:n}=i;try{this.isValidExtend({topic:r}),await this.setExpiry(r,dt(Hs)),await this.sendResult({id:n,topic:r,result:!0}),this.client.events.emit("session_extend",{id:n,topic:r})}catch(s){await this.sendError({id:n,topic:r,error:s}),this.client.logger.error(s)}}),G(this,"onSessionExtendResponse",(r,i)=>{const{id:n}=i,s=xe("session_extend",n);if(this.events.listenerCount(s)===0)throw new Error(`emitting ${s} without any listeners`);yi(i)?this.events.emit(xe("session_extend",n),{}):$r(i)&&this.events.emit(xe("session_extend",n),{error:i.error})}),G(this,"onSessionPingRequest",async(r,i)=>{const{id:n}=i;try{this.isValidPing({topic:r}),await this.sendResult({id:n,topic:r,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:n,topic:r})}catch(s){await this.sendError({id:n,topic:r,error:s}),this.client.logger.error(s)}}),G(this,"onSessionPingResponse",(r,i)=>{const{id:n}=i,s=xe("session_ping",n);setTimeout(()=>{if(this.events.listenerCount(s)===0)throw new Error(`emitting ${s} without any listeners 2176`);yi(i)?this.events.emit(xe("session_ping",n),{}):$r(i)&&this.events.emit(xe("session_ping",n),{error:i.error})},500)}),G(this,"onSessionDeleteRequest",async(r,i)=>{const{id:n}=i;try{await this.isValidDisconnect({topic:r,reason:i.params}),this.cleanupPendingSentRequestsForTopic({topic:r,error:ot("USER_DISCONNECTED")}),await this.deleteSession({topic:r,id:n})}catch(s){this.client.logger.error(s)}}),G(this,"onSessionRequest",async r=>{var i,n,s;const{topic:o,payload:a,attestation:c,encryptedId:l,transportType:u}=r,{id:h,params:g}=a;try{await this.isValidRequest(ve({topic:o},g));const y=this.client.session.get(o),w=await this.getVerifyContext({attestationId:c,hash:kr(JSON.stringify(ti("wc_sessionRequest",g,h))),encryptedId:l,metadata:y.peer.metadata,transportType:u}),E={id:h,topic:o,params:g,verifyContext:w};await this.setPendingSessionRequest(E),u===st.link_mode&&(i=y.peer.metadata.redirect)!=null&&i.universal&&this.client.core.addLinkModeSupportedApp((n=y.peer.metadata.redirect)==null?void 0:n.universal),(s=this.client.signConfig)!=null&&s.disableRequestQueue?this.emitSessionRequest(E):(this.addSessionRequestToSessionRequestQueue(E),this.processSessionRequestQueue())}catch(y){await this.sendError({id:h,topic:o,error:y}),this.client.logger.error(y)}}),G(this,"onSessionRequestResponse",(r,i)=>{const{id:n}=i,s=xe("session_request",n);if(this.events.listenerCount(s)===0)throw new Error(`emitting ${s} without any listeners`);yi(i)?this.events.emit(xe("session_request",n),{result:i.result}):$r(i)&&this.events.emit(xe("session_request",n),{error:i.error})}),G(this,"onSessionEventRequest",async(r,i)=>{const{id:n,params:s}=i;try{const o=`${r}_session_event_${s.event.name}`,a=Ho.get(o);if(a&&this.isRequestOutOfSync(a,n)){this.client.logger.info(`Discarding out of sync request - ${n}`);return}this.isValidEmit(ve({topic:r},s)),this.client.events.emit("session_event",{id:n,topic:r,params:s}),Ho.set(o,n)}catch(o){await this.sendError({id:n,topic:r,error:o}),this.client.logger.error(o)}}),G(this,"onSessionAuthenticateResponse",(r,i)=>{const{id:n}=i;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:r,payload:i}),yi(i)?this.events.emit(xe("session_request",n),{result:i.result}):$r(i)&&this.events.emit(xe("session_request",n),{error:i.error})}),G(this,"onSessionAuthenticateRequest",async r=>{var i;const{topic:n,payload:s,attestation:o,encryptedId:a,transportType:c}=r;try{const{requester:l,authPayload:u,expiryTimestamp:h}=s.params,g=await this.getVerifyContext({attestationId:o,hash:kr(JSON.stringify(s)),encryptedId:a,metadata:l.metadata,transportType:c}),y={requester:l,pairingTopic:n,id:s.id,authPayload:u,verifyContext:g,expiryTimestamp:h};await this.setAuthRequest(s.id,{request:y,pairingTopic:n,transportType:c}),c===st.link_mode&&(i=l.metadata.redirect)!=null&&i.universal&&this.client.core.addLinkModeSupportedApp(l.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:n,params:s.params,id:s.id,verifyContext:g})}catch(l){this.client.logger.error(l);const u=s.params.requester.publicKey,h=await this.client.core.crypto.generateKeyPair(),g=this.getAppLinkIfEnabled(s.params.requester.metadata,c),y={type:Zi,receiverPublicKey:u,senderPublicKey:h};await this.sendError({id:s.id,topic:n,error:l,encodeOpts:y,rpcOpts:Dt.wc_sessionAuthenticate.autoReject,appLink:g})}}),G(this,"addSessionRequestToSessionRequestQueue",r=>{this.sessionRequestQueue.queue.push(r)}),G(this,"cleanupAfterResponse",r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=di.idle,this.processSessionRequestQueue()},Q.toMiliseconds(this.requestQueueDelay))}),G(this,"cleanupPendingSentRequestsForTopic",({topic:r,error:i})=>{const n=this.client.core.history.pending;n.length>0&&n.filter(s=>s.topic===r&&s.request.method==="wc_sessionRequest").forEach(s=>{this.events.emit(xe("session_request",s.request.id),{error:i})})}),G(this,"processSessionRequestQueue",()=>{if(this.sessionRequestQueue.state===di.active){this.client.logger.info("session request queue is already active.");return}const r=this.sessionRequestQueue.queue[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{this.emitSessionRequest(r)}catch(i){this.client.logger.error(i)}}),G(this,"emitSessionRequest",r=>{if(this.emittedSessionRequests.has(r.id)){this.client.logger.warn({id:r.id},`Skipping emitting \`session_request\` event for duplicate request. id: ${r.id}`);return}this.sessionRequestQueue.state=di.active,this.emittedSessionRequests.add(r.id),this.client.events.emit("session_request",r)}),G(this,"onPairingCreated",r=>{if(r.methods&&this.expectedPairingMethodMap.set(r.topic,r.methods),r.active)return;const i=this.client.proposal.getAll().find(n=>n.pairingTopic===r.topic);i&&this.onSessionProposeRequest({topic:r.topic,payload:ti("wc_sessionPropose",Nt(ve({},i),{requiredNamespaces:i.requiredNamespaces,optionalNamespaces:i.optionalNamespaces,relays:i.relays,proposer:i.proposer,sessionProperties:i.sessionProperties,scopedProperties:i.scopedProperties}),i.id),attestation:i.attestation,encryptedId:i.encryptedId})}),G(this,"isValidConnect",async r=>{if(!nr(r)){const{message:l}=Z("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(l)}const{pairingTopic:i,requiredNamespaces:n,optionalNamespaces:s,sessionProperties:o,scopedProperties:a,relays:c}=r;if(At(i)||await this.isValidPairingTopic(i),!PC(c)){const{message:l}=Z("MISSING_OR_INVALID",`connect() relays: ${c}`);throw new Error(l)}if(n&&!At(n)&&Ii(n)!==0){const l="requiredNamespaces are deprecated and are automatically assigned to optionalNamespaces";["fatal","error","silent"].includes(this.client.logger.level)?console.warn(l):this.client.logger.warn(l),this.validateNamespaces(n,"requiredNamespaces")}if(s&&!At(s)&&Ii(s)!==0&&this.validateNamespaces(s,"optionalNamespaces"),o&&!At(o)&&this.validateSessionProps(o,"sessionProperties"),a&&!At(a)){this.validateSessionProps(a,"scopedProperties");const l=Object.keys(n||{}).concat(Object.keys(s||{}));if(!Object.keys(a).every(u=>l.includes(u.split(":")[0])))throw new Error(`Scoped properties must be a subset of required/optional namespaces, received: ${JSON.stringify(a)}, required/optional namespaces: ${JSON.stringify(l)}`)}}),G(this,"validateNamespaces",(r,i)=>{const n=SC(r,"connect()",i);if(n)throw new Error(n.message)}),G(this,"isValidApprove",async r=>{if(!nr(r))throw new Error(Z("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:i,namespaces:n,relayProtocol:s,sessionProperties:o,scopedProperties:a}=r;this.checkRecentlyDeleted(i),await this.isValidProposalId(i);const c=this.client.proposal.get(i),l=Zu(n,"approve()");if(l)throw new Error(l.message);const u=Pg(c.requiredNamespaces,n,"approve()");if(u)throw new Error(u.message);if(!mt(s,!0)){const{message:h}=Z("MISSING_OR_INVALID",`approve() relayProtocol: ${s}`);throw new Error(h)}if(o&&!At(o)&&this.validateSessionProps(o,"sessionProperties"),a&&!At(a)){this.validateSessionProps(a,"scopedProperties");const h=new Set(Object.keys(n));if(!Object.keys(a).every(g=>h.has(g.split(":")[0])))throw new Error(`Scoped properties must be a subset of approved namespaces, received: ${JSON.stringify(a)}, approved namespaces: ${Array.from(h).join(", ")}`)}}),G(this,"isValidReject",async r=>{if(!nr(r)){const{message:s}=Z("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(s)}const{id:i,reason:n}=r;if(this.checkRecentlyDeleted(i),await this.isValidProposalId(i),!DC(n)){const{message:s}=Z("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(n)}`);throw new Error(s)}}),G(this,"isValidSessionSettleRequest",r=>{if(!nr(r)){const{message:l}=Z("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(l)}const{relay:i,controller:n,namespaces:s,expiry:o}=r;if(!iv(i)){const{message:l}=Z("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(l)}const a=vC(n,"onSessionSettleRequest()");if(a)throw new Error(a.message);const c=Zu(s,"onSessionSettleRequest()");if(c)throw new Error(c.message);if(bi(o)){const{message:l}=Z("EXPIRED","onSessionSettleRequest()");throw new Error(l)}}),G(this,"isValidUpdate",async r=>{if(!nr(r)){const{message:c}=Z("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(c)}const{topic:i,namespaces:n}=r;this.checkRecentlyDeleted(i),await this.isValidSessionTopic(i);const s=this.client.session.get(i),o=Zu(n,"update()");if(o)throw new Error(o.message);const a=Pg(s.requiredNamespaces,n,"update()");if(a)throw new Error(a.message)}),G(this,"isValidExtend",async r=>{if(!nr(r)){const{message:n}=Z("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(n)}const{topic:i}=r;this.checkRecentlyDeleted(i),await this.isValidSessionTopic(i)}),G(this,"isValidRequest",async r=>{if(!nr(r)){const{message:c}=Z("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(c)}const{topic:i,request:n,chainId:s,expiry:o}=r;this.checkRecentlyDeleted(i),await this.isValidSessionTopic(i);const{namespaces:a}=this.client.session.get(i);if(!Sg(a,s)){const{message:c}=Z("MISSING_OR_INVALID",`request() chainId: ${s}`);throw new Error(c)}if(!NC(n)){const{message:c}=Z("MISSING_OR_INVALID",`request() ${JSON.stringify(n)}`);throw new Error(c)}if(!RC(a,s,n.method)){const{message:c}=Z("MISSING_OR_INVALID",`request() method: ${n.method}`);throw new Error(c)}this.validateRequestExpiry(o)}),G(this,"isValidRespond",async r=>{var i;if(!nr(r)){const{message:a}=Z("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(a)}const{topic:n,response:s}=r;try{await this.isValidSessionTopic(n)}catch(a){throw(i=r==null?void 0:r.response)!=null&&i.id&&this.cleanupAfterResponse(r),a}if(!CC(s)){const{message:a}=Z("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(s)}`);throw new Error(a)}const o=this.client.pendingRequest.get(s.id);if(o.topic!==n){const{message:a}=Z("MISMATCHED_TOPIC",`Request response topic mismatch. reqId: ${s.id}, expected topic: ${o.topic}, received topic: ${n}`);throw new Error(a)}}),G(this,"isValidPing",async r=>{if(!nr(r)){const{message:n}=Z("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidSessionOrPairingTopic(i)}),G(this,"isValidEmit",async r=>{if(!nr(r)){const{message:a}=Z("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(a)}const{topic:i,event:n,chainId:s}=r;await this.isValidSessionTopic(i);const{namespaces:o}=this.client.session.get(i);if(!Sg(o,s)){const{message:a}=Z("MISSING_OR_INVALID",`emit() chainId: ${s}`);throw new Error(a)}if(!BC(n)){const{message:a}=Z("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(n)}`);throw new Error(a)}if(!TC(o,s,n.name)){const{message:a}=Z("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(n)}`);throw new Error(a)}}),G(this,"isValidDisconnect",async r=>{if(!nr(r)){const{message:n}=Z("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidSessionOrPairingTopic(i)}),G(this,"isValidAuthenticate",r=>{const{chains:i,uri:n,domain:s,nonce:o}=r;if(!Array.isArray(i)||i.length===0)throw new Error("chains is required and must be a non-empty array");if(!mt(n,!1))throw new Error("uri is required parameter");if(!mt(s,!1))throw new Error("domain is required parameter");if(!mt(o,!1))throw new Error("nonce is required parameter");if([...new Set(i.map(c=>Qi(c).namespace))].length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");const{namespace:a}=Qi(i[0]);if(a!=="eip155")throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")}),G(this,"getVerifyContext",async r=>{const{attestationId:i,hash:n,encryptedId:s,metadata:o,transportType:a}=r,c={verified:{verifyUrl:o.verifyUrl||ua,validation:"UNKNOWN",origin:o.url||""}};try{if(a===st.link_mode){const u=this.getAppLinkIfEnabled(o,a);return c.verified.validation=u&&new URL(u).origin===new URL(o.url).origin?"VALID":"INVALID",c}const l=await this.client.core.verify.resolve({attestationId:i,hash:n,encryptedId:s,verifyUrl:o.verifyUrl});l&&(c.verified.origin=l.origin,c.verified.isScam=l.isScam,c.verified.validation=l.origin===new URL(o.url).origin?"VALID":"INVALID")}catch(l){this.client.logger.warn(l)}return this.client.logger.debug(`Verify context: ${JSON.stringify(c)}`),c}),G(this,"validateSessionProps",(r,i)=>{Object.values(r).forEach((n,s)=>{if(n==null){const{message:o}=Z("MISSING_OR_INVALID",`${i} must contain an existing value for each key. Received: ${n} for key ${Object.keys(r)[s]}`);throw new Error(o)}})}),G(this,"getPendingAuthRequest",r=>{const i=this.client.auth.requests.get(r);return typeof i=="object"?i:void 0}),G(this,"addToRecentlyDeleted",(r,i)=>{if(this.recentlyDeletedMap.set(r,i),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let n=0;const s=this.recentlyDeletedLimit/2;for(const o of this.recentlyDeletedMap.keys()){if(n++>=s)break;this.recentlyDeletedMap.delete(o)}}}),G(this,"checkRecentlyDeleted",r=>{const i=this.recentlyDeletedMap.get(r);if(i){const{message:n}=Z("MISSING_OR_INVALID",`Record was recently deleted - ${i}: ${r}`);throw new Error(n)}}),G(this,"isLinkModeEnabled",(r,i)=>{var n,s,o,a,c,l,u,h,g;return!r||i!==st.link_mode?!1:((s=(n=this.client.metadata)==null?void 0:n.redirect)==null?void 0:s.linkMode)===!0&&((a=(o=this.client.metadata)==null?void 0:o.redirect)==null?void 0:a.universal)!==void 0&&((l=(c=this.client.metadata)==null?void 0:c.redirect)==null?void 0:l.universal)!==""&&((u=r==null?void 0:r.redirect)==null?void 0:u.universal)!==void 0&&((h=r==null?void 0:r.redirect)==null?void 0:h.universal)!==""&&((g=r==null?void 0:r.redirect)==null?void 0:g.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(r.redirect.universal)&&typeof(global==null?void 0:global.Linking)<"u"}),G(this,"getAppLinkIfEnabled",(r,i)=>{var n;return this.isLinkModeEnabled(r,i)?(n=r==null?void 0:r.redirect)==null?void 0:n.universal:void 0}),G(this,"handleLinkModeMessage",({url:r})=>{if(!r||!r.includes("wc_ev")||!r.includes("topic"))return;const i=U0(r,"topic")||"",n=decodeURIComponent(U0(r,"wc_ev")||""),s=this.client.session.keys.includes(i);s&&this.client.session.update(i,{transportType:st.link_mode}),this.client.core.dispatchEnvelope({topic:i,message:n,sessionExists:s})}),G(this,"registerLinkModeListeners",async()=>{var r;if(ud()||qn()&&(r=this.client.metadata.redirect)!=null&&r.linkMode){const i=global==null?void 0:global.Linking;if(typeof i<"u"){i.addEventListener("url",this.handleLinkModeMessage,this.client.name);const n=await i.getInitialURL();n&&setTimeout(()=>{this.handleLinkModeMessage({url:n})},50)}}}),G(this,"getTVFApproveParams",r=>{try{const i=tv(r.namespaces),n=aC(r.namespaces),s=cC(r.namespaces),o=r.sessionProperties,a=r.scopedProperties;return{approvedChains:i,approvedMethods:n,approvedEvents:s,sessionProperties:o,scopedProperties:a}}catch(i){return this.client.logger.warn(i,"Error getting TVF approve params"),{}}}),G(this,"getTVFParams",(r,i,n)=>{var s,o,a;if(!((s=i.request)!=null&&s.method))return{};const c={correlationId:r,rpcMethods:[i.request.method],chainId:i.chainId};try{const l=this.extractTxHashesFromResult(i.request,n);c.txHashes=l,c.contractAddresses=this.isValidContractData(i.request.params)?[(a=(o=i.request.params)==null?void 0:o[0])==null?void 0:a.to]:[]}catch(l){this.client.logger.warn(l,"Error getting TVF params")}return c}),G(this,"isValidContractData",r=>{var i;if(!r)return!1;try{const n=(r==null?void 0:r.data)||((i=r==null?void 0:r[0])==null?void 0:i.data);if(!n.startsWith("0x"))return!1;const s=n.slice(2);return/^[0-9a-fA-F]*$/.test(s)?s.length%2===0:!1}catch{}return!1}),G(this,"extractTxHashesFromResult",(r,i)=>{var n;try{if(!i)return[];const s=r.method,o=l$[s];if(s==="sui_signTransaction")return[JO(i.transactionBytes)];if(s==="near_signTransaction")return[V0(i)];if(s==="near_signTransactions")return i.map(c=>V0(c));if(s==="xrpl_signTransactionFor"||s==="xrpl_signTransaction")return[(n=i.tx_json)==null?void 0:n.hash];if(s==="polkadot_signTransaction")return[ZC({transaction:r.params.transactionPayload,signature:i.signature})];if(s==="algo_signTxn")return Fr(i)?i.map(c=>G0(c)):[G0(i)];if(s==="cosmos_signDirect")return[ZO(i)];if(s==="wallet_sendCalls")return XO(i);if(typeof i=="string")return[i];const a=i[o.key];if(Fr(a))return s==="solana_signAllTransactions"?a.map(c=>YO(c)):a;if(typeof a=="string")return[a]}catch(s){this.client.logger.warn(s,"Error extracting tx hashes from result")}return[]})}async processPendingMessageEvents(){try{const e=this.client.session.keys,r=this.client.core.relayer.messages.getWithoutAck(e);for(const[i,n]of Object.entries(r))for(const s of n)try{await this.onProviderMessageEvent({topic:i,message:s,publishedAt:Date.now()})}catch{this.client.logger.warn(`Error processing pending message event for topic: ${i}, message: ${s}`)}}catch(e){this.client.logger.warn(e,"processPendingMessageEvents failed")}}isInitialized(){if(!this.initialized){const{message:e}=Z("NOT_INITIALIZED",this.name);throw new Error(e)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(gt.message,e=>{this.onProviderMessageEvent(e)})}async onRelayMessage(e){const{topic:r,message:i,attestation:n,transportType:s}=e,{publicKey:o}=this.client.auth.authKeys.keys.includes(Oc)?this.client.auth.authKeys.get(Oc):{publicKey:void 0};try{const a=await this.client.core.crypto.decode(r,i,{receiverPublicKey:o,encoding:s===st.link_mode?Rn:ar});Ad(a)?(this.client.core.history.set(r,a),await this.onRelayEventRequest({topic:r,payload:a,attestation:n,transportType:s,encryptedId:kr(i)})):Ml(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a,transportType:s}),this.client.core.history.delete(r,a.id)):(this.client.logger.error(`onRelayMessage() -> unknown payload: ${JSON.stringify(a)}`),await this.onRelayEventUnknownPayload({topic:r,payload:a,transportType:s})),await this.client.core.relayer.messages.ack(r,i)}catch(a){this.client.logger.error(`onRelayMessage() -> failed to process an inbound message: ${i}`),this.client.logger.error(a)}}registerExpirerEvents(){this.client.core.expirer.on(Tr.expired,async e=>{const{topic:r,id:i}=r1(e.target);if(i&&this.client.pendingRequest.keys.includes(i))return await this.deletePendingSessionRequest(i,Z("EXPIRED"),!0);if(i&&this.client.auth.requests.keys.includes(i))return await this.deletePendingAuthRequest(i,Z("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession({topic:r,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:r})):i&&(await this.deleteProposal(i,!0),this.client.events.emit("proposal_expire",{id:i}))})}registerPairingEvents(){this.client.core.pairing.events.on(ls.create,e=>this.onPairingCreated(e)),this.client.core.pairing.events.on(ls.delete,e=>{this.addToRecentlyDeleted(e.topic,"pairing")})}isValidPairingTopic(e){if(!mt(e,!1)){const{message:r}=Z("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:r}=Z("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(r)}if(bi(this.client.core.pairing.pairings.get(e).expiry)){const{message:r}=Z("EXPIRED",`pairing topic: ${e}`);throw new Error(r)}}async isValidSessionTopic(e){if(!mt(e,!1)){const{message:r}=Z("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(r)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){const{message:r}=Z("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(r)}if(bi(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});const{message:r}=Z("EXPIRED",`session topic: ${e}`);throw new Error(r)}if(!this.client.core.crypto.keychain.has(e)){const{message:r}=Z("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),new Error(r)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(mt(e,!1)){const{message:r}=Z("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(r)}else{const{message:r}=Z("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(r)}}async isValidProposalId(e){if(!OC(e)){const{message:r}=Z("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(r)}if(!this.client.proposal.keys.includes(e)){const{message:r}=Z("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(r)}if(bi(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);const{message:r}=Z("EXPIRED",`proposal id: ${e}`);throw new Error(r)}}validateRequestExpiry(e){if(e&&!$C(e,oh)){const{message:r}=Z("MISSING_OR_INVALID",`request() expiry: ${e}. Expiry must be a number (in seconds) between ${oh.min} and ${oh.max}`);throw new Error(r)}}}class A$ extends Ms{constructor(e,r){super(e,r,o$,Id),this.core=e,this.logger=r}}let _$=class extends Ms{constructor(e,r){super(e,r,a$,Id),this.core=e,this.logger=r}};class I$ extends Ms{constructor(e,r){super(e,r,u$,Id,i=>i.id),this.core=e,this.logger=r}}class S$ extends Ms{constructor(e,r){super(e,r,p$,$l,()=>Oc),this.core=e,this.logger=r}}class P$ extends Ms{constructor(e,r){super(e,r,g$,$l),this.core=e,this.logger=r}}class O$ extends Ms{constructor(e,r){super(e,r,m$,$l,i=>i.id),this.core=e,this.logger=r}}var D$=Object.defineProperty,N$=(t,e,r)=>e in t?D$(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ah=(t,e,r)=>N$(t,typeof e!="symbol"?e+"":e,r);class C${constructor(e,r){this.core=e,this.logger=r,ah(this,"authKeys"),ah(this,"pairingTopics"),ah(this,"requests"),this.authKeys=new S$(this.core,this.logger),this.pairingTopics=new P$(this.core,this.logger),this.requests=new O$(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}var B$=Object.defineProperty,R$=(t,e,r)=>e in t?B$(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ge=(t,e,r)=>R$(t,typeof e!="symbol"?e+"":e,r);class Sd extends XB{constructor(e){super(e),ge(this,"protocol",Dv),ge(this,"version",Nv),ge(this,"name",sh.name),ge(this,"metadata"),ge(this,"core"),ge(this,"logger"),ge(this,"events",new Or.EventEmitter),ge(this,"engine"),ge(this,"session"),ge(this,"proposal"),ge(this,"pendingRequest"),ge(this,"auth"),ge(this,"signConfig"),ge(this,"on",(i,n)=>this.events.on(i,n)),ge(this,"once",(i,n)=>this.events.once(i,n)),ge(this,"off",(i,n)=>this.events.off(i,n)),ge(this,"removeListener",(i,n)=>this.events.removeListener(i,n)),ge(this,"removeAllListeners",i=>this.events.removeAllListeners(i)),ge(this,"connect",async i=>{try{return await this.engine.connect(i)}catch(n){throw this.logger.error(n.message),n}}),ge(this,"pair",async i=>{try{return await this.engine.pair(i)}catch(n){throw this.logger.error(n.message),n}}),ge(this,"approve",async i=>{try{return await this.engine.approve(i)}catch(n){throw this.logger.error(n.message),n}}),ge(this,"reject",async i=>{try{return await this.engine.reject(i)}catch(n){throw this.logger.error(n.message),n}}),ge(this,"update",async i=>{try{return await this.engine.update(i)}catch(n){throw this.logger.error(n.message),n}}),ge(this,"extend",async i=>{try{return await this.engine.extend(i)}catch(n){throw this.logger.error(n.message),n}}),ge(this,"request",async i=>{try{return await this.engine.request(i)}catch(n){throw this.logger.error(n.message),n}}),ge(this,"respond",async i=>{try{return await this.engine.respond(i)}catch(n){throw this.logger.error(n.message),n}}),ge(this,"ping",async i=>{try{return await this.engine.ping(i)}catch(n){throw this.logger.error(n.message),n}}),ge(this,"emit",async i=>{try{return await this.engine.emit(i)}catch(n){throw this.logger.error(n.message),n}}),ge(this,"disconnect",async i=>{try{return await this.engine.disconnect(i)}catch(n){throw this.logger.error(n.message),n}}),ge(this,"find",i=>{try{return this.engine.find(i)}catch(n){throw this.logger.error(n.message),n}}),ge(this,"getPendingSessionRequests",()=>{try{return this.engine.getPendingSessionRequests()}catch(i){throw this.logger.error(i.message),i}}),ge(this,"authenticate",async(i,n)=>{try{return await this.engine.authenticate(i,n)}catch(s){throw this.logger.error(s.message),s}}),ge(this,"formatAuthMessage",i=>{try{return this.engine.formatAuthMessage(i)}catch(n){throw this.logger.error(n.message),n}}),ge(this,"approveSessionAuthenticate",async i=>{try{return await this.engine.approveSessionAuthenticate(i)}catch(n){throw this.logger.error(n.message),n}}),ge(this,"rejectSessionAuthenticate",async i=>{try{return await this.engine.rejectSessionAuthenticate(i)}catch(n){throw this.logger.error(n.message),n}}),this.name=(e==null?void 0:e.name)||sh.name,this.metadata=jP(e==null?void 0:e.metadata),this.signConfig=e==null?void 0:e.signConfig;const r=Ed({logger:(e==null?void 0:e.logger)||sh.logger,name:this.name});this.logger=r,this.core=(e==null?void 0:e.core)||new s$(e),this.session=new _$(this.core,this.logger),this.proposal=new A$(this.core,this.logger),this.pendingRequest=new I$(this.core,this.logger),this.engine=new x$(this),this.auth=new C$(this.core,this.logger)}static async init(e){const r=new Sd(e);return await r.initialize(),r}get context(){return pr(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}}const T$=Sd;var yf={exports:{}};(function(t,e){var r=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof Ur<"u"&&Ur,i=function(){function s(){this.fetch=!1,this.DOMException=r.DOMException}return s.prototype=r,new s}();(function(s){(function(o){var a=typeof s<"u"&&s||typeof self<"u"&&self||typeof Ur<"u"&&Ur||{},c={searchParams:"URLSearchParams"in a,iterable:"Symbol"in a&&"iterator"in Symbol,blob:"FileReader"in a&&"Blob"in a&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in a,arrayBuffer:"ArrayBuffer"in a};function l(f){return f&&DataView.prototype.isPrototypeOf(f)}if(c.arrayBuffer)var u=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],h=ArrayBuffer.isView||function(f){return f&&u.indexOf(Object.prototype.toString.call(f))>-1};function g(f){if(typeof f!="string"&&(f=String(f)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(f)||f==="")throw new TypeError('Invalid character in header field name: "'+f+'"');return f.toLowerCase()}function y(f){return typeof f!="string"&&(f=String(f)),f}function w(f){var p={next:function(){var b=f.shift();return{done:b===void 0,value:b}}};return c.iterable&&(p[Symbol.iterator]=function(){return p}),p}function E(f){this.map={},f instanceof E?f.forEach(function(p,b){this.append(b,p)},this):Array.isArray(f)?f.forEach(function(p){if(p.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+p.length);this.append(p[0],p[1])},this):f&&Object.getOwnPropertyNames(f).forEach(function(p){this.append(p,f[p])},this)}E.prototype.append=function(f,p){f=g(f),p=y(p);var b=this.map[f];this.map[f]=b?b+", "+p:p},E.prototype.delete=function(f){delete this.map[g(f)]},E.prototype.get=function(f){return f=g(f),this.has(f)?this.map[f]:null},E.prototype.has=function(f){return this.map.hasOwnProperty(g(f))},E.prototype.set=function(f,p){this.map[g(f)]=y(p)},E.prototype.forEach=function(f,p){for(var b in this.map)this.map.hasOwnProperty(b)&&f.call(p,this.map[b],b,this)},E.prototype.keys=function(){var f=[];return this.forEach(function(p,b){f.push(b)}),w(f)},E.prototype.values=function(){var f=[];return this.forEach(function(p){f.push(p)}),w(f)},E.prototype.entries=function(){var f=[];return this.forEach(function(p,b){f.push([b,p])}),w(f)},c.iterable&&(E.prototype[Symbol.iterator]=E.prototype.entries);function P(f){if(!f._noBody){if(f.bodyUsed)return Promise.reject(new TypeError("Already read"));f.bodyUsed=!0}}function N(f){return new Promise(function(p,b){f.onload=function(){p(f.result)},f.onerror=function(){b(f.error)}})}function R(f){var p=new FileReader,b=N(p);return p.readAsArrayBuffer(f),b}function D(f){var p=new FileReader,b=N(p),x=/charset=([A-Za-z0-9_-]+)/.exec(f.type),_=x?x[1]:"utf-8";return p.readAsText(f,_),b}function C(f){for(var p=new Uint8Array(f),b=new Array(p.length),x=0;x<p.length;x++)b[x]=String.fromCharCode(p[x]);return b.join("")}function B(f){if(f.slice)return f.slice(0);var p=new Uint8Array(f.byteLength);return p.set(new Uint8Array(f)),p.buffer}function M(){return this.bodyUsed=!1,this._initBody=function(f){this.bodyUsed=this.bodyUsed,this._bodyInit=f,f?typeof f=="string"?this._bodyText=f:c.blob&&Blob.prototype.isPrototypeOf(f)?this._bodyBlob=f:c.formData&&FormData.prototype.isPrototypeOf(f)?this._bodyFormData=f:c.searchParams&&URLSearchParams.prototype.isPrototypeOf(f)?this._bodyText=f.toString():c.arrayBuffer&&c.blob&&l(f)?(this._bodyArrayBuffer=B(f.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):c.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(f)||h(f))?this._bodyArrayBuffer=B(f):this._bodyText=f=Object.prototype.toString.call(f):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof f=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):c.searchParams&&URLSearchParams.prototype.isPrototypeOf(f)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},c.blob&&(this.blob=function(){var f=P(this);if(f)return f;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var f=P(this);return f||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(c.blob)return this.blob().then(R);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var f=P(this);if(f)return f;if(this._bodyBlob)return D(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(C(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},c.formData&&(this.formData=function(){return this.text().then(V)}),this.json=function(){return this.text().then(JSON.parse)},this}var L=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function F(f){var p=f.toUpperCase();return L.indexOf(p)>-1?p:f}function k(f,p){if(!(this instanceof k))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');p=p||{};var b=p.body;if(f instanceof k){if(f.bodyUsed)throw new TypeError("Already read");this.url=f.url,this.credentials=f.credentials,p.headers||(this.headers=new E(f.headers)),this.method=f.method,this.mode=f.mode,this.signal=f.signal,!b&&f._bodyInit!=null&&(b=f._bodyInit,f.bodyUsed=!0)}else this.url=String(f);if(this.credentials=p.credentials||this.credentials||"same-origin",(p.headers||!this.headers)&&(this.headers=new E(p.headers)),this.method=F(p.method||this.method||"GET"),this.mode=p.mode||this.mode||null,this.signal=p.signal||this.signal||function(){if("AbortController"in a){var S=new AbortController;return S.signal}}(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&b)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(b),(this.method==="GET"||this.method==="HEAD")&&(p.cache==="no-store"||p.cache==="no-cache")){var x=/([?&])_=[^&]*/;if(x.test(this.url))this.url=this.url.replace(x,"$1_="+new Date().getTime());else{var _=/\?/;this.url+=(_.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}k.prototype.clone=function(){return new k(this,{body:this._bodyInit})};function V(f){var p=new FormData;return f.trim().split("&").forEach(function(b){if(b){var x=b.split("="),_=x.shift().replace(/\+/g," "),S=x.join("=").replace(/\+/g," ");p.append(decodeURIComponent(_),decodeURIComponent(S))}}),p}function H(f){var p=new E,b=f.replace(/\r?\n[\t ]+/g," ");return b.split("\r").map(function(x){return x.indexOf(`
`)===0?x.substr(1,x.length):x}).forEach(function(x){var _=x.split(":"),S=_.shift().trim();if(S){var I=_.join(":").trim();try{p.append(S,I)}catch(m){console.warn("Response "+m.message)}}}),p}M.call(k.prototype);function $(f,p){if(!(this instanceof $))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(p||(p={}),this.type="default",this.status=p.status===void 0?200:p.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=p.statusText===void 0?"":""+p.statusText,this.headers=new E(p.headers),this.url=p.url||"",this._initBody(f)}M.call($.prototype),$.prototype.clone=function(){return new $(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new E(this.headers),url:this.url})},$.error=function(){var f=new $(null,{status:200,statusText:""});return f.ok=!1,f.status=0,f.type="error",f};var A=[301,302,303,307,308];$.redirect=function(f,p){if(A.indexOf(p)===-1)throw new RangeError("Invalid status code");return new $(null,{status:p,headers:{location:f}})},o.DOMException=a.DOMException;try{new o.DOMException}catch{o.DOMException=function(p,b){this.message=p,this.name=b;var x=Error(p);this.stack=x.stack},o.DOMException.prototype=Object.create(Error.prototype),o.DOMException.prototype.constructor=o.DOMException}function d(f,p){return new Promise(function(b,x){var _=new k(f,p);if(_.signal&&_.signal.aborted)return x(new o.DOMException("Aborted","AbortError"));var S=new XMLHttpRequest;function I(){S.abort()}S.onload=function(){var j={statusText:S.statusText,headers:H(S.getAllResponseHeaders()||"")};_.url.indexOf("file://")===0&&(S.status<200||S.status>599)?j.status=200:j.status=S.status,j.url="responseURL"in S?S.responseURL:j.headers.get("X-Request-URL");var v="response"in S?S.response:S.responseText;setTimeout(function(){b(new $(v,j))},0)},S.onerror=function(){setTimeout(function(){x(new TypeError("Network request failed"))},0)},S.ontimeout=function(){setTimeout(function(){x(new TypeError("Network request timed out"))},0)},S.onabort=function(){setTimeout(function(){x(new o.DOMException("Aborted","AbortError"))},0)};function m(j){try{return j===""&&a.location.href?a.location.href:j}catch{return j}}if(S.open(_.method,m(_.url),!0),_.credentials==="include"?S.withCredentials=!0:_.credentials==="omit"&&(S.withCredentials=!1),"responseType"in S&&(c.blob?S.responseType="blob":c.arrayBuffer&&(S.responseType="arraybuffer")),p&&typeof p.headers=="object"&&!(p.headers instanceof E||a.Headers&&p.headers instanceof a.Headers)){var O=[];Object.getOwnPropertyNames(p.headers).forEach(function(j){O.push(g(j)),S.setRequestHeader(j,y(p.headers[j]))}),_.headers.forEach(function(j,v){O.indexOf(v)===-1&&S.setRequestHeader(v,j)})}else _.headers.forEach(function(j,v){S.setRequestHeader(v,j)});_.signal&&(_.signal.addEventListener("abort",I),S.onreadystatechange=function(){S.readyState===4&&_.signal.removeEventListener("abort",I)}),S.send(typeof _._bodyInit>"u"?null:_._bodyInit)})}return d.polyfill=!0,a.fetch||(a.fetch=d,a.Headers=E,a.Request=k,a.Response=$),o.Headers=E,o.Request=k,o.Response=$,o.fetch=d,Object.defineProperty(o,"__esModule",{value:!0}),o})({})})(i),i.fetch.ponyfill=!0,delete i.fetch.polyfill;var n=r.fetch?r:i;e=n.fetch,e.default=n.fetch,e.fetch=n.fetch,e.Headers=n.Headers,e.Request=n.Request,e.Response=n.Response,t.exports=e})(yf,yf.exports);var M$=yf.exports;const ym=Os(M$);var k$=Object.defineProperty,$$=Object.defineProperties,U$=Object.getOwnPropertyDescriptors,wm=Object.getOwnPropertySymbols,L$=Object.prototype.hasOwnProperty,F$=Object.prototype.propertyIsEnumerable,bm=(t,e,r)=>e in t?k$(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,vm=(t,e)=>{for(var r in e||(e={}))L$.call(e,r)&&bm(t,r,e[r]);if(wm)for(var r of wm(e))F$.call(e,r)&&bm(t,r,e[r]);return t},Em=(t,e)=>$$(t,U$(e));const q$={Accept:"application/json","Content-Type":"application/json"},j$="POST",xm={headers:q$,method:j$},Am=10;let Bv=class{constructor(e,r=!1){if(this.url=e,this.disableProviderPing=r,this.events=new Or.EventEmitter,this.isAvailable=!1,this.registering=!1,!Fg(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=r}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e){this.isAvailable||await this.register();try{const r=rn(e),i=await(await ym(this.url,Em(vm({},xm),{body:r}))).json();this.onPayload({data:i})}catch(r){this.onError(e.id,r)}}async register(e=this.url){if(!Fg(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((i,n)=>{this.events.once("register_error",s=>{this.resetMaxListeners(),n(s)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return n(new Error("HTTP connection is missing or invalid"));i()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const r=rn({id:1,jsonrpc:"2.0",method:"test",params:[]});await ym(e,Em(vm({},xm),{body:r}))}this.onOpen()}catch(r){const i=this.parseError(r);throw this.events.emit("register_error",i),this.onClose(),i}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?_s(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const i=this.parseError(r),n=i.message||i.toString(),s=Tl(e,n);this.events.emit("payload",s)}parseError(e,r=this.url){return cv(e,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Am&&this.events.setMaxListeners(Am)}};function Pd(t){return t==null||typeof t!="object"&&typeof t!="function"}function Rv(t){return Object.getOwnPropertySymbols(t).filter(e=>Object.prototype.propertyIsEnumerable.call(t,e))}function Tv(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const z$="[object RegExp]",Mv="[object String]",kv="[object Number]",$v="[object Boolean]",Uv="[object Arguments]",H$="[object Symbol]",K$="[object Date]",V$="[object Map]",G$="[object Set]",W$="[object Array]",Y$="[object ArrayBuffer]",J$="[object Object]",Q$="[object DataView]",Z$="[object Uint8Array]",X$="[object Uint8ClampedArray]",e9="[object Uint16Array]",t9="[object Uint32Array]",r9="[object Int8Array]",i9="[object Int16Array]",n9="[object Int32Array]",s9="[object Float32Array]",o9="[object Float64Array]";function Od(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function a9(t,e){return Qs(t,void 0,t,new Map,e)}function Qs(t,e,r,i=new Map,n=void 0){const s=n==null?void 0:n(t,e,r,i);if(s!=null)return s;if(Pd(t))return t;if(i.has(t))return i.get(t);if(Array.isArray(t)){const o=new Array(t.length);i.set(t,o);for(let a=0;a<t.length;a++)o[a]=Qs(t[a],a,r,i,n);return Object.hasOwn(t,"index")&&(o.index=t.index),Object.hasOwn(t,"input")&&(o.input=t.input),o}if(t instanceof Date)return new Date(t.getTime());if(t instanceof RegExp){const o=new RegExp(t.source,t.flags);return o.lastIndex=t.lastIndex,o}if(t instanceof Map){const o=new Map;i.set(t,o);for(const[a,c]of t)o.set(a,Qs(c,a,r,i,n));return o}if(t instanceof Set){const o=new Set;i.set(t,o);for(const a of t)o.add(Qs(a,void 0,r,i,n));return o}if(typeof Buffer<"u"&&Buffer.isBuffer(t))return t.subarray();if(Od(t)){const o=new(Object.getPrototypeOf(t)).constructor(t.length);i.set(t,o);for(let a=0;a<t.length;a++)o[a]=Qs(t[a],a,r,i,n);return o}if(t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer)return t.slice(0);if(t instanceof DataView){const o=new DataView(t.buffer.slice(0),t.byteOffset,t.byteLength);return i.set(t,o),us(o,t,r,i,n),o}if(typeof File<"u"&&t instanceof File){const o=new File([t],t.name,{type:t.type});return i.set(t,o),us(o,t,r,i,n),o}if(t instanceof Blob){const o=new Blob([t],{type:t.type});return i.set(t,o),us(o,t,r,i,n),o}if(t instanceof Error){const o=new t.constructor;return i.set(t,o),o.message=t.message,o.name=t.name,o.stack=t.stack,o.cause=t.cause,us(o,t,r,i,n),o}if(typeof t=="object"&&c9(t)){const o=Object.create(Object.getPrototypeOf(t));return i.set(t,o),us(o,t,r,i,n),o}return t}function us(t,e,r=t,i,n){const s=[...Object.keys(e),...Rv(e)];for(let o=0;o<s.length;o++){const a=s[o],c=Object.getOwnPropertyDescriptor(t,a);(c==null||c.writable)&&(t[a]=Qs(e[a],a,r,i,n))}}function c9(t){switch(Tv(t)){case Uv:case W$:case Y$:case Q$:case $v:case K$:case s9:case o9:case r9:case i9:case n9:case V$:case kv:case J$:case z$:case G$:case Mv:case H$:case Z$:case X$:case e9:case t9:return!0;default:return!1}}function l9(t,e){return a9(t,(r,i,n,s)=>{if(typeof t=="object")switch(Object.prototype.toString.call(t)){case kv:case Mv:case $v:{const o=new t.constructor(t==null?void 0:t.valueOf());return us(o,t),o}case Uv:{const o={};return us(o,t),o.length=t.length,o[Symbol.iterator]=t[Symbol.iterator],o}default:return}})}function _m(t){return l9(t)}function Im(t){return t!==null&&typeof t=="object"&&Tv(t)==="[object Arguments]"}function Sm(t){return typeof t=="object"&&t!==null}function u9(){}function h9(t){return Od(t)}function f9(t){var r;if(typeof t!="object"||t==null)return!1;if(Object.getPrototypeOf(t)===null)return!0;if(Object.prototype.toString.call(t)!=="[object Object]"){const i=t[Symbol.toStringTag];return i==null||!((r=Object.getOwnPropertyDescriptor(t,Symbol.toStringTag))!=null&&r.writable)?!1:t.toString()===`[object ${i}]`}let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function d9(t){if(Pd(t))return t;if(Array.isArray(t)||Od(t)||t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer)return t.slice(0);const e=Object.getPrototypeOf(t),r=e.constructor;if(t instanceof Date||t instanceof Map||t instanceof Set)return new r(t);if(t instanceof RegExp){const i=new r(t);return i.lastIndex=t.lastIndex,i}if(t instanceof DataView)return new r(t.buffer.slice(0));if(t instanceof Error){const i=new r(t.message);return i.stack=t.stack,i.name=t.name,i.cause=t.cause,i}if(typeof File<"u"&&t instanceof File)return new r([t],t.name,{type:t.type,lastModified:t.lastModified});if(typeof t=="object"){const i=Object.create(e);return Object.assign(i,t)}return t}function p9(t,...e){const r=e.slice(0,-1),i=e[e.length-1];let n=t;for(let s=0;s<r.length;s++){const o=r[s];n=wf(n,o,i,new Map)}return n}function wf(t,e,r,i){if(Pd(t)&&(t=Object(t)),e==null||typeof e!="object")return t;if(i.has(e))return d9(i.get(e));if(i.set(e,t),Array.isArray(e)){e=e.slice();for(let s=0;s<e.length;s++)e[s]=e[s]??void 0}const n=[...Object.keys(e),...Rv(e)];for(let s=0;s<n.length;s++){const o=n[s];let a=e[o],c=t[o];if(Im(a)&&(a={...a}),Im(c)&&(c={...c}),typeof Buffer<"u"&&Buffer.isBuffer(a)&&(a=_m(a)),Array.isArray(a))if(typeof c=="object"&&c!=null){const u=[],h=Reflect.ownKeys(c);for(let g=0;g<h.length;g++){const y=h[g];u[y]=c[y]}c=u}else c=[];const l=r(c,a,o,t,e,i);l!=null?t[o]=l:Array.isArray(a)||Sm(c)&&Sm(a)?t[o]=wf(c,a,r,i):c==null&&f9(a)?t[o]=wf({},a,r,i):c==null&&h9(a)?t[o]=_m(a):(c===void 0||a!==void 0)&&(t[o]=a)}return t}function g9(t,...e){return p9(t,...e,u9)}const Pm="error",m9="wss://relay.walletconnect.org",y9="wc",Lv="universal_provider",lc=`${y9}@2:${Lv}:`,Fv="https://rpc.walletconnect.org/v1/",qv="generic",w9=`${Fv}bundler`,ao="call_status",b9=86400,Dd={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var v9=Object.defineProperty,E9=Object.defineProperties,x9=Object.getOwnPropertyDescriptors,Om=Object.getOwnPropertySymbols,A9=Object.prototype.hasOwnProperty,_9=Object.prototype.propertyIsEnumerable,Dm=(t,e,r)=>e in t?v9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,uc=(t,e)=>{for(var r in e||(e={}))A9.call(e,r)&&Dm(t,r,e[r]);if(Om)for(var r of Om(e))_9.call(e,r)&&Dm(t,r,e[r]);return t},I9=(t,e)=>E9(t,x9(e));function jv(t,e,r){var i;const n=Qi(t);return((i=e.rpcMap)==null?void 0:i[n.reference])||`${Fv}?chainId=${n.namespace}:${n.reference}&projectId=${r}`}function S9(t){return t.includes(":")?t.split(":")[1]:t}function zv(t){return t.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function P9(t,e){const r=Object.keys(e.namespaces).filter(n=>n.includes(t));if(!r.length)return[];const i=[];return r.forEach(n=>{const s=e.namespaces[n].accounts;i.push(...s)}),i}function Nm(t){return Object.fromEntries(Object.entries(t).filter(([e,r])=>{var i,n;return((i=r==null?void 0:r.chains)==null?void 0:i.length)&&((n=r==null?void 0:r.chains)==null?void 0:n.length)>0}))}function hc(t={},e={}){const r=Nm(Cm(t)),i=Nm(Cm(e));return g9(r,i)}function Cm(t){var e,r,i,n,s;const o={};if(!Ii(t))return o;for(const[a,c]of Object.entries(t)){const l=Rl(a)?[a]:c.chains,u=c.methods||[],h=c.events||[],g=c.rpcMap||{},y=Js(a);o[y]=I9(uc(uc({},o[y]),c),{chains:_i(l,(e=o[y])==null?void 0:e.chains),methods:_i(u,(r=o[y])==null?void 0:r.methods),events:_i(h,(i=o[y])==null?void 0:i.events)}),(Ii(g)||Ii(((n=o[y])==null?void 0:n.rpcMap)||{}))&&(o[y].rpcMap=uc(uc({},g),(s=o[y])==null?void 0:s.rpcMap))}return o}function Bm(t){return t.includes(":")?t.split(":")[2]:t}function Rm(t){const e={};for(const[r,i]of Object.entries(t)){const n=i.methods||[],s=i.events||[],o=i.accounts||[],a=Rl(r)?[r]:i.chains?i.chains:zv(i.accounts);e[r]={chains:a,methods:n,events:s,accounts:o}}return e}function ch(t){return typeof t=="number"?t:t.includes("0x")?parseInt(t,16):(t=t.includes(":")?t.split(":")[1]:t,isNaN(Number(t))?t:Number(t))}function O9(t){try{const e=JSON.parse(t);return typeof e=="object"&&e!==null&&!Array.isArray(e)}catch{return!1}}const Hv={},co=t=>Hv[t],lh=(t,e)=>{Hv[t]=e};var D9=Object.defineProperty,Tm=Object.getOwnPropertySymbols,N9=Object.prototype.hasOwnProperty,C9=Object.prototype.propertyIsEnumerable,Mm=(t,e,r)=>e in t?D9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,km=(t,e)=>{for(var r in e||(e={}))N9.call(e,r)&&Mm(t,r,e[r]);if(Tm)for(var r of Tm(e))C9.call(e,r)&&Mm(t,r,e[r]);return t};const $m="eip155",B9=["atomic","flow-control","paymasterService","sessionKeys","auxiliaryFunds"],R9=t=>t&&t.startsWith("0x")?BigInt(t).toString(10):t,uh=t=>t&&t.startsWith("0x")?t:`0x${BigInt(t).toString(16)}`,Um=t=>Object.keys(t).filter(e=>B9.includes(e)).reduce((e,r)=>(e[r]=T9(t[r]),e),{}),T9=t=>typeof t=="string"&&O9(t)?JSON.parse(t):t,M9=(t,e,r)=>{const{sessionProperties:i={},scopedProperties:n={}}=t,s={};if(!Ii(n)&&!Ii(i))return;const o=Um(i);for(const a of r){const c=R9(a);if(!c)continue;s[uh(c)]=o;const l=n==null?void 0:n[`${$m}:${c}`];if(l){const u=l==null?void 0:l[`${$m}:${c}:${e}`];s[uh(c)]=km(km({},s[uh(c)]),Um(u||l))}}for(const[a,c]of Object.entries(s))Object.keys(c).length===0&&delete s[a];return Object.keys(s).length>0?s:void 0};var k9=Object.defineProperty,$9=(t,e,r)=>e in t?k9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,U9=(t,e,r)=>$9(t,e+"",r);let hh,L9=class Kv{constructor(e){U9(this,"storage"),this.storage=e}async getItem(e){return await this.storage.getItem(e)}async setItem(e,r){return await this.storage.setItem(e,r)}async removeItem(e){return await this.storage.removeItem(e)}static getStorage(e){return hh||(hh=new Kv(e)),hh}};var F9=Object.defineProperty,q9=Object.defineProperties,j9=Object.getOwnPropertyDescriptors,Lm=Object.getOwnPropertySymbols,z9=Object.prototype.hasOwnProperty,H9=Object.prototype.propertyIsEnumerable,Fm=(t,e,r)=>e in t?F9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,K9=(t,e)=>{for(var r in e||(e={}))z9.call(e,r)&&Fm(t,r,e[r]);if(Lm)for(var r of Lm(e))H9.call(e,r)&&Fm(t,r,e[r]);return t},V9=(t,e)=>q9(t,j9(e));async function G9(t,e){const r=Qi(t.result.capabilities.caip345.caip2),i=t.result.capabilities.caip345.transactionHashes,n=await Promise.allSettled(i.map(h=>W9(r.reference,h,e))),s=n.filter(h=>h.status==="fulfilled").map(h=>h.value).filter(h=>h);n.filter(h=>h.status==="rejected").forEach(h=>console.warn("Failed to fetch transaction receipt:",h.reason));const o=!s.length||s.some(h=>!h),a=s.every(h=>(h==null?void 0:h.status)==="0x1"),c=s.every(h=>(h==null?void 0:h.status)==="0x0"),l=s.some(h=>(h==null?void 0:h.status)==="0x0");let u;return o?u=100:a?u=200:c?u=500:l&&(u=600),{id:t.result.id,version:t.request.version,atomic:t.request.atomicRequired,chainId:t.request.chainId,capabilities:t.result.capabilities,receipts:s,status:u}}async function W9(t,e,r){return await r(parseInt(t)).request(ti("eth_getTransactionReceipt",[e]))}async function Y9({sendCalls:t,storage:e}){const r=await e.getItem(ao);await e.setItem(ao,V9(K9({},r),{[t.result.id]:{request:t.request,result:t.result,expiry:dt(b9)}}))}async function J9({resultId:t,storage:e}){const r=await e.getItem(ao);if(r){delete r[t],await e.setItem(ao,r);for(const i in r)bi(r[i].expiry)&&delete r[i];await e.setItem(ao,r)}}async function Q9({resultId:t,storage:e}){const r=await e.getItem(ao),i=r==null?void 0:r[t];if(i&&!bi(i.expiry))return i;await J9({resultId:t,storage:e})}var Z9=Object.defineProperty,X9=Object.defineProperties,e7=Object.getOwnPropertyDescriptors,qm=Object.getOwnPropertySymbols,t7=Object.prototype.hasOwnProperty,r7=Object.prototype.propertyIsEnumerable,bf=(t,e,r)=>e in t?Z9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,fh=(t,e)=>{for(var r in e||(e={}))t7.call(e,r)&&bf(t,r,e[r]);if(qm)for(var r of qm(e))r7.call(e,r)&&bf(t,r,e[r]);return t},dh=(t,e)=>X9(t,e7(e)),ss=(t,e,r)=>bf(t,typeof e!="symbol"?e+"":e,r);class i7{constructor(e){ss(this,"name","eip155"),ss(this,"client"),ss(this,"chainId"),ss(this,"namespace"),ss(this,"httpProviders"),ss(this,"events"),ss(this,"storage"),this.namespace=e.namespace,this.events=co("events"),this.client=co("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain()),this.storage=L9.getStorage(this.client.core.storage)}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(e);case"wallet_getCallsStatus":return await this.getCallStatus(e);case"wallet_sendCalls":return await this.sendCalls(e)}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(parseInt(e),r);const i=this.chainId;this.chainId=parseInt(e),this.events.emit(Dd.DEFAULT_CHAIN_CHANGED,{currentCaipChainId:`${this.name}:${e}`,previousCaipChainId:`${this.name}:${i}`})}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,r){const i=r||jv(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new _d(new Bv(i,co("disableProviderPing")))}setHttpProvider(e,r){const i=this.createHttpProvider(e,r);i&&(this.httpProviders[e]=i)}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var i;const n=parseInt(S9(r));e[n]=this.createHttpProvider(n,(i=this.namespace.rpcMap)==null?void 0:i[r])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(e){const r=e||this.chainId;return this.httpProviders[r]||(this.httpProviders=dh(fh({},this.httpProviders),{[r]:this.createHttpProvider(r)}),this.httpProviders[r])}async handleSwitchChain(e){var r,i;let n=e.request.params?(r=e.request.params[0])==null?void 0:r.chainId:"0x0";n=n.startsWith("0x")?n:`0x${n}`;const s=parseInt(n,16);if(this.isChainApproved(s))this.setDefaultChain(`${s}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:n}]},chainId:(i=this.namespace.chains)==null?void 0:i[0]}),this.setDefaultChain(`${s}`);else throw new Error(`Failed to switch to chain 'eip155:${s}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}async getCapabilities(e){var r,i,n,s,o;const a=(i=(r=e.request)==null?void 0:r.params)==null?void 0:i[0],c=((s=(n=e.request)==null?void 0:n.params)==null?void 0:s[1])||[];if(!a)throw new Error("Missing address parameter in `wallet_getCapabilities` request");const l=this.client.session.get(e.topic),u=((o=l==null?void 0:l.sessionProperties)==null?void 0:o.capabilities)||{},h=`${a}${c.join(",")}`,g=u==null?void 0:u[h];if(g)return g;let y;try{y=M9(l,a,c)}catch(E){console.warn("Failed to extract capabilities from session",E)}if(y)return y;const w=await this.client.request(e);try{await this.client.session.update(e.topic,{sessionProperties:dh(fh({},l.sessionProperties||{}),{capabilities:dh(fh({},u||{}),{[h]:w})})})}catch(E){console.warn("Failed to update session with capabilities",E)}return w}async getCallStatus(e){var r,i,n;const s=this.client.session.get(e.topic),o=(r=s.sessionProperties)==null?void 0:r.bundler_name;if(o){const l=this.getBundlerUrl(e.chainId,o);try{return await this.getUserOperationReceipt(l,e)}catch(u){console.warn("Failed to fetch call status from bundler",u,l)}}const a=(i=s.sessionProperties)==null?void 0:i.bundler_url;if(a)try{return await this.getUserOperationReceipt(a,e)}catch(l){console.warn("Failed to fetch call status from custom bundler",l,a)}const c=await Q9({resultId:(n=e.request.params)==null?void 0:n[0],storage:this.storage});if(c)try{return await G9(c,this.getHttpProvider.bind(this))}catch(l){console.warn("Failed to fetch call status from stored send calls",l,c)}if(this.namespace.methods.includes(e.request.method))return await this.client.request(e);throw new Error("Fetching call status not approved by the wallet.")}async getUserOperationReceipt(e,r){var i;const n=new URL(e),s=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ti("eth_getUserOperationReceipt",[(i=r.request.params)==null?void 0:i[0]]))});if(!s.ok)throw new Error(`Failed to fetch user operation receipt - ${s.status}`);return await s.json()}getBundlerUrl(e,r){return`${w9}?projectId=${this.client.core.projectId}&chainId=${e}&bundler=${r}`}async sendCalls(e){var r,i,n;const s=await this.client.request(e),o=(r=e.request.params)==null?void 0:r[0],a=s==null?void 0:s.id,c=(s==null?void 0:s.capabilities)||{},l=(i=c==null?void 0:c.caip345)==null?void 0:i.caip2,u=(n=c==null?void 0:c.caip345)==null?void 0:n.transactionHashes;return!a||!l||!(u!=null&&u.length)||await Y9({sendCalls:{request:o,result:s},storage:this.storage}),s}}var n7=Object.defineProperty,s7=(t,e,r)=>e in t?n7(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ks=(t,e,r)=>s7(t,typeof e!="symbol"?e+"":e,r);class o7{constructor(e){Ks(this,"name",qv),Ks(this,"client"),Ks(this,"httpProviders"),Ks(this,"events"),Ks(this,"namespace"),Ks(this,"chainId"),this.namespace=e.namespace,this.events=co("events"),this.client=co("client"),this.chainId=this.getDefaultChain(),this.name=this.getNamespaceName(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(e.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(e.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(e.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(e.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider(e.chainId).request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r);const i=this.chainId;this.chainId=e,this.events.emit(Dd.DEFAULT_CHAIN_CHANGED,{currentCaipChainId:`${this.name}:${e}`,previousCaipChainId:`${this.name}:${i}`})}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getNamespaceName(){const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return Qi(e).namespace}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){var e,r;const i={};return(r=(e=this.namespace)==null?void 0:e.accounts)==null||r.forEach(n=>{var s,o;const a=Qi(n),c=(o=(s=this.namespace)==null?void 0:s.rpcMap)==null?void 0:o[`${a.namespace}:${a.reference}`];i[a.reference]=this.createHttpProvider(n,c)}),i}getHttpProvider(e){const r=Qi(e).reference,i=this.httpProviders[r];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return i}setHttpProvider(e,r){const i=this.createHttpProvider(e,r);i&&(this.httpProviders[e]=i)}createHttpProvider(e,r){const i=r||jv(e,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new _d(new Bv(i,co("disableProviderPing")))}}var a7=Object.defineProperty,c7=Object.defineProperties,l7=Object.getOwnPropertyDescriptors,jm=Object.getOwnPropertySymbols,u7=Object.prototype.hasOwnProperty,h7=Object.prototype.propertyIsEnumerable,vf=(t,e,r)=>e in t?a7(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Yo=(t,e)=>{for(var r in e||(e={}))u7.call(e,r)&&vf(t,r,e[r]);if(jm)for(var r of jm(e))h7.call(e,r)&&vf(t,r,e[r]);return t},fc=(t,e)=>c7(t,l7(e)),mr=(t,e,r)=>vf(t,typeof e!="symbol"?e+"":e,r);class Nd{constructor(e){mr(this,"client"),mr(this,"namespaces"),mr(this,"optionalNamespaces"),mr(this,"sessionProperties"),mr(this,"scopedProperties"),mr(this,"events",new Uf),mr(this,"rpcProviders",{}),mr(this,"session"),mr(this,"providerOpts"),mr(this,"logger"),mr(this,"uri"),mr(this,"disableProviderPing",!1),mr(this,"connectParams");var r,i;this.providerOpts=e,this.logger=Ed({logger:(r=e.logger)!=null?r:Pm,name:(i=this.providerOpts.name)!=null?i:Lv}),this.disableProviderPing=(e==null?void 0:e.disableProviderPing)||!1}static async init(e){const r=new Nd(e);return await r.initialize(),r}async request(e,r,i){const[n,s]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(n).request({request:Yo({},e),chainId:`${n}:${s}`,topic:this.session.topic,expiry:i})}sendAsync(e,r,i,n){const s=new Date().getTime();this.request(e,i,n).then(o=>r(null,Aa(s,o))).catch(o=>r(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:ot("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.connectParams=e,this.setNamespaces(e),this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}async authenticate(e,r){if(!this.client)throw new Error("Sign Client not initialized");this.setNamespaces(e),await this.cleanupPendingPairings();const{uri:i,response:n}=await this.client.authenticate(e,r);i&&(this.uri=i,this.events.emit("display_uri",i));const s=await n();if(this.session=s.session,this.session){const o=Rm(this.session.namespaces);this.namespaces=hc(this.namespaces,o),await this.persist("namespaces",this.namespaces),this.onConnect()}return s}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}removeListener(e,r){this.events.removeListener(e,r)}off(e,r){this.events.off(e,r)}get isWalletConnect(){return!0}async pair(e){var r,i;const{uri:n,approval:s}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties,authentication:(r=this.connectParams)==null?void 0:r.authentication,walletPay:(i=this.connectParams)==null?void 0:i.walletPay});n&&(this.uri=n,this.events.emit("display_uri",n));const o=await s();this.session=o;const a=Rm(o.namespaces);return this.namespaces=hc(this.namespaces,a),await this.persist("namespaces",this.namespaces),await this.persist("optionalNamespaces",this.optionalNamespaces),this.onConnect(),this.session}setDefaultChain(e,r){try{if(!this.session)return;const[i,n]=this.validateChain(e);this.getProvider(i).setDefaultChain(n,r)}catch(i){if(!/Please call connect/.test(i.message))throw i}}async cleanupPendingPairings(e={}){try{this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(!Fr(r))return;for(const i of r)e.deletePairings?this.client.core.expirer.set(i.topic,0):await this.client.core.relayer.subscriber.unsubscribe(i.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}catch(r){this.logger.warn(r,"Failed to cleanup pending pairings")}}abortPairingAttempt(){this.logger.warn("abortPairingAttempt is deprecated. This is now a no-op.")}async checkStorage(){this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.session&&this.createProviders()}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){var e,r;if(this.client=this.providerOpts.client||await T$.init({core:this.providerOpts.core,logger:this.providerOpts.logger||Pm,relayUrl:this.providerOpts.relayUrl||m9,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.providerOpts.session)try{this.session=this.client.session.get(this.providerOpts.session.topic)}catch(i){throw this.logger.error(i,"Failed to get session"),new Error(`The provided session: ${(r=(e=this.providerOpts)==null?void 0:e.session)==null?void 0:r.topic} doesn't exist in the Sign client`)}else{const i=this.client.session.getAll();this.session=i[0]}this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(r=>Js(r)))];lh("client",this.client),lh("events",this.events),lh("disableProviderPing",this.disableProviderPing),e.forEach(r=>{if(!this.session)return;const i=P9(r,this.session);if((i==null?void 0:i.length)===0)return;const n=zv(i),s=hc(this.namespaces,this.optionalNamespaces),o=fc(Yo({},s[r]),{accounts:i,chains:n});switch(r){case"eip155":this.rpcProviders[r]=new i7({namespace:o});break;default:this.rpcProviders[r]=new o7({namespace:o})}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{var r;const{topic:i}=e;i===((r=this.session)==null?void 0:r.topic)&&this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{var r;const{params:i,topic:n}=e;if(n!==((r=this.session)==null?void 0:r.topic))return;const{event:s}=i;if(s.name==="accountsChanged"){const o=s.data;o&&Fr(o)&&this.events.emit("accountsChanged",o.map(Bm))}else if(s.name==="chainChanged"){const o=i.chainId,a=i.event.data,c=Js(o),l=ch(o)!==ch(a)?`${c}:${ch(a)}`:o;this.onChainChanged({currentCaipChainId:l})}else this.events.emit(s.name,s.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:r})=>{var i,n;if(e!==((i=this.session)==null?void 0:i.topic))return;const{namespaces:s}=r,o=(n=this.client)==null?void 0:n.session.get(e);this.session=fc(Yo({},o),{namespaces:s}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:r})}),this.client.on("session_delete",async e=>{var r;e.topic===((r=this.session)==null?void 0:r.topic)&&(await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",fc(Yo({},ot("USER_DISCONNECTED")),{data:e.topic})))}),this.on(Dd.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(fc(Yo({},e),{internal:!0}))})}getProvider(e){return this.rpcProviders[e]||this.rpcProviders[qv]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var r;this.getProvider(e).updateNamespace((r=this.session)==null?void 0:r.namespaces[e])})}setNamespaces(e){const{namespaces:r={},optionalNamespaces:i={},sessionProperties:n,scopedProperties:s}=e;this.optionalNamespaces=hc(r,i),this.sessionProperties=n,this.scopedProperties=s}validateChain(e){const[r,i]=(e==null?void 0:e.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[r,i];if(r&&!Object.keys(this.namespaces||{}).map(o=>Js(o)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&i)return[r,i];const n=Js(Object.keys(this.namespaces)[0]),s=this.rpcProviders[n].getDefaultChain();return[n,s]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}async onChainChanged({currentCaipChainId:e,previousCaipChainId:r,internal:i=!1}){if(!this.namespaces)return;const[n,s]=this.validateChain(e);s&&(this.updateNamespaceChain(n,s),i?(this.events.emit("chainChanged",s),this.emitAccountsChangedOnChainChange({namespace:n,currentCaipChainId:e,previousCaipChainId:r})):this.getProvider(n).setDefaultChain(s),await this.persist("namespaces",this.namespaces))}emitAccountsChangedOnChainChange({namespace:e,currentCaipChainId:r,previousCaipChainId:i}){var n,s;try{if(i===r)return;const o=(s=(n=this.session)==null?void 0:n.namespaces[e])==null?void 0:s.accounts;if(!o)return;const a=o.filter(c=>c.includes(`${r}:`)).map(Bm);if(!Fr(a))return;this.events.emit("accountsChanged",a)}catch(o){this.logger.warn(o,"Failed to emit accountsChanged on chain change")}}updateNamespaceChain(e,r){if(!this.namespaces)return;const i=this.namespaces[e]?e:`${e}:${r}`,n={chains:[],methods:[],events:[],defaultChain:r};this.namespaces[i]?this.namespaces[i]&&(this.namespaces[i].defaultChain=r):this.namespaces[i]=n}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.connectParams=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,await this.deleteFromStore("namespaces"),await this.deleteFromStore("optionalNamespaces"),await this.deleteFromStore("sessionProperties"),this.session=void 0,this.cleanupPendingPairings({deletePairings:!0}),await this.cleanupStorage()}async persist(e,r){var i;const n=((i=this.session)==null?void 0:i.topic)||"";await this.client.core.storage.setItem(`${lc}/${e}${n}`,r)}async getFromStore(e){var r;const i=((r=this.session)==null?void 0:r.topic)||"";return await this.client.core.storage.getItem(`${lc}/${e}${i}`)}async deleteFromStore(e){var r;const i=((r=this.session)==null?void 0:r.topic)||"";await this.client.core.storage.removeItem(`${lc}/${e}${i}`)}async cleanupStorage(){var e;try{if(((e=this.client)==null?void 0:e.session.length)>0)return;const r=await this.client.core.storage.getKeys();for(const i of r)i.startsWith(lc)&&await this.client.core.storage.removeItem(i)}catch(r){this.logger.warn(r,"Failed to cleanup storage")}}}const f7=Nd,d7="wc",p7="ethereum_provider",g7=`${d7}@2:${p7}:`,m7="https://rpc.walletconnect.org/v1/",Ef=["eth_sendTransaction","personal_sign"],y7=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_sendCalls","wallet_getCapabilities","wallet_getCallsStatus","wallet_showCallsStatus"],xf=["chainChanged","accountsChanged"],w7=["chainChanged","accountsChanged","message","disconnect","connect"],b7=async()=>{const{createAppKit:t}=await HA(()=>import("./core-U0G1qx4Q.js").then(e=>e.bt),[]);return t};var v7=Object.defineProperty,E7=Object.defineProperties,x7=Object.getOwnPropertyDescriptors,zm=Object.getOwnPropertySymbols,A7=Object.prototype.hasOwnProperty,_7=Object.prototype.propertyIsEnumerable,Af=(t,e,r)=>e in t?v7(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,as=(t,e)=>{for(var r in e||(e={}))A7.call(e,r)&&Af(t,r,e[r]);if(zm)for(var r of zm(e))_7.call(e,r)&&Af(t,r,e[r]);return t},Jo=(t,e)=>E7(t,x7(e)),yr=(t,e,r)=>Af(t,typeof e!="symbol"?e+"":e,r);function rl(t){return Number(t[0].split(":")[1])}function dc(t){return`0x${t.toString(16)}`}function I7(t){const{chains:e,optionalChains:r,methods:i,optionalMethods:n,events:s,optionalEvents:o,rpcMap:a}=t;if(!Fr(e))throw new Error("Invalid chains");const c={chains:e,methods:i||Ef,events:s||xf,rpcMap:as({},e.length?{[rl(e)]:a[rl(e)]}:{})},l=s==null?void 0:s.filter(y=>!xf.includes(y)),u=i==null?void 0:i.filter(y=>!Ef.includes(y));if(!r&&!o&&!n&&!(l!=null&&l.length)&&!(u!=null&&u.length))return{required:e.length?c:void 0};const h=(l==null?void 0:l.length)&&(u==null?void 0:u.length)||!r,g={chains:[...new Set(h?c.chains.concat(r||[]):r)],methods:[...new Set(c.methods.concat(n!=null&&n.length?n:y7))],events:[...new Set(c.events.concat(o!=null&&o.length?o:w7))],rpcMap:a};return{required:e.length?c:void 0,optional:r.length?g:void 0}}class Cd{constructor(){yr(this,"events",new Or.EventEmitter),yr(this,"namespace","eip155"),yr(this,"accounts",[]),yr(this,"signer"),yr(this,"chainId",1),yr(this,"modal"),yr(this,"rpc"),yr(this,"STORAGE_KEY",g7),yr(this,"on",(e,r)=>(this.events.on(e,r),this)),yr(this,"once",(e,r)=>(this.events.once(e,r),this)),yr(this,"removeListener",(e,r)=>(this.events.removeListener(e,r),this)),yr(this,"off",(e,r)=>(this.events.off(e,r),this)),yr(this,"parseAccount",e=>this.isCompatibleChainId(e)?this.parseAccountId(e).address:e),this.signer={},this.rpc={}}static async init(e){const r=new Cd;return await r.initialize(e),r}async request(e,r){return await this.signer.request(e,this.formatChainId(this.chainId),r)}sendAsync(e,r,i){this.signer.sendAsync(e,r,this.formatChainId(this.chainId),i)}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(e){var r;if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(e);const{required:i,optional:n}=I7(this.rpc);try{const s=await new Promise(async(a,c)=>{var l,u;this.rpc.showQrModal&&((l=this.modal)==null||l.open(),(u=this.modal)==null||u.subscribeState(g=>{!g.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),c(new Error("Connection request reset. Please try again.")))}));const h=e!=null&&e.scopedProperties?{[this.namespace]:e.scopedProperties}:void 0;await this.signer.connect(Jo(as({namespaces:as({},i&&{[this.namespace]:i})},n&&{optionalNamespaces:{[this.namespace]:n}}),{pairingTopic:e==null?void 0:e.pairingTopic,scopedProperties:h})).then(g=>{a(g)}).catch(g=>{var y;(y=this.modal)==null||y.showErrorMessage("Unable to connect"),c(new Error(g.message))})});if(!s)return;const o=R0(s.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:o),this.setAccounts(o),this.events.emit("connect",{chainId:dc(this.chainId)})}catch(s){throw this.signer.logger.error(s),s}finally{(r=this.modal)==null||r.close()}}async authenticate(e,r){var i;if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts({chains:e==null?void 0:e.chains});try{const n=await new Promise(async(o,a)=>{var c,l;this.rpc.showQrModal&&((c=this.modal)==null||c.open(),(l=this.modal)==null||l.subscribeState(u=>{!u.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),a(new Error("Connection request reset. Please try again.")))})),await this.signer.authenticate(Jo(as({},e),{chains:this.rpc.chains}),r).then(u=>{o(u)}).catch(u=>{var h;(h=this.modal)==null||h.showErrorMessage("Unable to connect"),a(new Error(u.message))})}),s=n.session;if(s){const o=R0(s.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:o),this.setAccounts(o),this.events.emit("connect",{chainId:dc(this.chainId)})}return n}catch(n){throw this.signer.logger.error(n),n}finally{(i=this.modal)==null||i.close()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",e=>{const{params:r}=e,{event:i}=r;i.name==="accountsChanged"?(this.accounts=this.parseAccounts(i.data),this.events.emit("accountsChanged",this.accounts)):i.name==="chainChanged"?this.setChainId(this.formatChainId(i.data)):this.events.emit(i.name,i.data),this.events.emit("session_event",e)}),this.signer.on("accountsChanged",e=>{this.accounts=this.parseAccounts(e),this.events.emit("accountsChanged",this.accounts)}),this.signer.on("chainChanged",e=>{const r=parseInt(e);this.chainId=r,this.events.emit("chainChanged",dc(this.chainId)),this.persist()}),this.signer.on("session_update",e=>{this.events.emit("session_update",e)}),this.signer.on("session_delete",e=>{this.reset(),this.events.emit("session_delete",e),this.events.emit("disconnect",Jo(as({},ot("USER_DISCONNECTED")),{data:e.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",e=>{this.events.emit("display_uri",e)})}switchEthereumChain(e){this.request({method:"wallet_switchEthereumChain",params:[{chainId:e.toString(16)}]})}isCompatibleChainId(e){return typeof e=="string"?e.startsWith(`${this.namespace}:`):!1}formatChainId(e){return`${this.namespace}:${e}`}parseChainId(e){return Number(e.split(":")[1])}setChainIds(e){const r=e.filter(i=>this.isCompatibleChainId(i)).map(i=>this.parseChainId(i));r.length&&(this.chainId=r[0],this.events.emit("chainChanged",dc(this.chainId)),this.persist())}setChainId(e){if(this.isCompatibleChainId(e)){const r=this.parseChainId(e);this.chainId=r,this.switchEthereumChain(r)}}parseAccountId(e){const[r,i,n]=e.split(":");return{chainId:`${r}:${i}`,address:n}}setAccounts(e){this.accounts=e.filter(r=>this.parseChainId(this.parseAccountId(r).chainId)===this.chainId).map(r=>this.parseAccountId(r).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(e){var r,i;const n=(r=e==null?void 0:e.chains)!=null?r:[],s=(i=e==null?void 0:e.optionalChains)!=null?i:[],o=n.concat(s);if(!o.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const a=n.length?(e==null?void 0:e.methods)||Ef:[],c=n.length?(e==null?void 0:e.events)||xf:[],l=(e==null?void 0:e.optionalMethods)||[],u=(e==null?void 0:e.optionalEvents)||[],h=(e==null?void 0:e.rpcMap)||this.buildRpcMap(o,e.projectId),g=(e==null?void 0:e.qrModalOptions)||void 0;return{chains:n==null?void 0:n.map(y=>this.formatChainId(y)),optionalChains:s.map(y=>this.formatChainId(y)),methods:a,events:c,optionalMethods:l,optionalEvents:u,rpcMap:h,showQrModal:!!(e!=null&&e.showQrModal),qrModalOptions:g,projectId:e.projectId,metadata:e.metadata}}buildRpcMap(e,r){const i={};return e.forEach(n=>{i[n]=this.getRpcUrl(n,r)}),i}async initialize(e){var r;if(this.rpc=this.getRpcConfig(e),this.chainId=this.rpc.chains.length?rl(this.rpc.chains):rl(this.rpc.optionalChains),this.signer=await f7.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:e.disableProviderPing,relayUrl:e.relayUrl,storage:e.storage,storageOptions:e.storageOptions,customStoragePrefix:e.customStoragePrefix,telemetryEnabled:e.telemetryEnabled,logger:e.logger}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let i;try{const n=await b7(),{convertWCMToAppKitOptions:s}=await Promise.resolve().then(function(){return M7}),o=s(Jo(as({},this.rpc.qrModalOptions),{chains:[...new Set([...this.rpc.chains,...this.rpc.optionalChains])],metadata:this.rpc.metadata,projectId:this.rpc.projectId}));if(!o.networks.length)throw new Error("No networks found for WalletConnect");i=n(Jo(as({},o),{universalProvider:this.signer,manualWCControl:!0,enableMobileFullScreen:((r=this.rpc.qrModalOptions)==null?void 0:r.enableMobileFullScreen)===!0}))}catch(n){throw console.warn(n),new Error("To use QR modal, please install @reown/appkit package")}if(i)try{this.modal=i}catch(n){throw this.signer.logger.error(n),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(e){if(!e)return;const{chains:r,optionalChains:i,rpcMap:n}=e;r&&Fr(r)&&(this.rpc.chains=r.map(s=>this.formatChainId(s)),r.forEach(s=>{this.rpc.rpcMap[s]=(n==null?void 0:n[s])||this.getRpcUrl(s)})),i&&Fr(i)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=i==null?void 0:i.map(s=>this.formatChainId(s)),i.forEach(s=>{this.rpc.rpcMap[s]=(n==null?void 0:n[s])||this.getRpcUrl(s)}))}getRpcUrl(e,r){var i;return((i=this.rpc.rpcMap)==null?void 0:i[e])||`${m7}?chainId=eip155:${e}&projectId=${r||this.rpc.projectId}`}async loadPersistedSession(){if(this.session)try{const e=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),r=this.session.namespaces[`${this.namespace}:${e}`]?this.session.namespaces[`${this.namespace}:${e}`]:this.session.namespaces[this.namespace];this.setChainIds(e?[this.formatChainId(e)]:r==null?void 0:r.accounts),this.setAccounts(r==null?void 0:r.accounts)}catch(e){this.signer.logger.error("Failed to load persisted session, clearing state..."),this.signer.logger.error(e),await this.disconnect().catch(r=>this.signer.logger.warn(r))}}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(e){return typeof e=="string"||e instanceof String?[this.parseAccount(e)]:e.map(r=>this.parseAccount(r))}}var S7=Object.defineProperty,P7=Object.defineProperties,O7=Object.getOwnPropertyDescriptors,Hm=Object.getOwnPropertySymbols,D7=Object.prototype.hasOwnProperty,N7=Object.prototype.propertyIsEnumerable,Km=(t,e,r)=>e in t?S7(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Vv=(t,e)=>{for(var r in e||(e={}))D7.call(e,r)&&Km(t,r,e[r]);if(Hm)for(var r of Hm(e))N7.call(e,r)&&Km(t,r,e[r]);return t},C7=(t,e)=>P7(t,O7(e));function B7(t){if(t)return{"--w3m-font-family":t["--wcm-font-family"],"--w3m-accent":t["--wcm-accent-color"],"--w3m-color-mix":t["--wcm-background-color"],"--w3m-z-index":t["--wcm-z-index"]?Number(t["--wcm-z-index"]):void 0,"--w3m-qr-color":t["--wcm-accent-color"],"--w3m-font-size-master":t["--wcm-text-medium-regular-size"],"--w3m-border-radius-master":t["--wcm-container-border-radius"],"--w3m-color-mix-strength":0}}const R7=t=>{const[e,r]=t.split(":");return Gv({id:r,caipNetworkId:t,chainNamespace:e,name:"",nativeCurrency:{name:"",symbol:"",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}}})};function T7(t){var e,r,i,n,s,o,a;const c=(e=t.chains)==null?void 0:e.map(R7).filter(Boolean);if(c.length===0)throw new Error("At least one chain must be specified");const l=c.find(h=>{var g;return h.id===((g=t.defaultChain)==null?void 0:g.id)}),u={projectId:t.projectId,networks:c,themeMode:t.themeMode,themeVariables:B7(t.themeVariables),chainImages:t.chainImages,connectorImages:t.walletImages,defaultNetwork:l,metadata:C7(Vv({},t.metadata),{name:((r=t.metadata)==null?void 0:r.name)||"WalletConnect",description:((i=t.metadata)==null?void 0:i.description)||"Connect to WalletConnect-compatible wallets",url:((n=t.metadata)==null?void 0:n.url)||"https://walletconnect.org",icons:((s=t.metadata)==null?void 0:s.icons)||["https://walletconnect.org/walletconnect-logo.png"]}),showWallets:!0,featuredWalletIds:t.explorerRecommendedWalletIds==="NONE"?[]:Array.isArray(t.explorerRecommendedWalletIds)?t.explorerRecommendedWalletIds:[],excludeWalletIds:t.explorerExcludedWalletIds==="ALL"?[]:Array.isArray(t.explorerExcludedWalletIds)?t.explorerExcludedWalletIds:[],enableEIP6963:!1,enableInjected:!1,enableCoinbase:!0,enableWalletConnect:!0,features:{email:!1,socials:!1}};if((o=t.mobileWallets)!=null&&o.length||(a=t.desktopWallets)!=null&&a.length){const h=[...(t.mobileWallets||[]).map(w=>({id:w.id,name:w.name,links:w.links})),...(t.desktopWallets||[]).map(w=>({id:w.id,name:w.name,links:{native:w.links.native,universal:w.links.universal}}))],g=[...u.featuredWalletIds||[],...u.excludeWalletIds||[]],y=h.filter(w=>!g.includes(w.id));y.length&&(u.customWallets=y)}return u}function Gv(t){return Vv({formatters:void 0,fees:void 0,serializers:void 0},t)}var M7=Object.freeze({__proto__:null,convertWCMToAppKitOptions:T7,defineChain:Gv});const Zs="0x89",Vm=137,Wv="https://polygon-mainnet.g.alchemy.com/v2/0OhpcdeB5kW9aeGdRDvXD",Gm="9ae9b4de3d3181b8ea8fda287858f35e";function Yv(){if(document.getElementById("nola-chip-modal"))return;const t=document.createElement("div");t.id="nola-chip-modal",t.className="nola-chip-modal",t.innerHTML=`
    <div class="nola-chip-sheet" role="dialog" aria-modal="true" aria-label="Connect wallet">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
        <div>
          <div style="font-weight:700;color:var(--purple-300);font-size:16px">Connect Wallet</div>
          <div style="font-size:13px;color:#cfc7ee">Choose a wallet to connect to Polygon</div>
        </div>
        <button id="nola-close-modal" style="background:transparent;border:none;color:#dcd0ff;font-size:18px;cursor:pointer">✕</button>
      </div>

      <div id="nola-wallet-list">
        <div class="wallet-chip" data-kind="injected">
          <div>Injected Wallet</div>
          <div style="opacity:0.9">Browser / mobile injected wallets</div>
        </div>
        <div class="wallet-chip" data-kind="walletconnect">
          <div>WalletConnect</div>
          <div style="opacity:0.9">Mobile wallets & deep links (v2)</div>
        </div>
      </div>

      <div id="nola-modal-status" class="nola-status" style="display:none"></div>
    </div>
  `,document.body.appendChild(t),t.addEventListener("click",e=>{e.target===t&&il()}),document.getElementById("nola-close-modal").addEventListener("click",il),document.querySelectorAll("#nola-wallet-list .wallet-chip").forEach(e=>{e.addEventListener("click",async()=>{e.dataset.kind==="injected"?await L7():await F7()})})}function k7(){Yv();const t=document.getElementById("nola-chip-modal"),e=document.getElementById("nola-modal-status");t&&(t.style.display="flex"),e&&(e.style.display="none",e.textContent="")}function il(){const t=document.getElementById("nola-chip-modal");t&&(t.style.display="none")}let Rt=null,Ji=null,nl=null,Sr=null,wo=null;function $7(t){return t?t.slice(0,6)+"…"+t.slice(-4):""}function ws(t){const e=document.getElementById("nola-modal-status");e&&(e.style.display="block",e.textContent=t)}function _a(){const t=document.getElementById("nola-modal-status");t&&(t.style.display="none",t.textContent="")}function Ps(){document.querySelectorAll(".connect-wallet").forEach(e=>{if(Sr){e.innerHTML="";const r=document.createElement("div");r.className="nola-connected-chip",r.title=Sr,r.innerHTML=`<span style="font-family:monospace">${$7(Sr)}</span><span style="background:rgba(255,255,255,0.02);padding:4px 8px;border-radius:6px;color:#ffd6ff;margin-left:8px">${wo} MATIC</span>`,r.addEventListener("click",bo),e.appendChild(r)}else e.innerHTML="Connect Wallet"})}async function U7(t){try{const e=await t.request({method:"eth_chainId"});if(e&&e.toLowerCase()===Zs)return;await t.request({method:"wallet_switchEthereumChain",params:[{chainId:Zs}]})}catch(e){if((e==null?void 0:e.code)===4902||e&&/Unrecognized chain/i.test(e.message||""))await t.request({method:"wallet_addEthereumChain",params:[{chainId:Zs,chainName:"Polygon Mainnet",nativeCurrency:{name:"MATIC",symbol:"MATIC",decimals:18},rpcUrls:[Wv],blockExplorerUrls:["https://polygonscan.com"]}]}),await t.request({method:"wallet_switchEthereumChain",params:[{chainId:Zs}]});else throw e}}async function L7(){try{if(!window.ethereum){ws("No injected wallet detected. Use MetaMask, Binance Mobile or mobile browser wallets.");return}ws("Connecting injected wallet..."),Rt=window.ethereum,await U7(Rt),await Rt.request({method:"eth_requestAccounts"}),Ji=new Xy(Rt),nl=Ji.getSigner(),Sr=await nl.getAddress();const t=await Ji.getBalance(Sr);wo=Number(kc(t)).toFixed(4),il(),q7(Rt),Ps(),_a()}catch(t){console.error("Injected connect error",t),ws("Injected connection failed: "+(t.message||t))}}async function F7(){try{ws("Opening WalletConnect modal..."),Rt=await Cd.init({projectId:Gm,chains:[Vm],showQrModal:!0,rpcMap:{[Vm]:Wv||"https://polygon-rpc.com/"},metadata:{name:document.title||"NOLA",description:"Connect to Polygon",url:window.location.origin,icons:[]}}),await Rt.connect();const t=await Rt.request({method:"eth_requestAccounts"});if(!t||t.length===0)throw new Error("No accounts returned from WalletConnect");Ji=new Xy(Rt),nl=Ji.getSigner(),Sr=fr(t[0]);const e=await Ji.getBalance(Sr);wo=Number(kc(e)).toFixed(4),Rt.on&&(Rt.on("disconnect",()=>bo()),Rt.on("accountsChanged",async r=>{if(!r||r.length===0){bo();return}Sr=fr(r[0]);const i=await Ji.getBalance(Sr);wo=Number(kc(i)).toFixed(4),Ps()}),Rt.on("chainChanged",r=>{r!==Zs?ws("Please switch your wallet back to Polygon."):_a()})),il(),Ps(),_a()}catch(t){console.error("WalletConnect v2 error",t),ws("WalletConnect failed: "+(t.message||t))}}async function bo(){try{if(Rt&&typeof Rt.disconnect=="function")try{await Rt.disconnect()}catch{}}catch{}Rt=null,Ji=null,nl=null,Sr=null,wo=null,Ps(),_a()}function q7(t){!t||!t.on||(t.on("accountsChanged",e=>{if(!e||e.length===0){bo();return}Sr=fr(e[0]),Ji.getBalance(Sr).then(r=>{wo=Number(kc(r)).toFixed(4),Ps()}).catch(()=>Ps())}),t.on("chainChanged",e=>{e!==Zs?ws("Please switch your wallet back to Polygon network."):_a()}),t.on("disconnect",()=>{bo()}))}function j7(t={}){const e=t.selector||".connect-wallet";Yv(),document.querySelectorAll(e).forEach(r=>{r.addEventListener("click",async i=>{if(Sr){await bo();return}k7()})}),Ps()}typeof window<"u"&&window.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".connect-wallet").length>0&&j7()});export{Ml as A,Aa as B,O5 as C,_P as D,Uf as E,C4 as F,rn as G,_s as H,Bs as I,Mn as J,Tl as K,yi as L,$r as M,mi as N,Bv as O,A0 as P,Ob as Q,Dr as X,Qb as Y,HA as _,xs as a,Lf as b,Q as c,s3 as d,uw as e,Lr as f,hw as g,aa as h,Na as i,L8 as j,N8 as k,XI as l,F5 as m,qI as n,Or as o,eB as p,TB as q,e8 as r,Lh as s,hr as t,ti as u,Rs as v,pr as w,_d as x,ER as y,Ad as z};
